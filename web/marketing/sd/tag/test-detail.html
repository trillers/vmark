require('./nest1.html');
require('./nest2.html');

<test-detail>
    <div if="{!hidden}">
        <div>测试页面</div>
        <a class="{active: nav === 1}" onclick="{onClick(1)}">页一</a>
        <a class="{active: nav === 2}" onclick="{onClick(2)}">页二</a>
        <nest1></nest1>
        <nest2></nest2>
    </div>

    <style>
        .active{
            background: red;
        }
    </style>

    <script>
        var self = this;
        this.mixin('viewify');
        this.mixin('router');
        self.nav = 0;
        this.onClick = function(i){
            return function(e){
                self.nav = i;
                riot.route('//test/_11111/nest' + i);
            }
        };
        this.routeConfig([
            {
                path: '/nest1',
                name: 'nest1',
                before: function(done){
                    self.nav = 1;
                    self.update();
                    console.log('router hook begin ****');
                    done();
                }
            },
            {
                path: '/nest2',
                name: 'nest2',
                before: function(done){
                    self.nav = 2;
                    self.update();
                    done();
                }
            }
        ]);
        this.on('open', function(){
            console.log("[parent] set time out begin ****")
            self.trigger('ready');
            setTimeout(function(){
                console.log("[parent] set time out over ****")

            }, 1000)

        })
    </script>
</test-detail>