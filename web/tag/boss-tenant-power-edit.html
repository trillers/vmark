<boss-tenant-power-edit>
    <div if="{!hidden}" class="container" style="margin-top: 0px">
        <div class="col-md-10 col-md-offset-1">
            <div class="jumbotron" style="height: auto; padding: 25px;">
                <div id="addForm" class="panel" style="margin-top: 1em;">
                    <div style="padding-left: 20px; padding-bottom: 20px; padding-top: 15px"><a href="#power/list" style="font-size: 15px; text-decoration: none;">返回活动列表</a></div>
                    <ul class="ul" style="text-align: left; padding-left: 2em">
                        <li><span>助力活动设置</span></li>
                        <li id="type_select"><span>类型: </span>
                            <label><input id="type_rp" name="activity_type" type="radio" value="rp" checked="{activity.type === 'rp'}"/>红包</label>
                            <label><input id="type_po" name="activity_type" type="radio" value="po" checked="{activity.type === 'po'}"/>积分</label>
                        </li>
                        <li><span>启动图片助力:  </span><input id="with_pic" type="checkbox" checked="{activity.with_pic}"></li>
                        <li><span>活动名称:  </span><input name="activityName" type="text" value="{activity.name}"/></li>
                        <li class="bgImg" style="min-height: 26px"><span style="float: left">背景图片(3张):  </span><input id="bgImg" type="file" multiple="multiple" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="uploadBgImg()" style="width: 60px;"/>

                            <div id="bgImg1" class="bgImgCon"><i class="glyphicon glyphicon-remove"></i><img src="" alt=""/></div>
                            <div id="bgImg2" class="bgImgCon"><i class="glyphicon glyphicon-remove"></i><img src="" alt=""/></div>
                            <div id="bgImg3" class="bgImgCon"><i class="glyphicon glyphicon-remove"></i><img src="" alt=""/></div>
                        </li>
                        <li style="clear: both; min-height: 26px"><span style="float: left">分享卡片图片:  </span><input id="shareImg" type="file" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="uploadShareImg()" style="width: 60px;"/>
                            <div id="shareImg1" class="shareImgCon"><i class="glyphicon glyphicon-remove"></i><img src="" alt=""/></div>
                        </li>
                        <li style="clear: both"><span>活动时间:  </span><input id="startTime" type="date" value="{formatDate(activity.startTime)}"/><span> 至 </span><input id="endTime" type="date" value="{formatDate(activity.endTime)}"/>
                        </li>
                        <li><span>活动介绍:  </span><div id="desc"></div></li>
                        <li><span>活动规则:  </span><div id="rule"></div></li>
                        <li><span>分享标题自定义:  </span><input class="form-control" type="text" name="shareTitle" value="{activity.shareTitle}"/></li>
                        <li><span>分享描述自定义:  </span><input class="form-control" type="text" name="shareDesc" value="{activity.shareTitle}"/></li>
                        <li><span>基础奖励:  </span><input id="base_power" type="text" value="{activity.base_power}"/></li>
                        <li><span>好友助力单次奖励:  </span><input id="friend_help_min_power" type="text" value="{activity.friend_help_min_power}"/><span> 至 </span><input id="friend_help_max_power" type="text" value="{activity.friend_help_max_power}"/></li>
                        <li><span>好友助力上限人数:  </span><input id="friend_help_count_limit" type="text" value="{activity.friend_help_count_limit}"/></li>
                        <li style="text-align: center; margin-top: 1em"><input class="btn btn-success" type="button"
                                                                               id="submit" value="提交"/></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    </div>
    <style scoped>
        .ul {list-style-type: none; text-align: center; padding: 0}
        .ul li {margin-bottom: 20px;}
        .bgImg #bgImg {float: left; margin-left: 10px;}
        .bgImg .bgImgCon {margin-left: 10px; display: -webkit-inline-box; position: relative; display: none; border: solid 1px #E8E7E7;}
        .bgImgCon i{color: #EC3131; position: absolute; left: 58px; top: 2px; cursor: pointer;}
        .bgImgCon div{margin-left: 20px; float: left;}
        .bgImgCon img {width: 75px; height: 75px;}
        .shareImgCon img {width: 75px; height: 75px;}
        #shareImg{float: left; margin-left: 10px;}
        .shareImgCon i{color: #EC3131;position: absolute;left: 58px;top: 2px;cursor: pointer;}
        .shareImgCon{margin-left: 10px; display: -webkit-inline-box;position: relative; display: none; border: solid 1px #E8E7E7;}
    </style>
    <script>
        "use strict"
        var self = nest.presentable(this);
        var loadPowerActivity = domain.action('loadPowerActivity');

        self.on('open', function(ctx){
            loadPowerActivity.newInvocation({
                id: ctx.id
            }).onDone(function(data){
                self.activity = data;
                self.trigger('ready', false);
                self.trigger('view-route-to');
                setTimeout(function(){
                    $('#rule').summernote({
                        height: 200,
                        minHeight: null,
                        maxHeight: null
                    }).summernote('code', self.activity.rule || '');
                }, 10);
                setTimeout(function(){
                    $('#desc').summernote({
                        height: 200,
                        minHeight: null,
                        maxHeight: null
                    }).summernote('code', self.activity.desc || '');
                }, 10);
            }).execute();
        });
        self.on('mount', function(){
            self.validators = _.widget.validatify([]);
        });

        self.formatDate = function(date) {
            var dateTime = new Date(date);
            var year = dateTime.getFullYear();
            var month = (dateTime.getMonth() + 1)>9 ? (dateTime.getMonth() + 1) : '0' + (dateTime.getMonth() + 1);
            var day = dateTime.getDate() > 9 ? dateTime.getDate() : '0' + dateTime.getDate();
            return year + '-' + month + '-' + day;
        }
    </script>
</boss-tenant-power-edit>