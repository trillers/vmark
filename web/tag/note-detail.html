<note-detail>
    <div if="{!hidden}">
        <note-menu></note-menu>
        <div>
            <label>标题: </label><label>{note.title}</label>
            <div class="">
                <img class="headimg_size_m" src="{note.user.headimgurl}"/>
                <span>{note.user.name}</span>
            </div>
            <div>
                <span>{note.txt}</span>
            </div>
            <ul each="{note.comments}">
                <li>{content}</li>
                <li>{user.name}</li>
                <li>{parent.formatDate(crtOn)}</li>
            </ul>
        </div>
        <note-footer cmds="{footerCmds}"></note-footer>
        <style>
            .headimg_size_m{
                width: 48px;
                height: 48px;
            }
        </style>
        <script>
            var self = nest.presentable(this);
            var loadNote = domain.action('loadNote');
            self.note = {
                title: null,
                comments: null,
                crtOn: null,
                _id: null
            };
            self.state = {
                'EDIT': false,
                'VIEW': false
            };
            self.init = function(){
                wx.onMenuShareTimeline({
                    title: '测试分享主题',
                    link: getLink(),
                    imgUrl: '',
                    success: function(){

                    },
                    cancel: function(){

                    }
                });
                function getLink(){
                }
            };
            self.comment = function(){
                alert('111')
            };
            self.like = function(){

            };
            self.footerCmds = [
                {
                    name: '评论',
                    method: self.comment
                },
                {
                    name: '喜欢',
                    method: self.like
                }
            ];
            self.formatDate = util.formatDateForComments;
            function onLoadNote(data) {
                console.log(data);
                if(data){
                    self.note = data;
                }
                else{

                }
                console.info('tag note detail is opening');
                self.trigger('ready', false);
                self.trigger('view-route-to');
            }
            this.on('mount', function(){
                loadNote.onDone(onLoadNote);
            });
            this.on('unmount', function(){
                loadNote.offDone(onLoadNote);
            });
            this.on('open', function(options){
                console.warn('options.........')
                console.warn(options);
                self.note._id = options._id;
                self.init();
                loadNote.execute({
                    userId: __page.user,
                    noteId: self.note._id
                });
            });

            this.on('leave', function(){
                self.mask = true;
                self.update();
            });

            this.on('reenter', function(){
                self.mask = false;
                self.update();
            });

            this.on('refresh', function(){
                console.info('tag group index is refreshing');
                //_refresh();
            });
        </script>
    </div>
</note-detail>