<btn-group>
    <div class="mask" if="{state.current === 'menu' || state.current === 'edit'}" ontouchstart="{viewMode}" style="height: {window.innerHeight + 'px'}"></div>
    <div class="add-section-bar" if="{state.current == 'view'}" style="position: fixed; z-index:4; bottom: 0px">
        <div onclick="{showSubMenu}" style="width:48px;height:48px;background: red;float:left">单</div>
        <div if="{editableOrNot()}" onclick="{addNewNote}" style="width:48px;height:48px;background: red;float:right">新</div>
    </div>
    <div if="{state.current === 'menu'}" style="width: 100%; position: fixed; bottom: 0px; z-index: 100">
        <ul class="group_ul">
            <li class="{active: opts.active === 'note'}">
                <a href="#timeline">笔记</a>
            </li>
            <li class="{active: opts.active === 'notebook'}">
                <a href="#notebook/index">笔记本</a>
            </li>
            <li class="{active: opts.active === 'share'}">
                <a href="#share">趣分享</a>
            </li>
        </ul>
    </div>
    <style scoped>
        .mask{
            width: 100%;
            position: fixed;
            top: 0px;
            left: 0px;
            z-index: 5;
            background: black;
            opacity: 0.2;
        }
        .active{
            background: #5D5D5D !important;
        }
        .group_ul{
            margin: 0px;
            padding: 0px;
        }
        .group_ul li{
            width: 33.3333333%;
            float: left;
            list-style-type:none;
            height: 40px;
            line-height: 40px;
            background: #A5A5A5;
            border-right:1px solid black;
            box-sizing:border-box;
            text-align: center;
        }
        .group_ul li a{
            display: inline-block;
            width: 100%;
            height: 100%;
            color: white;
        }
    </style>
    <script>
        "use strict";
        self = this;
        self.currNav = 'note';
        self.state = {
            current: 'view'
        };
        riot.route(function(){
            self.state.current = 'view';
            self.update();
        });
        self.showSubMenu = function(e){
            self.state.current = 'menu';
        };
        self.viewMode = function(){
            self.state.current = 'view';
            app.trigger('viewMode');
        };
        self.editableOrNot = function(){
            return ((self.opts.latestnotebook.participates.map(function(participate){return participate._id})).indexOf(__page.user._id) >= 0)
                && (window.location.hash.split('/')[0] === '#timeline')
        };
        app.on('changeForUpdate', function(res){
            self.update();
        });
        //view --> edit
        self.addNewNote = function(){
            app.trigger('addNewNote');
            self.state.current = 'edit';
        };
        self.onMenuClick = function(e){
            console.log(e)
        };
    </script>
</btn-group>