webpackJsonp([0,1],[function(e,t,n){var i=n(1);window.riot=i,n(2)();var o=(n(3).init(),n(7)),r=n(28),a=new r({defaultHash:"tenant"});a.routeView("tenant",nest.viewable({name:"tenant",mount:function(e){var t=i.mount("boss-tenant",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",e.req.query)}})),a.routeView("sd",nest.viewable({name:"sd",mount:function(e){var t=i.mount("boss-tenant-sd",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",e.req.query)}})),a.routeView("sd/courses",nest.viewable({name:"sd/courses",mount:function(e){var t=i.mount("boss-tenant-sd-courses",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",e.req.query)}})),a.routeView("sd/bespeaks",nest.viewable({name:"boss-tenant-sd-bespeaks",mount:function(e){var t=i.mount("boss-tenant-sd-bespeaks",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",e.req.query)}})),a.routeView("sd/catalogs",nest.viewable({name:"boss-tenant-sd-catalogs",mount:function(e){var t=i.mount("boss-tenant-sd-catalogs",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",e.req.query)}})),a.routeView("sd/catalogs/add",nest.viewable({name:"boss-tenant-sd-catalogs-add",mount:function(e){var t=i.mount("boss-tenant-sd-catalogs-add",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",e.req.query)}})),a.routeView("sd/catalogs/edit/_:id",nest.viewable({name:"boss-tenant-sd-catalogs-edit",mount:function(e){var t=i.mount("boss-tenant-sd-catalogs-edit",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",e)}})),a.routeView("sd/catalogs/_:id",nest.viewable({name:"boss-tenant-sd-catalogs-detail",mount:function(e){var t=i.mount("boss-tenant-sd-catalogs-detail",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",e)}})),a.routeView("sd/customers",nest.viewable({name:"boss-tenant-sd-customers",mount:function(e){var t=i.mount("boss-tenant-sd-customers",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",e.req.query)}})),a.routeView("sd/splitbill",nest.viewable({name:"boss-tenant-sd-splitbill",mount:function(e){var t=i.mount("boss-tenant-sd-splitbill",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",e.req.query)}})),a.routeView("sd/distributors",nest.viewable({name:"boss-tenant-sd-distributors",mount:function(e){var t=i.mount("boss-tenant-sd-distributors",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",e.req.query)}})),a.routeView("sd/courses/_:id",nest.viewable({name:"boss-tenant-sd-courses-detail",mount:function(e){var t=i.mount("boss-tenant-sd-courses-detail",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",e)}})),a.routeView("sd/courses/add",nest.viewable({name:"sd/courses/add",mount:function(e){var t=i.mount("boss-tenant-sd-courses-add",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",e.req.query)}})),a.routeView("sd/courses/edit/_:id",nest.viewable({name:"boss-tenant-sd-courses-edit",mount:function(e){var t=i.mount("boss-tenant-sd-courses-edit",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",e)}})),a.routeView("sd/courses/edit/details/_:id",nest.viewable({name:"boss-tenant-sd-courses-edit-detail",mount:function(e){var t=i.mount("boss-tenant-sd-courses-edit-detail",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",e)}})),a.routeView("wechatsite",nest.viewable({name:"wechatsite",mount:function(e){var t=i.mount("boss-tenant-wechatsite",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",e.req.query)}})),a.routeView("wechatsite/_:id",nest.viewable({name:"wechatsite/_:id",mount:function(e){var t=i.mount("boss-wechatsite",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",{id:e.req.params.id})}})),a.routeView("wechatsite/_:id/settings",nest.viewable({name:"wechatsite/_:id/settings",mount:function(e){var t=i.mount("boss-wechatsite-settings",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",{id:e.req.params.id})}})),a.routeView("wechatsite/edit/_:id",nest.viewable({name:"wechatsite/edit/_:id",mount:function(e){var t=i.mount("boss-wechatsite-edit",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",{id:e.req.params.id})}})),a.routeView("wechatsite/add",nest.viewable({name:"wechatsite/add",mount:function(e){var t=i.mount("boss-wechatsite-add",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",e.req.query)}})),a.routeView("power/list",nest.viewable({name:"power/list",mount:function(e){var t=i.mount("boss-tenant-power-list",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",e.req.query)}})),a.routeView("power/edit/_:id",nest.viewable({name:"power/edit/_:id",mount:function(e){var t=i.mount("boss-tenant-power-edit",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",{id:e.req.params.id})}})),a.routeView("power/add",nest.viewable({name:"power/add",mount:function(e){var t=i.mount("boss-tenant-power-add",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open")}})),a.routeView("sd/orders",nest.viewable({name:"boss-tenant-sd-orders",mount:function(e){var t=i.mount("boss-tenant-sd-orders",{filter:e.req.query,app:this.parent});this.tag=t[0]},route:function(e){this.context=e,this.tag.trigger("open",e.req.query)}})),a.on("init",function(){var e=o.getCookie("attentionUrl"),t=e||window.location.hash;t||(t=a.defaultHash),window.app=a,i.mount("boss-tenant-topbar"),i.mount("confirm"),i.mount("showimg"),i.route(t),e&&o.setCookie("attentionUrl","",-1)}),a.init(),e.exports=a},function(e,t,n){!function(){function t(e){var t={val:e},n=e.split(/\s+in\s+/);return n[1]&&(t.val=x(0)+n[1],n=n[0].slice(x(0).length).trim().split(/,\s*/),t.key=n[0],t.pos=n[1]),t}function n(e,t,n){var i={};return i[e.key]=t,e.pos&&(i[e.pos]=n),i}function i(e,i,o){function r(e,t,n){f.splice(e,0,t),h.splice(e,0,n)}u(e,"each");var s,l=e.outerHTML,c=e.previousSibling,p=e.parentNode,f=[],h=[];o=t(o),i.one("update",function(){p.removeChild(e)}).one("premount",function(){p.stub&&(p=i.root)}).on("update",function(){var e=k(o.val,i);if(e){if(!Array.isArray(e)){var t=JSON.stringify(e);if(t==s)return;s=t,d(h,function(e){e.unmount()}),f=[],h=[],e=Object.keys(e).map(function(t){return n(o,t,e[t])})}d(m(f,e),function(e){var t=f.indexOf(e),n=h[t];n&&(n.unmount(),f.splice(t,1),h.splice(t,1))});var u=p.childNodes,g=[].indexOf.call(u,c);d(e,function(t,c){var d=e.indexOf(t,c),m=f.indexOf(t,c);if(0>d&&(d=e.lastIndexOf(t,c)),0>m&&(m=f.lastIndexOf(t,c)),0>m){!s&&o.key&&(t=n(o,t,d));var v=new a({tmpl:l},{before:u[g+1+d],parent:i,root:p,item:t});return v.mount(),r(d,t,v)}return o.pos&&h[m][o.pos]!=d&&(h[m].one("update",function(e){e[o.pos]=d}),h[m].update()),d!=m?(p.insertBefore(u[g+m+1],u[g+d+1]),r(d,f.splice(m,1)[0],h.splice(m,1)[0])):void 0}),f=e.slice()}})}function o(e,t,n){h(e,function(e){if(1==e.nodeType){var i=v(e);if(i&&!e.getAttribute("each")){var o=new a(i,{root:e,parent:t});t.tags[e.getAttribute("name")||i.name]=o,n.push(o)}d(e.attributes,function(n){/^(name|id)$/.test(n.name)&&(t[n.value]=e)})}})}function r(e,t,n){function o(e,t,i){if(t.indexOf(x(0))>=0){var o={dom:e,expr:t};n.push(p(o,i))}}h(e,function(e){var n=e.nodeType;if(3==n&&"STYLE"!=e.parentNode.tagName&&o(e,e.nodeValue),1==n){var r=e.getAttribute("each");return r?(i(e,t,r),!1):(d(e.attributes,function(t){var n=t.name,i=n.split("__")[1];return o(e,t.value,{attr:i||n,bool:i}),i?(u(e,n),!1):void 0}),v(e)?!1:void 0)}})}function a(e,t){function n(e){d(Object.keys(C),function(e){l[e]=k(C[e],h||s)})}function i(e){if(d(v,function(t){t[e?"mount":"unmount"]()}),h){var t=e?"on":"off";h[t]("update",s.update)[t]("unmount",s.unmount)}}var a,s=w.observable(this),l=g(t.opts)||{},u=f(e.tmpl),h=t.parent,m=[],v=[],b=t.root,y=t.item,x=e.fn,C={};x&&b.riot||(b.riot=!0,p(this,{parent:h,root:b,opts:l,tags:{}},y),d(b.attributes,function(e){C[e.name]=e.value}),this.update=function(e,t){p(s,e,y),n(),s.trigger("update",y),c(m,s,y),s.trigger("updated")},this.mount=function(){if(n(),x&&x.call(s,l),i(!0),r(u,s,m),s.update(),s.trigger("premount"),x)for(;u.firstChild;)b.appendChild(u.firstChild);else a=u.firstChild,b.insertBefore(a,t.before||null);b.stub&&(s.root=b=h.root),s.trigger("mount")},this.unmount=function(){var e=x?b:a,t=e.parentNode;if(t){if(h)t.removeChild(e);else for(;b.firstChild;)b.removeChild(b.firstChild);i(),s.trigger("unmount"),s.off("*"),delete b.riot}},o(u,this,v))}function s(e,t,n,i,o){n[e]=function(e){e=e||window.event,e.which=e.which||e.charCode||e.keyCode,e.target=e.target||e.srcElement,e.currentTarget=n,e.item=o,t.call(i,e)!==!0&&(e.preventDefault&&e.preventDefault(),e.returnValue=!1);var r=o?i.parent:i;r.update()}}function l(e,t,n){e&&(e.insertBefore(n,t),e.removeChild(t))}function c(e,t,n){d(e,function(e){var i=e.dom,o=e.attr,r=k(e.expr,t),a=e.dom.parentNode;if(null==r&&(r=""),a&&"TEXTAREA"==a.tagName&&(r=r.replace(/riot-/g,"")),e.value!==r){if(e.value=r,!o)return i.nodeValue=r;if(u(i,o),"function"==typeof r)s(o,r,i,t,n);else if("if"==o){var c=e.stub;r?c&&l(c.parentNode,c,i):(c=e.stub=c||document.createTextNode(""),l(i.parentNode,i,c))}else if(/^(show|hide)$/.test(o))"hide"==o&&(r=!r),i.style.display=r?"":"none";else if("value"==o)i.value=r;else if("riot-"==o.slice(0,5))o=o.slice(5),r?i.setAttribute(o,r):u(i,o);else{if(e.bool){if(i[o]=r,!r)return;r=o}"object"!=typeof r&&i.setAttribute(o,r)}}})}function d(e,t){for(var n,i=0,o=(e||[]).length;o>i;i++)n=e[i],null!=n&&t(n,i)===!1&&i--;return e}function u(e,t){e.removeAttribute(t)}function p(e,t,n){return t&&d(Object.keys(t),function(n){e[n]=t[n]}),n?p(e,n):e}function f(e){var t=e.trim().slice(1,3).toLowerCase(),n=/td|th/.test(t)?"tr":"tr"==t?"tbody":"div",i=document.createElement(n);return i.stub=!0,i.innerHTML=e,i}function h(e,t){if(e)if(t(e)===!1)h(e.nextSibling,t);else for(e=e.firstChild;e;)h(e,t),e=e.nextSibling}function m(e,t){return e.filter(function(e){return t.indexOf(e)<0})}function g(e){function t(){}return t.prototype=e,new t}function v(e){return T[e.tagName.toLowerCase()]}function b(e){var t=document.createElement("style");t.innerHTML=e,document.head.appendChild(t)}function y(e,t,n){var i=T[t];return i&&e&&(i=new a(i,{root:e,opts:n})),i&&i.mount?(i.mount(),C.push(i),i.on("unmount",function(){C.splice(C.indexOf(i),1)})):void 0}var w={version:"WIP",settings:{}};w.observable=function(e){e=e||{};var t={},n=0;return e.on=function(i,o){return"function"==typeof o&&(o._id="undefined"==typeof o._id?n++:o._id,i.replace(/\S+/g,function(e,n){(t[e]=t[e]||[]).push(o),o.typed=n>0})),e},e.off=function(n,i){return"*"==n?t={}:n.replace(/\S+/g,function(e){if(i)for(var n,o=t[e],r=0;n=o&&o[r];++r)n._id==i._id&&(o.splice(r,1),r--);else t[e]=[]}),e},e.one=function(t,n){return n&&(n.one=1),e.on(t,n)},e.trigger=function(n){for(var i,o=[].slice.call(arguments,1),r=t[n]||[],a=0;i=r[a];++a)i.busy||(i.busy=1,i.apply(e,i.typed?[n].concat(o):o),i.one?(r.splice(a,1),a--):r[a]!==i&&a--,i.busy=0);return e},e},function(e,t){function n(){return a.hash.slice(1)}function i(e){return e.split("/")}function o(e){e.type&&(e=n()),e!=r&&(s.trigger.apply(null,["H"].concat(i(e))),r=e)}if(this.top){var r,a=location,s=e.observable(),l=window,c=e.route=function(e){e[0]?(a.hash=e,o(e)):s.on("H",e)};c.exec=function(e){e.apply(null,i(n()))},c.parser=function(e){i=e},l.addEventListener?l.addEventListener(t,o,!1):l.attachEvent("on"+t,o)}}(w,"hashchange");var x=function(e,t,n){return function(i){return t=w.settings.brackets||e,n!=t&&(n=t.split(" ")),i&&i.test?t==e?i:RegExp(i.source.replace(/\{/g,n[0].replace(/(?=.)/g,"\\")).replace(/\}/g,n[1].replace(/(?=.)/g,"\\")),i.global?"g":""):n[i]}}("{ }"),k=function(){function e(e,n){return e=(e||x(0)+x(1)).replace(x(/\\{/g),"￰").replace(x(/\\}/g),"￱"),n=i(e,x(/{[\s\S]*?}/g)),new Function("d","return "+(n[0]||n[2]||n[3]?"["+n.map(function(e,n){return n%2?t(e,!0):'"'+e.replace(/\n/g,"\\n").replace(/"/g,'\\"')+'"'}).join(",")+'].join("")':t(n[1])).replace(/\uFFF0/g,x(0)).replace(/\uFFF1/g,x(1))+";")}function t(e,t){return e=e.replace(/\n/g," ").replace(x(/^[{ ]+|[ }]+$|\/\*.+?\*\//g),""),/^\s*[\w- "']+ *:/.test(e)?"["+e.replace(/\W*([\w- ]+)\W*:([^,]+)/g,function(e,t,i){return i.replace(/[^&|=!><]+/g,n)+'?"'+t.trim()+'":"",'})+'].join(" ").trim()':n(e,t)}function n(e,t){return e=e.trim(),e?"(function(v){try{v="+(e.replace(r,function(e,t,n){return n?"(d."+n+"===undefined?window."+n+":d."+n+")":e})||"x")+"}finally{return "+(t===!0?'!v&&v!==0?"":v':"v")+"}}).call(d)":""}function i(e,t){var n=[],i=0;return e.replace(t,function(t,o){n.push(e.slice(i,o),t),i=o+t.length}),n.concat(e.slice(i))}var o={},r=/(['"\/]).*?[^\\]\1|\.\w*|\w*:|\b(?:(?:new|typeof|in|instanceof) |(?:this|true|false|null|undefined)\b|function *\()|([a-z_$]\w*)/gi;return function(t,n){return t&&(o[t]=o[t]||e(t))(n)}}(),C=[],T={};w.tag=function(e,t,n,i){"function"==typeof n?i=n:n&&b(n),T[e]={name:e,tmpl:t,fn:i}},w.mount=function(e,t,n){function i(e){var i=t||e.tagName.toLowerCase(),r=y(e,i,n);r&&o.push(r)}"*"==e&&(e=Object.keys(T).join(", ")),"object"==typeof t&&(n=t,t=0);var o=[];return e.tagName?(i(e),o[0]):(d(document.querySelectorAll(e),i),o)},w.update=function(){return d(C,function(e){e.update()})},w.mountTo=w.mount,w.util={brackets:x,tmpl:k},e.exports=w}()},function(e,t){e.exports=function(){riot.tag("accordion",'<nav> <ul class="nav nav-pills nav-stacked"> <li role="presentation" class="{active: useAsDefault}" each="{opts.navs}"> <a href="#{path}">{presentation}</a> </li> </ul> </nav>',"accordion ul{ margin: 0px; padding: 0px; }",function(e){}),riot.tag("add-group-member",'<div class="title_wrap"> <b onclick="{backToView}" style="display: block;width:24px;height:24px;float:left" onclick="{back}"> <i class="glyphicon glyphicon-chevron-left"></i> </b> 添加成员 <b onclick="{submit}" style="display: block;width:80px;height:24px;float:right"> <button type="button" class="btn btn-default" style="display:inline-block;background: #42AC3E; color:white; border: none"> 确认添加 </button> </b> </div> <div> <div class="wrapper" attr="{parent.mediaUsers}"> <div style="margin-bottom: 10px"> <button onclick="{selectContact}" class="{select_contact: status[\'contact\']}"> <span class="glyphicon glyphicon-user" aria-hidden="true"></span> 联系人 </button> <button onclick="{selectGroup}" class="{select_contact: status[\'group\']}"> <span class="glyphicon glyphicon-th" aria-hidden="true"></span> 群组 </button> </div> <div each="{parent.mediaUsers}"> <div class="list_container"> <div style="height:24px;line-height: 24px;margin-bottom: 10px;border-bottom:1px solid #ddd">{media.name}<strong>({mediaUsers.length})</strong></div> <ul class="user_list"> <li onclick="{parent.parent.selectMember}" each="{mediaUsers}" if="{parent.parent.status[contacttype]}" id="{_id}" media="{parent.media._id}" group="{parent.parent.parent.group._id}"> <img riot-src="{parent.parent.app.settings.api.url + \'/file?media_id=\' + headimgurl}"> <p style="overflow: hidden;height:24px">{remark}</p> </li> </ul> </div> </div> </div> </div>',"add-group-member .select_contact{ background: #5B6779; border:1px solid #2E3238; color:white; } add-group-member .list_container{ overflow: scroll; height:500px; } add-group-member .wrapper{ width:90%; margin:0px auto; } add-group-member .user_list{ overflow: hidden; list-style-type: none; margin:0px; padding:0px; color:#888; } add-group-member .user_list >li{ width:100px; float:left; margin:5px 0px; text-align: center; line-height: 30px; position: relative; } add-group-member .user_list >li img{ display: inline-block; width:64px; height:64px; } add-group-member .title_wrap{ height:50px; margin:8px 10px; text-align: center; line-height: 50px; } add-group-member .select{ position: absolute; top:0px; left:17px; background:#42AC3E; width:64px; height:64px; opacity: 0.8; } add-group-member .select div{ font-size: 40px; color:white; margin:8px; }",function(e){function t(e){e.success&&(n.members={},e.data&&e.data.length&&e.data.forEach(function(e){n.parent.groupMembers.unshift(e)}),n.parent.panel.view(),n.parent.update())}var n=this;n.page=__page,n.app=__app,n.nav=0,n.members={},n.init=function(){n.status={},n.status.contact="contact"};var i={"基本信息":0,"成员":1},o=domain.action("addGroupMembers");this.on("mount",function(){o.onDone(t)}),this.on("unmount",function(){o.offDone(t)}),this.selectContact=function(e){return n.status.contact?void delete n.status.contact:void(n.status.contact="contact")}.bind(this),this.selectGroup=function(e){return n.status.group?void delete n.status.group:void(n.status.group="group")}.bind(this),this.clickNav=function(e){n.nav=i[e.target.innerText]}.bind(this),this.addMember=function(e){n.parent.panel.status="add_m",n.parent.update()}.bind(this),this.selectMember=function(e){function t(e){if(n.members[a])o(e),delete n.members[a];else{var t={group:s,media:l,member:a};n.members[a]=t,i(e)}}function i(e){var t=document.createElement("div");t.classList.add("select");var n=document.createElement("div");n.classList.add("glyphicon"),n.classList.add("glyphicon-ok"),t.appendChild(n),e.appendChild(t)}function o(e){e.removeChild(e.childNodes[e.childNodes.length-1])}var r=e.currentTarget,a=r.id,s=r.getAttribute("group"),l=r.getAttribute("media");t(r)}.bind(this),this.submit=function(e){Object.keys(n.members).length&&o.execute({members:n.members})}.bind(this),this.backToView=function(e){n.members={},n.parent.panel.view(),n.parent.update()}.bind(this)}),riot.tag("add-group",'<div class="title_wrap"> <b onclick="{backToView}" style="display: block;width:24px;height:24px;float:left" onclick="{back}"> <i class="glyphicon glyphicon-chevron-left"></i> </b> 添加分组 </div> <form id="form"> <div class="profile"> <div class="profile_item row-fluid form-group"> <div class="primary col-md-5 col-xs-5 col-sm-5"> <label>名称</label> </div> <div class="primary col-md-7 col-xs-7 col-sm-7"> <input id="groupName" class="form-control" type="text" placeholder="请输入名称"> </div> </div> <div class="profile_item row-fluid form-group"> <div class="secondary col-md-5 col-xs-5 col-sm-5"> <label>类型</label> </div> <div class="secondary col-md-7 col-xs-7 col-sm-7"> <label class="radio-inline"> <input type="radio" name="inlineRadioOptions" id="inlineRadio1" value="{app.enums.GroupType.names.Selected}" checked> {app.enums.GroupType.values.selected} </label> <label class="radio-inline" style="color:#ccc"> <input type="radio" name="inlineRadioOptions" id="inlineRadio2" value="{app.enums.GroupType.names.Tagged}" disabled> {app.enums.GroupType.values.tagged} </label> </div> </div> <div class="profile_item row-fluid form-group"> <div class="secondary col-md-5 col-xs-5 col-sm-5"> <label>包含微信号</label> </div> <div class="secondary col-md-7 col-xs-7 col-sm-7"> <button each="{parent.myManageMedia}" onclick="{backToView}" type="button" class="btn btn-default" style="display:inline-block;background: #CCC; color:white; border: none"> {name} </button> </div> </div> <div class="profile_item row-fluid form-group"> <div class="secondary col-md-5 col-xs-5 col-sm-5"> <label>负责人</label> </div> <div class="secondary col-md-7 col-xs-7 col-sm-7"> <label>{page.user.nickname}</label> </div> </div> <div class="profile_item"> <button onclick="{submit}" type="button" class="btn btn-default" style="height:40px;width:160px;background: #42AC3E; color:white; border: none"> <span class="glyphicon glyphicon-ok" aria-hidden="true"></span> 确认 </button>&nbsp&nbsp&nbsp&nbsp <button onclick="{backToView}" type="button" class="btn btn-default" style="display:inline-block;height:40px;width:160px;background: #9D9D9D; color:white; border: none"> <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> 返回 </button> </div> </div> </form>',"add-group .profile{ padding-top:80px; margin:0px auto; width:80% } add-group .profile_item{ margin: 0px auto; text-align: center; margin-bottom: 30px; overflow: hidden; } add-group .profile_item div.secondary label{ font-size: 16px; } add-group .profile_item >div:first-child{ text-align: right; } add-group .profile_item >div:nth-child(2){ text-indent: 3em; text-align: left; } add-group .profile_item label{ font-weight:400; font-size: 24px; } add-group .title_wrap{ height:50px; line-height: 50px; margin:8px 10px; text-align: center; border-bottom: 1px solid #ddd; } add-group .tips_wrapper{ width:100%; position: absolute; top:0px; left:0px; overflow: hidden; margin-top:100px; -webkit-transition: opacity 1s ease-in; -moz-transition: opacity 1s ease-in; -ms-transition: opacity 1s ease-in; -o-transition: opacity 1s ease-in; transition: opacity 1s ease-in; } add-group .tips{ width:60%; margin:0px auto; } add-group .fadeout{ opacity: 0; }",function(e){function t(e){i.parent.groups.unshift(e.data),i.parent.group=e.data,i.parent.groupMembers=[],i.backToView()}function n(e,t,n){function o(e,t){e.classList.add(t)}function r(e,t){t.removeChild(e)}var a=null,s=null;n?(a="alert-success",s="glyphicon-ok"):(a="alert-danger",s="glyphicon-exclamation-sign");var l=document.createElement("div");o(l,"tips_wrapper");var c=document.createElement("div");o(c,"alert"),o(c,a),o(c,"tips"),c.setAttribute("role","alert");var d=document.createElement("span");o(d,"glyphicon"),o(d,s),d.setAttribute("aria-hidden","true");var u=document.createElement("span");o(u,"sr-only"),u.innerText="错误:";var p=document.createElement("span");p.innerText=" "+t,c.append=function(e){return c.appendChild(e),c},c.append(d).append(u).insertBefore(p,u.nextSibling),l.appendChild(c),e.appendChild(l),setTimeout(function(){o(l,"fadeout"),setTimeout(function(){r(l,i.form)},1e3)},1e3)}var i=this;i.app=__app,i.page=__page;var o=domain.action("addGroup");this.backToView=function(e){i.groupName.value="",i.parent.panel.status="view",i.parent.tags["group-left"].init(),i.parent.update()}.bind(this),this.on("mount",function(){o.onDone(t)}),this.on("unmount",function(){o.offDone(t)}),this.submit=function(e){if(!i.groupName.value)return void n(i.form,"请输入名称",!1);var t=document.querySelector('input[name="inlineRadioOptions"]:checked'),r={name:i.groupName.value,type:t.value};o.execute(r)}.bind(this)}),riot.tag("adlink-detail",'<div if="{!hidden}"> <div class="container-fluid"> <div class="row-fluid"> <div class="col-sm-12 col-md-12 col-lg-12" > <div id="adlink-msg" class="alert alert-danger alert-dismissible fade in hidden" style="margin-left: 20px;" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button> <h4></h4> <div id="msgs"></div> </div> </div> </div> <div class="row-fluid"> <div class="col-sm-12 col-md-12 col-lg-12" > <form class="form-horizontal" id="adlink-detail"> <input type="hidden" id="id" name="id" value="{adlink._id}"> <div class="form-group"> <label class="col-sm-2 col-md-2 col-lg-2 control-label">名称</label> <div class="col-sm-10 col-md-10 col-lg-10"> <p class="form-control-static">{adlink.name}</p> </div> </div>       <div class="form-group"> <label class="col-sm-2 col-md-2 col-lg-2 control-label">广告图片</label> <div class="col-sm-10 col-md-10 col-lg-10"> <div class="{hidden: !adlink.adpicUrl}"> <img riot-src="{adlink.adpicUrl}" style="width: 100%;"> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 col-md-2 col-lg-2 control-label">广告链接</label> <div class="col-sm-10"> <p class="form-control-static">{adlink.url}</p> </div> </div> <div class="form-group"> <label class="col-sm-2 col-md-2 col-lg-2 control-label">客服电话</label> <div class="col-sm-10 col-md-10 col-lg-10"> <div class="input-group"> <p class="form-control-static">{adlink.phone}</p> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 col-md-2 col-lg-2 control-label">位置</label> <div class="col-sm-10 col-md-10 col-lg-10"> <div class="btn-group"> <p class="form-control-static">{ __app.enums.AdlinkLayout.values[adlink.layout] }</p> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 col-md-2 col-lg-2 control-label">主题</label> <div class="col-sm-10 col-md-10 col-lg-10"> <div class="btn-group"> <p class="form-control-static">{ __app.enums.AdlinkTheme.values[adlink.theme] }</p> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 col-md-2 col-lg-2 control-label">创建时间</label> <div class="col-sm-10 col-md-10 col-lg-10"> <div class="btn-group"> <p class="form-control-static">{ adlink.crtOnText }</p> </div> </div> </div> <div class="form-group"> <div class="col-sm-offset-2 col-md-offset-2 col-lg-offset-2 col-sm-10 col-md-10 col-lg-10"> <button type="button" class="btn btn-primary" onclick="{onEdit}">编辑</button> </div> </div> </form> </div> </div> </div> </div>',"adlink-detail .row-fluid { word-wrap: break-word; }",function(e){function t(e){return e?e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""):""}function n(e){return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()}var i=nest.presentable(this);i.api=__app.settings.api.url,i.adlink={};var o=domain.action("loadAdlink"),r=function(e){e.crtOnText=n(new Date(e.crtOn)),i.update({hidden:!1,adlink:e})};this.on("mount",function(){o.onDone(r)}),this.on("unmount",function(){o.offDone(r)}),i.on("open",function(e){e.id?o.execute(e.id):r(e.model)}),i.on("close",function(){i.update({hidden:!0})}),this.onEdit=function(e){i.parent.showEditView(i.adlink._id)}.bind(this),this.onSyncLayout=function(e){$("#adlink-edit #layout").val($(e.currentTarget).find("input").val())}.bind(this),this.onSyncTheme=function(e){$("#adlink-edit #theme").val($(e.currentTarget).find("input").val())}.bind(this),this.onPhoneBlur=function(e){var n=$(e.currentTarget).val();$("#adlink-edit #hasPhone").prop("checked",""!==t(n))}.bind(this)}),riot.tag("adlink-edit",'<div if="{!hidden}"> <div class="container-fluid"> <div class="row-fluid"> <div class="col-sm-12 col-md-12 col-lg-12" > <div id="adlink-msg" class="alert alert-danger alert-dismissible fade in hidden" style="margin-left: 20px;" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button> <h4></h4> <div id="msgs"></div> </div> </div> </div> <div class="row-fluid"> <div class="col-sm-12 col-md-12 col-lg-12" > <form class="form-horizontal" id="adlink-edit"> <input if="{action==\'edit\'}" type="hidden" id="id" name="id" value="{adlink._id}"> <input if="{action==\'new\'}" type="hidden" id="org" name="org" value="{tenantId}"> <div class="form-group"> <label for="name" class="col-sm-2 col-md-2 col-lg-2 control-label">名称</label> <div class="col-sm-10 col-md-10 col-lg-10"> <input type="text" class="form-control" id="name" placeholder="" value="{adlink.name}"> </div> </div>       <div class="form-group"> <label for="adwords" class="col-sm-2 col-md-2 col-lg-2 control-label">广告图片</label> <div class="col-sm-10 col-md-10 col-lg-10">   <div class="{hidden: adpicMode!=\'select\'}"> <span class="btn btn-default btn-file"> 浏览<input id="img_file" type="file" multiple="multiple" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="{previewImg}"> </span> <div class="{hidden: !adlink.adpicUrl}"> <img riot-src="{adlink.adpicUrl}" style="width: 100%;"> </div> </div> <div class="{hidden: adpicMode!=\'preview\'}" class="panel panel-default" id="img_prew" style="margin-bottom: 10px"> <table class="table table-condensed" style="border: 0px; text-align: center; vertical-align: middle;"> <tbody> <tr> <td colspan="3"><img riot-src="{img_url}" style="width: 100%;"></td> </tr> <tr> <td>{img_name}</td> <td>{img_size}</td> <td>{img_width}*{img_height}</td> </tr> <tr> <td colspan="3"> <input class="btn btn-default" type="button" style="margin-right: 50px" value="取消" onclick="{cancel_send_img}"> <input class="btn btn-success" type="button" value="发送" onclick="{send_img}"> </td> </tr> </tbody> </table> </div> </div> </div> <div class="form-group"> <label for="url" class="col-sm-2 col-md-2 col-lg-2 control-label">广告链接</label> <div class="col-sm-10"> <input type="url" class="form-control" id="url" placeholder="" value="{adlink.url}"> </div> </div> <div class="form-group"> <label for="phone" class="col-sm-2 col-md-2 col-lg-2 control-label">客服电话</label> <div class="col-sm-10 col-md-10 col-lg-10"> <div class="input-group"> <span class="input-group-addon"> <input type="checkbox" aria-label="..." id="hasPhone" __checked="{adlink.phone==\'\' ? \'false\':\'true\'}"> </span> <input type="phone" class="form-control" id="phone" placeholder="" onblur="{onPhoneBlur}" value="{adlink.phone}"> </div> </div> </div> <div class="form-group"> <label for="layout" class="col-sm-2 col-md-2 col-lg-2 control-label">位置</label> <div class="col-sm-10 col-md-10 col-lg-10"> <div class="btn-group" data-toggle="buttons"> <input type="hidden" id="layout" name="layout" value="{adlink.layout ? adlink.layout : \'bottom\'}"> <label class="btn btn-default {!adlink.layout || adlink.layout==\'bottom\' ? \'active\': \'\'}" onclick="{onSyncLayout}"> <input type="radio" name="layoutRadio" id="layoutBottom" autocomplete="off" value="bottom">底部 </label> <label class="btn btn-default {adlink.layout==\'top\' ? \'active\': \'\'}" onclick="{onSyncLayout}"> <input type="radio" name="layoutRadio" id="layoutTop" autocomplete="off" value="top">顶部 </label> </div> </div> </div> <div class="form-group"> <label for="theme" class="col-sm-2 col-md-2 col-lg-2 control-label">主题</label> <div class="col-sm-10 col-md-10 col-lg-10"> <div class="btn-group" data-toggle="buttons"> <input type="hidden" id="theme" name="theme" value="{adlink.theme ? adlink.theme : \'dark\'}"> <label class="btn btn-default {!adlink.theme || adlink.theme==\'dark\' ? \'active\': \'\'}" onclick="{onSyncTheme}"> <input type="radio" name="themeRadio" id="themeDark" autocomplete="off" value="dark">深色 </label> <label class="btn btn-default {adlink.theme==\'light\' ? \'active\': \'\'}" onclick="{onSyncTheme}"> <input type="radio" name="themeRadio" id="themeLight" autocomplete="off" value="light">浅色 </label> </div> </div> </div> <div if="{action==\'edit\'}" class="form-group"> <label for="url" class="col-sm-2 col-md-2 col-lg-2 control-label">创建时间</label> <div class="btn-group"> <p class="form-control-static">{ adlink.crtOnText }</p> </div> </div> <div class="form-group"> <div class="col-sm-offset-2 col-md-offset-2 col-lg-offset-2 col-sm-10 col-md-10 col-lg-10"> <button if="{action==\'new\'}" type="button" class="btn btn-primary" onclick="{onSave}">创建</button> <button if="{action==\'edit\'}" type="button" class="btn btn-primary" onclick="{onSave}">更新</button> </div> </div> </form> </div> </div> </div> </div>',"adlink-edit .btn-file { position: relative; overflow: hidden; } adlink-edit .btn-file input[type=file] { position: absolute; top: 0; right: 0; min-width: 100%; min-height: 100%; font-size: 100px; text-align: right; filter: alpha(opacity=0); opacity: 0; outline: none; background: white; cursor: inherit; display: block; }",function(e){function t(e){return e?e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""):""}function n(e){return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()}var i=nest.presentable(this);i.api=__app.settings.api.url,
i.adlink={},i.adpicMode="select";var o=domain.action("createAdlink"),r=domain.action("updateAdlink"),a=function(e){i.parent.showDetailView(e),i.parent.onRefresh()},s=domain.action("loadAndEditAdlink"),l=function(e){e.crtOnText=n(new Date(e.crtOn)),i.update({hidden:!1,adlink:e})};this.on("mount",function(){o.onDone(a),r.onDone(a),s.onDone(l)}),this.on("unmount",function(){o.offDone(a),r.offDone(a),s.offDone(l)}),i.on("open",function(e){i.action=e.action,"new"==e.action?(i.tenantId=e.tenantId,i.adlink={org:e.tenantId},i.update({hidden:!1})):"edit"==e.action&&s.execute(e.id)}),i.on("close",function(){i.update({hidden:!0})}),this.cancel_send_img=function(e){i.adpicMode="select",i.update()}.bind(this),this.previewImg=function(e){var t=e.target.files[0],n=Math.round(t.size/1024);i.img_size=n>=1024?Math.round(n/1024)+"m":n+"k",i.img_name=t.name,i.img_width=0,i.img_height=0;var o=new FileReader;o.onload=function(e){i.img_url=e.target.result;var t=new Image;t.src=e.target.result,t.onload=function(){i.img_width=this.width,i.img_height=this.height,i.update()},i.adpicMode="preview",i.update()},o.readAsDataURL(t)}.bind(this),this.send_img=function(e){var t=new FormData,n=$("#img_file")[0].files;t.append("file",n[0]),$.ajax({url:i.api+"/file/upload",type:"POST",data:t,processData:!1,contentType:!1,success:function(e){i.adlink.adpic=e.media_id,i.adlink.adpicUrl="/api/file?media_id="+e.media_id,i.adpicMode="select",i.update()},error:function(e){console.error("失败:"+JSON.stringify(e))}})}.bind(this);var c={};this.onSave=function(e){var n=[];return c.name=$("#adlink-edit #name").val(),""==t(c.name)&&n.push('<p>"名称"不能为空</p>'),console.log(i.adlink),c.adpic=i.adlink.adpic,c.adpicUrl=i.adlink.adpicUrl,""==t(c.adpic)&&n.push('<p>"广告图片"不能为空</p>'),c.url=$("#adlink-edit #url").val(),""==t(c.url)&&n.push('<p>"广告链接"不能为空</p>'),c.phone=$("#adlink-edit #phone").val(),c.layout=$("#adlink-edit #layout").val(),c.theme=$("#adlink-edit #theme").val(),n.length?($("#adlink-msg #msgs").html(n.join("")),void $("#adlink-msg").removeClass("hidden")):($("#adlink-msg #msgs").html(""),$("#adlink-msg").addClass("hidden"),void("new"==i.action?(c.org=i.tenantId,o.execute(c)):"edit"==i.action&&(c._id=$("#adlink-edit #id").val(),r.execute(c))))}.bind(this),this.onSyncLayout=function(e){$("#adlink-edit #layout").val($(e.currentTarget).find("input").val())}.bind(this),this.onSyncTheme=function(e){$("#adlink-edit #theme").val($(e.currentTarget).find("input").val())}.bind(this),this.onPhoneBlur=function(e){var n=$(e.currentTarget).val();$("#adlink-edit #hasPhone").prop("checked",""!==t(n))}.bind(this)}),riot.tag("adlink-index",'<div if="{!hidden}"> <div class="container-fluid"> <div class="row-fluid"> &nbsp; </div> <div class="row-fluid"> <div class="col-md-4 col-lg-4" > <div class="row-fluid"> <div class="col-md-12 col-lg-12" > <div class="pull-right"> <button class="btn btn-default btn-sm" type="button" onclick="{onRefresh}">刷新</button> <button class="btn btn-default btn-sm" type="button" onclick="{onNew}">新建</button> </div> <table class="table table-striped"> <thead> <tr> <th>名称</th> <th>广告</th> <th>布局</th> </tr> </thead> <tbody> <tr each="{adlinks}"> <td> <a onclick="{parent.onView}"> <input type="hidden" value="{_id}"> {name} </a> </td> <td> <a href="{url}"> <img riot-src="{adpicUrl}" style="width: 200px;"> </a> </td> <td> { __app.enums.AdlinkLayout.values[layout] } </td> </tr> </tbody> </table> </div> </div> </div> <div class="col-md-8 col-lg-8" > <adlink-edit id="edit"></adlink-edit> <adlink-detail id="detail"></adlink-detail> </div> </div> </div> </div>',function(e){"use strict";this.app=this.opts.app;var t=nest.presentable(this);t.api=__app.settings.api.url,t.tenantId=this.opts.tenant;var n=t.tags["adlink-edit"],i=t.tags["adlink-detail"],o=domain.action("findTenantAdlinks"),r=function(e){t.update({adlinks:e})};this.on("mount",function(){o.onDone(r)}),this.on("unmount",function(){o.offDone(r)}),this.on("open",function(e){console.info("tag adlink-index is opening"),t.trigger("ready",!1),t.trigger("view-route-to"),o.execute(t.tenantId)}),this.on("leave",function(){t.mask=!0,t.update()}),this.on("reenter",function(){t.mask=!1,t.update()}),this.on("refresh",function(){onRefresh()}),this.onRefresh=function(e){o.execute(t.tenantId)}.bind(this),this.onNew=function(e){i.trigger("close"),n.trigger("open",{action:"new",tenantId:t.tenantId})}.bind(this),this.onView=function(e){var t=$(e.currentTarget).find("input[type=hidden]").val();n.trigger("close"),i.trigger("open",{id:t})}.bind(this),this.showEditView=function(e){i.trigger("close"),n.trigger("open",{action:"edit",id:e})},this.showDetailView=function(e){n.trigger("close"),i.trigger("open",{model:e})}}),riot.tag("alert",'<div class="alert-container" if="{opts.validators.length}"> <div style="width: 300px; margin: 0px auto;" class="alert {alert-warning: !opts.validator.success, alert-success: opts.validator.success} alert-dismissible fade in" role="alert"> <button onclick="{onCancel}" type="button" class="close" aria-label="Close"><span aria-hidden="true">×</span></button> <p each="{validator in opts.validators}"><strong>{validator.field && (\'【\' + validator.field + \'】\')}</strong> {validator.desc}</p> </div> </div>',"alert .alert-container{ top: 60px; width: 100%; }",function(e){var t=this;this.onCancel=function(e){t.opts.clear(),t.update()}}),riot.tag("boss-tenant-power-add",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <alert validators="{validators}" clear="{clear}"></alert> <div class="col-md-10 col-md-offset-1"> <div class="jumbotron" style="height: auto; padding: 25px;"> <div id="addForm" class="panel" style="margin-top: 1em;"> <div style="padding-left: 20px; padding-bottom: 20px; padding-top: 15px"><a href="#power/list" style="font-size: 15px; text-decoration: none;">返回活动列表</a></div> <ul class="ul" style="text-align: left; padding-left: 2em"> <li><span>助力活动设置</span></li> <li> <span>活动公众号: </span> <select id="selectMedia" > <option each="{wechatMedias}" value="{originalId}" __selected="{parent.activity.wechatId = originalId}">{name}</option> </select> </li> <li id="type_select"><span>类型: </span> <label><input id="type_rp" name="activity_type" type="radio" value="rp" __checked="{activity.type === \'rp\'}" onclick="{selectType}">红包</label> <label><input id="type_po" name="activity_type" type="radio" value="po" __checked="{activity.type === \'po\'}" onclick="{selectType}">积分</label> <label><input id="type_co" name="activity_type" type="radio" value="co" __checked="{activity.type === \'co\'}" onclick="{selectType}">课程助力</label> </li> <li if="{activity.type !== \'co\'}"><span>启动图片助力: </span><input name="withPic" type="checkbox" __checked="{activity.withPic === \'true\'}" onclick="{toggleWithPic}"></li> <li id="poster" if="{activity.withPic === \'true\' || activity.type === \'co\'}" style="clear: both; min-height: 26px;"><span style="float: left">海报背景图片: </span><input if="{!activity.posterBgImg}" id="posterBgImg" type="file" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="{uploadPosterBgImg}" style="width: 60px;"> <div if="{activity.posterBgImg}" class="posterBgImgCon"><i onclick="{deletePosterBgImg}" class="glyphicon glyphicon-remove"></i><img riot-src="{activity.posterBgImg}" alt=""></div> </li> <li><span>活动名称: </span><input name="activityName" type="text" value="{activity.name}"></li> <li if="{activity.type !== \'co\'}" class="bgImg" style="min-height: 26px"><span style="float: left">背景图片(3张): </span><input if="{activity.bgImg.length != 3}" id="bgImg" type="file" multiple="multiple" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="{uploadBgImg}" style="width: 60px;"> <div if="{activity.bgImg.length >= 1}" class="bgImgCon"><i onclick="{deleteBgImg}" class="glyphicon glyphicon-remove"></i><img riot-src="{activity.bgImg[0]}" alt=""></div> <div if="{activity.bgImg.length >= 2}" class="bgImgCon"><i onclick="{deleteBgImg}" class="glyphicon glyphicon-remove"></i><img riot-src="{activity.bgImg[1]}" alt=""></div> <div if="{activity.bgImg.length >= 3}" class="bgImgCon"><i onclick="{deleteBgImg}" class="glyphicon glyphicon-remove"></i><img riot-src="{activity.bgImg[2]}" alt=""></div> </li> <li style="clear: both; min-height: 26px"><span style="float: left" if="{activity.type !== \'co\'}">分享卡片图片: </span><span style="float: left" if="{activity.type === \'co\'}">消息卡片图片: </span><input if="{!activity.shareImg}" id="shareImg" type="file" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="{uploadShareImg}" style="width: 60px;"> <div if="{activity.shareImg}" class="shareImgCon"><i onclick="{deleteShareImg}" class="glyphicon glyphicon-remove"></i><img riot-src="{activity.shareImg}" alt=""></div> </li> <li style="clear: both"><span>活动时间: </span><input id="startTime" type="date" value="{formatDate(activity.startTime)}"><span> 至 </span><input id="endTime" type="date" value="{formatDate(activity.endTime)}"> </li> <li if="{activity.type !== \'co\'}"><span>活动介绍: </span><div id="desc"></div></li> <li if="{activity.type === \'co\'}"><span>活动介绍: </span><textarea class="form-control" name="co_desc" rows="10"></textarea></li> <li if="{activity.type !== \'co\'}"><span>活动规则: </span><div id="rule"></div></li> <li><span if="{activity.type !== \'co\'}">分享标题自定义: </span><span if="{activity.type === \'co\'}">消息卡片标题: </span><input class="form-control" type="text" name="shareTitle" value="{activity.shareTitle}"></li> <li><span if="{activity.type !== \'co\'}">分享描述自定义: </span><span if="{activity.type === \'co\'}">消息卡片描述: </span><input class="form-control" type="text" name="shareDesc" value="{activity.shareDesc}"></li> <li if="{activity.type !== \'co\'}"><span>基础奖励: </span><input id="base_power" type="number" value="{activity.base_power}"></li> <li if="{activity.type !== \'co\'}"><span>好友助力单次奖励: </span><input name="friend_help_min_power" type="number" value="{activity.friend_help_min_power}"><span> 至 </span><input name="friend_help_max_power" type="number" value="{activity.friend_help_max_power}"></li> <li><span if="{activity.type !== \'co\'}">好友助力上限人数: </span><span if="{activity.type === \'co\'}">最低好友助力人数: </span><input name="friend_help_count_limit" type="number" value="{activity.friend_help_count_limit}"></li> <li if="{activity.type === \'co\'}"><span>课程地址: </span><input class="form-control" type="text" name="courseUrl" value="{activity.courseUrl}"></li> <li style="text-align: center; margin-top: 1em"><input class="btn btn-success" type="button" onclick="{submit}" value="提交"></li> </ul> </div> </div> </div> </div> </div>',"boss-tenant-power-add .ul {list-style-type: none; text-align: center; padding: 0} boss-tenant-power-add .ul li {margin-bottom: 20px;} boss-tenant-power-add .bgImg #bgImg {float: left; margin-left: 10px;} boss-tenant-power-add .bgImg .bgImgCon {margin-left: 10px; display: -webkit-inline-box; position: relative; border: solid 1px #E8E7E7;} boss-tenant-power-add .bgImgCon i{color: #EC3131; position: absolute; left: 58px; top: 2px; cursor: pointer;} boss-tenant-power-add .bgImgCon div{margin-left: 20px; float: left;} boss-tenant-power-add .bgImgCon img {width: 75px; height: 75px;} boss-tenant-power-add .shareImgCon img {width: 75px; height: 75px;} boss-tenant-power-add #shareImg{float: left; margin-left: 10px;} boss-tenant-power-add .shareImgCon i{color: #EC3131;position: absolute;left: 58px;top: 2px;cursor: pointer;} boss-tenant-power-add .shareImgCon{margin-left: 10px; display: -webkit-inline-box;position: relative; border: solid 1px #E8E7E7;} boss-tenant-power-add .posterBgImgCon img {width: 75px; height: 75px;} boss-tenant-power-add #posterBgImg{float: left; margin-left: 10px;} boss-tenant-power-add .posterBgImgCon i{color: #EC3131;position: absolute;left: 58px;top: 2px;cursor: pointer;} boss-tenant-power-add .posterBgImgCon{margin-left: 10px; display: -webkit-inline-box;position: relative; border: solid 1px #E8E7E7;}",function(e){"use strict";function t(e,t){if(n.validators=[],e.size>2097152)return void n.validators.push({success:!1,field:"提示",desc:"文件大小超过限制-2M"});var i=new FormData;i.append("file",e),$.ajax({url:__app.settings.api.url+"/file/upload",type:"POST",data:i,processData:!1,contentType:!1,success:function(e){t(null,e)},error:function(e){t(e,null)}})}var n=nest.presentable(this);n.validators=[];var i=domain.action("addPowerActivity"),o=domain.action("loadAllTenantWechatSite");n.activity={org:__page.tenantId,type:"rp",bgImg:[],withPic:"false"},n.on("open",function(e){n.trigger("ready",!1),n.trigger("view-route-to"),setTimeout(function(){$("#rule").summernote({height:200,minHeight:null,maxHeight:null,toolbar:[["style",["bold","italic","underline","clear"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["fontname",["fontname"]],["insert",["picture","link","video","hr","table"]]],callbacks:{onImageUpload:function(e){r(e[0],"#rule")}}}).summernote("code",n.activity.rule||"")},10),setTimeout(function(){$("#desc").summernote({height:200,minHeight:null,maxHeight:null,toolbar:[["style",["bold","italic","underline","clear"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["fontname",["fontname"]],["insert",["picture","link","video","hr","table"]]],callbacks:{onImageUpload:function(e){r(e[0],"#desc")}}}).summernote("code",n.activity.desc||"")},10),o.newInvocation(__page.tenantId).onDone(function(e){n.wechatMedias=e,n.update()}).execute()}),n.on("mount",function(){n.validators=_.widget.validatify([])}),n.formatDate=function(e){var t=new Date(e),n=t.getFullYear(),i=t.getMonth()+1>9?t.getMonth()+1:"0"+(t.getMonth()+1),o=t.getDate()>9?t.getDate():"0"+t.getDate();return n+"-"+i+"-"+o},n.uploadPosterBgImg=function(e){var i=e.currentTarget.files[0];t(i,function(e,t){return e?console.error("upload file err in func uploadPosterBgImg, err: "+e):(n.activity.posterBgImg=window.__app.settings.api.url+"/file?media_id="+t.media_id,void n.update())})},n.uploadBgImg=function(e){var i=e.currentTarget.files;if(n.validators=[],i.length>3-n.activity.bgImg.length)return void n.validators.push({success:!1,field:"提示",desc:"最多上传三张背景图片"});for(var o=0;o<i.length;o++)t(i[o],function(e,t){return e?console.error("upload file err in func uploadBgImg, err: "+e):(n.activity.bgImg.push(window.__app.settings.api.url+"/file?media_id="+t.media_id),void n.update())})},n.uploadShareImg=function(e){var i=e.currentTarget.files[0];t(i,function(e,t){return e?console.error("upload file err in func uploadShareImg, err: "+e):(n.activity.shareImg=window.__app.settings.api.url+"/file?media_id="+t.media_id,void n.update())})},n.deleteBgImg=function(e){n.activity.bgImg=n.activity.bgImg.filter(function(t){return t!=$($(e.currentTarget).siblings("img")[0]).attr("src")})},n.deletePosterBgImg=function(e){n.activity.posterBgImg=""},n.deleteShareImg=function(e){n.activity.shareImg=""},n.clear=function(){n.validators=[]},n.toggleWithPic=function(e){return $(e.currentTarget).is(":checked")?n.activity.withPic="true":n.activity.withPic="false",!0},n.verify=function(e){var t=!0;if(e.name||(n.validators.push({success:!1,field:"提示",desc:"活动名称不能为空!"}),t=!1),!e.shareDesc){var i={success:!1,field:"提示",desc:"分享描述不能为空!"};"co"===e.type&&(i.desc="消息卡片描述不能为空!"),n.validators.push(i),t=!1}if(!e.shareTitle){var i={success:!1,field:"提示",desc:"分享标题不能为空!"};"co"===e.type&&(i.desc="消息卡片标题不能为空!"),n.validators.push(i),t=!1}if(("true"===e.withPic&&!e.posterBgImg||"co"===e.type&&!e.posterBgImg)&&(n.validators.push({success:!1,field:"提示",desc:"必须上传海报背景图片!"}),t=!1),!e.shareImg){var i={success:!1,field:"提示",desc:"必须设置分享卡片图片!"};"co"===e.type&&(i.desc="必须设置消息卡片图片!"),t=!1}if("co"!==e.type&&(!e.bgImg||e.bgImg.length<1)&&(n.validators.push({success:!1,field:"提示",desc:"必须设置背景图片!"}),t=!1),e.startTime||(n.validators.push({success:!1,field:"提示",desc:"必须设置活动开始时间!"}),t=!1),e.endTime||(n.validators.push({success:!1,field:"提示",desc:"必须设置活动结束时间!"}),t=!1),"co"===e.type||e.base_power&&/^[0-9]+$/.test(e.base_power)||(n.validators.push({success:!1,field:"提示",desc:"基础奖励必填且必须为数字!"}),t=!1),!e.friend_help_count_limit||!/^[0-9]+$/.test(e.friend_help_count_limit)){var i={success:!1,field:"提示",desc:"好友助力上限必填且必须为数字!"};"co"===e.type&&(i.desc="最低好友助力人数必填且必须为数字!"),n.validators.push(i),t=!1}return"co"===e.type||e.friend_help_max_power&&/^[0-9]+$/.test(e.friend_help_max_power)||(n.validators.push({success:!1,field:"提示",desc:"单次助力最大值必填且必须为数字!"}),t=!1),"co"===e.type||e.friend_help_min_power&&/^[0-9]+$/.test(e.friend_help_min_power)||(n.validators.push({success:!1,field:"提示",desc:"单次助力最小值必填且必须为数字!"}),t=!1),t},n.submit=function(e){n.validators=[],n.activity.type=$(':radio[name="activity_type"]:checked').val(),n.activity.name=n.activityName.value,n.activity.shareTitle=n.shareTitle.value,n.activity.shareDesc=n.shareDesc.value,n.activity.startTime=n.startTime.value,n.activity.endTime=n.endTime.value,n.activity.friend_help_count_limit=n.friend_help_count_limit.value,n.activity.wechatId=n.selectMedia.value,"co"!==n.activity.type?(n.activity.base_power=n.base_power.value,n.activity.friend_help_min_power=n.friend_help_min_power.value,n.activity.friend_help_max_power=n.friend_help_max_power.value,n.activity.rule=$("#rule").summernote("code"),n.activity.desc=$("#desc").summernote("code")||n.co_desc.value):(n.activity.desc=n.co_desc.value,n.activity.courseUrl=n.courseUrl.value,n.activity.withPic="true");var t=n.verify(n.activity);t&&i.newInvocation(n.activity).onDone(function(e){n.activity={org:__page.tenantId,type:"rp",bgImg:[]},riot.route("power/list")}).execute()};var r=function(e,t){_.uploadImgFile(e,function(e,n){e?alert("上传图片失败"):$(t).summernote("insertImage",n)})};n.selectType=function(e){return n.activity.type=e.currentTarget.value,!0}}),riot.tag("boss-tenant-power-edit",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <alert validators="{validators}" clear="{clear}"></alert> <div class="col-md-10 col-md-offset-1"> <div class="jumbotron" style="height: auto; padding: 25px;"> <div id="addForm" class="panel" style="margin-top: 1em;"> <div style="padding-left: 20px; padding-bottom: 20px; padding-top: 15px"><a href="#power/list" style="font-size: 15px; text-decoration: none;">返回活动列表</a></div> <ul class="ul" style="text-align: left; padding-left: 2em"> <li><span>助力活动设置</span></li> <li> <span>活动公众号: </span> <select id="selectMedia" > <option each="{wechatMedias}" value="{originalId}" __selected="{parent.activity.wechatId = originalId}">{name}</option> </select> </li> <li id="type_select"><span>类型: </span> <label><input id="type_rp" name="activity_type" type="radio" value="rp" __checked="{activity.type === \'rp\'}" onclick="{selectType}">红包</label> <label><input id="type_po" name="activity_type" type="radio" value="po" __checked="{activity.type === \'po\'}" onclick="{selectType}">积分</label> <label><input id="type_co" name="activity_type" type="radio" value="co" __checked="{activity.type === \'co\'}" onclick="{selectType}">课程助力</label> </li> <li if="{activity.type !== \'co\'}"><span>启动图片助力: </span><input name="withPic" type="checkbox" __checked="{activity.withPic === \'true\'}" onclick="{toggleWithPic}"></li> <li id="poster" if="{activity.withPic === \'true\' || activity.type === \'co\'}" style="clear: both; min-height: 26px;"><span style="float: left">海报背景图片: </span><input if="{!activity.posterBgImg}" id="posterBgImg" type="file" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="{uploadPosterBgImg}" style="width: 60px;"> <div if="{activity.posterBgImg}" class="posterBgImgCon"><i onclick="{deletePosterBgImg}" class="glyphicon glyphicon-remove"></i><img riot-src="{activity.posterBgImg}" alt=""></div> </li> <li><span>活动名称: </span><input name="activityName" type="text" value="{activity.name}"></li> <li if="{activity.type !== \'co\'}" class="bgImg" style="min-height: 26px"><span style="float: left">背景图片(3张): </span><input if="{activity.bgImg.length != 3}" id="bgImg" type="file" multiple="multiple" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="{uploadBgImg}" style="width: 60px;"> <div if="{activity.bgImg.length >= 1}" class="bgImgCon"><i onclick="{deleteBgImg}" class="glyphicon glyphicon-remove"></i><img riot-src="{activity.bgImg[0]}" alt=""></div> <div if="{activity.bgImg.length >= 2}" class="bgImgCon"><i onclick="{deleteBgImg}" class="glyphicon glyphicon-remove"></i><img riot-src="{activity.bgImg[1]}" alt=""></div> <div if="{activity.bgImg.length >= 3}" class="bgImgCon"><i onclick="{deleteBgImg}" class="glyphicon glyphicon-remove"></i><img riot-src="{activity.bgImg[2]}" alt=""></div> </li> <li style="clear: both; min-height: 26px"><span style="float: left" if="{activity.type !== \'co\'}">分享卡片图片: </span><span style="float: left" if="{activity.type === \'co\'}">消息卡片图片: </span><input if="{!activity.shareImg}" id="shareImg" type="file" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="{uploadShareImg}" style="width: 60px;"> <div if="{activity.shareImg}" class="shareImgCon"><i onclick="{deleteShareImg}" class="glyphicon glyphicon-remove"></i><img riot-src="{activity.shareImg}" alt=""></div> </li> <li style="clear: both"><span>活动时间: </span><input id="startTime" type="date" value="{formatDate(activity.startTime)}"><span> 至 </span><input id="endTime" type="date" value="{formatDate(activity.endTime)}"> </li> <li if="{activity.type !== \'co\'}"><span>活动介绍: </span><div id="desc"></div></li> <li if="{activity.type === \'co\'}"><span>活动介绍: </span><textarea class="form-control" name="co_desc" rows="10" value="{activity.desc}"></textarea></li> <li if="{activity.type !== \'co\'}"><span>活动规则: </span><div id="rule"></div></li> <li><span if="{activity.type !== \'co\'}">分享标题自定义: </span><span if="{activity.type === \'co\'}">消息卡片标题: </span><input class="form-control" type="text" name="shareTitle" value="{activity.shareTitle}"></li> <li><span if="{activity.type !== \'co\'}">分享描述自定义: </span><span if="{activity.type === \'co\'}">消息卡片描述: </span><input class="form-control" type="text" name="shareDesc" value="{activity.shareDesc}"></li> <li if="{activity.type !== \'co\'}"><span>基础奖励: </span><input id="base_power" type="number" value="{activity.base_power}"></li> <li if="{activity.type !== \'co\'}"><span>好友助力单次奖励: </span><input name="friend_help_min_power" type="number" value="{activity.friend_help_min_power}"><span> 至 </span><input name="friend_help_max_power" type="number" value="{activity.friend_help_max_power}"></li> <li><span if="{activity.type !== \'co\'}">好友助力上限人数: </span><span if="{activity.type === \'co\'}">最低好友助力人数: </span><input name="friend_help_count_limit" type="number" value="{activity.friend_help_count_limit}"></li> <li if="{activity.type === \'co\'}"><span>课程地址: </span><input class="form-control" type="text" name="courseUrl" value="{activity.courseUrl}"></li> <li style="text-align: center; margin-top: 1em"><input class="btn btn-success" type="button" onclick="{submit}" value="提交"></li> </ul> </div> </div> </div> </div> </div>',"boss-tenant-power-edit .ul {list-style-type: none; text-align: center; padding: 0} boss-tenant-power-edit .ul li {margin-bottom: 20px;} boss-tenant-power-edit .bgImg #bgImg {float: left; margin-left: 10px;} boss-tenant-power-edit .bgImg .bgImgCon {margin-left: 10px; display: -webkit-inline-box; position: relative; border: solid 1px #E8E7E7;} boss-tenant-power-edit .bgImgCon i{color: #EC3131; position: absolute; left: 58px; top: 2px; cursor: pointer;} boss-tenant-power-edit .bgImgCon div{margin-left: 20px; float: left;} boss-tenant-power-edit .bgImgCon img {width: 75px; height: 75px;} boss-tenant-power-edit .shareImgCon img {width: 75px; height: 75px;} boss-tenant-power-edit #shareImg{float: left; margin-left: 10px;} boss-tenant-power-edit .shareImgCon i{color: #EC3131;position: absolute;left: 58px;top: 2px;cursor: pointer;} boss-tenant-power-edit .shareImgCon{margin-left: 10px; display: -webkit-inline-box;position: relative; border: solid 1px #E8E7E7;} boss-tenant-power-edit .posterBgImgCon img {width: 75px; height: 75px;} boss-tenant-power-edit #posterBgImg{float: left; margin-left: 10px;} boss-tenant-power-edit .posterBgImgCon i{color: #EC3131;position: absolute;left: 58px;top: 2px;cursor: pointer;} boss-tenant-power-edit .posterBgImgCon{margin-left: 10px; display: -webkit-inline-box;position: relative; border: solid 1px #E8E7E7;}",function(e){"use strict";function t(e,t){if(n.validators=[],e.size>2097152)return void n.validators.push({success:!1,field:"提示",desc:"文件大小超过限制-2M"});var i=new FormData;i.append("file",e),$.ajax({url:__app.settings.api.url+"/file/upload",type:"POST",data:i,processData:!1,contentType:!1,success:function(e){t(null,e)},error:function(e){t(e,null)}})}var n=nest.presentable(this);n.validators=[];var i=domain.action("loadPowerActivity"),o=domain.action("updatePowerActivity"),r=domain.action("loadAllTenantWechatSite");n.on("open",function(e){i.newInvocation({id:e.id}).onDone(function(e){n.activity=e,n.trigger("ready",!1),n.trigger("view-route-to"),setTimeout(function(){$("#rule").summernote({height:200,minHeight:null,maxHeight:null,toolbar:[["style",["bold","italic","underline","clear"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["fontname",["fontname"]],["insert",["picture","link","video","hr","table"]]],callbacks:{onImageUpload:function(e){a(e[0],"#rule")}}}).summernote("code",n.activity.rule||"")},10),setTimeout(function(){$("#desc").summernote({height:200,minHeight:null,maxHeight:null,toolbar:[["style",["bold","italic","underline","clear"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["fontname",["fontname"]],["insert",["picture","link","video","hr","table"]]],callbacks:{onImageUpload:function(e){a(e[0],"#desc")}}}).summernote("code",n.activity.desc||"")},10)}).execute(),r.newInvocation(__page.tenantId).onDone(function(e){n.wechatMedias=e,n.update()}).execute()}),n.on("mount",function(){n.validators=_.widget.validatify([])}),n.formatDate=function(e){var t=new Date(e),n=t.getFullYear(),i=t.getMonth()+1>9?t.getMonth()+1:"0"+(t.getMonth()+1),o=t.getDate()>9?t.getDate():"0"+t.getDate();return n+"-"+i+"-"+o},n.uploadPosterBgImg=function(e){var i=e.currentTarget.files[0];t(i,function(e,t){return e?console.error("upload file err in func uploadPosterBgImg, err: "+e):(n.activity.posterBgImg=window.__app.settings.api.url+"/file?media_id="+t.media_id,void n.update())})},n.uploadBgImg=function(e){var i=e.currentTarget.files;if(n.validators=[],i.length>3-n.activity.bgImg.length)return void n.validators.push({success:!1,field:"提示",desc:"最多上传三张背景图片"});for(var o=0;o<i.length;o++)t(i[o],function(e,t){return e?console.error("upload file err in func uploadBgImg, err: "+e):(n.activity.bgImg.push(window.__app.settings.api.url+"/file?media_id="+t.media_id),void n.update())})},n.uploadShareImg=function(e){var i=e.currentTarget.files[0];t(i,function(e,t){return e?console.error("upload file err in func uploadShareImg, err: "+e):(n.activity.shareImg=window.__app.settings.api.url+"/file?media_id="+t.media_id,void n.update())})},n.deleteBgImg=function(e){n.activity.bgImg=n.activity.bgImg.filter(function(t){return t!=$($(e.currentTarget).siblings("img")[0]).attr("src")})},n.deletePosterBgImg=function(e){n.activity.posterBgImg=""},n.deleteShareImg=function(e){n.activity.shareImg=""},n.clear=function(){n.validators=[]},n.toggleWithPic=function(e){return $(e.currentTarget).is(":checked")?n.activity.withPic="true":n.activity.withPic="false",!0},n.verify=function(e){var t=!0;if(e.name||(n.validators.push({success:!1,field:"提示",desc:"活动名称不能为空!"}),t=!1),!e.shareDesc){var i={success:!1,field:"提示",desc:"分享描述不能为空!"};"co"===e.type&&(i.desc="消息卡片描述不能为空!"),n.validators.push(i),t=!1}if(!e.shareTitle){var i={success:!1,field:"提示",desc:"分享标题不能为空!"};"co"===e.type&&(i.desc="消息卡片标题不能为空!"),n.validators.push(i),t=!1}if(("true"===e.withPic&&!e.posterBgImg||"co"===e.type&&!e.posterBgImg)&&(n.validators.push({success:!1,field:"提示",desc:"必须上传海报背景图片!"}),t=!1),!e.shareImg){var i={success:!1,field:"提示",desc:"必须设置分享卡片图片!"};"co"===e.type&&(i.desc="必须设置消息卡片图片!"),t=!1}if("co"!==e.type&&(!e.bgImg||e.bgImg.length<1)&&(n.validators.push({success:!1,field:"提示",desc:"必须设置背景图片!"}),t=!1),e.startTime||(n.validators.push({success:!1,field:"提示",desc:"必须设置活动开始时间!"}),t=!1),e.endTime||(n.validators.push({success:!1,field:"提示",desc:"必须设置活动结束时间!"}),t=!1),"co"===e.type||e.base_power&&/^[0-9]+$/.test(e.base_power)||(n.validators.push({success:!1,field:"提示",desc:"基础奖励必填且必须为数字!"}),t=!1),!e.friend_help_count_limit||!/^[0-9]+$/.test(e.friend_help_count_limit)){var i={success:!1,field:"提示",desc:"好友助力上限必填且必须为数字!"};"co"===e.type&&(i.desc="最低好友助力人数必填且必须为数字!"),n.validators.push(i),t=!1}return"co"===e.type||e.friend_help_max_power&&/^[0-9]+$/.test(e.friend_help_max_power)||(n.validators.push({success:!1,field:"提示",desc:"单次助力最大值必填且必须为数字!"}),t=!1),"co"===e.type||e.friend_help_min_power&&/^[0-9]+$/.test(e.friend_help_min_power)||(n.validators.push({success:!1,field:"提示",desc:"单次助力最小值必填且必须为数字!"}),t=!1),t},n.submit=function(e){n.validators=[],n.activity.type=$(':radio[name="activity_type"]:checked').val(),n.activity.name=n.activityName.value,n.activity.shareTitle=n.shareTitle.value,n.activity.shareDesc=n.shareDesc.value,n.activity.startTime=n.startTime.value,n.activity.endTime=n.endTime.value,n.activity.friend_help_count_limit=n.friend_help_count_limit.value,n.activity.wechatId=n.selectMedia.value,"co"!==n.activity.type?(n.activity.base_power=n.base_power.value,n.activity.friend_help_min_power=n.friend_help_min_power.value,n.activity.friend_help_max_power=n.friend_help_max_power.value,n.activity.rule=$("#rule").summernote("code"),n.activity.desc=$("#desc").summernote("code")||n.co_desc.value):(n.activity.desc=n.co_desc.value,n.activity.courseUrl=n.courseUrl.value,n.activity.withPic="true");var t=n.verify(n.activity);t&&o.newInvocation(n.activity).onDone(function(e){n.activity={org:__page.tenantId,type:"rp",bgImg:[]},riot.route("power/list")}).execute()};var a=function(e,t){_.uploadImgFile(e,function(e,n){e?alert("上传图片失败"):$(t).summernote("insertImage",n)})};n.selectType=function(e){return n.activity.type=e.currentTarget.value,!0}}),riot.tag("boss-tenant-power-list",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="col-md-10 col-md-offset-1"> <div class="jumbotron" style="height: auto; padding: 25px;"> <div id="powerList" class="panel" style="margin-top: 1em; padding: 0; min-height: 30em"> <div style="padding-left: 20px; padding-top: 10px;"><a id="add" href="#power/add" style="font-size: 15px; text-decoration: none; cursor: pointer">新增</a> </div> <ul class="ul" id="list"> <li> <strong class="col-md-2">活动名称</strong> <strong class="col-md-2">开始时间</strong> <strong class="col-md-2">结束时间</strong> <strong class="col-md-2">类型</strong> <strong class="col-md-2">海报二维码</strong> <strong class="col-md-2">操作</strong> </li> <li> <hr width="100%"> </li> <li class="actItem" each="{activityArr}"> <strong class="col-md-2"><a href="#power/edit/_{_id}">{name}</a></strong> <strong class="col-md-2">{_.date.format(new Date(startTime), \'yyyy-MM-dd\')}</strong> <strong class="col-md-2">{_.date.format(new Date(endTime), \'yyyy-MM-dd\')}</strong> <strong class="col-md-2">{__app.enums.PowerType.values[type]}</strong> <strong class="col-md-2 actionCon"> <a class="fa fa-qrcode fa-lg" data-toggle="modal" data-target="#showImg" onclick="{parent.showImg}"></a> </strong> <strong if="{type !== \'co\'}" class="col-md-2 actionCon"><a href="{ __app.settings.app.url + \'/marketing/tenant/power/\' + wechatId + \'/activity?id=\' + _id }" target="_blank">查看</a><a href="{__app.settings.api.url + \'/marketing/tenant/power/exportParticipants?id=\' + _id }" target="_blank" >导出</a></strong> <strong if="{type === \'co\'}" class="col-md-2 actionCon"><a href="javascript:void(0)">无</a></strong> </li> </ul> </div> </div> </div> </div> </div>',"boss-tenant-power-list .ul {list-style-type: none; text-align: center; padding: 0} boss-tenant-power-list .ul li {margin-bottom: 20px;} boss-tenant-power-list .actItem {height: 17px; overflow: hidden; margin-top: 2px;} boss-tenant-power-list li strong{ padding: 0 !important; margin: 0 !important; } boss-tenant-power-list .actionCon a{ margin-left: 10px; cursor: pointer; }",function(e){
"use strict";var t=nest.presentable(this),n=domain.action("loadPowerActivities");t.showImg=function(e){var t="";e.item.qrCodeUrl||(t="该活动不是海报助力活动"),_.widget.showImg({title:"用微信扫描下方二维码获取活动海报",imgUrl:e.item.qrCodeUrl,width:"300px",height:"300px",errorMsg:t})},t.on("open",function(e){n.newInvocation({tenantId:__page.tenantId}).onDone(function(e){t.activityArr=e,t.trigger("ready",!1),t.trigger("view-route-to")}).execute()}),t.on("mount",function(){t.validators=_.widget.validatify([])})}),riot.tag("boss-tenant-sd-bespeaks",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/bespeaks"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>预约管理</h4> </div> <div class="row"> <form class="form-inline"> <div class="col-md-6 col-lg-6"> <div class="form-group"> <label for="bespeakStatus">状态</label> <select id="bespeakStatus" class="form-control" onchange="{onSelect}"> <option value="">全部状态</option> <option selected value="{__app.enums.LifeFlag.names.Active}">待处理</option> <option value="{__app.enums.LifeFlag.names.Deleted}">已处理</option> </select> </div> <input onclick="{onSearch}" class="btn btn-primary" type="button" value="查询"> </div> </form> </div> <div class="row" style="margin-top: 10px"> <table class="table table-striped"> <thead> <tr> <th>客户昵称</th> <th>预约产品</th> <th>日期</th> <th>电话</th> <th>状态</th> <th>成单</th> </tr> </thead> <tbody> <tr each="{bespeaks}"> <td> <a href="#sd/bespeaks/_{_id}"> {user.nickname} </a> </td> <td> { product.name } </td> <td> {_.date.format(new Date(crtOn), \'yyyy-MM-dd hh点mm分\')} </td> <td> { telephone } </td> <td> { lFlg === __app.enums.LifeFlag.names.Active ? \'待处理\': \'已处理\' } </td> <td> <div if="{lFlg === __app.enums.LifeFlag.names.Active}"> <input onclick="{parent.onOrderCreate}" data-toggle="modal" data-target="#orderModal" type="button" class="btn btn-default" value="成单"> <input onclick="{parent.onOrderGiveUp}" data-toggle="modal" data-target="#modal" type="button" class="btn btn-default" value="弃单"> </div> </td> </tr> </tbody> </table> </div> </div> </div> <div id="orderModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title">生成订单</h4> </div> <div class="modal-body"> <form class="form-horizontal"> <div class="form-group"> <label class="col-sm-2 control-label">媒体价</label> <div class="col-sm-10"> <span>{currBespeak.product.listPrice}</span> </div> </div> <div class="form-group"> <label for="finalPrice" class="col-sm-2 control-label">成交价</label> <div class="col-sm-10"> <input class="form-control" oninput="{onInput}" id="finalPrice" type="number" name="finalPrice"> </div> </div> </form> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">取消</button> <button __disabled="{finalPrice.value.trim() === \'\' || parseInt(finalPrice.value.trim(), 10)<0 || parseInt(finalPrice.value.trim(), 10) > currBespeak.product.listPrice}" onclick="{onSubmitOrder}" data-dismiss="modal" type="button" class="btn btn-primary">确认</button> </div> </div> </div> </div> </div>',function(e){"use strict";var t=nest.presentable(this),n=domain.action("findBespeaks"),i=domain.action("createOrder"),o=domain.action("updateBespeakById");t.bespeaks=[],t.currBespeak={},t.filter={tenant:__page.tenantId,lFlg:"a"},t.on("open",function(){n.newInvocation({filter:t.filter}).onDone(function(e){return e.error?alert("failed to search bespeaks"):(t.bespeaks=e.bespeaks,t.trigger("ready",!1),void t.trigger("view-route-to"))}).execute()}),t.onOrderCreate=function(e){t.finalPrice.value="",t.currBespeak=e.item},t.onOrderGiveUp=function(e){t.currBespeak=e.item,_.widget.confirm({title:"操作确认",content:"你确认要“销毁”该预约吗？",callback:function(){t.currBespeak.lFlg=__app.enums.LifeFlag.names.Deleted,console.log(e.item),o.newInvocation({id:t.currBespeak._id,o:{media:t.currBespeak.media,lFlg:t.currBespeak.lFlg}}).onDone(function(e){return e.error?void alert("销毁预约失败"):(t.currBespeak=null,t.bespeaks=t.bespeaks.filter(function(t){return t._id!=e.bespeak._id}),void t.update())}).execute()}})},t.onSearch=function(e){n.newInvocation({filter:t.filter}).onDone(function(e){return e.error?alert("failed to search bespeaks"):void t.update({bespeaks:e.bespeaks})}).execute()},t.onInput=function(){},t.onSubmitOrder=function(e){i.newInvocation({bespeak:t.currBespeak,finalPrice:t.finalPrice.value.trim()}).onDone(function(e){return e.error?void alert("成单失败"):(t.currBespeak=null,t.bespeaks=t.bespeaks.filter(function(t){return t._id!=e.order.bespeak}),void t.update())}).execute()},t.onSelect=function(e){var n=t.bespeakStatus.value;return console.log(n),n?void(t.filter.lFlg=n):void(t.filter.hasOwnProperty("lFlg")&&delete t.filter.lFlg)}}),riot.tag("boss-tenant-sd-catalogs-add",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/catalogs"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>新建课程目录</h4> </div> <alert validators="{validators}" clear="{clear}"></alert> <div class="row"> <div class="panel panel-default"> <div class="panel-heading">基本信息</div> <div class="panel-body"> <form class="form-horizontal"> <div class="form-group text-left"> <label for="catalogNameInput" class="col-sm-2 control-label text-left">课程目录名称</label> <div class="col-sm-10 {has-error: !catalogNameInput.value.trim()} has-feedback"> <input onblur="{catalogNameInputBlur}" type="text" class="form-control " id="catalogNameInput"> </div> </div> <div class="form-group"> <label for="catalogWechatsiteInput" class="col-sm-2 control-label">公众号</label> <div class="col-sm-10"> <select class="form-control" id="catalogWechatsiteInput" style="width: 200px"> <option each="{wechatsites}" value="{_id}">{name}</option> </select> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">上/下架状态</label> <div class="col-sm-10" style="height: 32px;line-height: 32px"> <span>待上架</span> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">创建时间</label> <div class="col-sm-10"> <span>{_.date.format(new Date(), \'yyyy-MM-dd hh点mm分\') }</span> </div> </div> <div class="form-group"> <label for="catalogDescInput" class="col-sm-2 control-label">备注</label> <div class="col-sm-10"> <textarea onblur="{catalogDescInputBlur}" type="password" class="form-control" id="catalogDescInput"></textarea> </div> </div> </form> </div> </div> </div> <div class="row" style="margin-top: 10px"> <div class="col-md-12 col-lg-12 text-center"> <input __disabled="{!courseMediaPriceInput.value.trim() || !courseNameInput.value.trim()}" onclick="{onSubmit}" type="button" class="btn btn-primary" value="保存"> <a href="#sd/catalogs" class="btn btn-default">取消</a> </div> </div> </div> </div> </div>',".form-horizontal .control-label{ text-align: left !important; }",function(e){"use strict";var t=nest.presentable(this),n=domain.action("loadAllTenantWechatSite"),i=domain.action("createCatalog");t.on("open",function(){t.catalog={},t.catalog.tenant=__page.tenantId,t.validators=[],t.catalogNameInput.value="",t.catalogDescInput.value="",n.newInvocation(__page.tenantId).onDone(function(e){t.wechatsites=e,t.trigger("ready",!1),t.trigger("view-route-to")}).execute()}),t.catalogNameInputBlur=function(){var e=t.catalogNameInput.value.trim();return e?void(t.catalog.name=e):t.validators.push({success:!1,field:"课程目录名称",desc:"不能为空!"})},t.clear=function(){t.validators=[]},t.catalogDescInputBlur=function(){t.catalog.desc=t.catalogDescInput.value.trim()},t.onSubmit=function(){t.catalog.media=t.catalogWechatsiteInput.value,i.newInvocation(t.catalog).onDone(function(e){riot.route("sd/catalogs/_"+e.courses._id)}).execute()}}),riot.tag("boss-tenant-sd-catalogs-detail",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/catalogs"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div> <div class="row" style="text-align: center"> <a href="#sd/catalogs" style="position: absolute; left: 0px; top: 10px">返回课程目录列表</a> <h4>{catalog.name}</h4> </div> <alert validators="{validators.raw()}" clear="{clear}"></alert> <div class="row"> <div class="panel panel-default"> <div class="panel-body"> <div> <table class="table table-narrow"> <tr> <td>所属公众号</td> <td>{catalog.media.name}</td> </tr> <tr> <td>租户类型</td> <td>{__app.enums.PartyType.values[catalog.tenant.type]}</td> </tr> <tr> <td>状态</td> <td>{__app.enums.LifeFlag.values[catalog.lFlg]}</td> </tr> <tr> <td>创建时间</td> <td>{_.date.format(new Date(catalog.crtOn), \'yyyy-MM-dd hh点mm分\')}</td> </tr> <tr> <td>备注</td> <td>{catalog.desc}</td> </tr> <tr> <td>微站URL</td> <td><span>{__app.settings.app.url + "/sd/" + catalog.media.originalId + "/catalog?id=" + catalog._id}</span></td> </tr> </table> <div class="row text-center" style="margin-top: 20px; margin-bottom: 20px"> <div class="col-md-12 col-lg-12"> <a href="#sd/catalogs/edit/_{catalog._id}" class="btn btn-default">修改</a> <input if="{catalog.lFlg === __app.enums.LifeFlag.names.Active}" onclick="{onInactive}" data-toggle="modal" data-target="#modal" value="锁定" type="button" class="btn btn-default"> <input if="{catalog.lFlg === __app.enums.LifeFlag.names.Inactive}" onclick="{onActive}" data-toggle="modal" data-target="#modal" value="激活" type="button" class="btn btn-default"> <input onclick="{onDelete}" data-toggle="modal" data-target="#modal" value="删除" type="button" class="btn btn-default"> </div> </div> <div class="row" style="margin-top: 20px; margin-bottom: 20px"> <div class="col-md-12 col-lg-12"> <h4 class="text-left">课程目录</h4> <hr> <div class="text-right"> <input onclick="{onAddProduct}" type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal" value="添加"> </div> <div> <table class="table table-striped"> <thead> <tr> <th>名称</th> <th>状态</th> <th>上/下架时间</th> <th>创建时间</th> <th>备注</th> <th>二维码</th> </tr> </thead> <tbody> <tr each="{populateProducts(catalog.products)}"> <td> {name} </td> <td> { __app.enums.LiveStatus.values[liveStatus] } </td> <td> { actionTime && _.date.format(new Date(actionTime), \'yyyy-MM-dd hh点mm分\') || \'空\'} </td> <td> {_.date.format(new Date(crtOn), \'yyyy-MM-dd hh点mm分\')} </td> <td> { desc } </td> <td> <i class="fa fa-qrcode fa-lg" aria-hidden="true" data-toggle="modal" data-target="#showImg" onclick="{parent.obtainQr(this)}"></i> </td> </tr> </tbody> </table> </div> </div> </div> </div> </div> </div> </div> </div> <div id="myModal" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"> <div class="modal-dialog modal-lg"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title">选择课程</h4> </div> <div class="modal-body"> <table class="table table-striped"> <thead> <tr> <th> <div class="checkbox"> <label> <input id="toggleInput" type="checkbox" onclick="{onToggleSelectAll}"> </label> </div> </th> <th>名称</th> <th>状态</th> <th>上/下架时间</th> <th>创建时间</th> <th>备注</th> </tr> </thead> <tbody> <tr each="{courses}"> <td> <div class="checkbox"> <label> <input name="CourseCheckBox" type="checkbox" __checked="{parent.isChecked(_id)}" value="{_id}"> </label> </div> </td> <td> {name} </td> <td> { __app.enums.LiveStatus.values[liveStatus] } </td> <td> { actionTime && _.date.format(new Date(actionTime), \'yyyy-MM-dd hh点mm分\') || \'空\'} </td> <td> {_.date.format(new Date(crtOn), \'yyyy-MM-dd hh点mm分\')} </td> <td> { desc } </td> </tr> </tbody> </table> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">取消</button> <button onclick="{onSubmitCourses}" data-dismiss="modal" type="button" class="btn btn-primary">确认</button> </div> </div> </div> </div> </div> </div> </div> </div>',"boss-tenant-sd-catalogs-detail .form-horizontal .control-label{ text-align: left !important; } boss-tenant-sd-catalogs-detail .vcenter { vertical-align: middle; } boss-tenant-sd-catalogs-detail .table-narrow tr td{ border: none !important; width: 30% !important; } boss-tenant-sd-catalogs-detail .my-table{ width: 100%; } boss-tenant-sd-catalogs-detail .my-table td{ width: 33.33333%; } boss-tenant-sd-catalogs-detail .panel-default { border-top: none; border-color: #ddd; }",function(e){"use strict";var t=nest.presentable(this),n=domain.action("loadCatalogById"),i=domain.action("findCourses"),o=domain.action("updateCatalogById"),r=domain.action("fetchSdQrByProductAndWechatSite");t.on("open",function(e){var o=e.req.paramList[0];n.newInvocation({id:o}).onDone(function(e){t.catalog=e.catalog,i.newInvocation({tenant:__page.tenantId}).onDone(function(e){t.courses=e.courses,t.trigger("ready",!1),t.trigger("view-route-to")}).execute()}).execute()}),t.on("mount",function(){t.validators=_.widget.validatify([])}),t.isChecked=function(e){return t.catalog.products.map(function(e){return e._id}).indexOf(e)>=0},t.populateProducts=function(e){return e.map(function(e){return t.courses.filter(function(t){return t._id===e._id})[0]})},t.onToggleSelectAll=function(){var e=[].slice.apply(document.querySelectorAll('input[name="CourseCheckBox"]'));return t.toggleInput.checked===!1?e.map(function(e){e.checked=!1}):e.map(function(e){e.checked=!0}),!0},t.onInactive=function(e){_.widget.confirm({title:"操作确认",content:"你确认要“锁定”该课程目录吗？",callback:function(){t.catalog.lFlg=__app.enums.LifeFlag.names.Inactive,o.newInvocation({id:t.catalog._id,o:t.catalog}).onDone(function(e){t.update()}).execute()}})},t.obtainQr=function(e){return function(n){var i=null,o=null;return"object"==typeof t.catalog.media&&e?e.poster?e.qr&&e.qr.ticket?(i=e.qr.ticket||e.qr.ticket,o="https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket="+i,void _.widget.showImg({title:"扫一扫获取课程海报",imgUrl:o,width:"300px",height:"300px"})):void r.newInvocation({product:_.toObjectFromRiot(e),media:t.catalog.media}).onDone(function(e){return e.error?void alert("获取二维码失败"):(i=e.product.qr.ticket,o="https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket="+i,_.widget.showImg({title:"扫一扫获取课程海报",imgUrl:o,width:"300px",height:"300px"}),void t.catalog.products.forEach(function(n,i){e.product._id===n._id&&(t.catalog.products[i]=e.product)}))}).execute():void _.widget.showImg({title:"扫一扫获取课程海报",imgUrl:"",width:"300px",height:"300px",errorMsg:"该课程尚没有背景图片"}):void 0}},t.onActive=function(){_.widget.confirm({title:"操作确认",content:"你确认要“锁定”该课程目录吗？",callback:function(){t.catalog.lFlg=__app.enums.LifeFlag.names.Active,o.newInvocation({id:t.catalog._id,o:t.catalog}).onDone(function(e){t.update()}).execute()}})},t.onDelete=function(){_.widget.confirm({title:"操作确认",content:"你确认要“删除”该课程目录吗？",callback:function(){t.catalog.lFlg=__app.enums.LifeFlag.names.Deleted,o.newInvocation({id:t.catalog._id,o:t.catalog}).onDone(function(e){e.error||riot.route("sd/catalogs")}).execute()}})},t.onSubmitCourses=function(){var e=document.querySelectorAll('input[name="CourseCheckBox"]:checked'),n=[];t.catalog.products=[].slice.apply(e).map(function(e){return n.push(e.value),t.courses.filter(function(t){return t._id===e.value})[0]});var i={};i._id=t.catalog._id,i.products=n,o.newInvocation({id:t.catalog._id,o:i}).onDone(function(e){e.error&&alert("保存课程失败")}).execute()},t.onAddProduct=function(){t.toggleInput.checked=!1}}),riot.tag("boss-tenant-sd-catalogs-edit",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/catalogs"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>{catalog.name}</h4> </div> <alert validators="{validators.raw()}" clear="{clear}"></alert> <div class="row"> <div class="panel panel-default"> <div class="panel-body"> <form class="form-horizontal"> <div class="form-group text-left"> <label for="catalogNameInput" class="col-sm-2 control-label text-left">课程目录名称</label> <div class="col-sm-10 {has-error: !catalogNameInput.value.trim()} has-feedback"> <input onblur="{catalogNameInputBlur}" value="{catalog.name}" id="catalogNameInput" type="text" class="form-control "> </div> </div> <div class="form-group"> <label for="catalogMediaInput" class="col-sm-2 control-label">公众号</label> <div class="col-sm-10"> <select id="catalogMediaInput" class="form-control"> <option each="{wechatsites}" value="{_id}">{name}</option> </select> </div> </div> <div class="form-group"> <label for="catalogDescInput" class="col-sm-2 control-label">备注</label> <div class="col-sm-10"> <textarea onblur="{catalogDescInputBlur}" type="password" class="form-control" id="catalogDescInput"> {catalog.desc} </textarea> </div> </div> </form> </div> </div> </div> <div class="row" style="margin-top: 10px"> <div class="col-md-12 col-lg-12 text-center"> <input __disabled="{!courseMediaPriceInput.value.trim() || !courseNameInput.value.trim()}" onclick="{onSubmit}" type="button" class="btn btn-primary" value="保存"> <a href="#sd/catalogs" class="btn btn-default">取消</a> </div> </div> </div> </div> </div> </div>',".form-horizontal .control-label{ text-align: left !important; } .vcenter { vertical-align: middle; } .my-table{ width: 100%; } .my-table td{ width: 33.33333%; } .panel-default { border-top: none; border-color: #ddd; }",function(e){"use strict";var t=nest.presentable(this),n=domain.action("loadCatalogById"),i=domain.action("updateCatalogById"),o=domain.action("loadAllTenantWechatSite");t.on("open",function(e){var i=e.req.paramList[0];n.newInvocation({id:i}).onDone(function(e){t.catalog=e.catalog,o.newInvocation(__page.tenantId).onDone(function(e){t.wechatsites=e,t.trigger("ready",!1),t.trigger("view-route-to")}).execute()}).execute()}),t.on("mount",function(){t.validators=_.widget.validatify([])}),t.catalogNameInputBlur=function(){var e=t.catalogNameInput.value.trim();return e?void(t.catalog.name=e):t.validators.addToSet({success:!1,field:"课程名称",desc:"不能为空!",key:"courseNameInput"})},t.clear=function(){t.validators.clear()},t.catalogDescInputBlur=function(){t.catalog.desc=t.catalogDescInput.value.trim()},t.onSubmit=function(){var e={id:t.catalog._id,o:t.catalog};i.newInvocation(e).onDone(function(e){riot.route("sd/catalogs")}).execute()}}),riot.tag("boss-tenant-sd-catalogs",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/catalogs"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>课程目录管理</h4> </div> <div class="row"> <form class="form-inline"> <div class="col-md-6 col-lg-6"> <div class="form-group"> <label for="catalogStatus">状态</label> <select id="catalogStatus" class="form-control" onchange="{onSelect}"> <option value="">全部状态</option> <option value="{__app.enums.LifeFlag.names.Active}">已激活</option> <option value="{__app.enums.LifeFlag.names.Inactive}">已锁定</option> <option value="{__app.enums.LifeFlag.names.Deleted}">已删除</option> </select> </div> <input onclick="{onSearch}" class="btn btn-primary" type="button" value="查询"> </div> <div class="col-md-6 col-lg-6 text-right"> <a class="btn btn-primary" href="#sd/catalogs/add">添加</a> </div> </form> </div> <div class="row" style="margin-top: 10px"> <table class="table table-striped"> <thead> <tr> <th>名称</th> <th>状态</th> <th>公众号</th> <th>创建时间</th> <th>备注</th> </tr> </thead> <tbody> <tr each="{catalogs}"> <td> <a href="#sd/catalogs/_{_id}"> {name} </a> </td> <td> { __app.enums.LifeFlag.values[lFlg] } </td> <td> { media.name } </td> <td> {_.date.format(new Date(crtOn), \'yyyy-MM-dd hh点mm分\')} </td> <td> { desc } </td> </tr> </tbody> </table> </div> </div> </div> </div>',function(e){"use strict";var t=nest.presentable(this),n=domain.action("findCatalogs");t.courses=[],t.filter={tenant:__page.tenantId},t.on("open",function(){n.newInvocation({filter:t.filter}).onDone(function(e){return e.error?alert("failed to search courses"):(t.catalogs=e.catalogs,t.trigger("ready",!1),void t.trigger("view-route-to"))}).execute()}),t.onSearch=function(e){n.newInvocation({filter:t.filter}).onDone(function(e){return e.error?alert("failed to search courses"):void t.update({catalogs:e.catalogs})}).execute()},t.onSelect=function(e){var n=t.catalogStatus.value;return n?void(t.filter.lFlg=n):void(t.filter.hasOwnProperty("lFlg")&&delete t.filter.lFlg)}}),riot.tag("boss-tenant-sd-courses-add",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/courses"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>新建课程</h4> </div> <alert validators="{validators}" clear="{clear}"></alert> <div class="row"> <div class="panel panel-default"> <div class="panel-heading">基本信息</div> <div class="panel-body"> <form class="form-horizontal"> <div class="form-group text-left"> <label for="courseNameInput" class="col-sm-2 control-label text-left">课程名称</label> <div class="col-sm-10 {has-error: !courseNameInput.value.trim()} has-feedback"> <input onblur="{courseNameInputBlur}" type="text" class="form-control " id="courseNameInput"> </div> </div> <div class="form-group"> <label for="coursePromoteInput" class="col-sm-2 control-label">推广语</label> <div class="col-sm-10 {has-error: !courseNameInput.value.trim()} has-feedback"> <input onblur="{coursePromoteInputBlur}" type="text" class="form-control" id="coursePromoteInput"> </div> </div> <div class="form-group"> <label for="courseMediaPriceInput" class="col-sm-2 control-label">媒体价 ( :元 )</label> <div class="col-sm-10 {has-error: !courseMediaPriceInput.value.trim()}"> <input onblur="{courseMediaPriceInputBlur}" type="number" class="form-control" id="courseMediaPriceInput"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">上/下架状态</label> <div class="col-sm-10" style="height: 32px;line-height: 32px"> <span>待上架</span> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">上/下架时间</label> <div class="col-sm-10" style="height: 32px;line-height: 32px"> <span>空</span> </div> </div> <div class="form-group"> <label for="courseDescInput" class="col-sm-2 control-label">备注</label> <div class="col-sm-10"> <textarea onblur="{courseDescInputBlur}" type="password" class="form-control" id="courseDescInput"></textarea> </div> </div> </form> </div> </div> </div> <div class="row" style="margin-top: 10px"> <div class="col-md-12 col-lg-12 text-center"> <input __disabled="{!courseMediaPriceInput.value.trim() || !courseNameInput.value.trim() || !coursePromoteInput.value.trim()}" onclick="{onSubmit}" type="button" class="btn btn-primary" value="保存"> <a href="#sd/courses" class="btn btn-default">取消</a> </div> </div> </div> </div> </div>',".form-horizontal .control-label{ text-align: left !important; }",function(e){"use strict";var t=nest.presentable(this),n=domain.action("createCourse");t.on("open",function(){t.course={},t.course.tenant=__page.tenantId,t.validators=[],t.courseMediaPriceInput.value="",t.courseNameInput.value="",t.coursePromoteInput.value="",t.courseDescInput.value="",t.trigger("ready",!1),t.trigger("view-route-to")}),t.courseNameInputBlur=function(){var e=t.courseNameInput.value.trim();return e?void(t.course.name=e):t.validators.push({success:!1,field:"课程名称",desc:"不能为空!"})},t.clear=function(){t.validators=[]},t.courseDescInputBlur=function(){t.course.desc=t.courseDescInput.value.trim()},t.coursePromoteInputBlur=function(){var e=t.coursePromoteInput.value.trim();return e?void(t.course.slogan=e):t.validators.push({success:!1,field:"推广语",desc:"不能为空!"})},t.courseMediaPriceInputBlur=function(){var e=t.courseMediaPriceInput.value.trim();return e?void(t.course.listPrice=e):t.validators.push({success:!1,field:"媒体价",desc:"不能为空!"})},t.onSubmit=function(){n.newInvocation(t.course).onDone(function(e){riot.route("sd/courses/_"+e.course._id)}).execute()}}),riot.tag("boss-tenant-sd-courses-detail",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/courses"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div> <div class="row" style="text-align: center"> <a href="#sd/courses" style="position: absolute; left: 0px; top: 10px">返回课程列表</a> <h4>{course.name}</h4> </div> <alert validators="{validators.raw()}" clear="{clear}"></alert> <div class="row"> <ul class="nav nav-tabs"> <li role="presentation" class="{active: currNav === 0}"> <a onclick="{onChangeTab(0)}">课程</a> </li> <li role="presentation" class="{active: currNav === 1}"> <a onclick="{onChangeTab(1)}">分销<b if="{course.upLine1CommissionValue == 0 && course.upLine2CommissionValue == 0 && course.upLine3CommissionValue == 0}" class="new_tag">新</b></a> </li> </ul> </div> <div class="row" if="{currNav === 0}"> <div class="panel panel-default"> <div class="panel-body"> <div> <table class="table table-narrow"> <tr> <td>课程名称</td> <td>{course.name}</td> </tr> <tr> <td>推广语</td> <td>{course.slogan}</td> </tr> <tr> <td>媒体价 ( :元 )</td> <td>{course.listPrice}</td> </tr> <tr> <td>上/下架状态</td> <td>{__app.enums.LiveStatus.values[course.liveStatus]}</td> </tr> <tr> <td>上/下架时间</td> <td>{course.actionTime && _.date.format(new Date(course.actionTime), \'yyyy-MM-dd hh点mm分\') || \'空\'}</td> </tr> <tr> <td>备注</td> <td>{course.desc}</td> </tr> <tr> <td><strong>焦点图</strong></td> <td colspan="2"> <ul class="banners-container"> <li each="{banner, i in course.banners}"> <img riot-src="{banner && (__app.settings.api.url + \'/file?media_id=\' + banner)}"> </li> </ul> </td> </tr> </table> <div class="row text-center"> <div class="col-md-12 col-lg-12"> <a href="#sd/courses/edit/details/_{course._id}">编辑课程详情</a> </div> </div> </div> </div> </div> </div> <div class="row" if="{currNav === 1}"> <div class="panel panel-default"> <div class="panel-body"> <td class="text-left"> <table class="my-table table table-narrow"> <tr> <td><strong>会员折扣</strong></td> <td>单位课程优惠</td> <td> <span>{__app.enums.CommissionType.names.Cash === course.memberDiscountsType && \'金额\' || \'百分比\'}</span> <span>{ course.memberDiscountsValue }</span> </td> </tr> <tr> <td><strong>直接分销商-直接推荐人</strong></td> <td>单位课程佣金</td> <td> <span>{__app.enums.CommissionType.names.Cash === course.upLine1CommissionType && \'金额\' || \'百分比\'}</span> <span>{ course.upLine1CommissionValue }</span> </td> </tr> <tr> <td><strong>间接分销商-间接推荐人</strong></td> <td>单位课程佣金</td> <td> <span>{__app.enums.CommissionType.names.Cash === course.upLine2CommissionType && \'金额\' || \'百分比\'}</span> <span>{ course.upLine2CommissionValue }</span> </td> </tr> <tr> <td><strong>第三级分销商-间接推荐人的推荐人</strong></td> <td>单位课程佣金</td> <td> <span>{__app.enums.CommissionType.names.Cash === course.upLine3CommissionType && \'金额\' || \'百分比\'}</span> <span>{ course.upLine3CommissionValue }</span> </td> </tr> <tr> <td colspan="3" style="text-align: center">注： 如果佣金按百分比计算，佣金基数以实际消费者实付金额为准（即线下实际核销金额）</td> </tr> <tr> <td><strong>分销海报背景</strong></td> <td colspan="2"><img style="width: 200px" riot-src="{course.poster &&__app.settings.api.url + \'/file?media_id=\' + course.poster}"></td> </tr> </table> </div> </div> </div>  <div class="row text-center" style="margin-top: 20px; margin-bottom: 20px"> <div class="col-md-12 col-lg-12"> <a href="#sd/courses/edit/_{course._id}" class="btn btn-default">修改</a> <input if="{course.liveStatus === __app.enums.LiveStatus.names.Idle}" onclick="{onGoLive}" data-toggle="modal" data-target="#modal" value="上架" type="button" class="btn btn-default"> <input if="{course.liveStatus === __app.enums.LiveStatus.names.GoLive}" onclick="{onSunset}" data-toggle="modal" data-target="#modal" value="下架" type="button" class="btn btn-default"> <input onclick="{onDelete}" data-toggle="modal" data-target="#modal" value="删除" type="button" class="btn btn-default"> </div> </div> </div> </div> </div> </div> </div>',"boss-tenant-sd-courses-detail .form-horizontal .control-label{ text-align: left !important; } boss-tenant-sd-courses-detail .vcenter { vertical-align: middle; } boss-tenant-sd-courses-detail .table-narrow tr td{ border: none !important; width: 30% !important; } boss-tenant-sd-courses-detail .my-table{ width: 100%; } boss-tenant-sd-courses-detail .my-table td{ width: 33.33333%; } boss-tenant-sd-courses-detail .panel-default { border-top: none; border-color: #ddd; } boss-tenant-sd-courses-detail .new_tag { display: block; position: absolute; top: 5px; right: 5px; background: red; width: 10px; height: 10px; border-radius: 50em; text-indent: -99em; }",function(e){"use strict";var t=nest.presentable(this),n=domain.action("loadCourseById"),i=domain.action("updateCourseById");t.currNav=0,t.onChangeTab=function(e){return function(){t.currNav=e}},t.on("open",function(e){var i=e.req.paramList[0];n.newInvocation({id:i}).onDone(function(e){console.log(e.course.upLine1CommissionValue),t.course=e.course,t.course.banners||(t.course.banners=[]),t.trigger("ready",!1),t.trigger("view-route-to")}).execute()}),t.on("mount",function(){t.validators=_.widget.validatify([])}),t.onGoLive=function(e){_.widget.confirm({title:"操作确认",content:"你确认要“上架”该课程吗？",callback:function(){t.course.liveStatus=__app.enums.LiveStatus.names.GoLive,i.newInvocation({id:t.course._id,intention:"GoLiveOrSunset",o:t.course}).onDone(function(e){t.course.actionTime=e.course.actionTime,t.course.qr=e.course.qr,t.update()}).execute()}})},t.onSunset=function(){_.widget.confirm({title:"操作确认",content:"你确认要“下架”该课程吗？",callback:function(){t.course.liveStatus=__app.enums.LiveStatus.names.Sunset,i.newInvocation({id:t.course._id,intention:"GoLiveOrSunset",o:t.course}).onDone(function(e){t.course.actionTime=e.course.actionTime,t.update()}).execute()}})},t.onDelete=function(){_.widget.confirm({title:"操作确认",content:"你确认要“删除”该课程吗？",callback:function(){t.course.lFlg=__app.enums.LifeFlag.names.Deleted,i.newInvocation({id:t.course._id,o:t.course}).onDone(function(e){e.error||riot.route("sd/courses")}).execute()}})}}),riot.tag("boss-tenant-sd-courses-edit-detail",'<div class="container" if="{!hidden}"> <div class="row"> <div class="col-md-6 col-md-offset-3"> <div class="row text-center"> <a href="#sd/courses/_{course._id}" style="position: absolute; left: 0px; top: 10px">返回</a> <h4>课程详情-{course.name}</h4> </div> <div class="row" style="margin-bottom: 10px"> <span>更新时间: {course.updOn && _.date.format(new Date(course.updOn), \'yyyy-MM-dd hh点mm分\')}</span> </div> <div if="{status===\'view\'}"> <div class="row" style="margin-bottom: 10px"> <input onclick="{onEdit}" type="button" class="btn btn-primary" value="编辑"> </div> <div class="row" style="height:450px; background: white; padding: 10px; margin-bottom: 20px; overflow: scroll"> <raw content="{course.details}"></raw> </div> </div> <div if="{status===\'edit\'}"> <div class="row" style="margin-bottom: 10px"> <input onclick="{onPreview}" type="button" class="btn btn-primary" value="预览"> </div> <div class="row text-center" style="padding-bottom: 50px"> <div id="richEditor"></div> <input onclick="{onSubmit}" type="button" class="btn-primary btn" value="保存"> <input onclick="{onCancel}" type="button" class="btn-default btn" value="取消"> </div> </div> <div if="{status===\'preview\'}"> <div class="row" style="margin-bottom: 10px"> <input onclick="{onBack}" type="button" class="btn btn-primary" value="返回"> </div> <div class="row" style="height: 450px;background: white; padding: 10px; margin-bottom: 20px; overflow: scroll"> <raw content="{preview}"></raw> </div>    </div> </div> </div> </div>',function(e){"use strict";var t=nest.presentable(this),n=domain.action("loadCourseById"),i=domain.action("updateCourseById");t.on("open",function(e){t.status="view";
var i=e.req.paramList[0];n.newInvocation({id:i}).onDone(function(e){t.course=e.course,t.preview=e.course.details||"",t.trigger("ready",!1),t.trigger("view-route-to")}).execute()}),t.onEdit=function(){t.status="edit",setTimeout(function(){$("#richEditor").summernote({height:400,minHeight:null,maxHeight:null,toolbar:[["style",["bold","italic","underline","clear"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["fontname",["fontname"]],["insert",["picture","link","video","hr","table"]]],callbacks:{onImageUpload:function(e){o(e[0])}}}).summernote("code",t.course.details||"")},0)},t.onSubmit=function(){t.course.details=$("#richEditor").summernote("code"),i.newInvocation({id:t.course._id,o:t.course}).onDone(function(e){return e.error?alert("error occur."):void riot.route("sd/courses/_"+t.course._id)}).execute()},t.onPreview=function(){"preview"!=t.status&&(t.status="preview",t.preview=$("#richEditor").summernote("code"))},t.onBack=function(){t.status="edit"},t.onCancel=function(){t.status="view"};var o=function(e){_.uploadImgFile(e,function(e,t){e?alert("上传图片失败"):$("#richEditor").summernote("insertImage",t,function(e){e.css("width","100%")})})}}),riot.tag("boss-tenant-sd-courses-edit",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/courses"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>{course.name}</h4> </div> <alert validators="{validators.raw()}" clear="{clear}"></alert> <div class="row"> <ul class="nav nav-tabs"> <li role="presentation" class="{active: currNav === 0}"><a onclick="{onChangeTab(0)}">课程</a></li> <li role="presentation" class="{active: currNav === 1}"><a onclick="{onChangeTab(1)}">分销</a></li> </ul> </div> <div class="row" if="{currNav === 0}"> <div class="panel panel-default"> <div class="panel-body"> <form class="form-horizontal"> <div class="form-group text-left"> <label for="courseNameInput" class="col-sm-2 control-label text-left">课程名称</label> <div class="col-sm-10 {has-error: !courseNameInput.value.trim()} has-feedback"> <input onblur="{courseNameInputBlur}" value="{course.name}" id="courseNameInput" type="text" class="form-control "> </div> </div> <div class="form-group"> <label for="coursePromoteInput" class="col-sm-2 control-label">推广语</label> <div class="col-sm-10"> <input onblur="{coursePromoteInputBlur}" value="{course.slogan}" type="text" class="form-control" id="coursePromoteInput"> </div> </div> <div class="form-group"> <label for="courseMediaPriceInput" class="col-sm-2 control-label">媒体价 ( :元 )</label> <div class="col-sm-10 {has-error: !courseMediaPriceInput.value.trim()}"> <input onblur="{courseMediaPriceInputBlur}" value="{course.listPrice}" type="number" class="form-control" id="courseMediaPriceInput"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">上/下架状态</label> <div class="col-sm-10" style="height: 32px;line-height: 32px"> <span>{__app.enums.LiveStatus.values[course.liveStatus]}</span> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">上/下架时间</label> <div class="col-sm-10" style="height: 32px;line-height: 32px"> <span>{course.actionTime && _.date.format(new Date(course.actionTime), \'yyyy-MM-dd hh点mm分\') || \'空\'}</span> </div> </div> <div class="form-group"> <label for="courseDescInput" class="col-sm-2 control-label">备注</label> <div class="col-sm-10"> <textarea onblur="{courseDescInputBlur}" type="password" class="form-control" id="courseDescInput"> {course.desc} </textarea> </div> </div> <div class="form-group"> <label for="courseDescInput" class="col-sm-2 control-label">轮播焦点图</label> <div class="col-sm-10"> <input multiple="multiple" onchange="{onBannersChange}" id="bannersInput" type="file" accept="image/jpeg, image/png, image/jpg"> <ul class="banners-container"> <li each="{banner, i in course.banners}" onmouseenter="{parent.onHover}" onmouseleave="{parent.onUnHover}"> <div onclick="{parent.removeBanner}" if="{isImgMaskShow}"> <b> <b class="close-a"></b> <b class="close-b"></b> </b> </div> <img riot-src="{banner.data || banner && (__app.settings.api.url + \'/file?media_id=\' + banner)}"> </li> </ul> </div> </div> </form> </div> </div> </div> <div class="row" if="{currNav === 1}"> <div class="panel panel-default"> <div class="panel-body"> <td class="text-left"> <table class="my-table table table-striped"> <tr> <td><strong>会员折扣</strong></td> <td>单位课程优惠</td> <td> <table> <tr> <td> <div onclick="{onSelectMemberDiscountsType1}" class="radio form-inline"> <label for="memberDiscountsTypeInput1"> <input id="memberDiscountsTypeInput1" value="{__app.enums.CommissionType.names.Cash}" __checked="{course.memberDiscountsType === __app.enums.CommissionType.names.Cash}" type="radio" name="memberDiscountsType"> 金额 </label> </div> </td> <td> <input id="memberDiscountsValueInput1" onblur="{onValidateValue}" __disabled="{course.memberDiscountsType != __app.enums.CommissionType.names.Cash}" value="{course.memberDiscountsType === __app.enums.CommissionType.names.Cash && course.memberDiscountsValue || \'\'}" class="form-control" type="number"> </td> </tr> <tr> <td> <div onclick="{onSelectMemberDiscountsType2}" class="radio form-inline"> <label for="memberDiscountsTypeInput2"> <input type="radio" name="memberDiscountsType" id="memberDiscountsTypeInput2" value="{__app.enums.CommissionType.names.Percent}" __checked="{course.memberDiscountsType === __app.enums.CommissionType.names.Percent}"> 百分比 </label> </div> </td> <td> <input id="memberDiscountsValueInput2" onblur="{onValidatePercent}" __disabled="{course.memberDiscountsType != __app.enums.CommissionType.names.Percent}" value="{course.memberDiscountsType === __app.enums.CommissionType.names.Percent && course.memberDiscountsValue || \'\'}" class="form-control" type="number"> </td> </tr> </table> </td> </tr> <tr> <td><strong>直接分销商-直接推荐人</strong></td> <td>单位课程佣金</td> <td> <table> <tr> <td> <div onclick="{onSelectUpLine1CommissionType1}" class="radio form-inline"> <label for="upLine1CommissionTypeInput1"> <input id="upLine1CommissionTypeInput1" value="{__app.enums.CommissionType.names.Cash}" __checked="{course.upLine1CommissionType === __app.enums.CommissionType.names.Cash}" type="radio" name="upLine1CommissionType"> 金额 </label> </div> </td> <td> <input id="upLine1CommissionValueInput1" onblur="{onBlurUpLine1CommissionValue(\'val\')}" __disabled="{course.upLine1CommissionType != __app.enums.CommissionType.names.Cash}" value="{course.upLine1CommissionType === __app.enums.CommissionType.names.Cash && course.upLine1CommissionValue || \'\'}" class="form-control" type="number"> </td> </tr> <tr> <td> <div onclick="{onSelectUpLine1CommissionType2}" class="radio form-inline"> <label for="upLine1CommissionTypeInput2"> <input id="upLine1CommissionTypeInput2" value="{__app.enums.CommissionType.names.Percent}" __checked="{course.upLine1CommissionType === __app.enums.CommissionType.names.Percent}" type="radio" name="upLine1CommissionType"> 百分比 </label> </div> </td> <td> <input id="upLine1CommissionValueInput2" onblur="{onBlurUpLine1CommissionValue(\'percent\')}" __disabled="{course.upLine1CommissionType != __app.enums.CommissionType.names.Percent}" value="{course.upLine1CommissionType === __app.enums.CommissionType.names.Percent && course.upLine1CommissionValue || \'\'}" class="form-control" type="number"> </td> </tr> </table> </td> </tr> <tr> <td><strong>间接分销商-间接推荐人</strong></td> <td>单位课程佣金</td> <td> <table> <tr> <td> <div onclick="{onSelectUpLine2CommissionType1}" class="radio form-inline"> <label for="upLine2CommissionTypeInput1"> <input id="upLine2CommissionTypeInput1" value="{__app.enums.CommissionType.names.Cash}" __checked="{course.upLine2CommissionType === __app.enums.CommissionType.names.Cash}" type="radio" name="upLine2CommissionType"> 金额 </label> </div> </td> <td> <input id="upLine2CommissionValueInput1" onblur="{onBlurUpLine2CommissionValue(\'val\')}" __disabled="{course.upLine2CommissionType != __app.enums.CommissionType.names.Cash}" value="{course.upLine2CommissionType === __app.enums.CommissionType.names.Cash && course.upLine2CommissionValue || \'\'}" class="form-control" type="number"> </td> </tr> <tr> <td> <div onclick="{onSelectUpLine2CommissionType2}" class="radio form-inline"> <label for="upLine2CommissionTypeInput2"> <input id="upLine2CommissionTypeInput2" value="{__app.enums.CommissionType.names.Percent}" __checked="{course.upLine2CommissionType === __app.enums.CommissionType.names.Percent}" type="radio" name="upLine2CommissionType"> 百分比 </label> </div> </td> <td> <input id="upLine2CommissionValueInput2" onblur="{onBlurUpLine2CommissionValue(\'percent\')}" __disabled="{course.upLine2CommissionType != __app.enums.CommissionType.names.Percent}" value="{course.upLine2CommissionType === __app.enums.CommissionType.names.Percent && course.upLine2CommissionValue || \'\'}" class="form-control" type="number"> </td> </tr> </table> </td> </tr> <tr> <td><strong>第三级分销商-间接推荐人的推荐人</strong></td> <td>单位课程佣金</td> <td> <table> <tr> <td> <div onclick="{onSelectUpLine3CommissionType1}" class="radio form-inline"> <label for="upLine3CommissionTypeInput1"> <input id="upLine3CommissionTypeInput1" value="{__app.enums.CommissionType.names.Cash}" __checked="{course.upLine3CommissionType === __app.enums.CommissionType.names.Cash}" type="radio" name="upLine3CommissionType"> 金额 </label> </div> </td> <td> <input id="upLine3CommissionValueInput1" onblur="{onBlurUpLine3CommissionValue(\'val\')}" __disabled="{course.upLine3CommissionType != __app.enums.CommissionType.names.Cash}" value="{course.upLine3CommissionType === __app.enums.CommissionType.names.Cash && course.upLine3CommissionValue || \'\'}" class="form-control" type="number"> </td> </tr> <tr> <td> <div onclick="{onSelectUpLine3CommissionType2}" class="radio form-inline"> <label for="upLine3CommissionTypeInput2"> <input id="upLine3CommissionTypeInput2" value="{__app.enums.CommissionType.names.Percent}" __checked="{course.upLine3CommissionType === __app.enums.CommissionType.names.Percent}" type="radio" name="upLine3CommissionType"> 百分比 </label> </div> </td> <td> <input id="upLine3CommissionValueInput2" onblur="{onBlurUpLine3CommissionValue(\'percent\')}" __disabled="{course.upLine3CommissionType != __app.enums.CommissionType.names.Percent}" value="{course.upLine3CommissionType === __app.enums.CommissionType.names.Percent && course.upLine3CommissionValue || \'\'}" class="form-control" type="number"> </td> </tr> </table> </td> </tr> <tr> <td colspan="3" style="text-align: center">注： 如果佣金按百分比计算，佣金基数以实际消费者实付金额为准（即线下实际核销金额）</td> </tr> <tr> <td> <strong>分销海报背景</strong> </td> <td colspan="2"> <input onchange="{onFileChange}" id="posterInput" type="file" accept="image/jpeg, image/png, image/jpg"> <img style="width: 100px; margin-top: 10px" riot-src="{course.poster && !course.poster.data && __app.settings.api.url + \'/file?media_id=\' + course.poster || course.poster.data}"> </td> </tr> </table> </div> </div> </div>  <div class="row" style="margin-top: 10px"> <div class="col-md-12 col-lg-12 text-center"> <input __disabled="{!courseMediaPriceInput.value.trim() || !courseNameInput.value.trim() || !validators.allOk()}" onclick="{onSubmit}" type="button" class="btn btn-primary" value="保存"> <a href="#sd/courses" class="btn btn-default">取消</a> </div> </div> </div> </div> </div> </div>',".form-horizontal .control-label{ text-align: left !important; } .vcenter { vertical-align: middle; } .my-table{ width: 100%; } .my-table td{ width: 33.33333%; } .panel-default { border-top: none; border-color: #ddd; } .banners-container{ margin: 0px; margin-top: 10px;overflow: hidden;padding:0px } .banners-container >li { position: relative;width: 100px;height:100px;overflow: hidden;background-color: #EFEFEF; list-style-type:none;float:left;margin-right: 10px;line-height: 100px;text-align: center } .banners-container >li img{ width: 100px; } .banners-container >li div{ position: absolute; top: 0px; left: 0px; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); } .banners-container >li div >b{ position: absolute; top:38px; left:38px; width:24px; height:24px; } .close-a{ position: absolute; top:0px; left:10px; width: 4px; height: 24px; transform:rotate(45deg); background: white; } .close-b{ position: absolute; top:0px; left:10px; width: 4px; height: 24px; transform:rotate(135deg); background: white; }",function(e){"use strict";var t=nest.presentable(this),n=3,i=domain.action("loadCourseById"),o=domain.action("updateCourseById");t.currNav=0,t.onChangeTab=function(e){return function(){t.currNav=e}},t.on("open",function(e){var n=e.req.paramList[0];t.posterInput.value="",t.bannersInput.value="",i.newInvocation({id:n}).onDone(function(e){t.course=e.course,t.course.banners||(t.course.banners=[]),t.trigger("ready",!1),t.trigger("view-route-to")}).execute()}),t.onHover=function(){this.isImgMaskShow=!0},t.onUnHover=function(){this.isImgMaskShow=!1},t.on("mount",function(){t.validators=_.widget.validatify([]),setTimeout(function(){$("#richEditor").summernote({height:200,minHeight:null,maxHeight:null,focus:!0})},100)}),t.courseNameInputBlur=function(){var e=t.courseNameInput.value.trim();return e?void(t.course.name=e):t.validators.addToSet({success:!1,field:"课程名称",desc:"不能为空!",key:"courseNameInput"})},t.clear=function(){t.validators.clear()},t.courseDescInputBlur=function(){t.course.desc=t.courseDescInput.value.trim()},t.coursePromoteInputBlur=function(){t.course.slogan=t.coursePromoteInput.value.trim()},t.courseMediaPriceInputBlur=function(){var e=t.courseMediaPriceInput.value.trim();return e?void(t.course.listPrice=e):t.validators.addToSet({success:!1,field:"媒体价",desc:"不能为空!",key:"courseMediaPrice"})},t.onSelectMemberDiscountsType1=function(e){t.course.memberDiscountsType=__app.enums.CommissionType.names.Cash,t.course.memberDiscountsValue=""};var r=function(e,n,i){return e.trim()<0||parseInt(e.trim(),10)>parseInt(t.course.listPrice,10)?t.validators.addToSet({success:!1,field:n.value,desc:"所属金额小于0,或者大于媒体价",key:n.key}):(t.validators.pass(n.key),void i())},a=function(e,n,i){return e.trim()<=0||e.trim()>100?t.validators.addToSet({success:!1,field:n.value,desc:"请输入1到100的自然数",key:n.key}):(t.validators.pass(n.key),void i())};t.onValidateValue=function(e){r(e.target.value,{key:"membershipDiscountValue",value:"会员折扣金额非法"},function(){t.course.memberDiscountsValue=e.target.value})},t.onValidatePercent=function(e){a(e.target.value,{key:"membershipDiscountPercent",value:"会员折扣百分比非法"},function(){t.course.memberDiscountsValue=e.target.value})},t.onSelectMemberDiscountsType2=function(e){t.course.memberDiscountsType=__app.enums.CommissionType.names.Percent,t.course.memberDiscountsValue=""},t.onSelectUpLine1CommissionType1=function(e){t.course.upLine1CommissionType=__app.enums.CommissionType.names.Cash,t.course.upLine1CommissionValue=""},t.onSelectUpLine1CommissionType2=function(e){t.course.upLine1CommissionType=__app.enums.CommissionType.names.Percent,t.course.upLine1CommissionValue=""},t.onBlurUpLine1CommissionValue=function(e){return function(n){return"val"===e?void r(n.target.value,{key:"upLine1CommissionValue",value:"一级分销金额非法"},function(){t.course.upLine1CommissionValue=n.target.value}):void a(n.target.value,{key:"upLine1CommissionPercent",value:"一级分销百分比非法"},function(){t.course.upLine1CommissionValue=n.target.value})}},t.onSelectUpLine2CommissionType1=function(e){t.course.upLine2CommissionType=__app.enums.CommissionType.names.Cash,t.course.upLine2CommissionValue=""},t.onSelectUpLine2CommissionType2=function(e){t.course.upLine2CommissionType=__app.enums.CommissionType.names.Percent,t.course.upLine2CommissionValue=""},t.onBlurUpLine2CommissionValue=function(e){return function(n){return"val"===e?void r(n.target.value,{key:"upLine2CommissionValue",value:"二级分销金额非法"},function(){t.course.upLine2CommissionValue=n.target.value}):void a(n.target.value,{key:"upLine2CommissionPercent",value:"二级分销百分比非法"},function(){t.course.upLine2CommissionValue=n.target.value})}},t.onSelectUpLine3CommissionType1=function(e){t.course.upLine3CommissionType=__app.enums.CommissionType.names.Cash,t.course.upLine3CommissionValue=""},t.onSelectUpLine3CommissionType2=function(e){t.course.upLine3CommissionType=__app.enums.CommissionType.names.Percent,t.course.upLine3CommissionValue=""},t.onBlurUpLine3CommissionValue=function(e){return function(n){return"val"===e?void r(n.target.value,{key:"upLine3CommissionValue",value:"三级分销金额非法"},function(){t.course.upLine3CommissionValue=n.target.value}):void a(n.target.value,{key:"upLine3CommissionPercent",value:"三级分销百分比非法"},function(){t.course.upLine3CommissionValue=n.target.value})}},t.onFileChange=function(e){var n=document.getElementById("posterInput").files[0];if(n.size>2097152)return void alert("文件大小超过限制-2M");var i=new FileReader;i.readAsDataURL(n),i.onload=function(e){t.course.poster={file:n,data:e.target.result},t.update()}},t.removeBanner=function(e){t.course.banners.map(function(n,i){return n&&n.file&&n.file.name&&e.item.banner&&e.item.banner.file&&e.item.banner.file.name?void(n.file.name===e.item.banner.file.name&&t.course.banners.splice(i,1)):void(n===e.item.banner&&t.course.banners.splice(i,1))})},t.onBannersChange=function(e){var i=document.getElementById("bannersInput").files;if(t.course.banners){if(t.course.banners.length+i.length>n)return void alert("焦点图最多"+n+"张")}else if(i.length>n)return void alert("焦点图最多"+n+"张");if(i&&i.length){var o=0,r=function(e){var n=i[e];if(n){if(n.size>2097152)return void alert("文件大小超过限制-2M");var o=new FileReader;o.readAsDataURL(n),o.onload=function(i){t.course.banners||(t.course.banners=[]),t.course.banners.push({file:n,data:i.target.result}),t.update(),r(++e)}}};r(o)}},t.onSubmit=function(){function e(){i==n&&o.newInvocation(r).onDone(function(e){riot.route("sd/courses")}).execute()}var n=0,i=0,r={id:t.course._id,o:t.course};if(t.course.poster&&t.course.poster.file){++n;var a=new FormData;a.append("file",t.course.poster.file),$.ajax({url:__app.settings.api.url+"/file/upload",type:"POST",data:a,processData:!1,contentType:!1,success:function(t){r.o.poster=t.media_id,++i,e()},error:function(e){console.error("失败:"+JSON.stringify(e))}})}if(t.course.banners){++n;var s=new FormData;t.course.banners.map(function(e){e.file&&s.append("files",e.file)}),$.ajax({url:__app.settings.api.url+"/file/uploads",type:"POST",data:s,processData:!1,contentType:!1,success:function(n){var o=[];t.course.banners&&t.course.banners.length&&(o=t.course.banners.filter(function(e){return"string"==typeof e})),r.o.banners=o.concat(n.metas.map(function(e){return e.media_id})),++i,e()},error:function(e){console.error("失败:"+JSON.stringify(e))}})}e()}}),riot.tag("boss-tenant-sd-courses",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/courses"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>课程管理</h4> </div> <div class="row"> <form class="form-inline"> <div class="col-md-6 col-lg-6"> <div class="form-group"> <label for="coursesStatus">状态</label> <select id="coursesStatus" class="form-control" onchange="{onSelect}"> <option value="">全部状态</option> <option value="{__app.enums.LiveStatus.names.Idle}">待上架</option> <option value="{__app.enums.LiveStatus.names.GoLive}">已上架</option> <option value="{__app.enums.LiveStatus.names.Sunset}">已下架</option> </select> </div> <input onclick="{onSearch}" class="btn btn-primary" type="button" value="查询"> </div> <div class="col-md-6 col-lg-6 text-right"> <a class="btn btn-primary" href="#sd/courses/add">添加</a> </div> </form> </div> <div class="row" style="margin-top: 10px"> <table class="table table-striped"> <thead> <tr> <th>名称</th> <th>状态</th> <th>上/下架时间</th> <th>创建时间</th> <th>备注</th> </tr> </thead> <tbody> <tr each="{courses}"> <td> <a href="#sd/courses/_{_id}"> {name} </a> </td> <td> { __app.enums.LiveStatus.values[liveStatus] } </td> <td> { actionTime && _.date.format(new Date(actionTime), \'yyyy-MM-dd hh点mm分\') || \'空\'} </td> <td> {_.date.format(new Date(crtOn), \'yyyy-MM-dd hh点mm分\')} </td> <td> { desc } </td> </tr> </tbody> </table> </div> </div> </div> </div>',function(e){"use strict";var t=nest.presentable(this),n=domain.action("findCourses");t.courses=[],t.filter={},console.log(__app.enums),t.on("open",function(){n.newInvocation({tenant:__page.tenantId,filter:t.filter}).onDone(function(e){return e.error?alert("failed to search courses"):(t.courses=e.courses,t.trigger("ready",!1),void t.trigger("view-route-to"))}).execute()}),t.onSearch=function(e){n.newInvocation({tenant:__page.tenantId,filter:t.filter}).onDone(function(e){return e.error?alert("failed to search courses"):void t.update({courses:e.courses})}).execute()},t.onSelect=function(e){var n=t.coursesStatus.value;return n?void(t.filter.liveStatus=n):void(t.filter.hasOwnProperty("liveStatus")&&delete t.filter.liveStatus)}}),riot.tag("boss-tenant-sd-customers",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/customers"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>客户管理</h4> </div> <div class="row"> <form class="form-inline"> <div class="col-md-12 col-lg-12"> <div class="form-group"> <label for="wechatsitesSelect">公众号</label> <select id="wechatsitesSelect" class="form-control" onchange="{onSelect}"> <option value="">全部</option> <option each="{wechatsites}" value="{originalId}">{name}</option> </select> </div> <input onclick="{onSearch}" class="btn btn-primary" type="button" value="查询"> </div> </form> </div> <div class="row" style="margin-top: 10px"> <span if="{!customers.length}"> <strong>该机构尚没有任何客户.</strong> </span> <table if="{customers.length}" class="table table-striped"> <thead> <tr> <th>名称</th> <th>所属公众号</th> <th>上线分销商</th> <th>创建时间</th> <th>备注</th> </tr> </thead> <tbody> <tr each="{customers}"> <td> { user.nickname } </td> <td> { media.name } </td> <td> { upLine && upLine.user.nickname || \'顶级\' } </td> <td> {_.date.format(new Date(crtOn), \'yyyy-MM-dd hh点mm分\')} </td> <td> { desc } </td> </tr> </tbody> </table> <div> <input onclick="{prevPage}" type="button" class="btn btn-default" value="上一页"> <span>当前页: </span> <span>{filter.no}</span>, <span>共( {totalPage} )页: </span> <input onclick="{nextPage}" type="button" class="btn btn-default" value="下一页"> <input name="pageTo" type="number" value=""> <input onclick="{jumpToPage}" type="button" class="btn btn-default" value="跳转"> </div> </div> </div> </div> </div>',function(e){"use strict";var t=nest.presentable(this),n=domain.action("findCustomersByTenantId"),i=domain.action("findCustomersCountByTenantId"),o=domain.action("loadAllTenantWechatSite");t.customers=[],t.totalPage=1,t.filter={tenant:__page.tenantId,no:1,size:10},t.on("mount",function(){n.onDone(function(e){t.customers=e.customers,t.update()})}),t.on("open",function(){o.newInvocation(__page.tenantId).onDone(function(e){t.update({wechatsites:e})}).execute(),i.newInvocation({tenant:__page.tenantId}).onDone(function(e){return e.error?alert("failed to search customers"):(t.totalPage=Math.ceil(e.count/t.filter.size),void t.update())}).execute(),n.newInvocation({filter:t.filter}).onDone(function(e){return e.error?alert("failed to search customers"):(t.customers=e.customers,t.trigger("ready",!1),void t.trigger("view-route-to"))}).execute()}),t.onSearch=function(e){n.execute({filter:t.filter})},t.onSelect=function(e){var n=t.wechatsitesSelect.value;return n?void(t.filter.wechatId=n):void(t.filter.hasOwnProperty("wechatId")&&delete t.filter.wechatId)},t.prevPage=function(e){var i=t.filter.no;1>=i||(t.filter.no=--i,n.execute({filter:t.filter}))},t.nextPage=function(e){var i=t.filter.no;i>=t.totalPage||(t.filter.no=++i,n.execute({filter:t.filter}))},t.jumpToPage=function(e){return console.log(typeof t.pageTo.value),""===t.pageTo.value.trim()?void alert("请输入页码"):t.pageTo.value<=0||t.pageTo.value>t.totalPage?void alert("页码非法"):(t.filter.no=parseInt(t.pageTo.value,10),void n.execute({filter:t.filter}))}}),riot.tag("boss-tenant-sd-distributors",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/distributors"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>分销商管理</h4> </div> <div class="row"> <form class="form-inline"> <div class="col-md-12 col-lg-12"> <div class="form-group"> <label for="wechatsitesSelect">公众号</label> <select id="wechatsitesSelect" class="form-control" onchange="{onSelect}"> <option value="">全部</option> <option each="{wechatsites}" value="{originalId}">{name}</option> </select> </div> <input onclick="{onSearch}" class="btn btn-primary" type="button" value="查询"> </div> </form> </div> <div class="row" style="margin-top: 10px"> <span if="{!distributors.length}"> <strong>该机构尚没有任何分销商.</strong> </span> <table if="{distributors.length}" class="table table-striped"> <thead> <tr> <th>名称</th> <th>所属公众号</th> <th>上线分销商</th> <th>创建时间</th> <th>备注</th> </tr> </thead> <tbody> <tr each="{distributors}"> <td> { user.nickname } </td> <td> { media.name } </td> <td> { upLine && upLine.user.nickname || \'顶级\' } </td> <td> {_.date.format(new Date(crtOn), \'yyyy-MM-dd hh点mm分\')} </td> <td> { desc } </td> </tr> </tbody> </table> <div> <input onclick="{prevPage}" type="button" class="btn btn-default" value="上一页"> <span>当前页: </span> <span>{filter.no}</span>, <span>共( {totalPage} )页: </span> <input onclick="{nextPage}" type="button" class="btn btn-default" value="下一页"> <input name="pageTo" type="number" value=""> <input onclick="{jumpToPage}" type="button" class="btn btn-default" value="跳转"> </div> </div> </div> </div> </div>',function(e){"use strict";var t=nest.presentable(this),n=domain.action("findDistributorsByTenantId"),i=domain.action("findDistributorsCountByTenantId"),o=domain.action("loadAllTenantWechatSite");t.distributors=[],t.totalPage=1,t.filter={tenant:__page.tenantId,no:1,size:10},t.on("mount",function(){n.onDone(function(e){t.distributors=e.distributors,t.update()})}),t.on("open",function(){o.newInvocation(__page.tenantId).onDone(function(e){t.update({wechatsites:e})}).execute(),i.newInvocation({tenant:__page.tenantId}).onDone(function(e){return e.error?alert("failed to search distributors"):(t.totalPage=Math.ceil(e.count/t.filter.size),void t.update())}).execute(),n.newInvocation({filter:t.filter}).onDone(function(e){return e.error?alert("failed to search distributors"):(t.distributors=e.distributors,t.trigger("ready",!1),void t.trigger("view-route-to"))}).execute()}),t.onSearch=function(e){n.execute({filter:t.filter})},t.onSelect=function(e){var n=t.wechatsitesSelect.value;return n?void(t.filter.wechatId=n):void(t.filter.hasOwnProperty("wechatId")&&delete t.filter.wechatId)},t.prevPage=function(e){var i=t.filter.no;1>=i||(t.filter.no=--i,n.execute({filter:t.filter}))},t.nextPage=function(e){var i=t.filter.no;i>=t.totalPage||(t.filter.no=++i,n.execute({filter:t.filter}))},t.jumpToPage=function(e){return console.log(typeof t.pageTo.value),""===t.pageTo.value.trim()?void alert("请输入页码"):t.pageTo.value<=0||t.pageTo.value>t.totalPage?void alert("页码非法"):(t.filter.no=parseInt(t.pageTo.value,10),void n.execute({filter:t.filter}))}}),riot.tag("boss-tenant-sd-left",'<div class="my-container"> <accordion navs="{navs}"></accordion> </div>',"boss-tenant-sd-left .my-container{ background: white; }",function(e){var t=this;t.navs=[{path:"sd",presentation:"首页"},{path:"sd/courses",presentation:"课程管理"},{path:"sd/catalogs",presentation:"课程目录管理"},{path:"sd/bespeaks",presentation:"预约管理"},{path:"sd/orders",presentation:"订单管理"},{path:"sd/customers",presentation:"客户管理"},{path:"sd/distributors",presentation:"分销商管理"},{path:"sd/splitbill",presentation:"分账管理"}],t.on("mount",function(){var e=this.opts.path;t.navs.forEach(function(t){t.path===e&&(t.useAsDefault=!0)})})}),riot.tag("boss-tenant-sd-orders",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/orders"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>订单管理</h4> </div> <div class="row"> <form class="form-inline"> <div class="col-md-6 col-lg-6"> <div class="form-group"> <label for="orderStatus">状态</label> <select id="orderStatus" class="form-control" onchange="{onSelect}"> <option value="">全部状态</option> <option value="{__app.enums.OrderStatus.names.finish}">已结算</option> <option value="{__app.enums.OrderStatus.names.unFinish}">未结算</option> </select> </div> <input onclick="{onSearch}" class="btn btn-primary" type="button" value="查询"> </div> </form> </div> <div class="row" style="margin-top: 10px"> <table class="table table-striped"> <thead> <tr> <th>客户昵称</th> <th>课程</th> <th>状态</th> <th>成交价</th> <th>创建时间</th> <th colspan="3">受益分销商</th> </tr> </thead> <tbody> <tr each="{orders}"> <td> {bespeak.user.nickname} </td> <td> {bespeak.product.name} </td> <td> { __app.enums.OrderStatus.values[status] } </td> <td> { finalPrice } </td> <td> {_.date.format(new Date(crtOn), \'yyyy-MM-dd hh点mm分\')} </td> <td> {distributors && distributors[0] && parent.getDistributorMoney(distributors[0].user, bespeak.product, 1, finalPrice) || \'无\'} </td> <td> {distributors && distributors[1] && parent.getDistributorMoney(distributors[1].user, bespeak.product, 2, finalPrice) || \'无\'} </td> <td> {distributors && distributors[2] && parent.getDistributorMoney(distributors[2].user, bespeak.product, 3, finalPrice) || \'无\'} </td> </tr> </tbody> </table> <div> <input onclick="{prevPage}" type="button" class="btn btn-default" value="上一页"> <span>当前页: </span> <span>{filter.no}</span>, <span>共( {totalPage} )页: </span> <input onclick="{nextPage}" type="button" class="btn btn-default" value="下一页"> <input name="pageTo" type="number" value=""> <input onclick="{jumpToPage}" type="button" class="btn btn-default" value="跳转"> </div> </div> </div> </div> </div>',function(e){"use strict";var t=nest.presentable(this),n=domain.action("findOrders");t.orders=[],t.totalPage=1,t.filter={tenant:__page.tenantId,no:1,size:10},t.on("mount",function(){n.onDone(function(e){e.error?console.error("failed find orders err:"+e.error):(t.orders=e.orders,t.totalPage=Math.ceil(e.count/t.filter.size),t.update())})}),t.on("open",function(){n.execute({filter:t.filter}),t.trigger("ready",!1),t.trigger("view-route-to")}),t.onSearch=function(e){n.execute({filter:t.filter})},t.onSelect=function(e){var n=t.orderStatus.value;return n?void(t.filter.status=n):void(t.filter.hasOwnProperty("status")&&delete t.filter.status)},t.getDistributorMoney=function(e,t,n,i){var o=0,r="upLine"+n+"CommissionType",a="upLine"+n+"CommissionValue";return t[r]===__app.enums.CommissionType.names.Percent?o=(parseFloat(i)*parseFloat(parseFloat(t[a])/100)).toFixed(2):t[r]===__app.enums.CommissionType.names.Cash&&(o=parseFloat(t[a])),e.nickname+": "+o},t.prevPage=function(e){var i=t.filter.no;1>=i||(t.filter.no=--i,n.execute({filter:t.filter}))},t.nextPage=function(e){var i=t.filter.no;i>=t.totalPage||(t.filter.no=++i,n.execute({filter:t.filter}))},t.jumpToPage=function(e){return console.log(typeof t.pageTo.value),""===t.pageTo.value.trim()?void alert("请输入页码"):t.pageTo.value<=0||t.pageTo.value>t.totalPage?void alert("页码非法"):(t.filter.no=parseInt(t.pageTo.value,10),void n.execute({filter:t.filter}))}}),riot.tag("boss-tenant-sd-splitbill",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/splitbill"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>分账管理</h4> </div>                 <div class="row" style="margin-top: 10px"> <span if="{!distributors.length}"> <strong>尚没有未结款项.</strong> </span> <table if="{distributors.length}" class="table table-striped"> <thead> <tr> <th>分销商</th> <th>所属公众号</th> <th>待结款</th> <th>结款</th> </tr> </thead> <tbody> <tr each="{distributors}"> <td> <a data-toggle="modal" data-target="#ordersInDistributors" onclick="{parent.onClickDistributor}">{ user.nickname }</a> </td> <td> { media.name } </td> <td> { accountBalance || \'顶级\' } </td> <td> <input onclick="{parent.onCheckout}" data-toggle="modal" data-target="#modal" type="button" class="btn btn-default" value="结款"> </td> </tr> </tbody> </table> <div> <input onclick="{prevPage}" type="button" class="btn btn-default" value="上一页"> <span>当前页: </span> <span>{filter.no}</span>, <span>共( {totalPage} )页: </span> <input onclick="{nextPage}" type="button" class="btn btn-default" value="下一页"> <input name="pageTo" type="number" value=""> <input onclick="{jumpToPage}" type="button" class="btn btn-default" value="跳转"> </div> </div> <div id="ordersInDistributors" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"> <div class="modal-dialog modal-lg"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title">相关订单</h4> </div> <div class="modal-body"> <table class="table table-striped"> <thead> <tr> <th>客户</th> <th>产品</th> <th>成交价</th> <th>所获分成</th> </tr> </thead> <tbody> <tr each="{orders}"> <td> { bespeak.user.nickname } </td> <td> { bespeak.product.name } </td> <td> { finalPrice } </td> <td> { commission } </td> </tr> </tbody> </table> </div> </div> </div> </div> </div> </div> </div>',function(e){
"use strict";var t=nest.presentable(this),n=domain.action("findDistributorsWithPendingPaymentByTenantId"),i=domain.action("findDistributorsCountWithPendingPaymentByTenantId"),o=domain.action("findOrderRelatedDistributor"),r=domain.action("checkout");t.distributors=[],t.totalPage=1,t.filter={tenant:__page.tenantId,no:1,size:10},t.on("mount",function(){n.onDone(function(e){t.distributors=e.distributors,t.update()})}),t.on("open",function(){i.newInvocation({tenant:__page.tenantId}).onDone(function(e){return e.error?alert("failed to search distributors"):(t.totalPage=Math.ceil(e.count/t.filter.size),void t.update())}).execute(),n.newInvocation({filter:t.filter}).onDone(function(e){return e.error?alert("failed to search distributors"):(t.distributors=e.distributors,t.trigger("ready",!1),void t.trigger("view-route-to"))}).execute()}),t.onSearch=function(e){n.execute({filter:t.filter})},t.onClickDistributor=function(e){o.newInvocation({distributor:e.item._id,status:__app.enums.OrderStatus.names.unFinish}).onDone(function(n){return n.error?void alert("获取相关订单失败"):(t.orders=n.orders.map(function(t){var n=0,i=t.bespeak.product;if(t.distributors){var o=t.distributors.indexOf(e.item._id)+1,r=i["upLine"+o+"CommissionType"],a=i["upLine"+o+"CommissionValue"];n=r===__app.enums.CommissionType.names.Percent?parseFloat(t.finalPrice)*parseFloat(parseFloat(a)/100):a}return t.commission=n,t}),void t.update())}).execute()},t.onCheckout=function(e){_.widget.confirm({title:"操作确认",content:"你已经为 [ "+e.item.user.nickname+" ] 结清款项了吗？",callback:function(){r.newInvocation({media:e.item.media,distributor:e.item._id,tenant:__page.tenantId}).onDone(function(e){return e.error?void alert("借款失败,请联系管理员"):void n.execute({filter:t.filter})}).execute()}})},t.onSelect=function(e){var n=t.coursesStatus.value;return n?void(t.filter.liveStatus=n):void(t.filter.hasOwnProperty("liveStatus")&&delete t.filter.liveStatus)},t.prevPage=function(e){var i=t.filter.no;1>=i||(t.filter.no=--i,n.execute({filter:t.filter}))},t.nextPage=function(e){var i=t.filter.no;i>=t.totalPage||(t.filter.no=++i,n.execute({filter:t.filter}))},t.jumpToPage=function(e){return""===t.pageTo.value.trim()?void alert("请输入页码"):t.pageTo.value<=0||t.pageTo.value>t.totalPage?void alert("页码非法"):(t.filter.no=parseInt(t.pageTo.value,10),void n.execute({filter:t.filter}))}}),riot.tag("boss-tenant-sd",'<div if="{!hidden}" class="container"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row"> <h4 class="text-center">欢迎来到课程分销系统</h4> </div> </div> </div> </div>',function(e){var t=nest.presentable(this);t.on("open",function(){t.trigger("ready",!1),t.trigger("view-route-to")})}),riot.tag("boss-tenant-topbar",'<nav class="navbar navbar-default navbar-inverse" role="navigation" style="margin-bottom: 5px; border-radius: 0;"> <div class="collapse navbar-collapse"> <a class="navbar-brand" style="font-size:20px; color: #ffffff">百加宝-平台端</a> <ul class="nav navbar-nav" style="width: 86%"> <li class="navbtn"><a id="tenant" href="#" route="tenant" class="myActive" onclick="{nav}">机构</a></li> <li class="navbtn"><a id="wechatsite" href="#" route="wechatsite" onclick="{nav}" >公众号</a></li> <li class="navbtn"><a id="sd" href="#" route="sd" onclick="{nav}">分销</a></li> <li class="navbtn"><a id="power" href="#" route="power/list" onclick="{nav}">助力活动</a></li> <li class="navbtn"><a id="recontent" href="/tenant-recontent-{tenantId}">浮层广告</a></li> <li style="float: right;"><a href="#" style="font-size: 1.4em" class="glyphicon glyphicon-off" title="退出" onclick="{logout}"></a></li> <li style="float: right; margin-right: 20px; padding-top: 5px;"> <img riot-src="{headimgurl}" style="height: 40px; width: 40px" alt=""><span style="margin-left: 10px; color: white">{nickname}</span> </li> </ul> </div> </nav>',".navbtn{padding-left: 20px; font-size:16px} .myActive{color: #ffffff !important; border:0; outline: none !important;}",function(e){this.headimgurl=__page.user.headimgurl,this.nickname=__page.user.nickname,this.tenantId=__page.tenantId,this.on("mount",function(){if(window.location.hash){$(".navbtn a").removeClass("myActive");var e=new RegExp(/^#[a-z, A-Z, _]+/),t=e.exec(window.location.hash);$(t[0]).addClass("myActive")}}),this.logout=function(e){$.get("/logout",function(e){window.location.href="/login"})}.bind(this),this.nav=function(e){e.preventUpdate=!0,$(".navbtn a").removeClass("myActive"),$(e.currentTarget).addClass("myActive"),riot.route($(e.currentTarget).attr("route"))}.bind(this)}),riot.tag("boss-tenant-wechatsite",'<div class="container" if="{!hidden}"> <div class="row"> <div class="col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2" style="text-align: center"><h3>公众号管理</h3></div> </div> <div class="row" style="margin-top: 10px"> <div class="action col-md-offset-2 col-lg-offset-2"> <button class="btn btn-default" onclick="{add}">添加</button> </div> <div class="col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2"> <div class="row panel-container"> <table class="table table-striped"> <thead> <tr> <th>名称</th> <th>类型</th> <th>状态</th> <th>创建时间</th> <th>操作</th> </tr> </thead> <tbody> <tr each="{wechatSites}"> <td><a href="#wechatsite/_{_id}">{name}</a></td> <td>{ __app.enums.WechatSiteType.values[wechatSiteType] }</td> <td>{ __app.enums.LifeFlag.values[lFlg] }</td> <td>{_.date.format(new Date(crtOn), \'yyyy-MM-dd hh点mm分\')}</td> <td><a href="#wechatsite/_{originalId}/settings">设置</a></td> </tr> </tbody> </table> </div> </div> </div> </div>',"boss-tenant-wechatsite .panel-container >div{ height: 40px; line-height: 40px; }",function(e){var t=nest.presentable(this),n=domain.action("loadAllTenantWechatSite"),i=function(e){t.update({wechatSites:e})};t.on("open",function(){n.execute(__page.tenantId),t.trigger("ready",!1),t.trigger("view-route-to")}),t.on("mount",function(){n.onDone(i)}),t.add=function(e){riot.route("wechatsite/add")}}),riot.tag("boss-tenant",'<div class="container" if="{!hidden}"> <div class="row"> <div class="col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2" style="text-align: center"><h3>{tenant.name}</h3></div> </div> <div class="row" style="margin-top: 30px"> <div class="col-md-4 col-md-offset-3 col-lg-4 col-lg-offset-3"> <div class="row panel-container"> <div class="col-md-6">名称</div> <div class="col-md-6">{tenant.name}</div> <div class="col-md-6">类型</div> <div class="col-md-6">{__app.enums.PartyType.values[tenant.type]}</div> <div class="col-md-6">状态</div> <div class="col-md-6">{ __app.enums.LifeFlag.values[tenant.lFlg]}</div> <div class="col-md-6">创建时间</div> <div class="col-md-6">{_.date.format(new Date(tenant.crtOn), \'yyyy-MM-dd hh点mm分\')}</div> <div class="col-md-6">备注</div> <div class="col-md-6">{tenant.desc}</div> </div> </div> </div> </div>',"boss-tenant .panel-container >div{ height: 40px; line-height: 40px; }",function(e){var t=nest.presentable(this),n=domain.action("loadTenantById"),i=function(e){t.update({tenant:e.tenant})};t.on("open",function(){n.execute({id:__page.tenantId}),t.trigger("ready",!1),t.trigger("view-route-to")}),t.on("mount",function(){n.onDone(i)}),t.on("unmount",function(){n.offDone(i)})}),riot.tag("boss-topbar",'<nav class="navbar navbar-default navbar-inverse" role="navigation" style="margin-bottom: 5px; border-radius: 0;"> <div class="collapse navbar-collapse"> <a class="navbar-brand" style="font-size:20px; color: #ffffff">微节点</a> <ul class="nav navbar-nav" style="width: 88%"> <li class="navbtn"><a id="tenants" href="#" route="tenants" class="myActive" onclick="{tenants}">机构</a></li> <li class="navbtn"><a id="power" href="/marketing/boss/power" >助力活动</a></li> <li style="float: right;"><a href="#" style="font-size: 1.4em" class="glyphicon glyphicon-off" title="退出" onclick="{logout}"></a></li> <li style="float: right; margin-right: 20px; padding-top: 5px;"> <img riot-src="{headimgurl}" style="height: 40px; width: 40px" alt=""><span style="margin-left: 10px; color: white">{nickname}</span> </li> </ul> </div> </nav>',".navbtn{padding-left: 20px; font-size:16px} .myActive{color: #ffffff !important; border:0; outline: none !important;}",function(e){this.headimgurl=__page.user.headimgurl,this.nickname=__page.user.nickname,this.on("mount",function(){if(window.location.hash){$(".navbtn a").removeClass("myActive");var e=new RegExp(/^#[a-z, A-Z, _]+/),t=e.exec(window.location.hash);$(t[0]).addClass("myActive")}}),this.logout=function(e){$.get("/logout",function(e){window.location.href="/login"})}.bind(this),this.tenants=function(e){e.preventUpdate=!0,$(".navbtn a").removeClass("myActive"),$(e.currentTarget).addClass("myActive"),riot.route($(e.currentTarget).attr("route"))}.bind(this)}),riot.tag("boss-wechatsite-add",'<div class="container" if="{!hidden}"> <alert validators="{validators}" clear="{clear}"></alert> <div class="row" style="margin-top: 10px"> <div class="action col-md-offset-2 col-lg-offset-2"> <a href="#wechatsite">返回公众号列表</a> </div> <div class="form-con col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2"> <div class="panel panel-default"> <div class="panel-heading">基本信息</div> <div class="panel-body"> <div class="row"> <div class="col-md-3">名称</div> <div class="col-md-9"><input name="name" class="form-control" type="text"></div> </div> <div class="row"> <div class="col-md-3">类型</div> <div class="col-md-9"> <select id="selectType" class="form-control"> <option value="voa">认证服务号</option> <option value="vsa">认证订阅号</option> <option value="oa">服务号</option> <option value="sa">订阅号</option> </select> </div> </div> <div class="row"> <div class="col-md-3">公众号邮箱</div> <div class="col-md-9"><input name="email" class="form-control" type="email"></div> </div> <div class="row"> <div class="col-md-3">原始ID</div> <div class="col-md-9"><input name="originalId" class="form-control" type="text"></div> </div> <div class="row"> <div class="col-md-3">AppID</div> <div class="col-md-9"><input name="appId" class="form-control" type="text"></div> </div> <div class="row"> <div class="col-md-3">AppSecret</div> <div class="col-md-9"><input name="appSecret" class="form-control" type="text"></div> </div> </div> </div> <div class="sub"> <input class="btn btn-primary" onclick="{submit}" type="button" value="提交"> <input class="btn btn-default" onclick="{cancel}" type="button" value="取消"> </div> </div> </div> </div>',"boss-wechatsite-add a { cursor: pointer; } boss-wechatsite-add .row{ margin-top: 10px; } boss-wechatsite-add .panel-container >div{ height: 40px; line-height: 40px; } boss-wechatsite-add .form-con { margin-top: 15px; padding: 0 0; } boss-wechatsite-add #selectType{ width: 30% !important; } boss-wechatsite-add .sub{ text-align: center; } boss-wechatsite-add .sub input{ margin-left: 30px; }",function(e){var t=nest.presentable(this);t.validators=[];var n=domain.action("addTenantWechatSite"),i=function(e){e.error||riot.route("wechatsite/_"+e.wechatSite._id)};t.on("open",function(){t.trigger("ready",!1),t.trigger("view-route-to")}),t.on("mount",function(){n.onDone(i)}),t.cancel=function(e){riot.route("wechatsite")},t.verify=function(e){var n=!0;if(e.name||(t.validators.push({success:!1,field:"名称",desc:"不能为空!"}),n=!1),e.email||(t.validators.push({success:!1,field:"邮箱",desc:"不能为空!"}),n=!1),e.originalId||(t.validators.push({success:!1,field:"原始ID",desc:"不能为空!"}),n=!1),e.appId||(t.validators.push({success:!1,field:"AppID",desc:"不能为空!"}),n=!1),e.appSecret||(t.validators.push({success:!1,field:"AppSecret",desc:"不能为空!"}),n=!1),e.email){var i=new RegExp(/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/);i.test(e.email)||(t.validators.push({success:!1,field:"邮箱",desc:"输入邮箱非法!"}),n=!1)}return n},t.clear=function(){t.validators=[]},t.submit=function(e){t.validators=[];var i={org:__page.tenantId,name:t.name.value.trim(),email:t.email.value.trim(),originalId:t.originalId.value.trim(),appId:t.appId.value.trim(),appSecret:t.appSecret.value.trim(),wechatSiteType:t.selectType.value},o=t.verify(i);o&&n.execute(i)}}),riot.tag("boss-wechatsite-edit",'<div class="container" if="{!hidden}"> <alert validators="{validators}" clear="{clear}"></alert> <div class="row" style="margin-top: 10px"> <div class="action col-md-offset-2 col-lg-offset-2"> <a href="#wechatsite">返回公众号列表</a> </div> <div class="form-con col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2"> <div class="panel panel-default"> <div class="panel-heading">基本信息</div> <div class="panel-body"> <div class="row"> <div class="col-md-3">名称</div> <div class="col-md-9"><input name="name" class="form-control" type="text" value="{wechatSite.name}"></div> </div> <div class="row"> <div class="col-md-3">类型</div> <div class="col-md-9"> <select id="selectType" class="form-control"> <option value="voa">认证服务号</option> <option value="vsa">认证订阅号</option> <option value="oa">服务号</option> <option value="sa">订阅号</option> </select> </div> </div> <div class="row"> <div class="col-md-3">公众号邮箱</div> <div class="col-md-9"><input name="email" class="form-control" type="email" value="{wechatSite.email}"></div> </div> <div class="row"> <div class="col-md-3">原始ID</div> <div class="col-md-9"><input name="originalId" class="form-control" type="text" value="{wechatSite.originalId}"></div> </div> <div class="row"> <div class="col-md-3">AppID</div> <div class="col-md-9"><input name="appId" class="form-control" type="text" value="{wechatSite.appId}"></div> </div> <div class="row"> <div class="col-md-3">AppSecret</div> <div class="col-md-9"><input name="appSecret" class="form-control" type="text" value="{wechatSite.appSecret}"></div> </div> </div> </div> <div class="panel panel-default"> <div class="panel-heading">托管配置信息</div> <div class="panel-body"> <div class="row"> <div class="col-md-3">Token(令牌)</div> <div class="col-md-7" id="token">{ wechatSite.token }</div> <a class="col-md-2 resetToken" onclick="{resetToken}">重新生成</a> </div> <div class="row"> <div class="col-md-3">EncodingAESKey<br>(消息加解密密钥)</div> <div class="col-md-7" id="encodingAESKey">{ wechatSite.encodingAESKey }</div> <a class="col-md-2 resetAes" onclick="{resetAes}">重新生成</a> </div> </div> </div> <div class="sub"> <input class="btn btn-primary" onclick="{submit}" type="button" value="提交"> <input class="btn btn-default" onclick="{cancel}" type="button" value="取消"> </div> </div> </div> </div>',"boss-wechatsite-edit a { cursor: pointer; } boss-wechatsite-edit .row{ margin-top: 10px; } boss-wechatsite-edit .panel-container >div{ height: 40px; line-height: 40px; } boss-wechatsite-edit .form-con { margin-top: 15px; padding: 0 0; } boss-wechatsite-edit #selectType{ width: 30% !important; } boss-wechatsite-edit .sub{ text-align: center; padding-bottom: 50px; } boss-wechatsite-edit .sub input{ margin-left: 30px; }",function(e){var t=nest.presentable(this);t.validators=[];var n=domain.action("loadTenantWechatSite"),i=domain.action("updateTenantWechatSiteById");t.on("open",function(e){t.trigger("ready",!1),t.trigger("view-route-to"),t.id=e.id,n.newInvocation(e.id).onDone(function(e){t.update({wechatSite:e.wechatSite}),$("#selectType").find("option[value='"+e.wechatSite.wechatSiteType+"']").attr("selected",!0)}).execute()}),t.on("mount",function(){}),t.cancel=function(e){riot.route("wechatsite/_"+t.wechatSite._id)},t.verify=function(e){var n=!0;if(e.name||(t.validators.push({success:!1,field:"名称",desc:"不能为空!"}),n=!1),e.email||(t.validators.push({success:!1,field:"邮箱",desc:"不能为空!"}),n=!1),e.originalId||(t.validators.push({success:!1,field:"原始ID",desc:"不能为空!"}),n=!1),e.appId||(t.validators.push({success:!1,field:"AppID",desc:"不能为空!"}),n=!1),e.appSecret||(t.validators.push({success:!1,field:"AppSecret",desc:"不能为空!"}),n=!1),e.email){var i=new RegExp(/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/);i.test(e.email)||(t.validators.push({success:!1,field:"邮箱",desc:"输入邮箱非法!"}),n=!1)}return n},t.clear=function(){t.validators=[]},t.submit=function(e){t.validators=[];var n={id:t.id,org:__page.tenantId,name:t.name.value.trim(),email:t.email.value.trim(),originalId:t.originalId.value.trim(),appId:t.appId.value.trim(),appSecret:t.appSecret.value.trim(),wechatSiteType:t.selectType.value,token:$("#token").text(),encodingAESKey:$("#encodingAESKey").text()},o=t.verify(n);o&&i.newInvocation(n).onDone(function(e){e.error?t.validators.push({success:!1,field:"公众号",desc:"修改失败!"}):riot.route("wechatsite/_"+t.wechatSite._id)}).execute()},t.resetToken=function(e){t.wechatSite.token=_.generateRandomString(20),t.update()},t.resetAes=function(e){t.wechatSite.encodingAESKey=_.generateRandomString(43),t.update()}}),riot.tag("boss-wechatsite-settings",'<div id="tips" style="position: fixed; top:0px; z-index: 1000" class="col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2"> <div if="{alert_success}" class="alert alert-success" role="alert" style="text-align: center"> <strong>{tip_msg}</strong> </div> <div if="{alert_failed}" class="alert alert-danger" role="alert" style="text-align: center"> <strong>{tip_msg}</strong> </div> </div> <div class="container" if="{!hidden}"> <div class="row" style="margin-top: 10px"> <div class="row"> <div class="col-md-2 col-md-offset-2 col-lg-offset-2"> <a href="#wechatsite">返回公众号列表</a> </div> <div class="col-md-2 col-md-offset-1 col-lg-2 col-lg-offset-1" style="text-align: center"><h3>{wechatSite.name}</h3></div> </div> <div class="form-con col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2"> <div class="panel panel-default"> <div class="panel-heading">公众号关注回复消息设置</div> <div class="panel-body"> <div class="type-nav"> <ul class="type-nav-ul" style="margin-left:0;"> <li> <a type="text" onclick="{selectType}" href="javascript:void(0);" onclick="return false;" class="{replyType == \'text\' ? \'selected\' : \'\'}"><i class="glyphicon glyphicon-pencil"></i>&nbsp;<span class="msg_tab_title">文字</span></a> </li> <li> <a type="image" href="javascript:void(0);" class="{replyType == \'image\' ? \'selected\' : \'\'}"><i class="glyphicon glyphicon-picture"></i>&nbsp;<span class="msg_tab_title">图片</span></a> </li> <li> <a type="voice" href="javascript:void(0);" class="{replyType == \'voice\' ? \'selected\' : \'\'}"><i class="glyphicon glyphicon-volume-up"></i>&nbsp;<span class="msg_tab_title">语音</span></a> </li> <li> <a type="video" href="javascript:void(0);" class="{replyType == \'video\' ? \'selected\' : \'\'}"><i class="glyphicon glyphicon-facetime-video"></i>&nbsp;<span class="msg_tab_title">视频</span></a> </li> </ul> </div> <div if="{replyType == \'text\'}" class="text-reply"> <textarea id="text-reply-con" cols="30" rows="10">{reply_con}</textarea> </div> <div if="{replyType == \'image\'}" class="text-reply"> </div> <div if="{replyType == \'voice\'}" class="text-reply"> <br> <div style="margin-left: 30px;">开发中.......</div> </div> <div if="{replyType == \'video\'}" class="text-reply"> <br> <div style="margin-left: 30px;">开发中.......</div> </div> <div> <div class="btn btn-success btn-save" onclick="{subReplySave}">保存</div> </div> </div> </div> <div class="panel panel-default"> <div class="panel-heading">公众号菜单设置</div> <div class="panel-body" style="padding-top: 0"> <div class="row" style="margin-top: 0"> <div id="menu-setting"> <div id="menu-con"> <ul each="{menu.button}" riot-style="margin-top: {parent.getMenuMarginTopValue(sub_button)}"> <li if="{(!sub_button && name) || (name && sub_button && sub_button.length < 5)}" class="add-menu" onclick="{parent.addSubMenu}">+</li> <li each="{sub_button}" class="menu sub-menu" onclick="{parent.parent.clickMenu}">{name}</li> <li if="{name}" class="menu" onclick="{parent.clickMenu}">{name}</li> <li if="{!name}" class="add-menu" style="margin-top: 35px" onclick="{parent.addMenu}">+</li> </ul> </div> <div id="setting"> <div if="{!current_menu}" id="menu-edit-tip">点击左侧菜单进行编辑</div> <div if="{current_menu}"> <div> <span>菜单名称</span><a style="float:right" onclick="{deleteMenu}">删除菜单</a> </div> <hr> <div if="{current_menu.sub_button}" style="color: #8d8d8d;"> 已添加子菜单，仅可设置菜单名称。 </div> <div> <span>菜单名称</span><input style="margin-left: 50px" type="text" value="{current_menu.name}" name="menu_name" onblur="{saveMenuName}"> </div> <div> <span style="margin-left: 100px; color: #8d8d8d;">{sub_menu_index == -1 ? \'字数不超过4个汉字或8个字母\' : \'字数不超过8个汉字或16个字母\'}</span> </div> <div if="{!current_menu.sub_button}"> <span>菜单内容</span> <label style="margin-left: 30px; cursor: pointer"><input name="menu_con_type" type="radio" value="click" __checked="{current_menu.type === \'click\'}" onclick="{selectMenuType}">发送消息</label> <label style="margin-left: 30px;cursor: pointer"><input name="menu_con_type" type="radio" value="view" __checked="{current_menu.type === \'view\'}" onclick="{selectMenuType}">跳转网页</label> </div> <div if="{!current_menu.sub_button}"> <div if="{current_menu.type == \'view\'}"> <div>订阅者点击该子菜单会跳到以下链接</div> <div style="margin-top: 20px"><span>页面地址</span><input name="view_url" type="text" style="margin-left: 50px;width: 300px;" value="{current_menu.url}" onblur="{saveMenuUrl}"></div> <div style="margin-left: 107px;">参考格式:&nbsp;&nbsp;http://www.baijiabao.com</div> </div> <div if="{current_menu.type == \'click\'}"> <textarea class="menu_reply_con" onblur="{saveMenuCon}" name="menu_reply_con"></textarea> </div> </div> </div> </div> <hr style="clear:both"> <div> <div class="btn btn-success btn-save" onclick="{saveMenu}" style="margin-left: 10px">保存</div> </div> </div> </div> </div> </div> </div> </div> </div>',"boss-wechatsite-settings a { cursor: pointer; } boss-wechatsite-settings .row{ margin-top: 10px; } boss-wechatsite-settings .panel-container >div{ height: 40px; line-height: 40px; } boss-wechatsite-settings .form-con { margin-top: 15px; padding: 0 0; } boss-wechatsite-settings .type-nav { border: solid 1px #C3C3C3; height: 33px; } boss-wechatsite-settings .type-nav-ul{ list-style: none; margin-top: 5px; } boss-wechatsite-settings .type-nav-ul li{ width: 15%; float: left; } boss-wechatsite-settings .type-nav-ul li a{ text-decoration: none; color: #9A9494; } boss-wechatsite-settings .type-nav-ul li a:hover{ text-decoration: none; color: black !important; } boss-wechatsite-settings .text-reply{ height: 200px; border: solid 1px #C3C3C3; border-top-style: none; padding: 10px; } boss-wechatsite-settings .selected { color: black !important; } boss-wechatsite-settings .btn-save { margin-top: 5px; width: 100px; } boss-wechatsite-settings #text-reply-con{ height: 180px; width: 100%; resize: none; border: none; } boss-wechatsite-settings #text-reply-con:focus{ outline: none; } boss-wechatsite-settings #menu-setting{ min-height: 400px; } boss-wechatsite-settings #menu-setting ul{ padding: 0; list-style: none; float:left; } boss-wechatsite-settings #menu-con{ padding: 5px; padding-top: 15px; border-right: solid 1px lightgray; min-height: 360px; min-width: 265px; float:left; } boss-wechatsite-settings #setting{ padding: 10px; min-height: 360px; min-width: 500px; float:left; } boss-wechatsite-settings #setting div{ margin-bottom: 5px; } boss-wechatsite-settings .menu{ cursor: pointer; line-height: 35px; text-align: center; width: 85px; height: 35px; border: solid 1px lightgray; } boss-wechatsite-settings .menu_selected{ border: solid 1px #44b549; color: #44b549; } boss-wechatsite-settings .sub-menu{ font-size: 12px; overflow: hidden; } boss-wechatsite-settings .menu:hover{ background-color: #eeeeee; } boss-wechatsite-settings .add-menu{ cursor: pointer; line-height: 25px; text-align: center; width: 85px; height: 35px; color: gray; font-size: 30px; border: solid 1px lightgray; } boss-wechatsite-settings .add-menu:hover{ background-color: #eeeeee; } boss-wechatsite-settings #menu-edit-tip{ text-align: center; line-height: 340px; } boss-wechatsite-settings .menu_reply_con{ height: 175px; width: 100%; resize: none; border: solid 1px lightgray; } boss-wechatsite-settings .menu_reply_con:focus{ outline: none; }",function(e){var t=nest.presentable(this),n=domain.action("loadWechatSiteSettings"),i=domain.action("saveWechatSiteSettings");t.current_menu=null,t.menu_index=-1,t.sub_menu_index=-1,t.on("open",function(e){t.trigger("ready",!1),t.trigger("view-route-to"),t.originalId=e.id,t.replyType="text",n.newInvocation(t.originalId).onDone(function(e){if(e)if(t.id=e._id,e.subscribeReply&&(t.replyType=e.subscribeReply.type,t.reply_con=e.subscribeReply.content),e.menu){t.menu=JSON.parse(e.menu);for(var n=0;n<3-t.menu.button.length;n++)t.menu.button.push({})}else t.menu={button:[{},{},{}]};else t.menu={button:[{},{},{}]};t.update()}).execute()}),t.on("mount",function(){}),t.selectType=function(e){document.querySelector("a[class=selected]")&&(document.querySelector("a[class=selected]").className=""),e.currentTarget.className="selected",t.replyType=e.currentTarget.type},t.subReplySave=function(e){var n={id:t.id,originalId:t.originalId,subscribeReply:{type:t.replyType}};"text"===t.replyType&&(n.subscribeReply.content=document.querySelector("#text-reply-con").value.trim()),i.newInvocation(n).onDone(function(e){e.success?(t.id=e.data._id,t.update({alert_success:!0,tip_msg:"保存关注自动回复成功"})):t.update({alert_failed:!0,tip_msg:"保存关注自动回复失败"}),o()}).execute()};var o=function(){setTimeout(function(){t.update({alert_success:!1,alert_failed:!1,tip_msg:""})},2e3)};t.getMenuMarginTopValue=function(e){return e?e.length<4?35*(4-e.length)+"px":0:"140px"},t.selectMenuType=function(e){return t.current_menu.type=e.currentTarget.value,-1==t.sub_menu_index?t.menu.button[t.menu_index].type=e.currentTarget.value:t.menu.button[t.menu_index].sub_button[t.sub_menu_index].type=e.currentTarget.value,!0},t.addMenu=function(e){var n={name:"菜单",type:"click",key:(new Date).getTime(),con:""};t.menu_index=t.menu.button.indexOf(e.item),t.sub_menu_index=-1,t.menu.button.splice(t.menu_index,1,n),t.menu_reply_con.value="",t.current_menu=null},t.addSubMenu=function(e){var n={name:"菜单",type:"click",key:(new Date).getTime(),con:""};t.menu_index=t.menu.button.indexOf(e.item),t.menu.button[t.menu_index].sub_button?t.menu.button[t.menu_index].sub_button.push(n):t.menu.button[t.menu_index].sub_button=[n],t.sub_menu_index=t.menu.button[t.menu_index].sub_button.length-1,t.menu_reply_con.value="",t.current_menu=null},t.clickMenu=function(e){document.querySelector('li[class="menu menu_selected"]')&&(document.querySelector('li[class="menu menu_selected"]').className="menu"),document.querySelector('li[class="menu sub-menu menu_selected"]')&&(document.querySelector('li[class="menu sub-menu menu_selected"]').className="menu sub-menu"),e.currentTarget.className+=" menu_selected",t.current_menu=e.item,t.menu_index=t.menu.button.indexOf(e.item),-1===t.menu_index?t.menu.button.map(function(n,i){n.sub_button&&-1!==n.sub_button.indexOf(e.item)&&(t.sub_menu_index=n.sub_button.indexOf(e.item),t.menu_index=i)}):t.sub_menu_index=-1,t.menu_reply_con.value=t.current_menu.con,t.update()},t.deleteMenu=function(e){t.current_menu=null,-1==t.sub_menu_index?t.menu.button.splice(t.menu_index,1,{}):t.menu.button[t.menu_index].sub_button.splice(t.sub_menu_index,1)},t.saveMenuName=function(e){var n=!1,i="",r=t.menu_name.value;r=r.replace(/[^\u0000-\u00ff]/g,"aa"),-1==t.sub_menu_index?r.length>8?(n=!0,i="菜单名称不能超过4个汉字或8个字母"):t.menu.button[t.menu_index].name=t.menu_name.value:r.length>16?(n=!0,i="子菜单名称不能超过8个汉字或16个字母"):t.menu.button[t.menu_index].sub_button[t.sub_menu_index].name=t.menu_name.value,n&&(t.update({alert_failed:!0,tip_msg:i}),o())},t.saveMenuUrl=function(e){/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:\/~\+#]*[\w\-\@?^=%&amp;\/~\+#])?/.test(t.view_url.value)?-1==t.sub_menu_index?t.menu.button[t.menu_index].url=t.view_url.value:t.menu.button[t.menu_index].sub_button[t.sub_menu_index].url=t.view_url.value:(t.update({alert_failed:!0,tip_msg:"输入网址格式不对"}),o())},t.saveMenuCon=function(e){-1==t.sub_menu_index?t.menu.button[t.menu_index].con=e.currentTarget.value:t.menu.button[t.menu_index].sub_button[t.sub_menu_index].con=e.currentTarget.value},t.saveMenu=function(e){var n={id:t.id,originalId:t.originalId,menu:t.menu};i.newInvocation(n).onDone(function(e){e.success?(t.id=e.data._id,t.update({alert_success:!0,tip_msg:"保存菜单成功"})):t.update({alert_failed:!0,tip_msg:"保存关菜单失败"}),o()}).execute()}}),riot.tag("boss-wechatsite",'<div class="container" if="{!hidden}"> <div class="row" style="margin-top: 10px"> <div class="row"> <div class="col-md-2 col-md-offset-2 col-lg-offset-2"> <a href="#wechatsite">返回公众号列表</a> </div> <div class="col-md-2 col-md-offset-1 col-lg-2 col-lg-offset-1" style="text-align: center"><h3>{wechatSite.name}</h3></div> </div> <div class="form-con col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2"> <div class="panel panel-default"> <div class="panel-heading">基本信息</div> <div class="panel-body"> <div class="row"> <div class="col-md-3">名称</div> <div class="col-md-9">{wechatSite.name}</div> </div> <div class="row"> <div class="col-md-3">类型</div> <div class="col-md-9">{ __app.enums.WechatSiteType.values[wechatSite.wechatSiteType] }</div> </div> <div class="row"> <div class="col-md-3">状态</div> <div class="col-md-9">{ __app.enums.LifeFlag.values[wechatSite.lFlg] }</div> </div> <div class="row"> <div class="col-md-3">创建时间</div> <div class="col-md-9">{_.date.format(new Date(wechatSite.crtOn), \'yyyy-MM-dd hh点mm分\')}</div> </div> <div class="row"> <div class="col-md-3">公众号邮箱</div> <div class="col-md-9">{wechatSite.email}</div> </div> <div class="row"> <div class="col-md-3">原始ID</div> <div class="col-md-9">{wechatSite.originalId}</div> </div> <div class="row"> <div class="col-md-3">AppID</div> <div class="col-md-9">{wechatSite.appId}</div> </div> <div class="row"> <div class="col-md-3">AppSecret</div> <div class="col-md-9">{wechatSite.appSecret}</div> </div> </div> </div> <div class="panel panel-default"> <div class="panel-heading">托管配置信息</div> <div class="panel-body"> <div class="row"> <div class="col-md-3">URL(服务器地址)</div> <div class="col-md-8" id="url">{__app.settings.app.protocol + \'://\' + __app.settings.app.domain + \'/wechat/\' + wechatSite.originalId + \'/message\'}</div> <a class="col-md-1 clip_button" data-clipboard-target="url">复制</a> </div> <div class="row"> <div class="col-md-3">Token(令牌)</div> <div class="col-md-8" id="token">{ wechatSite.token }</div> <a class="col-md-1 clip_button" data-clipboard-target="token">复制</a> </div> <div class="row"> <div class="col-md-3">EncodingAESKey<br>(消息加解密密钥)</div> <div class="col-md-8" id="encodingAESKey">{ wechatSite.encodingAESKey }</div> <a class="col-md-1 clip_button" data-clipboard-target="encodingAESKey">复制</a> </div> <div class="row"> <div class="col-md-3">公众号邮箱</div> <div class="col-md-8" id="email">{wechatSite.email}</div> <a class="col-md-1 clip_button" data-clipboard-target="email">复制</a> </div> <div class="row"> <div class="col-md-3">授权回调页面域名</div> <div class="col-md-8" id="callbackDomain">{__app.settings.app.domain}</div> <a class="col-md-1 clip_button" data-clipboard-target="callbackDomain">复制</a> </div> <div class="row"> <div class="col-md-3">JS接口安全域名</div> <div class="col-md-8" id="jsDomain">{__app.settings.app.domain}</div> <a class="col-md-1 clip_button" data-clipboard-target="jsDomain">复制</a> </div> </div> </div> <div class="action"> <a href="#wechatsite/edit/_{wechatSite._id}" class="btn btn-default">修改</a> <input if="{wechatSite.lFlg != \'a\'}" onclick="{unlockWechatSite}" class="btn btn-default" data-toggle="modal" data-target="#modal" type="button" value="激活"> <input if="{wechatSite.lFlg != \'i\'}" onclick="{lockWechatSite}" class="btn btn-default" data-toggle="modal" data-target="#modal" type="button" value="锁定"> <input if="{wechatSite.lFlg != \'d\'}" onclick="{delWechatSite}" class="btn btn-default" data-toggle="modal" data-target="#modal" type="button" value="删除"> </div> </div> </div> </div>',"boss-wechatsite a { cursor: pointer; } boss-wechatsite .row{ margin-top: 10px; } boss-wechatsite .panel-container >div{ height: 40px; line-height: 40px; } boss-wechatsite .form-con { margin-top: 15px; padding: 0 0; } boss-wechatsite .action{ text-align: center; padding-bottom: 50px; } boss-wechatsite .action input{ margin-left: 30px; }",function(e){var t=nest.presentable(this),n=domain.action("loadTenantWechatSite"),i=domain.action("updateTenantWechatSiteById"),o=function(e){
e.error||t.update({wechatSite:e.wechatSite})};t.on("open",function(e){t.trigger("ready",!1),t.trigger("view-route-to"),n.execute(e.id);new ZeroClipboard($(".clip_button"))}),t.on("mount",function(){n.onDone(o)}),t.unlockWechatSite=function(){_.widget.confirm({title:"操作确认?",content:"你确认要“激活”该公众号吗？",callback:function(){t.wechatSite.lFlg=__app.enums.LifeFlag.names.Active,i.newInvocation({id:t.wechatSite._id,lFlg:t.wechatSite.lFlg}).onDone(function(e){t.update()}).execute()}})},t.lockWechatSite=function(){_.widget.confirm({title:"操作确认?",content:"你确认要“锁定”该公众号吗？",callback:function(){t.wechatSite.lFlg=__app.enums.LifeFlag.names.Inactive,i.newInvocation({id:t.wechatSite._id,lFlg:t.wechatSite.lFlg}).onDone(function(e){t.update()}).execute()}})},t.delWechatSite=function(){_.widget.confirm({title:"操作确认?",content:"你确认要“删除”该公众号吗？",callback:function(){t.wechatSite.lFlg=__app.enums.LifeFlag.names.Deleted,i.newInvocation({id:t.wechatSite._id,lFlg:t.wechatSite.lFlg}).onDone(function(e){t.update()}).execute()}})}}),riot.tag("broadcast",'<div if="{!hidden}"> <div if="{tip}" class="alert {addClass}" style="margin-top: -5px; float: left; width: 100%; text-align: center; margin-bottom: 0; position: absolute; z-index: 9999"> <strong>{tipInfo}</strong> </div> <div class="container" style="width: 100%; margin-left: 0; margin-right: 0; padding-left: 0; padding-right: 0"> <div class="row-fluid"> <div class="col-md-4 col-xs-4 col-sm-4" style="padding-right: 0; padding-left: 0; margin-top: -5px; width: 30%"> <div class="well sidebar-nav" style="padding-top: 0; padding-right: 0; padding-left: 0;height: 48em; background-color: #222; border: 1px solid #080808; overflow: scroll; border-radius: 0"> <div if="{!broadcastHistory.length}"> <ul style="padding: 0; margin: 0; list-style-type: none"> <li style="margin-bottom: 3px; padding: 25px 20px; background-color: #333; cursor: pointer; text-align: center"> <span style="color: white">暂无群发纪录</span> </li> </ul> </div> <div if="{broadcastHistory.length}"> <ul style="padding: 0; margin: 0; list-style-type: none"> <li each="{broadcastHistory}" style="position:relative; border-bottom: 1px solid #252525; padding: 5px 5px 5px 10px; background-color:#2E3238; cursor: pointer; color: white"> <div if="{contentType == \'image\'}" style="height: 100%; width: 100%"> <div style="display: -webkit-inline-box;"> <img style="width: 48px;height:48px" riot-src="{contentType == \'image\' && media_id && parent.api + \'/file/?media_id=\' + media_id}" alt=""> </div> <div style="position:absolute;right:10px;bottom:10px;font-size: 12px;float:right; text-align: right;">{parent.formatDate(crtOn)}</div> </div> <div if="{contentType == \'text\'}" style="height: 100%; width: 100%"> <div style="display: -webkit-inline-box; padding: 5px; min-height: 50px; overflow: hidden; width: 100%; font-size: 14px">{content}</div> <div style="position:absolute;right:10px;bottom:10px;font-size: 12px;float:right; text-align: right;">{parent.formatDate(crtOn)}</div> </div> </li> </ul> </div> </div> </div> <div class="col-md-8 col-xs-8 col-sm-8" style="padding-right: 1px; padding-left: 0; margin-top: -5px; width: 70%"> <div class="jumbotron" style="height: 48em; border-radius: 0"> <div id="broadcast"> <div class="panel panel-default" id="img_prew" style="display:none; margin-bottom: 10px"> <table class="table table-bordered" style="text-align: center; vertical-align: middle;"> <tbody> <tr> <td rowspan="3"> <img riot-src="{img_url}" alt="" style="height: 9em;"></td> <td>文件名</td> <td>{img_name}</td> </tr> <tr> <td>文件大小</td> <td>{img_size}</td> </tr> <tr> <td colspan="2"> <input class="btn btn-default" type="button" style="margin-right: 50px" value="取消" onclick="{cancel_send_img}"> <input class="btn btn-success" type="button" value="发送" onclick="{send_img}"> </td> </tr> </tbody> </table> </div> <div class="btn-group" style="float: left;margin-bottom: 10px"> <button type="button" class="btn btn-success dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <span id="groupDisplay">请选择分组</span><span class="caret"></span> </button> <ul class="dropdown-menu"> <li each="{groups}"><a href="javascript:void(0)" onclick="{parent.chooseGroup}" groupid="{_id}">{name}</a></li> </ul> <input id="group" type="hidden"> </div> <textarea id="broadcastMsg" style="height:160px;background: #FBFBFB;margin-top: 5px;" class="form-control" rows="3"></textarea> <button id="send" type="button" onclick="{broadcast}" style="margin-top: 1em; width: 7em;float:right" class="btn btn-success">发送</button> <div id="choose_img" style="float: right; margin-right: 20px; margin-top: 12px"> <span class="btn_addPic glyphicon glyphicon-picture" href="javascript:void(0);"><input id="img_file" type="file" class="filePrew" class="glyphicon glyphicon-picture" multiple="multiple" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="{previewImg}"></span> </div> </div> </div> </div> </div> </div> </div>',"broadcast .btn_addPic{ display: block; position: relative; font-size: 35px; width: 38px; height: 38px; overflow: hidden; cursor: pointer; text-align: center; } broadcast .filePrew { display: block; position: absolute; top: 0; left: 0; width: 38px; height: 38px; cursor: pointer; font-size: 100px; opacity: 0; filter:alpha(opacity=0); }",function(e){function t(e,t){var i="";"success"===e&&(i="alert-success"),"error"===e&&(i="alert-danger"),"info"===e&&(i="alert-info"),"warning"===e&&(i="alert-warning"),n.update({tip:!0,tipInfo:t,addClass:i}),setTimeout(function(){n.update({tip:!1,tipInfo:"",addClass:""})},1e3)}this.app=this.opts.app;var n=nest.presentable(this);n.env="production"==__app.settings.env.NODE_ENV?"public":"web",n.api=__app.settings.api.url,n.botId=__page.bot.customId,n.broadcastHistory=[],n.tip=!1,n.tipInfo="";var i=domain.action("broadcastTxt"),o=domain.action("broadcastImg"),r=domain.action("loadBroadcastHistory"),a=domain.action("loadGroups"),s=function(e){n.update({groups:e.groups})},l=function(e){$("#send").attr("disabled",!1),e.success?($("#broadcastMsg").val(""),e.msgArr.forEach(function(e){n.broadcastHistory.unshift(e)}),n.update(),t("success","群发成功")):t("error","群发失败")},c=function(e){e.success?($("#img_file").val(""),e.msgArr.forEach(function(e){n.broadcastHistory.unshift(e)}),n.update(),t("success","群发图片成功")):t("error","群发图片失败")},d=function(e){n.broadcastHistory=e.history||[],n.update()};this.on("mount",function(){console.info("tag broadcast index is mounted"),i.onDone(l),o.onDone(c),r.onDone(d),a.onDone(s)}),this.on("unmount",function(){console.info("tag broadcast index is unmounted"),i.offDone(l),o.offDone(c),r.offDone(d),a.offDone(s)}),this.on("open",function(e){console.info("tag broadcast index is opening"),n.trigger("ready",!1),n.trigger("view-route-to"),r.execute(n.botId),a.execute({tenantId:__page.user.posts[0].org,operatorId:__page.user.posts[0].member})}),this.on("leave",function(){n.mask=!0,n.update()}),this.on("reenter",function(){n.mask=!1,n.update()}),this.on("refresh",function(){console.info("tag broadcast index is refreshing")}),n.formatDate=function(e){var t=new Date(e).toLocaleString();return t.replace(/\//g,"-")},this.previewImg=function(e){var t=e.target.files[0];n.img_size=t.size/1e3+"KB",n.img_name=t.name;var i=new FileReader;i.onload=function(e){n.img_url=e.target.result,n.update(),$("#img_prew").show()},i.readAsDataURL(t)}.bind(this),this.cancel_send_img=function(e){$("#img_prew").hide()}.bind(this),this.send_img=function(e){var i=$("#group").val();if(i){var r=new FormData,a=$("#img_file")[0].files;r.append("file",a[0]),$.ajax({url:n.api+"/file/upload",type:"POST",data:r,processData:!1,contentType:!1,success:function(e){$("#img_prew").hide();var t={botId:n.botId,groupId:i,media_id:e.media_id};o.execute(t)},error:function(e){console.error("失败:"+JSON.stringify(e))}})}else t("warning","请先选择群发的分组")}.bind(this),this.broadcast=function(e){e.preventUpdate=!0;var o=$("#group").val();if(o){var r=$("#broadcastMsg").val().trim();if(r.length>0){var a={botId:n.botId,groupId:o,msg:r};i.execute(a),$(e.currentTarget).attr("disabled",!0)}else t("warning","发送内容不能为空")}else t("warning","请先选择群发的分组")}.bind(this),this.chooseGroup=function(e){$("#groupDisplay").text($(e.currentTarget).text()),$("#group").val($(e.currentTarget).attr("groupId"))}.bind(this)}),riot.tag("confirm",'<div class="modal fade" id="modal"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title">{title || \'操作确认\'}</h4> </div> <div class="modal-body"> <p>{content || \'确定吗?\'}&hellip;</p> </div> <div class="modal-footer"> <button onclick="{Cancel}" type="button" class="btn btn-default" data-dismiss="modal">取消</button> <button onclick="{Confirm}" type="button" class="btn btn-primary" data-dismiss="modal">确认</button> </div> </div> </div> </div>',function(e){var t=this;app.on("confirm",function(e){t.update({title:e.title,content:e.content})}),this.Cancel=function(e){app.trigger("confirmCancel")},this.Confirm=function(e){app.trigger("confirmOk")}}),riot.tag("contacts",'<div if="{!hidden}" onclick="{hideMenu}"> <div if="{tip}" class="alert {addClass}" style="margin-top: -5px; float: left; width: 100%; text-align: center; margin-bottom: 0; position: absolute; z-index: 9999"> <strong>{tipInfo}</strong> </div> <div class="container" style="width: 100%; margin-left: 0; margin-right: 0; padding-left: 0; padding-right: 0"> <div class="row-fluid"> <div class="col-md-4 col-xs-4 col-sm-4" style="padding-right: 0; padding-left: 0; margin-top: -5px; width: 30%"> <div class="row-fluid" style="height:50px; background: #2E3238;"> <div onclick="{selectContacts}" class="{left_nav_sel: viewModel.nav === CONST.NAV.CONTACT, left_nav_def: viewModel.nav != CONST.NAV.CONTACT} col-md-5 col-xs-5 col-sm-5" style="text-align: center;height:50px; line-height: 50px;border-right:1px solid #1C2129"> <span class="glyphicon glyphicon-user" aria-hidden="true"></span> &nbsp联系人 </div> <div onclick="{selectGroups}" class="{left_nav_sel: viewModel.nav === CONST.NAV.GROUP,left_nav_def: viewModel.nav != CONST.NAV.GROUP} col-md-5 col-xs-5 col-sm-5" style="border-right:1px solid #1C2129;text-align: center;height:50px; line-height: 50px"> <span class="glyphicon glyphicon-th" aria-hidden="true"></span> &nbsp群 </div> <div id="menuBtn" onclick="{toggleMenu}" class="{menu_open: menuOpen} col-md-2 col-xs-2 col-sm-2" style="overflow:visible;position:relative;height:50px;line-height: 50px;color:white;font-size:16px;text-align: center"> <span class="glyphicon glyphicon-cog" aria-hidden="true"></span> <div if="{menuOpen===true}" id="menu" style="position: absolute;top:50px;left:0px;width:170px;height:100px"> <ul style="list-style-type: none;margin: 0px;padding:0px;"> <li if="{!syncingContacts}" style="background: #4D5767;border-bottom: 1px solid #3F4650;text-align: left;padding-left:20px" onclick="{syncContact}"> <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> &nbsp<span style="font-size: 14px">同步联系人</span> </li> <li if="{syncingContacts}" style="background: #4D5767;border-bottom: 1px solid #3F4650;text-align: left;padding-left:20px"> <span class="sync glyphicon glyphicon-refresh" aria-hidden="true"></span> &nbsp<span style="font-size: 14px">正在同步联系人...</span> </li> <li if="{!syncingGroups}" style="background: #4D5767;border-bottom: 1px solid #3F4650;text-align: left;padding-left:20px" onclick="{syncGroup}"> <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> &nbsp<span style="font-size: 14px">同步群</span> </li> <li if="{syncingGroups}" style="background: #4D5767;border-bottom: 1px solid #3F4650;text-align: left;padding-left:20px"> <span class="sync glyphicon glyphicon-refresh" aria-hidden="true"></span> &nbsp<span style="font-size: 14px">正在同步群...</span> </li> </ul> </div> </div> </div> <div class="well sidebar-nav" style="padding-top: 0; padding-right: 0; padding-left: 0;height: 48em; background-color: #2E3238; border: 1px solid #080808; overflow: scroll; border-radius: 0"> <ul if="{viewModel.nav === CONST.NAV.CONTACT}" style="padding: 0; margin: 0; list-style-type: none"> <li each="{contacts}" onclick="{parent.selectContact}" style="margin-bottom: 3px; padding: 5px 20px; border-bottom:1px solid #292C33; cursor: pointer"> <img riot-src="{parent.api + \'/file?media_id=\' + headimgurl}" style="width: 4em; height: 4em" alt=""> <span style="color: white; margin-left: 15px">{nickname}</span> </li> </ul> <span style="display:block;text-align: center;margin-top: 10px; color: white" if="{!groups || groups.length===0}">暂无相关记录</span> <ul if="{viewModel.nav === CONST.NAV.GROUP}" style="padding: 0; margin: 0; list-style-type: none"> <li each="{groups}" style="height:50px;line-height:40px;margin-bottom: 3px; padding: 5px 20px; border-bottom:1px solid #292C33; cursor: pointer">  <span style="color: white; margin-left: 15px">{nickname}</span> </li> </ul> </div> </div> <div if="{Object.keys(currUser).length>0}" class="col-md-8 col-xs-8 col-sm-8" style="padding-right: 1px; padding-left: 0; margin-top: -5px; width: 70%"> <div style="margin-bottom:50px;height: 50px;line-height:50px;border-bottom:1px solid #ddd;text-align: center"> <span>明细</span> </div> <div style="padding-bottom:30px;"> <div class="avatar" style="text-align: center;"><img riot-src="{api + \'/file?media_id=\' + currUser.headimgurl}" style="width:120px;height:120px;border-radius: 5px;margin-bottom: 10px"></div> <div class="nickname_area" style="text-align:center;height:48px;line-height: 48px;"><strong style="font-size: 24px;font-weight: 100">{currUser.nickname}</strong></div> <div style="width:70%;padding-left: 28%;margin: 0px auto;color:#999;margin-bottom:10px"> <label>备注: &nbsp&nbsp&nbsp&nbsp</label><span>{currUser.remark}</span><br> <label>地区: &nbsp&nbsp&nbsp&nbsp</label><span>{showPlace()}</span> </div> <div class="tags_area"> <div style="text-align: center; margin-bottom:20px"> <button if="{viewModel.mode===\'view\'}" onclick="{editTags}" type="button" class="btn btn-default" style="display:inline-block;background: #269227; color:white; border: none"> 编辑标签 </button> <button if="{viewModel.mode===\'edit\'}" onclick="{submitTags}" type="button" class="btn btn-default" style="display:inline-block;background: #269227; color:white; border: none"> 确认 </button>    </div> <ul onclick="{clickTags}" class="{tags_body:true, tags_body_edit:viewModel.mode===\'edit\'}"> <li style="position: relative" class="{tags_item:true ,tags_edit: parent.viewModel.mode===\'edit\'}" each="{name in (currUser.tags || [])}"> {name} <b onclick="{parent.removeTag}" if="{parent.viewModel.mode===\'edit\'}" style="position: absolute;border-radius: 50em;top:6px;right:3px;width:18px;height:18px;background:#8A8A8A"> <b style="width:16px;height:16px;border-radius: 50em;display:block;margin:4px auto"> <span style="position: absolute; top: 2px; left: 2px;" class="glyphicon glyphicon-remove" aria-hidden="true"></span> </b> </b> </li> <li><input name="newTag" onkeyup="{newTagInput}" type="text" value="" style="display:inline-block;margin-left:10px;margin-top:5px;font-size:16px;background:transparent;border:none"></li> </ul> </div> </div> <div> </div> </div> </div> </div> </div>',"contacts .sync{ animation:rotation 2.5s linear infinite; -webkit-animation:rotation 2.5s linear infinite; } contacts .menu_open{ background: #4D5767; } contacts input,contacts textarea{ outline:none; } contacts .left_nav_def{ color:white; } contacts .left_nav_sel{ color:#6CBD6E; } contacts .tags_body{ list-style-type: none; width:50%; margin:0px auto; padding-top: 12px; overflow:hidden; padding-left:0px; padding:10px; } contacts .tags_body_edit{ border:1px solid #ccc; border-radius: 5px; } contacts .tags_item{ float:left;margin-right:10px;margin-bottom:10px;height:32px;padding:5px 25px; background:#6CBD6E;color:white;text-align:center;border-radius: 5px; } contacts .tags_item:first-child{ margin-left:0px; } contacts .tags_edit{ background:#8FC590 !important; }",function(e){this.app=this.opts.app;var t=nest.presentable(this),n=t.CONST={NAV:{CONTACT:"contact",GROUP:"group"}};t.env="production"==__app.settings.env.NODE_ENV?"public":"web",t.api=__app.settings.api.url,t.botId=__page.bot.customId,t.tip=!1,t.tipInfo="",t.viewModel={nav:n.NAV.CONTACT,mode:"view"},t.menuOpen=!1,t.currUser={},t.init=function(){};var i=domain.action("loadContacts"),o=domain.action("saveTagsById"),r=domain.action("syncContacts"),a=domain.action("syncGroups"),s=function(e){t.update({contacts:e.contacts,groups:e.groups})},l=function(e){setTimeout(function(){t.syncingContacts=!1,t.update()},18e6)},c=function(e){setTimeout(function(){t.syncingGroups=!1,t.update()},18e6)},d=function(e){e.success&&(t.viewModel.mode="view",t.newTag.value="",t.update())};this.on("mount",function(){console.info("tag contacts index is mounted"),r.onDone(l),a.onDone(c),i.onDone(s),o.onDone(d)}),this.on("unmount",function(){console.info("tag contacts index is unmounted"),r.offDone(l),a.offDone(c),i.offDone(s),o.offDone(d)}),this.on("open",function(e){console.info("tag contacts index is opening"),t.trigger("ready",!1),t.trigger("view-route-to"),i.execute(t.botId)}),this.on("leave",function(){t.mask=!0,t.update()}),this.on("reenter",function(){t.mask=!1,t.update()}),this.on("refresh",function(){console.info("tag contacts index is refreshing")}),this.selectContact=function(e){t.currUser=e.item,t.viewModel.mode="view",t.newTag.value=""}.bind(this),t.formatDate=function(e){var t=new Date(e).toLocaleDateString();return t.replace(/\//g,"-")},t.showPlace=function(){var e="";return e=t.currUser.district?(t.currUser.city||"")+" "+(t.currUser.district||""):(t.currUser.province||"")+" "+(t.currUser.city||"")},this.hideMenu=function(e){t.menuOpen=!1}.bind(this),this.selectContacts=function(e){t.viewModel.nav=n.NAV.CONTACT}.bind(this),this.selectGroups=function(e){t.viewModel.nav=n.NAV.GROUP}.bind(this),this.editTags=function(e){t.viewModel.mode="edit",$(".tags_body").find(">li>input").focus()}.bind(this),this.cancelTags=function(e){t.viewModel.mode="view",t.newTag.value=""}.bind(this),this.clickTags=function(e){var t=$(e.currentTarget);t.find(">li>input").focus()}.bind(this),this.newTagInput=function(e){if(32===e.which&&""!=t.newTag.value.trim()){if(t.currUser.tags||(t.currUser.tags=[]),t.currUser.tags.length>4)return void alert("最多添加五个标签");t.currUser.tags.forEach(function(e){e.trim()===t.newTag.value.trim()}),t.currUser.tags.push(t.newTag.value.trim()),t.newTag.value=""}}.bind(this),this.removeTag=function(e){return t.currUser.tags.forEach(function(n,i){n===e.item.name&&t.currUser.tags.splice(i,1)}),!1}.bind(this),this.submitTags=function(e){o.execute({id:t.currUser._id,tags:t.currUser.tags,tenant:__page.bot.org})}.bind(this),this.toggleMenu=function(e){t.menuOpen=!t.menuOpen,e.stopPropagation()}.bind(this),this.syncContact=function(e){r.execute({botid:__page.bot.customId}),t.syncingContacts=!0,e.stopPropagation()}.bind(this),this.syncGroup=function(e){a.execute({botid:__page.bot.customId}),t.syncingGroups=!0,e.stopPropagation()}.bind(this)}),riot.tag("del-group-member",'<div class="title_wrap"> <b onclick="{backToView}" style="display: block;width:24px;height:24px;float:left" onclick="{back}"> <i class="glyphicon glyphicon-chevron-left"></i> </b> 移除成员 <b onclick="{submit}" style="display: block;width:80px;height:24px;float:right"> <button type="button" class="btn btn-default" style="display:inline-block;background: #42AC3E; color:white; border: none"> 确认移除 </button> </b> </div> <div> <div class="wrapper" attr="{parent.mediaUsers}"> <div>   <ul class="user_list"> <li onclick="{parent.selectMember}" each="{parent.groupMembers}" id="{_id}" media="{parent.media._id}" group="{parent.parent.parent.group._id}"> <img riot-src="{parent.app.settings.api.url + \'/file?media_id=\' + member.headimgurl}"> <p style="overflow: hidden;height:24px">{member.remark}</p> </li> </ul> </div> </div> </div>',"del-group-member .wrapper{ width:90%; margin:0px auto; } del-group-member .user_list{ overflow: hidden; list-style-type: none; margin:0px; padding:0px; color:#888; } del-group-member .user_list >li{ width:100px; float:left; margin:5px 0px; text-align: center; line-height: 30px; position: relative; } del-group-member .user_list >li img{ display: inline-block; width:64px; height:64px; } del-group-member .title_wrap{ height:50px; margin:8px 10px; text-align: center; line-height: 50px; } del-group-member .select{ position: absolute; top:0px; left:17px; background:#42AC3E; width:64px; height:64px; opacity: 0.8; } del-group-member .select div{ font-size: 40px; color:white; margin:8px; }",function(e){function t(e){e.success&&(n.members={},e.data&&e.data.length&&e.data.forEach(function(e){n.parent.groupMembers.unshift(e)}),n.parent.panel.view(),n.parent.update())}var n=this;n.page=__page,n.app=__app,n.nav=0,n.members={};var i={"基本信息":0,"成员":1},o=domain.action("addGroupMembers");this.on("mount",function(){o.onDone(t)}),this.on("unmount",function(){o.offDone(t)}),this.clickNav=function(e){n.nav=i[e.target.innerText]}.bind(this),this.addMember=function(e){n.parent.panel.status="add_m",n.parent.update()}.bind(this),this.selectMember=function(e){function t(e){if(n.members[a])o(e),delete n.members[a];else{var t={group:s,media:l,member:a};n.members[a]=t,i(e)}}function i(e){var t=document.createElement("div");t.classList.add("select");var n=document.createElement("div");n.classList.add("glyphicon"),n.classList.add("glyphicon-ok"),t.appendChild(n),e.appendChild(t)}function o(e){e.removeChild(e.childNodes[e.childNodes.length-1])}var r=e.currentTarget,a=r.id,s=r.getAttribute("group"),l=r.getAttribute("media");t(r)}.bind(this),this.submit=function(e){Object.keys(n.members).length&&o.execute({members:n.members})}.bind(this),this.backToView=function(e){n.members={},n.parent.panel.view(),n.parent.update()}.bind(this)}),riot.tag("group-left",'<div class="well sidebar-nav" style="padding-top: 0; padding-right: 0; padding-left: 0;height: 48em; background-color: #2E3238; border: 1px solid #080808; overflow: scroll; border-radius: 0"> <ul style="padding: 0; margin: 0; list-style-type: none"> <li style="height: 50px; border-bottom:1px solid #252525; line-height: 50px;overflow: hidden"> <div class="col-md-8 col-xs-8 col-sm-8" style="height:50px;line-height:50px;overflow: hidden"> <div style="padding-left:10px;background: #24272C;height: 32px; margin-top: 8px;line-height:32px;color: #777"> <b style="width:20%;"> <span class="glyphicon glyphicon-search"></span> </b> <input oninput="{search}" type="text" id="searchInput" style="background: transparent;border: none;width:80%" placeholder="搜索"> </div> </div> <div class="col-md-4 col-xs-4 col-sm-4" style="height:50px;overflow: hidden;"> <div style="height:32px;margin-top: 6px;line-height: 32px"> <button type="button" onclick="{parent.addGroup}" class="btn btn-sm" style="background: #42AC3E; color:white"> <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> 添加分组 </button> </div> </div> </li> <li onclick="{parent.parent.viewGroup}" id="{_id}" each="{ownGroups || parent.groups}" style="height: 50px;line-height: 40px;border-bottom:1px solid #252525;padding: 5px 20px; cursor: pointer"> <span style="color: white; margin-left: 15px">{name}</span> </li> </ul> </div>',function(e){var t=this;t.ownGroups=null,t._timeout=null,t.init=function(){t.ownGroups=null,t.searchInput.value=""},this.search=function(e){t._timeout||(t._timeout=setTimeout(function(){var e=t.searchInput.value,n=e.split(" ");t.ownGroups=t.parent.groups.filter(function(e){var t=!0;return n.forEach(function(n){e.name.search(new RegExp(n))<=-1&&(t=!1)}),t}),clearTimeout(t._timeout),t._timeout=null,t.update()},500))}.bind(this)}),riot.tag("group",'<div if="{!hidden}"> <div class="row-fluid" style="overflow: hidden; background: #eee;margin-top:-6px"> <div class="col-md-4 col-xs-4 col-sm-4" style="padding-right: 0; padding-left: 0; width: 30%"> <group-left></group-left> </div> <div class="col-md-8 col-xs-8 col-sm-8" style="background:#eee;padding-right: 1px; padding-left: 0;width: 70%"> <div if ="{panel.status === \'start\'}"> </div> <view-group if="{panel.status === \'view\'}"></view-group> <add-group if="{panel.status === \'add\'}"></add-group> <del-group-member if="{panel.status === \'del_m\'}"></del-group-member> <add-group-member if="{panel.status === \'add_m\'}"></add-group-member> </div> </div> </div>',function(e){this.app=this.opts.app;var t=nest.presentable(this);t.env="production"==__app.settings.env.NODE_ENV?"public":"web",t.api=__app.settings.api.url,t.botId=__page.bot.customId,t.tip=!1,t.tipInfo="",t.groups={},t.groupMembers=[];var n=domain.action("loadAllMyManageMedia"),i=domain.action("loadGroups"),o=domain.action("loadGroup"),r=function(e){t.groups=e.groups,t.update()},a=function(e){t.myManageMedia=e.medias,t.panel.add(),t.update()},s=function(e){t.group=e.group,t.groupMembers=e.members,t.panel.view(),t.update()};this.on("mount",function(){n.onDone(a),i.onDone(r),o.onDone(s)}),this.on("unmount",function(){n.offDone(a),i.offDone(r),o.offDone(s)}),this.on("open",function(e){console.info("tag group index is opening"),t.trigger("ready",!1),t.trigger("view-route-to"),i.execute({tenantId:__page.user.posts[0].org,operatorId:__page.user.posts[0].member})}),this.on("leave",function(){t.mask=!0,t.update()}),this.on("reenter",function(){t.mask=!1,t.update()}),this.on("refresh",function(){console.info("tag group index is refreshing")}),t.formatDate=function(e){var t=new Date(e).toLocaleDateString();return t.replace(/\//g,"-")},t.panel={status:"start",add:function(){this.status="add"},view:function(){this.status="view",t.tags["view-group"].init()},start:function(){this.status="start",t.group={},t.groupMembers=[]}},this.viewGroup=function(e){var t=e.currentTarget.id;o.execute({id:t})}.bind(this),this.addGroup=function(e){var i=t.panel;"add"!==i.status&&n.execute({tenantId:__page.user.posts[0].org,operatorId:__page.user.posts[0].member})}.bind(this)}),riot.tag("overview",'<div if="{!hidden}"> <div if="{tip}" class="alert {addClass}" style="margin-top: -5px; float: left; width: 100%; text-align: center; margin-bottom: 0; position: absolute; z-index: 9999"> <strong>{tipInfo}</strong> </div> <div class="container" style="width: 100%; margin-left: 0; margin-right: 0; padding-left: 0; padding-right: 0"> <div class="row"> &nbsp; </div> <div class="row"> <div class="col-md-8 col-md-offset-2" > <div class="panel panel-default"> <div class="panel-heading">账户信息</div> <div class="panel-body"> <div class="container" style=""> <div class="row"> <div class="col-md-1 col-lg-1" style=""> 账户： </div> <div class="col-md-3 col-lg-3" riot-style=""> {user.nickname} &nbsp;&nbsp; <small><small>个人账户</small></small> </div> <div class="col-md-1 col-lg-1" style=""> 管理员： </div> <div class="col-md-3 col-lg-3" style=""> <img src="{user.headimgurl}" alt="{user.nickname}" class="img-rounded" data-src="holder.js/40x40" style="width: 40px; height: 40px;"> &nbsp;&nbsp;{user.nickname} </div> </div> </div> </div> </div> <div class="panel panel-default"> <div class="panel-heading">微信托管</div> <div class="panel-body"> <div style=""> <div class="row"> <div class="col-md-3 col-lg-3" style=""> <img src="{bot.headimgurl}" alt="{bot.name}" class="img-rounded" data-src="holder.js/40x40" style="width: 40px; height: 40px;"> &nbsp; {bot.name} <img if="{bot.sex==1}" src="/web/images/male.png" alt="男" class="" style="boder:0px; width: 16px; height: 16px;"> <img if="{bot.sex==2}" src="/web/images/female.png" alt="女" class="" style="boder:0px; width: 16px; height: 16px;"> </div> <div class="col-md-3 col-lg-3" style=""> <div class="row" > <div class="col-md-4 col-lg-4" style="height: 60px"> <img if="{!botActioning && botKeepLogged}" src="/web/images/stop-active.png" alt="退出" onclick="{goExiting}" class="bot-action-icon bot-logged" style=""> <img if="{botActioning && botKeepLogged}" src="/web/images/start.png" alt="启动中..." class="bot-action-icon bot-logging" style=""> <img if="{!botActioning && botKeepExited}" src="/web/images/start-active.png" alt="启动" onclick="{goLogging}" class="bot-action-icon bot-exited" style=""> <img if="{botActioning && botKeepExited}" src="/web/images/stop.png" alt="退出中..." class="bot-action-icon bot-exiting" style=""> </div> <div class="col-md-8 col-lg-8" style="vertical-align: middle;height: 60px;"> <label>&nbsp;&nbsp;{bot.statusName}</label> </div> </div> </div> <div class="col-md-6 col-lg-6" if="{needLoginFlg}"> <div class="row" > <div class="col-md-4 col-lg-4" style="height: 112px;"> <img riot-src="{loginQR}" style="border:1px solid #ddd;display: inline-block; height: 100%"> </div> <div class="col-md-8 col-lg-8" style="vertical-align: middle;height: 60px;"> <label>扫描左方二维码登录</label> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div>',"overview .panel-body{ line-height: 70px; } overview .bot-action-icon{ border: 0px; width: 60px; height: 60px; } overview .bot-logged {cursor: default !important;} overview .bot-logging {cursor: wait !important;} overview .bot-exited {cursor: default !important;} overview .bot-exiting {cursor: wait !important;}",function(e){"use strict";this.app=this.opts.app;var t=nest.presentable(this);t.api=__app.settings.api.url,t.tip=!1,t.tipInfo="",t.botId=__page.bot.customId,t.bot=__page.bot,t.user=__page.user,t.tenantId=__page.tenantId,t.botKeepLogged=!0,t.botKeepExited=!1,t.botActioning=!0,t.needLoginFlg=!1;var n=domain.action("loadBotByMediaId"),i=domain.action("startBot"),o=domain.action("stopBot"),r=__app.enums.IntentionStatus.names,a=__app.enums.WechatBotStatus.names,s=__app.enums.WechatBotStatus.values,l=function(e,t,n){this.id=e,this.intentionStatus=t||r.Logged,this.on("logged",this.onLogged.bind(this)),this.on("exited",this.onExited.bind(this)),this.on("logging",this.onLogging.bind(this)),this.on("exiting",this.onExiting.bind(this)),this.on("status-changed",this.onStatusChanged.bind(this)),this.updateStatus(n)};l.prototype=riot.observable({}),l.prototype.updateStatus=function(e){this.status!=e&&(this.status=e,e==r.Logged?this.trigger("logged"):e!=r.Exited&&e!=a.Aborted||this.trigger("exited"),this.trigger("status-changed",this.status,e))},l.prototype.goLogging=function(){this.trigger("logging")},l.prototype.goExiting=function(){this.trigger("exiting")},l.prototype.onLogged=function(){t.bot.intentionStatus=r.Logged,t.botKeepLogged=!0,t.botKeepExited=!1,t.botActioning=!1,t.update()},l.prototype.onExited=function(){t.bot.intentionStatus=r.Exited,t.botKeepLogged=!1,t.botKeepExited=!0,t.botActioning=!1,t.update()},l.prototype.onLogging=function(){t.botKeepLogged=!0,t.botKeepExited=!1,t.botActioning=!0,t.update(),console.info("logging...")},l.prototype.onExiting=function(){t.botKeepLogged=!1,t.botKeepExited=!0,t.botActioning=!0,t.update(),console.info("exiting...")},l.prototype.onStatusChanged=function(e,n){t.bot.status=n,t.bot.statusName=s[t.bot.status],console.info(t.bot.statusName),t.update()};var c=null;ws.subscribe("/bot/st_change",function(e){var n=e;n.agentId===t.bot.customId&&(n.newStatus===a.Logged&&(t.needLoginFlg=!1),c.updateStatus(n.newStatus))}),ws.subscribe("/bot/need_login",function(e){var n=e;n.agentId===t.bot.customId&&(t.loginQR=n.mediaUrl,t.needLoginFlg=!0,t.update())}),this.goLogging=function(e){i.execute({openid:t.bot.customId,intention:"login",mode:"untrusted",nickname:t.bot.name,sex:t.bot.sex}),c.goLogging()}.bind(this),this.goExiting=function(e){o.execute({openid:t.bot.customId}),console.log({openid:t.bot.customId}),c.goExiting()}.bind(this);var d=function(e){c=new l(t.bot.id,e.media.intentionStatus,e.media.status),c.updateStatus(e.media.status),t.update()};this.on("mount",function(){n.onDone(d),n.execute({botId:t.bot._id})}),this.on("unmount",function(){n.offDone(d)}),this.on("open",function(e){console.info("tag overview is opening"),t.trigger("ready",!1),t.trigger("view-route-to")}),this.on("leave",function(){t.mask=!0,t.update()}),this.on("reenter",function(){
t.mask=!1,t.update()}),this.on("refresh",function(){console.info("tag overview is refreshing")})}),riot.tag("raw","",function(e){var t=this;t.on("update",function(){t.root.innerHTML=t.opts.content||""})}),riot.tag("recontent-index",'<div if="{!hidden}"> <div class="container-fluid"> <div class="row-fluid"> &nbsp; </div> <div class="row-fluid"> <div class="col-md-6 col-lg-6" > <div class="row-fluid"> <div class="col-md-12 col-lg-12" > <div class="pull-right"> <button class="btn btn-default btn-sm" type="button" onclick="{onRefresh}">刷新</button> <button class="btn btn-default btn-sm" type="button" onclick="{onNew}">新建</button> </div> <table class="table table-striped"> <thead> <tr> <th>名称</th> <th>广告</th> <th>预览</th> </tr> </thead> <tbody> <tr each="{recontents}"> <td> <a onclick="{parent.onView}"> <input type="hidden" value="{_id}"> {originalTitle} </a> </td> <td> {adName} </td> <td> <a href="{newUrl}" target="_blank"> 预览 </a> </td> </tr> </tbody> </table> </div> </div> </div> <div class="col-md-6 col-lg-6" >   </div> </div> </div> <form id="newForm" method="post" action="recontent-set" target="_blank"> <input type="hidden" id="tenantId" name="tenantId" value="{tenantId}"> </form> </div>',function(e){"use strict";this.app=this.opts.app;var t=nest.presentable(this);t.api=__app.settings.api.url,t.tenantId=this.opts.tenant;var n=domain.action("findTenantRecontents"),i=function(e){console.log(e),t.update({recontents:e})};this.on("mount",function(){n.onDone(i)}),this.on("unmount",function(){n.offDone(i)}),this.on("open",function(e){console.info("tag adlink-index is opening"),t.trigger("ready",!1),t.trigger("view-route-to"),n.execute(t.tenantId)}),this.on("leave",function(){t.mask=!0,t.update()}),this.on("reenter",function(){t.mask=!1,t.update()}),this.on("refresh",function(){onRefresh()}),this.onRefresh=function(e){n.execute(t.tenantId)}.bind(this),this.onNew=function(e){$("#newForm").submit()}.bind(this),this.onView=function(e){}.bind(this),this.showEditView=function(e){detail.trigger("close"),edit.trigger("open",{action:"edit",id:e})},this.showDetailView=function(e){edit.trigger("close"),detail.trigger("open",{model:e})}}),riot.tag("redpacket-boss",'<div if="{!hidden}"> <div if="{tip}" class="alert {addClass}" style="margin-top: -5px; float: left; width: 100%; text-align: center; margin-bottom: 0; position: absolute; z-index: 9999"> <strong>{tipInfo}</strong> </div> <div class="container"> <div class="row-fluid"> <div class="jumbotron" style="height: auto; padding: 25px;"> <div if="{!editing}" id="luckyMoneyHelpList" class="panel" style="margin-top: 1em; padding: 0; min-height: 30em"> <div style="padding-left: 20px; padding-bottom: 10px;"><a id="add" style="font-size: 1.5em; text-decoration: none; cursor: pointer">新增</a> </div> <ul class="ul" id="list"> <li> <strong class="col-md-2">活动名称</strong> <strong class="col-md-2">开始时间</strong> <strong class="col-md-2">结束时间</strong>  <strong class="col-md-6">操作</strong> </li> <li> <hr width="100%"> </li> <li each="{redpackets}"> <strong class="col-md-2 activity-name" onclick="{parent.edit}">{name}</strong> <strong class="col-md-2">{parent.formatDate(startTime)}</strong> <strong class="col-md-2">{parent.formatDate(endTime)}</strong> <strong class="col-md-6 actionCon"><a href="{__app.settings.app.url + \'/marketing/redpacket/redpacket?id=\' + _id}" target="_blank">查看</a><a href="{__app.settings.api.url + \'/marketing/redpacket/exportParticipants?id=\' + _id}" target="_blank" >导出</a></strong> </li> </ul> </div> <div if="{editing}" id="addForm" class="panel" style="margin-top: 1em;"> <div style="padding-left: 20px; padding-bottom: 10px;"><a id="return" style="font-size: 1.5em; text-decoration: none; cursor: pointer">返回</a></div> <ul class="ul" style="text-align: left; padding-left: 2em"> <li><span>红包助力活动设置</span></li> <li><span>活动名称: </span><input name="redpacketActivityName" id="activityName" type="text" value="{redpacket.name}"></li> <li class="bgImg" style="min-height: 26px"><span style="float: left">背景图片(3张): </span><input id="bgImg" type="file" multiple="multiple" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="uploadBgImg()" style="width: 60px;"> <div id="bgImg1" if="{redpacket.bgImg[0]}" class="bgImgCon"><i class="glyphicon glyphicon-remove"></i><img riot-src="{redpacket.bgImg[0]}" alt=""></div> <div id="bgImg2" if="{redpacket.bgImg[1]}" class="bgImgCon"><i class="glyphicon glyphicon-remove"></i><img riot-src="{redpacket.bgImg[1]}" alt=""></div> <div id="bgImg3" if="{redpacket.bgImg[2]}" class="bgImgCon"><i class="glyphicon glyphicon-remove"></i><img riot-src="{redpacket.bgImg[2]}" alt=""></div> </li> <li style="clear: both; min-height: 26px"><span style="float: left">分享卡片图片: </span><input id="shareImg" type="file" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="uploadShareImg()" style="width: 60px;"> <div id="shareImg1" if="{redpacket.shareImg}" class="shareImgCon"><i class="glyphicon glyphicon-remove"></i><img riot-src="{redpacket.shareImg}" alt=""></div> </li> <li style="clear: both"><span>活动时间: </span><input id="startTime" type="date" value="{formatDate(redpacket.startTime)}"><span> 至 </span><input id="endTime" type="date" value="{formatDate(redpacket.endTime)}"> </li> <li><span>活动介绍: </span><div id="desc"></div></li> <li><span>活动规则: </span><div id="rule"></div></li> <li><span>分享标题自定义: </span><textarea id="shareTitle" cols="60" rows="1">{redpacket.shareTitle}</textarea></li> <li><span>分享描述自定义: </span><textarea id="shareDesc" cols="60" rows="1">{redpacket.shareDesc}</textarea></li> <li><span>基础红包金额: </span><input id="base_power" type="text" value="{redpacket.base_power}"></li> <li><span>好友助力单次奖励: </span><input id="friend_help_min_power" type="text" value="{redpacket.friend_help_min_power}"><span> 至 </span><input id="friend_help_max_power" type="text" value="{redpacket.friend_help_max_power}"></li> <li><span>好友助力上限人数: </span><input id="friend_help_count_limit" type="text" value="{redpacket.friend_help_count_limit}"></li> <li style="text-align: center; margin-top: 1em"><input class="btn btn-success" type="button" id="submit" value="提交"></li> </ul> </div> </div> </div>  </div> </div>',"redpacket-boss .leftlist {list-style-type: none; text-align: center; font-size: 1.3em} redpacket-boss .ul {list-style-type: none; text-align: center; padding: 0} redpacket-boss .ul li {margin-bottom: 20px;} redpacket-boss .bgImg #bgImg {float: left; margin-left: 10px;} redpacket-boss .bgImg .bgImgCon {margin-left: 10px; display: -webkit-inline-box; position: relative; display: none; border: solid 1px #E8E7E7;} redpacket-boss .bgImgCon i{color: #EC3131; position: absolute; left: 58px; top: 2px; cursor: pointer;} redpacket-boss .bgImgCon div{margin-left: 20px; float: left;} redpacket-boss .bgImgCon img {width: 75px; height: 75px;} redpacket-boss .shareImgCon img {width: 75px; height: 75px;} redpacket-boss #shareImg{float: left; margin-left: 10px;} redpacket-boss .shareImgCon i{color: #EC3131;position: absolute;left: 58px;top: 2px;cursor: pointer;} redpacket-boss .shareImgCon{margin-left: 10px; display: -webkit-inline-box;position: relative; display: none; border: solid 1px #E8E7E7;} redpacket-boss .activity-name{ color: #23527c; cursor: pointer; } redpacket-boss li strong{ padding: 0 !important; margin: 0 !important; } redpacket-boss .actionCon a{ margin-left: 10px; }",function(e){"use strict";this.app=this.opts.app;var t=nest.presentable(this);t.api=__app.settings.api.url,t.tip=!1,t.tipInfo="",t.redpacket={},t.editing=!1;var n=domain.action("loadRedpackets"),i=function(e){t.redpackets=e,t.update()};setTimeout(function(){console.error($("#desc").summernote),console.log($("#desc")),$("#desc").summernote({height:200,minHeight:null,maxHeight:null,focus:!0}),$("#rule").summernote({height:200,minHeight:null,maxHeight:null,focus:!0})},5e3),this.on("mount",function(){n.onDone(i)}),this.on("unmount",function(){n.offDone(i)}),this.on("open",function(e){t.trigger("ready",!1),t.trigger("view-route-to"),n.execute({}),console.info("tag tenants is opening")}),this.on("leave",function(){t.mask=!0,t.update()}),this.on("reenter",function(){t.mask=!1,t.update()}),this.on("refresh",function(){console.info("tag tenants is refreshing")}),t.formatDate=function(e){var t=new Date(e),n=t.getFullYear(),i=t.getMonth()+1>9?t.getMonth()+1:"0"+(t.getMonth()+1),o=t.getDate()>9?t.getDate():"0"+t.getDate();return n+"-"+i+"-"+o},t.edit=function(e){t.update({redpacket:e.item,editing:!0})}}),riot.tag("showimg",'<div class="modal fade" id="showImg"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title">{title || \'图片\'}</h4> </div> <div if="{!errorMsg}" class="modal-body" style="text-align: center"> <img riot-src="{imgUrl}" alt="" id="img" riot-style="height: {height}; width: {width}"> </div> <div if="{errorMsg}" class="modal-body" style="text-align: center"> <span>{errorMsg}</span> </div> </div> </div> </div>',function(e){var t=this;app.on("showImg",function(e){console.log(e),t.update({title:e.title,imgUrl:e.imgUrl,width:e.width,height:e.imgUrl,errorMsg:e.errorMsg})})}),riot.tag("tenant-edit",'<div class="container" if="{!hidden}"> <div class="row"> <div class="col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2" style="text-align: center"><h3>{tenant.name}</h3></div> </div> <alert validators="{validators}" clear="{clear}"></alert> <div class="row" style="margin-top: 30px"> <div class="col-md-6 col-md-offset-3 col-lg-6 col-lg-offset-3"> <div class="row panel-container"> <div class="col-md-3">名称</div> <div class="col-md-9"> <div class="{has-error: !tenantNameInput.value.trim()} has-feedback"> <input type="text" onblur="{onNameBlur}" class="form-control" name="tenantNameInput" value="{tenant.name}" required> </div> </div> <div class="col-md-3">类型</div> <div class="col-md-9"> <div class="btn-group" data-toggle="buttons"> <label onclick="{selectPersonalType}" class="btn btn-default {active: tenant.type == \'p\'}"> <input type="radio" name="orgTypeRadio" autocomplete="off" __checked="{tenant.type == \'p\'}" value="p"> 个人 </label> <label onclick="{selectOrgType}" class="btn btn-default {active: tenant.type == \'o\'}"> <input type="radio" name="orgTypeRadio" autocomplete="off" __checked="{tenant.type == \'o\'}" value="o"> 机构 </label> </div> </div> <div class="col-md-3">状态</div> <div class="col-md-9">{ __app.enums.LifeFlag.values[tenant.lFlg]}</div> <div class="col-md-3">创建时间</div> <div class="col-md-9">{_.date.format(new Date(tenant.crtOn), \'yyyy-MM-dd hh点mm分\')}</div> <div class="col-md-3">备注</div> <div class="col-md-9"><textarea name="tenantDescInput" class="form-control" onblur="{descOnBlur}">{tenant.desc}</textarea></div> </div> </div> </div> <div class="row" style="margin-top: 30px"> <div class="col-md-12 col-lg-12" style="text-align: center"> <input __disabled="{!tenantNameInput.value.trim()}" onclick="{onSubmit}" class="btn btn-primary" type="button" value="保存"> <a href="#tenants/_{tenant._id}" class="btn btn-default">取消</a> </div> </div> </div>',function(e){var t=nest.presentable(this),n=domain.action("loadTenantById"),i=domain.action("updateTenantById"),o=function(e){t.update({tenant:e.tenant}),t.trigger("ready",!1),t.trigger("view-route-to")};t.validators=[],t.on("open",function(e){n.newInvocation({id:e.req.paramList[0]}).onDone(o).execute()}),t.selectPersonalType=function(e){t.tenant.type="p",t.update()},t.selectOrgType=function(e){t.tenant.type="o",t.update()},t.onSubmit=function(){i.newInvocation(t.tenant).onDone(function(){riot.route("tenants/_"+t.tenant._id)}).execute()},t.onNameBlur=function(){var e=t.tenantNameInput.value.trim();return e?void(t.tenant.name=e):t.validators.push({success:!1,field:"名称",desc:"不能为空!"})},t.clear=function(){t.validators=[]},t.descOnBlur=function(){var e=t.tenantDescInput.value.trim();e&&(t.tenant.desc=e)}}),riot.tag("tenant-topbar",'<nav class="navbar navbar-default navbar-inverse" role="navigation" style="margin-bottom: 5px; border-radius: 0;"> <div class="collapse navbar-collapse"> <a class="navbar-brand" style="font-size:20px; color: #ffffff">微节点</a> <ul class="nav navbar-nav" style="width: 88%"> <li class="navbtn"><a id="adlink-index" href="#" route="adlink-index" onclick="{adlinks}">广告位</a></li> <li class="navbtn"><a id="recontent-index" href="#" route="recontent-index" class="myActive" onclick="{recontents}">文章</a></li> <li style="float: right;"><a href="#" style="font-size: 1.4em" class="glyphicon glyphicon-off" title="退出" onclick="{logout}"></a></li> <li style="float: right; margin-right: 20px; padding-top: 5px;"> <img riot-src="{headimgurl}" style="height: 40px; width: 40px" alt=""><span style="margin-left: 10px; color: white">{nickname}</span> </li> </ul> </div> </nav>',".navbtn{padding-left: 20px; font-size:16px} .myActive{color: #ffffff !important; border:0; outline: none !important;}",function(e){this.headimgurl=__page.user.headimgurl,this.nickname=__page.user.nickname,this.tenantId=this.opts.tenant,this.on("mount",function(){window.location.hash&&($(".navbtn a").removeClass("myActive"),$(window.location.hash).addClass("myActive"))}),this.logout=function(e){$.get("/logout",function(e){window.location.href="/login"})}.bind(this),this.adlinks=function(e){e.preventUpdate=!0,$(".navbtn a").removeClass("myActive"),$(e.currentTarget).addClass("myActive"),riot.route($(e.currentTarget).attr("route"))}.bind(this),this.recontents=function(e){e.preventUpdate=!0,$(".navbtn a").removeClass("myActive"),$(e.currentTarget).addClass("myActive"),riot.route($(e.currentTarget).attr("route"))}.bind(this)}),riot.tag("tenant",'<div class="container" if="{!hidden}"> <div class="row"> <div class="col-md-6 col-md-offset-3 col-lg-6 col-lg-offset-3" style="position: relative;text-align: center"> <a href="#tenants" style="position: absolute; left: 0px; top: 20px;">返回机构列表</a> <h3>{tenant.name}</h3> </div> </div> <div class="row" style="margin-top: 30px"> <div class="col-md-4 col-md-offset-3 col-lg-4 col-lg-offset-3"> <div class="row panel-container"> <div class="col-md-6">名称</div> <div class="col-md-6">{tenant.name}</div> <div class="col-md-6">类型</div> <div class="col-md-6">{__app.enums.PartyType.values[tenant.type]}</div> <div class="col-md-6">状态</div> <div class="col-md-6">{ __app.enums.LifeFlag.values[tenant.lFlg]}</div> <div class="col-md-6">创建时间</div> <div class="col-md-6">{_.date.format(new Date(tenant.crtOn), \'yyyy-MM-dd hh点mm分\')}</div> <div class="col-md-6">备注</div> <div class="col-md-6">{tenant.desc}</div> </div> </div> </div> <div class="row" style="margin-top: 30px"> <div class="col-md-4 col-md-offset-4 col-lg-4 col-lg-offset-4" style="text-align: center"> <a href="#tenants/edit/_{tenant._id}" class="btn btn-default">修改</a> <input if="{tenant.lFlg != \'a\'}" onclick="{unlockTenant}" class="btn btn-default" data-toggle="modal" data-target="#modal" type="button" value="激活"> <input if="{tenant.lFlg != \'i\'}" onclick="{lockTenant}" class="btn btn-default" data-toggle="modal" data-target="#modal" type="button" value="锁定"> <input if="{tenant.lFlg != \'d\'}" onclick="{delTenant}" class="btn btn-default" data-toggle="modal" data-target="#modal" type="button" value="删除"> </div> </div> <div class="row" style="margin-top: 30px"> <div class="col-md-12 col-lg-12" style="text-align: center"> <a href="/boss/tenant/_{tenant._id}">机构管理</a> </div> </div> </div>',".panel-container >div{ height: 40px; line-height: 40px; }",function(e){var t=nest.presentable(this),n=domain.action("loadTenantById"),i=domain.action("updateTenantById");t.unlockTenant=function(){_.widget.confirm({title:"操作确认?",content:"你确认要“激活”机构吗？",callback:function(){t.tenant.lFlg=__app.enums.LifeFlag.names.Active,i.newInvocation({id:t.tenant._id,lFlg:t.tenant.lFlg}).onDone(function(e){t.update()}).execute()}})},t.lockTenant=function(){_.widget.confirm({title:"操作确认?",content:"你确认要“锁定”机构吗？",callback:function(){t.tenant.lFlg=__app.enums.LifeFlag.names.Inactive,i.newInvocation({id:t.tenant._id,lFlg:t.tenant.lFlg}).onDone(function(e){t.update()}).execute()}})},t.delTenant=function(){_.widget.confirm({title:"操作确认?",content:"你确认要“删除”机构吗？",callback:function(){t.tenant.lFlg=__app.enums.LifeFlag.names.Deleted,i.newInvocation({id:t.tenant._id,lFlg:t.tenant.lFlg}).onDone(function(e){t.update()}).execute()}})},t.on("open",function(e){n.newInvocation({id:e.req.paramList[0]}).onDone(function(e){t.update({tenant:e.tenant}),t.trigger("ready",!1),t.trigger("view-route-to")}).execute()})}),riot.tag("tenants",'<div if="{!hidden}"> <div if="{tip}" class="alert {addClass}" style="margin-top: -5px; float: left; width: 100%; text-align: center; margin-bottom: 0; position: absolute; z-index: 9999"> <strong>{tipInfo}</strong> </div> <div class="container" style="width: 100%; margin-left: 0; margin-right: 0; padding-left: 0; padding-right: 0"> <div class="row"> &nbsp; </div> <div class="row"> <div class="col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2" > <form class="form-inline"> <div class="form-group"> <label for="statusSelect">状态</label> <select id="statusSelect" class="form-control"> <option value="" selected>请选择</option> <option value="{__app.enums.LifeFlag.names.Active}">{__app.enums.LifeFlag.values.a}</option> <option value="{__app.enums.LifeFlag.names.Inactive}">{__app.enums.LifeFlag.values.i}</option> <option value="{__app.enums.LifeFlag.names.Deleted}">{__app.enums.LifeFlag.values.d}</option> </select> </div> <button onclick="{queryTenantsByFilter}" class="btn btn-primary">查询</button> </form> <table class="table table-striped"> <thead> <tr> <th>名称</th> <th>类型</th> <th>状态</th> <th>创建时间</th> <th>备注</th> </tr> </thead> <tbody> <tr each="{tenants}"> <td> <a href="#tenants/_{_id}"> {name} </a> </td> <td> { __app.enums.PartyType.values[type] } </td> <td> { __app.enums.LifeFlag.values[lFlg] } </td> <td> {_.date.format(new Date(crtOn), \'yyyy-MM-dd hh点mm分\')} </td> <td> { desc } </td> </tr> </tbody> </table> </div> </div> </div> </div>',function(e){"use strict";this.app=this.opts.app;var t=nest.presentable(this);t.api=__app.settings.api.url,t.tip=!1,t.tipInfo="";var n=domain.action("findTenants"),i=function(e){var n=e.tenants;n=n.filter(function(e){return"a"===e.lFlg}).concat(n.filter(function(e){return"i"===e.lFlg})).concat(n.filter(function(e){return"d"===e.lFlg})),t.update({tenants:n})};t.queryTenantsByFilter=function(e){var i={};t.statusSelect.value&&(i.lFlg=t.statusSelect.value),n.execute(i)},this.on("mount",function(){n.onDone(i)}),this.on("unmount",function(){n.offDone(i)}),this.on("open",function(e){t.trigger("ready",!1),t.trigger("view-route-to"),n.execute({}),console.info("tag tenants is opening")})}),riot.tag("top-menu",'<nav class="navbar navbar-default navbar-inverse" role="navigation" style="margin-bottom: 5px; border-radius: 0;"> <div class="collapse navbar-collapse"> <a class="navbar-brand" style="font-size: 1.6em;color: white">微节点</a> <ul class="nav navbar-nav" style="width: 88%"> <li class="navbtn"><a id="overview" href="#" route="overview" class="myActive" onclick="{overview}">首页</a></li> <li class="navbtn"><a id="broadcast" href="#" route="broadcast" class="" onclick="{broadcast}">群发</a></li> <li class="navbtn"><a id="contacts" href="#" route="contacts" onclick="{contacts}">联系人</a></li> <li class="navbtn"><a id="group" href="#" route="group" onclick="{group}">群组</a></li> <li style="float: right;"><a href="#" style="font-size: 1.4em" class="glyphicon glyphicon-off" title="退出" onclick="{logout}"></a></li> <li style="float: right; margin-right: 20px; padding-top: 5px;"> <img riot-src="{headimgurl}" style="height: 40px; width: 40px" alt=""><span style="margin-left: 10px; color: white">{nickname}</span> </li> </ul> </div> </nav>',"top-menu .navbtn{padding-left: 3em; font-size:1.2em} top-menu .myActive{color: #ffffff !important; border:0; outline:none !important;}",function(e){this.headimgurl=__page.user.headimgurl,this.nickname=__page.user.nickname,this.on("mount",function(){window.location.hash&&($(".navbtn a").removeClass("myActive"),$(window.location.hash).addClass("myActive"))}),this.logout=function(e){$.get("/logout",function(e){window.location.href="/login"})}.bind(this),this.overview=function(e){e.preventUpdate=!0,$(".navbtn a").removeClass("myActive"),$(e.currentTarget).addClass("myActive"),riot.route($(e.currentTarget).attr("route"))}.bind(this),this.broadcast=function(e){e.preventUpdate=!0,$(".navbtn a").removeClass("myActive"),$(e.currentTarget).addClass("myActive"),riot.route($(e.currentTarget).attr("route"))}.bind(this),this.group=function(e){e.preventUpdate=!0,$(".navbtn a").removeClass("myActive"),$(e.currentTarget).addClass("myActive"),riot.route($(e.currentTarget).attr("route"))}.bind(this),this.contacts=function(e){e.preventUpdate=!0,$(".navbtn a").removeClass("myActive"),$(e.currentTarget).addClass("myActive"),riot.route($(e.currentTarget).attr("route"))}.bind(this)}),riot.tag("view-group",'<div class="title_wrap"> <ul onclick="{clickNav}" class="nav nav-tabs" style="color: #3E3D3D"> <li role="presentation" class="{active: nav===0}"><a href="#">基本信息</a></li> <li role="presentation" class="{active: nav===1}"><a href="#">成员</a></li> </ul> </div> <div if="{nav===0}" class="profile"> <div class="profile_item row-fluid"> <div class="primary col-md-6 col-xs-6 col-sm-6"> <label>名称</label> </div> <div class="primary col-md-6 col-xs-6 col-sm-6"> <div if="{viewModel.mode === \'view\'}"> <label>{parent.group.name}</label>&nbsp&nbsp <span onclick="{editGroupName}" style="color:#45cc10;font-size:16px;" class="glyphicon glyphicon-edit" aria-hidden="true"></span> </div> <form if="{viewModel.mode===\'edit\'}" class="form-inline"> <input onblur="{checkGroupName}" class="form-control" name="groupName" type="text" value="{parent.group.name}" style="width:100px"> <button onclick="{submitGroupName}" type="button" class="btn btn-default" style="background: #18c54b;border:none"> <span class="glyphicon glyphicon-ok" style="color:white" aria-hidden="true"></span> </button> </form> </div> </div> <div class="profile_item row-fluid"> <div class="secondary col-md-6 col-xs-6 col-sm-6"> <label>类型</label> </div> <div class="secondary col-md-6 col-xs-6 col-sm-6"> <label>{__app.enums.GroupType.values[parent.group.type]}</label> </div> </div> <div class="profile_item row-fluid"> <div class="secondary col-md-6 col-xs-6 col-sm-6"> <label>范围</label> </div> <div class="secondary col-md-6 col-xs-6 col-sm-6"> <label>{__app.enums.GroupScope.values[parent.group.scope]}</label> </div> </div> <div class="profile_item row-fluid"> <div class="secondary col-md-6 col-xs-6 col-sm-6"> <label>包含微信号</label> </div> <div class="secondary col-md-6 col-xs-6 col-sm-6"> <button each="{parent.group.medias}" onclick="{backToView}" type="button" class="btn btn-default" style="display:inline-block;background: #CCC; color:white; border: none"> {name} </button> </div> </div> <div class="profile_item row-fluid"> <div class="secondary col-md-6 col-xs-6 col-sm-6"> <label>负责人</label> </div> <div class="secondary col-md-6 col-xs-6 col-sm-6"> <label>{parent.group.operator.remark}</label> </div> </div> <div class="profile_item"> <button onclick="{delGroup}" type="button" class="btn btn-default" style="height:40px;width:160px;background: #903D3D; color:white; border: none"> <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> 删除该组 </button> </div> </div> <div if="{nav===1}"> <div class="wrapper"> <div style="margin-bottom: 10px; overflow: hidden"> <span>共 ( <strong style="color:#65cc2b">{parent.groupMembers.length}</strong> ) 人</span> <button onclick="{selectContact}" class="{select_contact: status[\'contact\']}"> <span class="glyphicon glyphicon-user" aria-hidden="true"></span> 联系人 </button> <button onclick="{selectGroup}" class="{select_contact: status[\'group\']}"> <span class="glyphicon glyphicon-th" aria-hidden="true"></span> 群组 </button> <div style="float:right"> <button if="{currentStatus === \'view\'}" onclick="{addMember}" style="background: #52B918; color:white" type="button" class="btn" aria-label="Left Align"> <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> 添加成员 </button> <button if="{currentStatus === \'view\'}" onclick="{editMember}" style="background: #e35a51; color:white" type="button" class="btn" aria-label="Align Right"> <span class="glyphicon glyphicon-minus" aria-hidden="true"></span> 移除成员 </button> <button if="{currentStatus === \'edit\'}" onclick="{delMember}" class="{btn: true, btn_enabled: members && Object.keys(members).length>0, btn_disable: !members || Object.keys(members).length===0}" style="color:white" type="button" aria-label="Align Right"> <span class="glyphicon glyphicon-trash" aria-hidden="true"></span> 完成 </button> <button if="{currentStatus === \'edit\'}" onclick="{cancelDelMember}" style="background: #B1B1B1; color:white" type="button" class="btn" aria-label="Align Right"> <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> 取消 </button> </div> </div> <div class="list_container"> <ul class="user_list" > <li onclick="{parent.selectMember}" each="{parent.groupMembers}" if="{parent.status[member.contacttype]}" remark="{member.remark}" mid="{member._id}"> <img class="{img_sel: parent.currentStatus === \'edit\'}" riot-src="{parent.app.settings.api.url + \'/file?media_id=\' + member.headimgurl}"> <p style="overflow: hidden;height:24px">{member.remark}</p> </li> </ul> </div> </div> </div>',"view-group input,view-group textarea{ outline:none; } view-group .select_contact{ background: #5B6779; border:1px solid #2E3238; color:white; } view-group .profile_item .primary:nth-child(1){ padding-left:25% } view-group .profile_item .primary:nth-child(2){ padding-left:15% } view-group .profile_item .secondary:nth-child(1){ padding-left:25% } view-group .profile_item .secondary:nth-child(2){ padding-left:15% } view-group .list_container{ overflow: scroll; height:500px; } view-group .img_sel{ opacity: 0.4; } view-group .wrapper{ width:90%; margin:0px auto; } view-group .user_list{ overflow: hidden; list-style-type: none; margin:0px; padding:0px; color:#888; } view-group .user_list >li{ width:100px; float:left; margin:5px 0px; text-align: center; line-height: 30px; position: relative; } view-group .user_list >li img{ display: inline-block; width:64px; height:64px; } view-group .profile{ padding-top:30px; margin:0px auto; width:80% } view-group .profile_item{ margin: 0px auto; text-align: center; margin-bottom: 30px; overflow: hidden; } view-group .profile_item div.secondary label{ font-size: 16px; } view-group .profile_item >div:first-child{ text-align: left; } view-group .profile_item >div:nth-child(2){ text-align: left; } view-group .profile_item label{ font-weight:400; font-size: 24px; } view-group .select{ position: absolute; top:0px; left:17px; background:#42AC3E; width:64px; height:64px; opacity: 0.8; } view-group .select div{ font-size: 40px; color:white; margin:8px; } view-group .title_wrap{ height:50px; margin:8px 10px; } view-group .btn_disable{ background: #B1B1B1; } view-group .btn_enabled{ background: #e35a51; }",function(e){function t(e){r.parent.panel.status="add_m",r.parent.mediaUsers=e.users,r.parent.tags["add-group-member"].init(),r.parent.update()}function n(e){e.success||alert("删除失败"),e.deprecateMembers.forEach(function(e){var t=r.parent.groupMembers.map(function(e){return e._id}),n=t.indexOf(e._id);return n>=0?r.parent.groupMembers.splice(n,1):void 0}),r.currentStatus=u.VIEW,r.members={},r.parent.update()}function i(e){r.parent.groups.forEach(function(e,t){e._id===r.parent.group._id&&r.parent.groups.splice(t,1)}),r.parent.panel.start(),r.parent.update()}function o(e){e.success&&(r.parent.group.name=e.group.name,r.parent.groups.forEach(function(t){t._id===e.group._id&&(t.name=e.group.name)}),r.parent.panel.view(),r.parent.update())}var r=this,a=domain.action("loadAllGroupMediaUsers"),s=domain.action("editGroup"),l=domain.action("delGroup"),c=domain.action("delGroupMember"),d={"基本信息":0,"成员":1},u={VIEW:"view",EDIT:"edit"};r.page=__page,r.app=__app,r.viewModel={},r.status={},r.init=function(){r.currentStatus=u.VIEW,r.members={},r.nav=0,r.viewModel.mode="view",r.status={},r.status.contact="contact"},r.init(),this.on("mount",function(){l.onDone(i),c.onDone(n),s.onDone(o),a.onDone(t)}),this.on("unmount",function(){l.offDone(i),c.offDone(n),s.offDone(o),a.offDone(t)}),this.selectContact=function(e){return r.status.contact?void delete r.status.contact:void(r.status.contact="contact")}.bind(this),this.selectGroup=function(e){return r.status.group?void delete r.status.group:void(r.status.group="group")}.bind(this),this.clickNav=function(e){r.nav=d[e.target.innerText]}.bind(this),this.addMember=function(e){var t=r.parent.group.medias,n=r.parent.group._id;a.execute({medias:t,groupId:n})}.bind(this),this.delGroup=function(e){l.execute({groupId:r.parent.group._id})}.bind(this),this.editMember=function(e){r.currentStatus=u.EDIT}.bind(this),this.delMember=function(e){Object.keys(r.members).length&&([].forEach.call(document.querySelectorAll("ul.user_list >li"),function(e){e.removeChild(e.childNodes[e.childNodes.length-1])}),c.execute({groupId:r.parent.group._id,mids:JSON.stringify(Object.keys(r.members))}))}.bind(this),this.submitGroupName=function(e){var t=r.groupName.value.trim();return""===t?void alert("请输入名称"):void s.execute({id:r.parent.group._id,name:t})}.bind(this),this.cancelDelMember=function(e){r.members={},[].forEach.call(document.querySelectorAll("ul.user_list >li >div.select"),function(e){e.parentNode.removeChild(e)}),r.currentStatus=u.VIEW}.bind(this),this.checkGroupName=function(e){var t=r.groupName.value;""===t.trim()?(e.target.parentNode.classList.add("has-error"),e.target.focus()):e.target.parentNode.classList.remove("has-error")}.bind(this),this.editGroupName=function(e){r.viewModel.mode="edit",r.groupName.focus()}.bind(this),this.selectMember=function(e){function t(e){r.members[s]?(i(e),delete r.members[s]):(r.members[s]=a,n(e))}function n(e){var t=document.createElement("div");t.classList.add("select");var n=document.createElement("div");n.classList.add("glyphicon"),n.classList.add("glyphicon-ok"),t.appendChild(n),e.appendChild(t)}function i(e){e.removeChild(e.childNodes[e.childNodes.length-1])}if(r.currentStatus==u.EDIT){var o=e.currentTarget,a=o.getAttribute("remark"),s=o.getAttribute("mid");t(o),r.update()}}.bind(this)})}},function(e,t,n){var i=n(4);i=n(6),util=n(7);n(8);riot=n(1),nest=n(9),$=jQuery=i,n(10),domain=n(11),n(24),n(25);var o={init:function(){return this}};!function(e){function t(e){util.forbidOperation()}function n(e,t,n){util.removeforbidOperation()}e(document).ajaxStart(t).ajaxComplete(n),e(window).resize(function(){}),e(".img_home").click(function(){e(".home_gy").removeClass("home_gy_set1"),e(".home_gy").addClass("home_gy_set")}),e(".home_close").click(function(){e(".home_gy").removeClass("home_gy_set"),e(".home_gy").addClass("home_gy_set1")}),window.newActivity={},window.revokedActivity={},riot.observable(window.newActivity),riot.observable(window.revokedActivity)}(i),e.exports=o},function(e,t,n){var i;!function(t,n){"object"==typeof e&&"object"==typeof e.exports?e.exports=t.document?n(t,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return n(e)}:n(t)}("undefined"!=typeof window?window:this,function(o,r){function a(e){var t=e.length,n=ie.type(e);return"function"===n||ie.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e}function s(e,t,n){if(ie.isFunction(t))return ie.grep(e,function(e,i){return!!t.call(e,i,e)!==n});if(t.nodeType)return ie.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(ue.test(t))return ie.filter(t,e,n);t=ie.filter(t,e)}return ie.grep(e,function(e){return Y.call(t,e)>=0!==n})}function l(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function c(e){var t=be[e]={};return ie.each(e.match(ve)||[],function(e,n){t[n]=!0}),t}function d(){te.removeEventListener("DOMContentLoaded",d,!1),
o.removeEventListener("load",d,!1),ie.ready()}function u(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=ie.expando+u.uid++}function p(e,t,n){var i;if(void 0===n&&1===e.nodeType)if(i="data-"+t.replace(Te,"-$1").toLowerCase(),n=e.getAttribute(i),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:Ce.test(n)?ie.parseJSON(n):n}catch(o){}ke.set(e,t,n)}else n=void 0;return n}function f(){return!0}function h(){return!1}function m(){try{return te.activeElement}catch(e){}}function g(e,t){return ie.nodeName(e,"table")&&ie.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function v(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function b(e){var t=Be.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function y(e,t){for(var n=0,i=e.length;i>n;n++)xe.set(e[n],"globalEval",!t||xe.get(t[n],"globalEval"))}function w(e,t){var n,i,o,r,a,s,l,c;if(1===t.nodeType){if(xe.hasData(e)&&(r=xe.access(e),a=xe.set(t,r),c=r.events)){delete a.handle,a.events={};for(o in c)for(n=0,i=c[o].length;i>n;n++)ie.event.add(t,o,c[o][n])}ke.hasData(e)&&(s=ke.access(e),l=ie.extend({},s),ke.set(t,l))}}function x(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&ie.nodeName(e,t)?ie.merge([e],n):n}function k(e,t){var n=t.nodeName.toLowerCase();"input"===n&&Le.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}function C(e,t){var n,i=ie(t.createElement(e)).appendTo(t.body),r=o.getDefaultComputedStyle&&(n=o.getDefaultComputedStyle(i[0]))?n.display:ie.css(i[0],"display");return i.detach(),r}function T(e){var t=te,n=Ue[e];return n||(n=C(e,t),"none"!==n&&n||(We=(We||ie("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=We[0].contentDocument,t.write(),t.close(),n=C(e,t),We.detach()),Ue[e]=n),n}function _(e,t,n){var i,o,r,a,s=e.style;return n=n||Ge(e),n&&(a=n.getPropertyValue(t)||n[t]),n&&(""!==a||ie.contains(e.ownerDocument,e)||(a=ie.style(e,t)),Ve.test(a)&&qe.test(t)&&(i=s.width,o=s.minWidth,r=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=i,s.minWidth=o,s.maxWidth=r)),void 0!==a?a+"":a}function S(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function I(e,t){if(t in e)return t;for(var n=t[0].toUpperCase()+t.slice(1),i=t,o=Ze.length;o--;)if(t=Ze[o]+n,t in e)return t;return i}function L(e,t,n){var i=Xe.exec(t);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):t}function D(e,t,n,i,o){for(var r=n===(i?"border":"content")?4:"width"===t?1:0,a=0;4>r;r+=2)"margin"===n&&(a+=ie.css(e,n+Se[r],!0,o)),i?("content"===n&&(a-=ie.css(e,"padding"+Se[r],!0,o)),"margin"!==n&&(a-=ie.css(e,"border"+Se[r]+"Width",!0,o))):(a+=ie.css(e,"padding"+Se[r],!0,o),"padding"!==n&&(a+=ie.css(e,"border"+Se[r]+"Width",!0,o)));return a}function N(e,t,n){var i=!0,o="width"===t?e.offsetWidth:e.offsetHeight,r=Ge(e),a="border-box"===ie.css(e,"boxSizing",!1,r);if(0>=o||null==o){if(o=_(e,t,r),(0>o||null==o)&&(o=e.style[t]),Ve.test(o))return o;i=a&&(ee.boxSizingReliable()||o===e.style[t]),o=parseFloat(o)||0}return o+D(e,t,n||(a?"border":"content"),i,r)+"px"}function E(e,t){for(var n,i,o,r=[],a=0,s=e.length;s>a;a++)i=e[a],i.style&&(r[a]=xe.get(i,"olddisplay"),n=i.style.display,t?(r[a]||"none"!==n||(i.style.display=""),""===i.style.display&&Ie(i)&&(r[a]=xe.access(i,"olddisplay",T(i.nodeName)))):(o=Ie(i),"none"===n&&o||xe.set(i,"olddisplay",o?n:ie.css(i,"display"))));for(a=0;s>a;a++)i=e[a],i.style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?r[a]||"":"none"));return e}function A(e,t,n,i,o){return new A.prototype.init(e,t,n,i,o)}function M(){return setTimeout(function(){et=void 0}),et=ie.now()}function P(e,t){var n,i=0,o={height:e};for(t=t?1:0;4>i;i+=2-t)n=Se[i],o["margin"+n]=o["padding"+n]=e;return t&&(o.opacity=o.width=e),o}function O(e,t,n){for(var i,o=(at[t]||[]).concat(at["*"]),r=0,a=o.length;a>r;r++)if(i=o[r].call(n,t,e))return i}function F(e,t,n){var i,o,r,a,s,l,c,d,u=this,p={},f=e.style,h=e.nodeType&&Ie(e),m=xe.get(e,"fxshow");n.queue||(s=ie._queueHooks(e,"fx"),null==s.unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,u.always(function(){u.always(function(){s.unqueued--,ie.queue(e,"fx").length||s.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],c=ie.css(e,"display"),d="none"===c?xe.get(e,"olddisplay")||T(e.nodeName):c,"inline"===d&&"none"===ie.css(e,"float")&&(f.display="inline-block")),n.overflow&&(f.overflow="hidden",u.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}));for(i in t)if(o=t[i],nt.exec(o)){if(delete t[i],r=r||"toggle"===o,o===(h?"hide":"show")){if("show"!==o||!m||void 0===m[i])continue;h=!0}p[i]=m&&m[i]||ie.style(e,i)}else c=void 0;if(ie.isEmptyObject(p))"inline"===("none"===c?T(e.nodeName):c)&&(f.display=c);else{m?"hidden"in m&&(h=m.hidden):m=xe.access(e,"fxshow",{}),r&&(m.hidden=!h),h?ie(e).show():u.done(function(){ie(e).hide()}),u.done(function(){var t;xe.remove(e,"fxshow");for(t in p)ie.style(e,t,p[t])});for(i in p)a=O(h?m[i]:0,i,u),i in m||(m[i]=a.start,h&&(a.end=a.start,a.start="width"===i||"height"===i?1:0))}}function H(e,t){var n,i,o,r,a;for(n in e)if(i=ie.camelCase(n),o=t[i],r=e[n],ie.isArray(r)&&(o=r[1],r=e[n]=r[0]),n!==i&&(e[i]=r,delete e[n]),a=ie.cssHooks[i],a&&"expand"in a){r=a.expand(r),delete e[i];for(n in r)n in e||(e[n]=r[n],t[n]=o)}else t[i]=o}function R(e,t,n){var i,o,r=0,a=rt.length,s=ie.Deferred().always(function(){delete l.elem}),l=function(){if(o)return!1;for(var t=et||M(),n=Math.max(0,c.startTime+c.duration-t),i=n/c.duration||0,r=1-i,a=0,l=c.tweens.length;l>a;a++)c.tweens[a].run(r);return s.notifyWith(e,[c,r,n]),1>r&&l?n:(s.resolveWith(e,[c]),!1)},c=s.promise({elem:e,props:ie.extend({},t),opts:ie.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:et||M(),duration:n.duration,tweens:[],createTween:function(t,n){var i=ie.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(i),i},stop:function(t){var n=0,i=t?c.tweens.length:0;if(o)return this;for(o=!0;i>n;n++)c.tweens[n].run(1);return t?s.resolveWith(e,[c,t]):s.rejectWith(e,[c,t]),this}}),d=c.props;for(H(d,c.opts.specialEasing);a>r;r++)if(i=rt[r].call(c,e,d,c.opts))return i;return ie.map(d,O,c),ie.isFunction(c.opts.start)&&c.opts.start.call(e,c),ie.fx.timer(ie.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function $(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,o=0,r=t.toLowerCase().match(ve)||[];if(ie.isFunction(n))for(;i=r[o++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function B(e,t,n,i){function o(s){var l;return r[s]=!0,ie.each(e[s]||[],function(e,s){var c=s(t,n,i);return"string"!=typeof c||a||r[c]?a?!(l=c):void 0:(t.dataTypes.unshift(c),o(c),!1)}),l}var r={},a=e===Ct;return o(t.dataTypes[0])||!r["*"]&&o("*")}function z(e,t){var n,i,o=ie.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((o[n]?e:i||(i={}))[n]=t[n]);return i&&ie.extend(!0,e,i),e}function j(e,t,n){for(var i,o,r,a,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(o in s)if(s[o]&&s[o].test(i)){l.unshift(o);break}if(l[0]in n)r=l[0];else{for(o in n){if(!l[0]||e.converters[o+" "+l[0]]){r=o;break}a||(a=o)}r=r||a}return r?(r!==l[0]&&l.unshift(r),n[r]):void 0}function W(e,t,n,i){var o,r,a,s,l,c={},d=e.dataTypes.slice();if(d[1])for(a in e.converters)c[a.toLowerCase()]=e.converters[a];for(r=d.shift();r;)if(e.responseFields[r]&&(n[e.responseFields[r]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=r,r=d.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(a=c[l+" "+r]||c["* "+r],!a)for(o in c)if(s=o.split(" "),s[1]===r&&(a=c[l+" "+s[0]]||c["* "+s[0]])){a===!0?a=c[o]:c[o]!==!0&&(r=s[0],d.unshift(s[1]));break}if(a!==!0)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(u){return{state:"parsererror",error:a?u:"No conversion from "+l+" to "+r}}}return{state:"success",data:t}}function U(e,t,n,i){var o;if(ie.isArray(t))ie.each(t,function(t,o){n||Lt.test(e)?i(e,o):U(e+"["+("object"==typeof o?t:"")+"]",o,n,i)});else if(n||"object"!==ie.type(t))i(e,t);else for(o in t)U(e+"["+o+"]",t[o],n,i)}function q(e){return ie.isWindow(e)?e:9===e.nodeType&&e.defaultView}var V=[],G=V.slice,K=V.concat,X=V.push,Y=V.indexOf,Q={},J=Q.toString,Z=Q.hasOwnProperty,ee={},te=o.document,ne="2.1.3",ie=function(e,t){return new ie.fn.init(e,t)},oe=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,re=/^-ms-/,ae=/-([\da-z])/gi,se=function(e,t){return t.toUpperCase()};ie.fn=ie.prototype={jquery:ne,constructor:ie,selector:"",length:0,toArray:function(){return G.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:G.call(this)},pushStack:function(e){var t=ie.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return ie.each(this,e,t)},map:function(e){return this.pushStack(ie.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(G.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:X,sort:V.sort,splice:V.splice},ie.extend=ie.fn.extend=function(){var e,t,n,i,o,r,a=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[s]||{},s++),"object"==typeof a||ie.isFunction(a)||(a={}),s===l&&(a=this,s--);l>s;s++)if(null!=(e=arguments[s]))for(t in e)n=a[t],i=e[t],a!==i&&(c&&i&&(ie.isPlainObject(i)||(o=ie.isArray(i)))?(o?(o=!1,r=n&&ie.isArray(n)?n:[]):r=n&&ie.isPlainObject(n)?n:{},a[t]=ie.extend(c,r,i)):void 0!==i&&(a[t]=i));return a},ie.extend({expando:"jQuery"+(ne+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===ie.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!ie.isArray(e)&&e-parseFloat(e)+1>=0},isPlainObject:function(e){return"object"!==ie.type(e)||e.nodeType||ie.isWindow(e)?!1:!e.constructor||Z.call(e.constructor.prototype,"isPrototypeOf")},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?Q[J.call(e)]||"object":typeof e},globalEval:function(e){var t,n=eval;e=ie.trim(e),e&&(1===e.indexOf("use strict")?(t=te.createElement("script"),t.text=e,te.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(re,"ms-").replace(ae,se)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var i,o=0,r=e.length,s=a(e);if(n){if(s)for(;r>o&&(i=t.apply(e[o],n),i!==!1);o++);else for(o in e)if(i=t.apply(e[o],n),i===!1)break}else if(s)for(;r>o&&(i=t.call(e[o],o,e[o]),i!==!1);o++);else for(o in e)if(i=t.call(e[o],o,e[o]),i===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(oe,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(a(Object(e))?ie.merge(n,"string"==typeof e?[e]:e):X.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:Y.call(t,e,n)},merge:function(e,t){for(var n=+t.length,i=0,o=e.length;n>i;i++)e[o++]=t[i];return e.length=o,e},grep:function(e,t,n){for(var i,o=[],r=0,a=e.length,s=!n;a>r;r++)i=!t(e[r],r),i!==s&&o.push(e[r]);return o},map:function(e,t,n){var i,o=0,r=e.length,s=a(e),l=[];if(s)for(;r>o;o++)i=t(e[o],o,n),null!=i&&l.push(i);else for(o in e)i=t(e[o],o,n),null!=i&&l.push(i);return K.apply([],l)},guid:1,proxy:function(e,t){var n,i,o;return"string"==typeof t&&(n=e[t],t=e,e=n),ie.isFunction(e)?(i=G.call(arguments,2),o=function(){return e.apply(t||this,i.concat(G.call(arguments)))},o.guid=e.guid=e.guid||ie.guid++,o):void 0},now:Date.now,support:ee}),ie.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){Q["[object "+t+"]"]=t.toLowerCase()});var le=function(e){function t(e,t,n,i){var o,r,a,s,l,c,u,f,h,m;if((t?t.ownerDocument||t:B)!==A&&E(t),t=t||A,n=n||[],s=t.nodeType,"string"!=typeof e||!e||1!==s&&9!==s&&11!==s)return n;if(!i&&P){if(11!==s&&(o=be.exec(e)))if(a=o[1]){if(9===s){if(r=t.getElementById(a),!r||!r.parentNode)return n;if(r.id===a)return n.push(r),n}else if(t.ownerDocument&&(r=t.ownerDocument.getElementById(a))&&R(t,r)&&r.id===a)return n.push(r),n}else{if(o[2])return J.apply(n,t.getElementsByTagName(e)),n;if((a=o[3])&&x.getElementsByClassName)return J.apply(n,t.getElementsByClassName(a)),n}if(x.qsa&&(!O||!O.test(e))){if(f=u=$,h=t,m=1!==s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(c=_(e),(u=t.getAttribute("id"))?f=u.replace(we,"\\$&"):t.setAttribute("id",f),f="[id='"+f+"'] ",l=c.length;l--;)c[l]=f+p(c[l]);h=ye.test(e)&&d(t.parentNode)||t,m=c.join(",")}if(m)try{return J.apply(n,h.querySelectorAll(m)),n}catch(g){}finally{u||t.removeAttribute("id")}}}return I(e.replace(le,"$1"),t,n,i)}function n(){function e(n,i){return t.push(n+" ")>k.cacheLength&&delete e[t.shift()],e[n+" "]=i}var t=[];return e}function i(e){return e[$]=!0,e}function o(e){var t=A.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function r(e,t){for(var n=e.split("|"),i=e.length;i--;)k.attrHandle[n[i]]=t}function a(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||G)-(~e.sourceIndex||G);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function s(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function l(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function c(e){return i(function(t){return t=+t,i(function(n,i){for(var o,r=e([],n.length,t),a=r.length;a--;)n[o=r[a]]&&(n[o]=!(i[o]=n[o]))})})}function d(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function u(){}function p(e){for(var t=0,n=e.length,i="";n>t;t++)i+=e[t].value;return i}function f(e,t,n){var i=t.dir,o=n&&"parentNode"===i,r=j++;return t.first?function(t,n,r){for(;t=t[i];)if(1===t.nodeType||o)return e(t,n,r)}:function(t,n,a){var s,l,c=[z,r];if(a){for(;t=t[i];)if((1===t.nodeType||o)&&e(t,n,a))return!0}else for(;t=t[i];)if(1===t.nodeType||o){if(l=t[$]||(t[$]={}),(s=l[i])&&s[0]===z&&s[1]===r)return c[2]=s[2];if(l[i]=c,c[2]=e(t,n,a))return!0}}}function h(e){return e.length>1?function(t,n,i){for(var o=e.length;o--;)if(!e[o](t,n,i))return!1;return!0}:e[0]}function m(e,n,i){for(var o=0,r=n.length;r>o;o++)t(e,n[o],i);return i}function g(e,t,n,i,o){for(var r,a=[],s=0,l=e.length,c=null!=t;l>s;s++)(r=e[s])&&(!n||n(r,i,o))&&(a.push(r),c&&t.push(s));return a}function v(e,t,n,o,r,a){return o&&!o[$]&&(o=v(o)),r&&!r[$]&&(r=v(r,a)),i(function(i,a,s,l){var c,d,u,p=[],f=[],h=a.length,v=i||m(t||"*",s.nodeType?[s]:s,[]),b=!e||!i&&t?v:g(v,p,e,s,l),y=n?r||(i?e:h||o)?[]:a:b;if(n&&n(b,y,s,l),o)for(c=g(y,f),o(c,[],s,l),d=c.length;d--;)(u=c[d])&&(y[f[d]]=!(b[f[d]]=u));if(i){if(r||e){if(r){for(c=[],d=y.length;d--;)(u=y[d])&&c.push(b[d]=u);r(null,y=[],c,l)}for(d=y.length;d--;)(u=y[d])&&(c=r?ee(i,u):p[d])>-1&&(i[c]=!(a[c]=u))}}else y=g(y===a?y.splice(h,y.length):y),r?r(null,a,y,l):J.apply(a,y)})}function b(e){for(var t,n,i,o=e.length,r=k.relative[e[0].type],a=r||k.relative[" "],s=r?1:0,l=f(function(e){return e===t},a,!0),c=f(function(e){return ee(t,e)>-1},a,!0),d=[function(e,n,i){var o=!r&&(i||n!==L)||((t=n).nodeType?l(e,n,i):c(e,n,i));return t=null,o}];o>s;s++)if(n=k.relative[e[s].type])d=[f(h(d),n)];else{if(n=k.filter[e[s].type].apply(null,e[s].matches),n[$]){for(i=++s;o>i&&!k.relative[e[i].type];i++);return v(s>1&&h(d),s>1&&p(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(le,"$1"),n,i>s&&b(e.slice(s,i)),o>i&&b(e=e.slice(i)),o>i&&p(e))}d.push(n)}return h(d)}function y(e,n){var o=n.length>0,r=e.length>0,a=function(i,a,s,l,c){var d,u,p,f=0,h="0",m=i&&[],v=[],b=L,y=i||r&&k.find.TAG("*",c),w=z+=null==b?1:Math.random()||.1,x=y.length;for(c&&(L=a!==A&&a);h!==x&&null!=(d=y[h]);h++){if(r&&d){for(u=0;p=e[u++];)if(p(d,a,s)){l.push(d);break}c&&(z=w)}o&&((d=!p&&d)&&f--,i&&m.push(d))}if(f+=h,o&&h!==f){for(u=0;p=n[u++];)p(m,v,a,s);if(i){if(f>0)for(;h--;)m[h]||v[h]||(v[h]=Y.call(l));v=g(v)}J.apply(l,v),c&&!i&&v.length>0&&f+n.length>1&&t.uniqueSort(l)}return c&&(z=w,L=b),m};return o?i(a):a}var w,x,k,C,T,_,S,I,L,D,N,E,A,M,P,O,F,H,R,$="sizzle"+1*new Date,B=e.document,z=0,j=0,W=n(),U=n(),q=n(),V=function(e,t){return e===t&&(N=!0),0},G=1<<31,K={}.hasOwnProperty,X=[],Y=X.pop,Q=X.push,J=X.push,Z=X.slice,ee=function(e,t){for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return n;return-1},te="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ne="[\\x20\\t\\r\\n\\f]",ie="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",oe=ie.replace("w","w#"),re="\\["+ne+"*("+ie+")(?:"+ne+"*([*^$|!~]?=)"+ne+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+oe+"))|)"+ne+"*\\]",ae=":("+ie+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+re+")*)|.*)\\)|)",se=new RegExp(ne+"+","g"),le=new RegExp("^"+ne+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ne+"+$","g"),ce=new RegExp("^"+ne+"*,"+ne+"*"),de=new RegExp("^"+ne+"*([>+~]|"+ne+")"+ne+"*"),ue=new RegExp("="+ne+"*([^\\]'\"]*?)"+ne+"*\\]","g"),pe=new RegExp(ae),fe=new RegExp("^"+oe+"$"),he={ID:new RegExp("^#("+ie+")"),CLASS:new RegExp("^\\.("+ie+")"),TAG:new RegExp("^("+ie.replace("w","w*")+")"),ATTR:new RegExp("^"+re),PSEUDO:new RegExp("^"+ae),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ne+"*(even|odd|(([+-]|)(\\d*)n|)"+ne+"*(?:([+-]|)"+ne+"*(\\d+)|))"+ne+"*\\)|)","i"),bool:new RegExp("^(?:"+te+")$","i"),needsContext:new RegExp("^"+ne+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ne+"*((?:-\\d)?\\d*)"+ne+"*\\)|)(?=[^-]|$)","i")},me=/^(?:input|select|textarea|button)$/i,ge=/^h\d$/i,ve=/^[^{]+\{\s*\[native \w/,be=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ye=/[+~]/,we=/'|\\/g,xe=new RegExp("\\\\([\\da-f]{1,6}"+ne+"?|("+ne+")|.)","ig"),ke=function(e,t,n){var i="0x"+t-65536;return i!==i||n?t:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},Ce=function(){E()};try{J.apply(X=Z.call(B.childNodes),B.childNodes),X[B.childNodes.length].nodeType}catch(Te){J={apply:X.length?function(e,t){Q.apply(e,Z.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}x=t.support={},T=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},E=t.setDocument=function(e){var t,n,i=e?e.ownerDocument||e:B;return i!==A&&9===i.nodeType&&i.documentElement?(A=i,M=i.documentElement,n=i.defaultView,n&&n!==n.top&&(n.addEventListener?n.addEventListener("unload",Ce,!1):n.attachEvent&&n.attachEvent("onunload",Ce)),P=!T(i),x.attributes=o(function(e){return e.className="i",!e.getAttribute("className")}),x.getElementsByTagName=o(function(e){return e.appendChild(i.createComment("")),!e.getElementsByTagName("*").length}),x.getElementsByClassName=ve.test(i.getElementsByClassName),x.getById=o(function(e){return M.appendChild(e).id=$,!i.getElementsByName||!i.getElementsByName($).length}),x.getById?(k.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&P){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},k.filter.ID=function(e){var t=e.replace(xe,ke);return function(e){return e.getAttribute("id")===t}}):(delete k.find.ID,k.filter.ID=function(e){var t=e.replace(xe,ke);return function(e){var n="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}}),k.find.TAG=x.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):x.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],o=0,r=t.getElementsByTagName(e);if("*"===e){for(;n=r[o++];)1===n.nodeType&&i.push(n);return i}return r},k.find.CLASS=x.getElementsByClassName&&function(e,t){return P?t.getElementsByClassName(e):void 0},F=[],O=[],(x.qsa=ve.test(i.querySelectorAll))&&(o(function(e){M.appendChild(e).innerHTML="<a id='"+$+"'></a><select id='"+$+"-\f]' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&O.push("[*^$]="+ne+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||O.push("\\["+ne+"*(?:value|"+te+")"),e.querySelectorAll("[id~="+$+"-]").length||O.push("~="),e.querySelectorAll(":checked").length||O.push(":checked"),e.querySelectorAll("a#"+$+"+*").length||O.push(".#.+[+~]")}),o(function(e){var t=i.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&O.push("name"+ne+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||O.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),O.push(",.*:")})),(x.matchesSelector=ve.test(H=M.matches||M.webkitMatchesSelector||M.mozMatchesSelector||M.oMatchesSelector||M.msMatchesSelector))&&o(function(e){x.disconnectedMatch=H.call(e,"div"),H.call(e,"[s!='']:x"),F.push("!=",ae)}),O=O.length&&new RegExp(O.join("|")),F=F.length&&new RegExp(F.join("|")),t=ve.test(M.compareDocumentPosition),R=t||ve.test(M.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},V=t?function(e,t){if(e===t)return N=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n?n:(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!x.sortDetached&&t.compareDocumentPosition(e)===n?e===i||e.ownerDocument===B&&R(B,e)?-1:t===i||t.ownerDocument===B&&R(B,t)?1:D?ee(D,e)-ee(D,t):0:4&n?-1:1)}:function(e,t){if(e===t)return N=!0,0;var n,o=0,r=e.parentNode,s=t.parentNode,l=[e],c=[t];if(!r||!s)return e===i?-1:t===i?1:r?-1:s?1:D?ee(D,e)-ee(D,t):0;if(r===s)return a(e,t);for(n=e;n=n.parentNode;)l.unshift(n);for(n=t;n=n.parentNode;)c.unshift(n);for(;l[o]===c[o];)o++;return o?a(l[o],c[o]):l[o]===B?-1:c[o]===B?1:0},i):A},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==A&&E(e),n=n.replace(ue,"='$1']"),!(!x.matchesSelector||!P||F&&F.test(n)||O&&O.test(n)))try{var i=H.call(e,n);if(i||x.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(o){}return t(n,A,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==A&&E(e),R(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==A&&E(e);var n=k.attrHandle[t.toLowerCase()],i=n&&K.call(k.attrHandle,t.toLowerCase())?n(e,t,!P):void 0;return void 0!==i?i:x.attributes||!P?e.getAttribute(t):(i=e.getAttributeNode(t))&&i.specified?i.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],i=0,o=0;if(N=!x.detectDuplicates,D=!x.sortStable&&e.slice(0),e.sort(V),N){for(;t=e[o++];)t===e[o]&&(i=n.push(o));for(;i--;)e.splice(n[i],1)}return D=null,e},C=t.getText=function(e){var t,n="",i=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=C(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[i++];)n+=C(t);return n},k=t.selectors={cacheLength:50,createPseudo:i,match:he,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(xe,ke),e[3]=(e[3]||e[4]||e[5]||"").replace(xe,ke),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return he.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&pe.test(n)&&(t=_(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(xe,ke).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=W[e+" "];return t||(t=new RegExp("(^|"+ne+")"+e+"("+ne+"|$)"))&&W(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,n,i){return function(o){var r=t.attr(o,e);return null==r?"!="===n:n?(r+="","="===n?r===i:"!="===n?r!==i:"^="===n?i&&0===r.indexOf(i):"*="===n?i&&r.indexOf(i)>-1:"$="===n?i&&r.slice(-i.length)===i:"~="===n?(" "+r.replace(se," ")+" ").indexOf(i)>-1:"|="===n?r===i||r.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(e,t,n,i,o){var r="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===i&&0===o?function(e){return!!e.parentNode}:function(t,n,l){var c,d,u,p,f,h,m=r!==a?"nextSibling":"previousSibling",g=t.parentNode,v=s&&t.nodeName.toLowerCase(),b=!l&&!s;if(g){if(r){for(;m;){for(u=t;u=u[m];)if(s?u.nodeName.toLowerCase()===v:1===u.nodeType)return!1;h=m="only"===e&&!h&&"nextSibling"}return!0}if(h=[a?g.firstChild:g.lastChild],a&&b){for(d=g[$]||(g[$]={}),c=d[e]||[],f=c[0]===z&&c[1],p=c[0]===z&&c[2],u=f&&g.childNodes[f];u=++f&&u&&u[m]||(p=f=0)||h.pop();)if(1===u.nodeType&&++p&&u===t){d[e]=[z,f,p];break}}else if(b&&(c=(t[$]||(t[$]={}))[e])&&c[0]===z)p=c[1];else for(;(u=++f&&u&&u[m]||(p=f=0)||h.pop())&&((s?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++p||(b&&((u[$]||(u[$]={}))[e]=[z,p]),u!==t)););return p-=o,p===i||p%i===0&&p/i>=0}}},PSEUDO:function(e,n){var o,r=k.pseudos[e]||k.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return r[$]?r(n):r.length>1?(o=[e,e,"",n],k.setFilters.hasOwnProperty(e.toLowerCase())?i(function(e,t){for(var i,o=r(e,n),a=o.length;a--;)i=ee(e,o[a]),e[i]=!(t[i]=o[a])}):function(e){return r(e,0,o)}):r}},pseudos:{not:i(function(e){var t=[],n=[],o=S(e.replace(le,"$1"));return o[$]?i(function(e,t,n,i){for(var r,a=o(e,null,i,[]),s=e.length;s--;)(r=a[s])&&(e[s]=!(t[s]=r))}):function(e,i,r){return t[0]=e,o(t,null,r,n),t[0]=null,!n.pop()}}),has:i(function(e){return function(n){return t(e,n).length>0}}),contains:i(function(e){return e=e.replace(xe,ke),function(t){return(t.textContent||t.innerText||C(t)).indexOf(e)>-1}}),lang:i(function(e){return fe.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(xe,ke).toLowerCase(),function(t){var n;do if(n=P?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===M},focus:function(e){return e===A.activeElement&&(!A.hasFocus||A.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!k.pseudos.empty(e)},header:function(e){return ge.test(e.nodeName)},input:function(e){return me.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:c(function(){return[0]}),last:c(function(e,t){return[t-1]}),eq:c(function(e,t,n){return[0>n?n+t:n]}),even:c(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:c(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:c(function(e,t,n){for(var i=0>n?n+t:n;--i>=0;)e.push(i);return e}),gt:c(function(e,t,n){for(var i=0>n?n+t:n;++i<t;)e.push(i);return e})}},k.pseudos.nth=k.pseudos.eq;for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})k.pseudos[w]=s(w);for(w in{submit:!0,reset:!0})k.pseudos[w]=l(w);return u.prototype=k.filters=k.pseudos,k.setFilters=new u,_=t.tokenize=function(e,n){var i,o,r,a,s,l,c,d=U[e+" "];if(d)return n?0:d.slice(0);for(s=e,l=[],c=k.preFilter;s;){(!i||(o=ce.exec(s)))&&(o&&(s=s.slice(o[0].length)||s),l.push(r=[])),i=!1,(o=de.exec(s))&&(i=o.shift(),r.push({value:i,type:o[0].replace(le," ")}),s=s.slice(i.length));for(a in k.filter)!(o=he[a].exec(s))||c[a]&&!(o=c[a](o))||(i=o.shift(),r.push({value:i,type:a,matches:o}),s=s.slice(i.length));if(!i)break}return n?s.length:s?t.error(e):U(e,l).slice(0)},S=t.compile=function(e,t){var n,i=[],o=[],r=q[e+" "];if(!r){for(t||(t=_(e)),n=t.length;n--;)r=b(t[n]),r[$]?i.push(r):o.push(r);r=q(e,y(o,i)),r.selector=e}return r},I=t.select=function(e,t,n,i){var o,r,a,s,l,c="function"==typeof e&&e,u=!i&&_(e=c.selector||e);if(n=n||[],1===u.length){if(r=u[0]=u[0].slice(0),r.length>2&&"ID"===(a=r[0]).type&&x.getById&&9===t.nodeType&&P&&k.relative[r[1].type]){if(t=(k.find.ID(a.matches[0].replace(xe,ke),t)||[])[0],!t)return n;c&&(t=t.parentNode),e=e.slice(r.shift().value.length)}for(o=he.needsContext.test(e)?0:r.length;o--&&(a=r[o],!k.relative[s=a.type]);)if((l=k.find[s])&&(i=l(a.matches[0].replace(xe,ke),ye.test(r[0].type)&&d(t.parentNode)||t))){if(r.splice(o,1),e=i.length&&p(r),!e)return J.apply(n,i),n;break}}return(c||S(e,u))(i,t,!P,n,ye.test(e)&&d(t.parentNode)||t),n},x.sortStable=$.split("").sort(V).join("")===$,x.detectDuplicates=!!N,E(),x.sortDetached=o(function(e){return 1&e.compareDocumentPosition(A.createElement("div"))}),o(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||r("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),x.attributes&&o(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||r("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),o(function(e){return null==e.getAttribute("disabled")})||r(te,function(e,t,n){var i;return n?void 0:e[t]===!0?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null}),t}(o);ie.find=le,ie.expr=le.selectors,ie.expr[":"]=ie.expr.pseudos,ie.unique=le.uniqueSort,ie.text=le.getText,ie.isXMLDoc=le.isXML,ie.contains=le.contains;var ce=ie.expr.match.needsContext,de=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ue=/^.[^:#\[\.,]*$/;ie.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?ie.find.matchesSelector(i,e)?[i]:[]:ie.find.matches(e,ie.grep(t,function(e){return 1===e.nodeType}))},ie.fn.extend({find:function(e){var t,n=this.length,i=[],o=this;if("string"!=typeof e)return this.pushStack(ie(e).filter(function(){for(t=0;n>t;t++)if(ie.contains(o[t],this))return!0}));for(t=0;n>t;t++)ie.find(e,o[t],i);return i=this.pushStack(n>1?ie.unique(i):i),i.selector=this.selector?this.selector+" "+e:e,i},filter:function(e){return this.pushStack(s(this,e||[],!1))},not:function(e){return this.pushStack(s(this,e||[],!0))},is:function(e){return!!s(this,"string"==typeof e&&ce.test(e)?ie(e):e||[],!1).length}});var pe,fe=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,he=ie.fn.init=function(e,t){var n,i;if(!e)return this;if("string"==typeof e){if(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:fe.exec(e),!n||!n[1]&&t)return!t||t.jquery?(t||pe).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof ie?t[0]:t,ie.merge(this,ie.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:te,!0)),
de.test(n[1])&&ie.isPlainObject(t))for(n in t)ie.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return i=te.getElementById(n[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=te,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):ie.isFunction(e)?"undefined"!=typeof pe.ready?pe.ready(e):e(ie):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),ie.makeArray(e,this))};he.prototype=ie.fn,pe=ie(te);var me=/^(?:parents|prev(?:Until|All))/,ge={children:!0,contents:!0,next:!0,prev:!0};ie.extend({dir:function(e,t,n){for(var i=[],o=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&ie(e).is(n))break;i.push(e)}return i},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}}),ie.fn.extend({has:function(e){var t=ie(e,this),n=t.length;return this.filter(function(){for(var e=0;n>e;e++)if(ie.contains(this,t[e]))return!0})},closest:function(e,t){for(var n,i=0,o=this.length,r=[],a=ce.test(e)||"string"!=typeof e?ie(e,t||this.context):0;o>i;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&ie.find.matchesSelector(n,e))){r.push(n);break}return this.pushStack(r.length>1?ie.unique(r):r)},index:function(e){return e?"string"==typeof e?Y.call(ie(e),this[0]):Y.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(ie.unique(ie.merge(this.get(),ie(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ie.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ie.dir(e,"parentNode")},parentsUntil:function(e,t,n){return ie.dir(e,"parentNode",n)},next:function(e){return l(e,"nextSibling")},prev:function(e){return l(e,"previousSibling")},nextAll:function(e){return ie.dir(e,"nextSibling")},prevAll:function(e){return ie.dir(e,"previousSibling")},nextUntil:function(e,t,n){return ie.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return ie.dir(e,"previousSibling",n)},siblings:function(e){return ie.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return ie.sibling(e.firstChild)},contents:function(e){return e.contentDocument||ie.merge([],e.childNodes)}},function(e,t){ie.fn[e]=function(n,i){var o=ie.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(o=ie.filter(i,o)),this.length>1&&(ge[e]||ie.unique(o),me.test(e)&&o.reverse()),this.pushStack(o)}});var ve=/\S+/g,be={};ie.Callbacks=function(e){e="string"==typeof e?be[e]||c(e):ie.extend({},e);var t,n,i,o,r,a,s=[],l=!e.once&&[],d=function(c){for(t=e.memory&&c,n=!0,a=o||0,o=0,r=s.length,i=!0;s&&r>a;a++)if(s[a].apply(c[0],c[1])===!1&&e.stopOnFalse){t=!1;break}i=!1,s&&(l?l.length&&d(l.shift()):t?s=[]:u.disable())},u={add:function(){if(s){var n=s.length;!function a(t){ie.each(t,function(t,n){var i=ie.type(n);"function"===i?e.unique&&u.has(n)||s.push(n):n&&n.length&&"string"!==i&&a(n)})}(arguments),i?r=s.length:t&&(o=n,d(t))}return this},remove:function(){return s&&ie.each(arguments,function(e,t){for(var n;(n=ie.inArray(t,s,n))>-1;)s.splice(n,1),i&&(r>=n&&r--,a>=n&&a--)}),this},has:function(e){return e?ie.inArray(e,s)>-1:!(!s||!s.length)},empty:function(){return s=[],r=0,this},disable:function(){return s=l=t=void 0,this},disabled:function(){return!s},lock:function(){return l=void 0,t||u.disable(),this},locked:function(){return!l},fireWith:function(e,t){return!s||n&&!l||(t=t||[],t=[e,t.slice?t.slice():t],i?l.push(t):d(t)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!n}};return u},ie.extend({Deferred:function(e){var t=[["resolve","done",ie.Callbacks("once memory"),"resolved"],["reject","fail",ie.Callbacks("once memory"),"rejected"],["notify","progress",ie.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var e=arguments;return ie.Deferred(function(n){ie.each(t,function(t,r){var a=ie.isFunction(e[t])&&e[t];o[r[1]](function(){var e=a&&a.apply(this,arguments);e&&ie.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[r[0]+"With"](this===i?n.promise():this,a?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?ie.extend(e,i):i}},o={};return i.pipe=i.then,ie.each(t,function(e,r){var a=r[2],s=r[3];i[r[1]]=a.add,s&&a.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),o[r[0]]=function(){return o[r[0]+"With"](this===o?i:this,arguments),this},o[r[0]+"With"]=a.fireWith}),i.promise(o),e&&e.call(o,o),o},when:function(e){var t,n,i,o=0,r=G.call(arguments),a=r.length,s=1!==a||e&&ie.isFunction(e.promise)?a:0,l=1===s?e:ie.Deferred(),c=function(e,n,i){return function(o){n[e]=this,i[e]=arguments.length>1?G.call(arguments):o,i===t?l.notifyWith(n,i):--s||l.resolveWith(n,i)}};if(a>1)for(t=new Array(a),n=new Array(a),i=new Array(a);a>o;o++)r[o]&&ie.isFunction(r[o].promise)?r[o].promise().done(c(o,i,r)).fail(l.reject).progress(c(o,n,t)):--s;return s||l.resolveWith(i,r),l.promise()}});var ye;ie.fn.ready=function(e){return ie.ready.promise().done(e),this},ie.extend({isReady:!1,readyWait:1,holdReady:function(e){e?ie.readyWait++:ie.ready(!0)},ready:function(e){(e===!0?--ie.readyWait:ie.isReady)||(ie.isReady=!0,e!==!0&&--ie.readyWait>0||(ye.resolveWith(te,[ie]),ie.fn.triggerHandler&&(ie(te).triggerHandler("ready"),ie(te).off("ready"))))}}),ie.ready.promise=function(e){return ye||(ye=ie.Deferred(),"complete"===te.readyState?setTimeout(ie.ready):(te.addEventListener("DOMContentLoaded",d,!1),o.addEventListener("load",d,!1))),ye.promise(e)},ie.ready.promise();var we=ie.access=function(e,t,n,i,o,r,a){var s=0,l=e.length,c=null==n;if("object"===ie.type(n)){o=!0;for(s in n)ie.access(e,t,s,n[s],!0,r,a)}else if(void 0!==i&&(o=!0,ie.isFunction(i)||(a=!0),c&&(a?(t.call(e,i),t=null):(c=t,t=function(e,t,n){return c.call(ie(e),n)})),t))for(;l>s;s++)t(e[s],n,a?i:i.call(e[s],s,t(e[s],n)));return o?e:c?t.call(e):l?t(e[0],n):r};ie.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},u.uid=1,u.accepts=ie.acceptData,u.prototype={key:function(e){if(!u.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=u.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(i){t[this.expando]=n,ie.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var i,o=this.key(e),r=this.cache[o];if("string"==typeof t)r[t]=n;else if(ie.isEmptyObject(r))ie.extend(this.cache[o],t);else for(i in t)r[i]=t[i];return r},get:function(e,t){var n=this.cache[this.key(e)];return void 0===t?n:n[t]},access:function(e,t,n){var i;return void 0===t||t&&"string"==typeof t&&void 0===n?(i=this.get(e,t),void 0!==i?i:this.get(e,ie.camelCase(t))):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,i,o,r=this.key(e),a=this.cache[r];if(void 0===t)this.cache[r]={};else{ie.isArray(t)?i=t.concat(t.map(ie.camelCase)):(o=ie.camelCase(t),t in a?i=[t,o]:(i=o,i=i in a?[i]:i.match(ve)||[])),n=i.length;for(;n--;)delete a[i[n]]}},hasData:function(e){return!ie.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var xe=new u,ke=new u,Ce=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Te=/([A-Z])/g;ie.extend({hasData:function(e){return ke.hasData(e)||xe.hasData(e)},data:function(e,t,n){return ke.access(e,t,n)},removeData:function(e,t){ke.remove(e,t)},_data:function(e,t,n){return xe.access(e,t,n)},_removeData:function(e,t){xe.remove(e,t)}}),ie.fn.extend({data:function(e,t){var n,i,o,r=this[0],a=r&&r.attributes;if(void 0===e){if(this.length&&(o=ke.get(r),1===r.nodeType&&!xe.get(r,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&(i=a[n].name,0===i.indexOf("data-")&&(i=ie.camelCase(i.slice(5)),p(r,i,o[i])));xe.set(r,"hasDataAttrs",!0)}return o}return"object"==typeof e?this.each(function(){ke.set(this,e)}):we(this,function(t){var n,i=ie.camelCase(e);if(r&&void 0===t){if(n=ke.get(r,e),void 0!==n)return n;if(n=ke.get(r,i),void 0!==n)return n;if(n=p(r,i,void 0),void 0!==n)return n}else this.each(function(){var n=ke.get(this,i);ke.set(this,i,t),-1!==e.indexOf("-")&&void 0!==n&&ke.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){ke.remove(this,e)})}}),ie.extend({queue:function(e,t,n){var i;return e?(t=(t||"fx")+"queue",i=xe.get(e,t),n&&(!i||ie.isArray(n)?i=xe.access(e,t,ie.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=ie.queue(e,t),i=n.length,o=n.shift(),r=ie._queueHooks(e,t),a=function(){ie.dequeue(e,t)};"inprogress"===o&&(o=n.shift(),i--),o&&("fx"===t&&n.unshift("inprogress"),delete r.stop,o.call(e,a,r)),!i&&r&&r.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return xe.get(e,n)||xe.access(e,n,{empty:ie.Callbacks("once memory").add(function(){xe.remove(e,[t+"queue",n])})})}}),ie.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?ie.queue(this[0],e):void 0===t?this:this.each(function(){var n=ie.queue(this,e,t);ie._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&ie.dequeue(this,e)})},dequeue:function(e){return this.each(function(){ie.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,o=ie.Deferred(),r=this,a=this.length,s=function(){--i||o.resolveWith(r,[r])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)n=xe.get(r[a],e+"queueHooks"),n&&n.empty&&(i++,n.empty.add(s));return s(),o.promise(t)}});var _e=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,Se=["Top","Right","Bottom","Left"],Ie=function(e,t){return e=t||e,"none"===ie.css(e,"display")||!ie.contains(e.ownerDocument,e)},Le=/^(?:checkbox|radio)$/i;!function(){var e=te.createDocumentFragment(),t=e.appendChild(te.createElement("div")),n=te.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),t.appendChild(n),ee.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",ee.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var De="undefined";ee.focusinBubbles="onfocusin"in o;var Ne=/^key/,Ee=/^(?:mouse|pointer|contextmenu)|click/,Ae=/^(?:focusinfocus|focusoutblur)$/,Me=/^([^.]*)(?:\.(.+)|)$/;ie.event={global:{},add:function(e,t,n,i,o){var r,a,s,l,c,d,u,p,f,h,m,g=xe.get(e);if(g)for(n.handler&&(r=n,n=r.handler,o=r.selector),n.guid||(n.guid=ie.guid++),(l=g.events)||(l=g.events={}),(a=g.handle)||(a=g.handle=function(t){return typeof ie!==De&&ie.event.triggered!==t.type?ie.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(ve)||[""],c=t.length;c--;)s=Me.exec(t[c])||[],f=m=s[1],h=(s[2]||"").split(".").sort(),f&&(u=ie.event.special[f]||{},f=(o?u.delegateType:u.bindType)||f,u=ie.event.special[f]||{},d=ie.extend({type:f,origType:m,data:i,handler:n,guid:n.guid,selector:o,needsContext:o&&ie.expr.match.needsContext.test(o),namespace:h.join(".")},r),(p=l[f])||(p=l[f]=[],p.delegateCount=0,u.setup&&u.setup.call(e,i,h,a)!==!1||e.addEventListener&&e.addEventListener(f,a,!1)),u.add&&(u.add.call(e,d),d.handler.guid||(d.handler.guid=n.guid)),o?p.splice(p.delegateCount++,0,d):p.push(d),ie.event.global[f]=!0)},remove:function(e,t,n,i,o){var r,a,s,l,c,d,u,p,f,h,m,g=xe.hasData(e)&&xe.get(e);if(g&&(l=g.events)){for(t=(t||"").match(ve)||[""],c=t.length;c--;)if(s=Me.exec(t[c])||[],f=m=s[1],h=(s[2]||"").split(".").sort(),f){for(u=ie.event.special[f]||{},f=(i?u.delegateType:u.bindType)||f,p=l[f]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=r=p.length;r--;)d=p[r],!o&&m!==d.origType||n&&n.guid!==d.guid||s&&!s.test(d.namespace)||i&&i!==d.selector&&("**"!==i||!d.selector)||(p.splice(r,1),d.selector&&p.delegateCount--,u.remove&&u.remove.call(e,d));a&&!p.length&&(u.teardown&&u.teardown.call(e,h,g.handle)!==!1||ie.removeEvent(e,f,g.handle),delete l[f])}else for(f in l)ie.event.remove(e,f+t[c],n,i,!0);ie.isEmptyObject(l)&&(delete g.handle,xe.remove(e,"events"))}},trigger:function(e,t,n,i){var r,a,s,l,c,d,u,p=[n||te],f=Z.call(e,"type")?e.type:e,h=Z.call(e,"namespace")?e.namespace.split("."):[];if(a=s=n=n||te,3!==n.nodeType&&8!==n.nodeType&&!Ae.test(f+ie.event.triggered)&&(f.indexOf(".")>=0&&(h=f.split("."),f=h.shift(),h.sort()),c=f.indexOf(":")<0&&"on"+f,e=e[ie.expando]?e:new ie.Event(f,"object"==typeof e&&e),e.isTrigger=i?2:3,e.namespace=h.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:ie.makeArray(t,[e]),u=ie.event.special[f]||{},i||!u.trigger||u.trigger.apply(n,t)!==!1)){if(!i&&!u.noBubble&&!ie.isWindow(n)){for(l=u.delegateType||f,Ae.test(l+f)||(a=a.parentNode);a;a=a.parentNode)p.push(a),s=a;s===(n.ownerDocument||te)&&p.push(s.defaultView||s.parentWindow||o)}for(r=0;(a=p[r++])&&!e.isPropagationStopped();)e.type=r>1?l:u.bindType||f,d=(xe.get(a,"events")||{})[e.type]&&xe.get(a,"handle"),d&&d.apply(a,t),d=c&&a[c],d&&d.apply&&ie.acceptData(a)&&(e.result=d.apply(a,t),e.result===!1&&e.preventDefault());return e.type=f,i||e.isDefaultPrevented()||u._default&&u._default.apply(p.pop(),t)!==!1||!ie.acceptData(n)||c&&ie.isFunction(n[f])&&!ie.isWindow(n)&&(s=n[c],s&&(n[c]=null),ie.event.triggered=f,n[f](),ie.event.triggered=void 0,s&&(n[c]=s)),e.result}},dispatch:function(e){e=ie.event.fix(e);var t,n,i,o,r,a=[],s=G.call(arguments),l=(xe.get(this,"events")||{})[e.type]||[],c=ie.event.special[e.type]||{};if(s[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){for(a=ie.event.handlers.call(this,e,l),t=0;(o=a[t++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,n=0;(r=o.handlers[n++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(r.namespace))&&(e.handleObj=r,e.data=r.data,i=((ie.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,s),void 0!==i&&(e.result=i)===!1&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,i,o,r,a=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!==this;l=l.parentNode||this)if(l.disabled!==!0||"click"!==e.type){for(i=[],n=0;s>n;n++)r=t[n],o=r.selector+" ",void 0===i[o]&&(i[o]=r.needsContext?ie(o,this).index(l)>=0:ie.find(o,this,null,[l]).length),i[o]&&i.push(r);i.length&&a.push({elem:l,handlers:i})}return s<t.length&&a.push({elem:this,handlers:t.slice(s)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,i,o,r=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||te,i=n.documentElement,o=n.body,e.pageX=t.clientX+(i&&i.scrollLeft||o&&o.scrollLeft||0)-(i&&i.clientLeft||o&&o.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||o&&o.scrollTop||0)-(i&&i.clientTop||o&&o.clientTop||0)),e.which||void 0===r||(e.which=1&r?1:2&r?3:4&r?2:0),e}},fix:function(e){if(e[ie.expando])return e;var t,n,i,o=e.type,r=e,a=this.fixHooks[o];for(a||(this.fixHooks[o]=a=Ee.test(o)?this.mouseHooks:Ne.test(o)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,e=new ie.Event(r),t=i.length;t--;)n=i[t],e[n]=r[n];return e.target||(e.target=te),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,r):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==m()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===m()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&ie.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return ie.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,i){var o=ie.extend(new ie.Event,n,{type:e,isSimulated:!0,originalEvent:{}});i?ie.event.trigger(o,null,t):ie.event.dispatch.call(t,o),o.isDefaultPrevented()&&n.preventDefault()}},ie.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},ie.Event=function(e,t){return this instanceof ie.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?f:h):this.type=e,t&&ie.extend(this,t),this.timeStamp=e&&e.timeStamp||ie.now(),void(this[ie.expando]=!0)):new ie.Event(e,t)},ie.Event.prototype={isDefaultPrevented:h,isPropagationStopped:h,isImmediatePropagationStopped:h,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=f,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=f,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=f,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},ie.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){ie.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,o=e.relatedTarget,r=e.handleObj;return(!o||o!==i&&!ie.contains(i,o))&&(e.type=r.origType,n=r.handler.apply(this,arguments),e.type=t),n}}}),ee.focusinBubbles||ie.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){ie.event.simulate(t,e.target,ie.event.fix(e),!0)};ie.event.special[t]={setup:function(){var i=this.ownerDocument||this,o=xe.access(i,t);o||i.addEventListener(e,n,!0),xe.access(i,t,(o||0)+1)},teardown:function(){var i=this.ownerDocument||this,o=xe.access(i,t)-1;o?xe.access(i,t,o):(i.removeEventListener(e,n,!0),xe.remove(i,t))}}}),ie.fn.extend({on:function(e,t,n,i,o){var r,a;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=void 0);for(a in e)this.on(a,t,n,e[a],o);return this}if(null==n&&null==i?(i=t,n=t=void 0):null==i&&("string"==typeof t?(i=n,n=void 0):(i=n,n=t,t=void 0)),i===!1)i=h;else if(!i)return this;return 1===o&&(r=i,i=function(e){return ie().off(e),r.apply(this,arguments)},i.guid=r.guid||(r.guid=ie.guid++)),this.each(function(){ie.event.add(this,e,i,n,t)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,t,n){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,ie(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(o in e)this.off(o,t,e[o]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=void 0),n===!1&&(n=h),this.each(function(){ie.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){ie.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?ie.event.trigger(e,t,n,!0):void 0}});var Pe=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Oe=/<([\w:]+)/,Fe=/<|&#?\w+;/,He=/<(?:script|style|link)/i,Re=/checked\s*(?:[^=]|=\s*.checked.)/i,$e=/^$|\/(?:java|ecma)script/i,Be=/^true\/(.*)/,ze=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,je={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};je.optgroup=je.option,je.tbody=je.tfoot=je.colgroup=je.caption=je.thead,je.th=je.td,ie.extend({clone:function(e,t,n){var i,o,r,a,s=e.cloneNode(!0),l=ie.contains(e.ownerDocument,e);if(!(ee.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ie.isXMLDoc(e)))for(a=x(s),r=x(e),i=0,o=r.length;o>i;i++)k(r[i],a[i]);if(t)if(n)for(r=r||x(e),a=a||x(s),i=0,o=r.length;o>i;i++)w(r[i],a[i]);else w(e,s);return a=x(s,"script"),a.length>0&&y(a,!l&&x(e,"script")),s},buildFragment:function(e,t,n,i){for(var o,r,a,s,l,c,d=t.createDocumentFragment(),u=[],p=0,f=e.length;f>p;p++)if(o=e[p],o||0===o)if("object"===ie.type(o))ie.merge(u,o.nodeType?[o]:o);else if(Fe.test(o)){for(r=r||d.appendChild(t.createElement("div")),a=(Oe.exec(o)||["",""])[1].toLowerCase(),s=je[a]||je._default,r.innerHTML=s[1]+o.replace(Pe,"<$1></$2>")+s[2],c=s[0];c--;)r=r.lastChild;ie.merge(u,r.childNodes),r=d.firstChild,r.textContent=""}else u.push(t.createTextNode(o));for(d.textContent="",p=0;o=u[p++];)if((!i||-1===ie.inArray(o,i))&&(l=ie.contains(o.ownerDocument,o),r=x(d.appendChild(o),"script"),l&&y(r),n))for(c=0;o=r[c++];)$e.test(o.type||"")&&n.push(o);return d},cleanData:function(e){for(var t,n,i,o,r=ie.event.special,a=0;void 0!==(n=e[a]);a++){if(ie.acceptData(n)&&(o=n[xe.expando],o&&(t=xe.cache[o]))){if(t.events)for(i in t.events)r[i]?ie.event.remove(n,i):ie.removeEvent(n,i,t.handle);xe.cache[o]&&delete xe.cache[o]}delete ke.cache[n[ke.expando]]}}}),ie.fn.extend({text:function(e){return we(this,function(e){return void 0===e?ie.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=e)})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=g(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=g(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,i=e?ie.filter(e,this):this,o=0;null!=(n=i[o]);o++)t||1!==n.nodeType||ie.cleanData(x(n)),n.parentNode&&(t&&ie.contains(n.ownerDocument,n)&&y(x(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(ie.cleanData(x(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return ie.clone(this,e,t)})},html:function(e){return we(this,function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!He.test(e)&&!je[(Oe.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Pe,"<$1></$2>");try{for(;i>n;n++)t=this[n]||{},1===t.nodeType&&(ie.cleanData(x(t,!1)),t.innerHTML=e);t=0}catch(o){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,ie.cleanData(x(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=K.apply([],e);var n,i,o,r,a,s,l=0,c=this.length,d=this,u=c-1,p=e[0],f=ie.isFunction(p);if(f||c>1&&"string"==typeof p&&!ee.checkClone&&Re.test(p))return this.each(function(n){var i=d.eq(n);f&&(e[0]=p.call(this,n,i.html())),i.domManip(e,t)});if(c&&(n=ie.buildFragment(e,this[0].ownerDocument,!1,this),i=n.firstChild,1===n.childNodes.length&&(n=i),i)){for(o=ie.map(x(n,"script"),v),r=o.length;c>l;l++)a=n,l!==u&&(a=ie.clone(a,!0,!0),r&&ie.merge(o,x(a,"script"))),t.call(this[l],a,l);if(r)for(s=o[o.length-1].ownerDocument,ie.map(o,b),l=0;r>l;l++)a=o[l],$e.test(a.type||"")&&!xe.access(a,"globalEval")&&ie.contains(s,a)&&(a.src?ie._evalUrl&&ie._evalUrl(a.src):ie.globalEval(a.textContent.replace(ze,"")))}return this}}),ie.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){ie.fn[e]=function(e){for(var n,i=[],o=ie(e),r=o.length-1,a=0;r>=a;a++)n=a===r?this:this.clone(!0),ie(o[a])[t](n),X.apply(i,n.get());return this.pushStack(i)}});var We,Ue={},qe=/^margin/,Ve=new RegExp("^("+_e+")(?!px)[a-z%]+$","i"),Ge=function(e){return e.ownerDocument.defaultView.opener?e.ownerDocument.defaultView.getComputedStyle(e,null):o.getComputedStyle(e,null)};!function(){function e(){a.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",a.innerHTML="",i.appendChild(r);var e=o.getComputedStyle(a,null);t="1%"!==e.top,n="4px"===e.width,i.removeChild(r)}var t,n,i=te.documentElement,r=te.createElement("div"),a=te.createElement("div");a.style&&(a.style.backgroundClip="content-box",a.cloneNode(!0).style.backgroundClip="",ee.clearCloneStyle="content-box"===a.style.backgroundClip,r.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",r.appendChild(a),o.getComputedStyle&&ie.extend(ee,{pixelPosition:function(){return e(),t},boxSizingReliable:function(){return null==n&&e(),n},reliableMarginRight:function(){var e,t=a.appendChild(te.createElement("div"));return t.style.cssText=a.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",t.style.marginRight=t.style.width="0",a.style.width="1px",i.appendChild(r),e=!parseFloat(o.getComputedStyle(t,null).marginRight),i.removeChild(r),a.removeChild(t),e}}))}(),ie.swap=function(e,t,n,i){var o,r,a={};for(r in t)a[r]=e.style[r],e.style[r]=t[r];o=n.apply(e,i||[]);for(r in t)e.style[r]=a[r];return o};var Ke=/^(none|table(?!-c[ea]).+)/,Xe=new RegExp("^("+_e+")(.*)$","i"),Ye=new RegExp("^([+-])=("+_e+")","i"),Qe={position:"absolute",visibility:"hidden",display:"block"},Je={letterSpacing:"0",fontWeight:"400"},Ze=["Webkit","O","Moz","ms"];ie.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=_(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,r,a,s=ie.camelCase(t),l=e.style;return t=ie.cssProps[s]||(ie.cssProps[s]=I(l,s)),a=ie.cssHooks[t]||ie.cssHooks[s],void 0===n?a&&"get"in a&&void 0!==(o=a.get(e,!1,i))?o:l[t]:(r=typeof n,"string"===r&&(o=Ye.exec(n))&&(n=(o[1]+1)*o[2]+parseFloat(ie.css(e,t)),r="number"),void(null!=n&&n===n&&("number"!==r||ie.cssNumber[s]||(n+="px"),ee.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,i))||(l[t]=n))))}},css:function(e,t,n,i){var o,r,a,s=ie.camelCase(t);return t=ie.cssProps[s]||(ie.cssProps[s]=I(e.style,s)),a=ie.cssHooks[t]||ie.cssHooks[s],a&&"get"in a&&(o=a.get(e,!0,n)),void 0===o&&(o=_(e,t,i)),"normal"===o&&t in Je&&(o=Je[t]),""===n||n?(r=parseFloat(o),n===!0||ie.isNumeric(r)?r||0:o):o}}),ie.each(["height","width"],function(e,t){ie.cssHooks[t]={get:function(e,n,i){return n?Ke.test(ie.css(e,"display"))&&0===e.offsetWidth?ie.swap(e,Qe,function(){return N(e,t,i)}):N(e,t,i):void 0},set:function(e,n,i){var o=i&&Ge(e);return L(e,n,i?D(e,t,i,"border-box"===ie.css(e,"boxSizing",!1,o),o):0)}}}),ie.cssHooks.marginRight=S(ee.reliableMarginRight,function(e,t){return t?ie.swap(e,{display:"inline-block"},_,[e,"marginRight"]):void 0}),ie.each({margin:"",padding:"",border:"Width"},function(e,t){ie.cssHooks[e+t]={expand:function(n){for(var i=0,o={},r="string"==typeof n?n.split(" "):[n];4>i;i++)o[e+Se[i]+t]=r[i]||r[i-2]||r[0];return o}},qe.test(e)||(ie.cssHooks[e+t].set=L)}),ie.fn.extend({css:function(e,t){return we(this,function(e,t,n){var i,o,r={},a=0;if(ie.isArray(t)){for(i=Ge(e),o=t.length;o>a;a++)r[t[a]]=ie.css(e,t[a],!1,i);return r}return void 0!==n?ie.style(e,t,n):ie.css(e,t)},e,t,arguments.length>1)},show:function(){return E(this,!0)},hide:function(){return E(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Ie(this)?ie(this).show():ie(this).hide()})}}),ie.Tween=A,A.prototype={constructor:A,init:function(e,t,n,i,o,r){this.elem=e,this.prop=n,this.easing=o||"swing",this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=r||(ie.cssNumber[n]?"":"px")},cur:function(){var e=A.propHooks[this.prop];return e&&e.get?e.get(this):A.propHooks._default.get(this)},run:function(e){var t,n=A.propHooks[this.prop];return this.pos=t=this.options.duration?ie.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):A.propHooks._default.set(this),this}},A.prototype.init.prototype=A.prototype,A.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=ie.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){ie.fx.step[e.prop]?ie.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[ie.cssProps[e.prop]]||ie.cssHooks[e.prop])?ie.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},A.propHooks.scrollTop=A.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ie.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},ie.fx=A.prototype.init,ie.fx.step={};var et,tt,nt=/^(?:toggle|show|hide)$/,it=new RegExp("^(?:([+-])=|)("+_e+")([a-z%]*)$","i"),ot=/queueHooks$/,rt=[F],at={"*":[function(e,t){var n=this.createTween(e,t),i=n.cur(),o=it.exec(t),r=o&&o[3]||(ie.cssNumber[e]?"":"px"),a=(ie.cssNumber[e]||"px"!==r&&+i)&&it.exec(ie.css(n.elem,e)),s=1,l=20;if(a&&a[3]!==r){r=r||a[3],o=o||[],a=+i||1;do s=s||".5",a/=s,ie.style(n.elem,e,a+r);while(s!==(s=n.cur()/i)&&1!==s&&--l)}return o&&(a=n.start=+a||+i||0,n.unit=r,n.end=o[1]?a+(o[1]+1)*o[2]:+o[2]),n}]};ie.Animation=ie.extend(R,{tweener:function(e,t){ie.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,i=0,o=e.length;o>i;i++)n=e[i],at[n]=at[n]||[],at[n].unshift(t)},prefilter:function(e,t){t?rt.unshift(e):rt.push(e)}}),ie.speed=function(e,t,n){var i=e&&"object"==typeof e?ie.extend({},e):{complete:n||!n&&t||ie.isFunction(e)&&e,duration:e,easing:n&&t||t&&!ie.isFunction(t)&&t};return i.duration=ie.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in ie.fx.speeds?ie.fx.speeds[i.duration]:ie.fx.speeds._default,(null==i.queue||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){ie.isFunction(i.old)&&i.old.call(this),i.queue&&ie.dequeue(this,i.queue)},i},ie.fn.extend({fadeTo:function(e,t,n,i){return this.filter(Ie).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var o=ie.isEmptyObject(e),r=ie.speed(t,n,i),a=function(){var t=R(this,ie.extend({},e),r);(o||xe.get(this,"finish"))&&t.stop(!0)};return a.finish=a,o||r.queue===!1?this.each(a):this.queue(r.queue,a)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,o=null!=e&&e+"queueHooks",r=ie.timers,a=xe.get(this);if(o)a[o]&&a[o].stop&&i(a[o]);else for(o in a)a[o]&&a[o].stop&&ot.test(o)&&i(a[o]);for(o=r.length;o--;)r[o].elem!==this||null!=e&&r[o].queue!==e||(r[o].anim.stop(n),t=!1,r.splice(o,1));(t||!n)&&ie.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=xe.get(this),i=n[e+"queue"],o=n[e+"queueHooks"],r=ie.timers,a=i?i.length:0;for(n.finish=!0,ie.queue(this,e,[]),o&&o.stop&&o.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===e&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;a>t;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish})}}),ie.each(["toggle","show","hide"],function(e,t){var n=ie.fn[t];ie.fn[t]=function(e,i,o){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(P(t,!0),e,i,o)}}),ie.each({slideDown:P("show"),slideUp:P("hide"),slideToggle:P("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){
ie.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),ie.timers=[],ie.fx.tick=function(){var e,t=0,n=ie.timers;for(et=ie.now();t<n.length;t++)e=n[t],e()||n[t]!==e||n.splice(t--,1);n.length||ie.fx.stop(),et=void 0},ie.fx.timer=function(e){ie.timers.push(e),e()?ie.fx.start():ie.timers.pop()},ie.fx.interval=13,ie.fx.start=function(){tt||(tt=setInterval(ie.fx.tick,ie.fx.interval))},ie.fx.stop=function(){clearInterval(tt),tt=null},ie.fx.speeds={slow:600,fast:200,_default:400},ie.fn.delay=function(e,t){return e=ie.fx?ie.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var i=setTimeout(t,e);n.stop=function(){clearTimeout(i)}})},function(){var e=te.createElement("input"),t=te.createElement("select"),n=t.appendChild(te.createElement("option"));e.type="checkbox",ee.checkOn=""!==e.value,ee.optSelected=n.selected,t.disabled=!0,ee.optDisabled=!n.disabled,e=te.createElement("input"),e.value="t",e.type="radio",ee.radioValue="t"===e.value}();var st,lt,ct=ie.expr.attrHandle;ie.fn.extend({attr:function(e,t){return we(this,ie.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){ie.removeAttr(this,e)})}}),ie.extend({attr:function(e,t,n){var i,o,r=e.nodeType;return e&&3!==r&&8!==r&&2!==r?typeof e.getAttribute===De?ie.prop(e,t,n):(1===r&&ie.isXMLDoc(e)||(t=t.toLowerCase(),i=ie.attrHooks[t]||(ie.expr.match.bool.test(t)?lt:st)),void 0===n?i&&"get"in i&&null!==(o=i.get(e,t))?o:(o=ie.find.attr(e,t),null==o?void 0:o):null!==n?i&&"set"in i&&void 0!==(o=i.set(e,n,t))?o:(e.setAttribute(t,n+""),n):void ie.removeAttr(e,t)):void 0},removeAttr:function(e,t){var n,i,o=0,r=t&&t.match(ve);if(r&&1===e.nodeType)for(;n=r[o++];)i=ie.propFix[n]||n,ie.expr.match.bool.test(n)&&(e[i]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!ee.radioValue&&"radio"===t&&ie.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),lt={set:function(e,t,n){return t===!1?ie.removeAttr(e,n):e.setAttribute(n,n),n}},ie.each(ie.expr.match.bool.source.match(/\w+/g),function(e,t){var n=ct[t]||ie.find.attr;ct[t]=function(e,t,i){var o,r;return i||(r=ct[t],ct[t]=o,o=null!=n(e,t,i)?t.toLowerCase():null,ct[t]=r),o}});var dt=/^(?:input|select|textarea|button)$/i;ie.fn.extend({prop:function(e,t){return we(this,ie.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[ie.propFix[e]||e]})}}),ie.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var i,o,r,a=e.nodeType;return e&&3!==a&&8!==a&&2!==a?(r=1!==a||!ie.isXMLDoc(e),r&&(t=ie.propFix[t]||t,o=ie.propHooks[t]),void 0!==n?o&&"set"in o&&void 0!==(i=o.set(e,n,t))?i:e[t]=n:o&&"get"in o&&null!==(i=o.get(e,t))?i:e[t]):void 0},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||dt.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),ee.optSelected||(ie.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),ie.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ie.propFix[this.toLowerCase()]=this});var ut=/[\t\r\n\f]/g;ie.fn.extend({addClass:function(e){var t,n,i,o,r,a,s="string"==typeof e&&e,l=0,c=this.length;if(ie.isFunction(e))return this.each(function(t){ie(this).addClass(e.call(this,t,this.className))});if(s)for(t=(e||"").match(ve)||[];c>l;l++)if(n=this[l],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(ut," "):" ")){for(r=0;o=t[r++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");a=ie.trim(i),n.className!==a&&(n.className=a)}return this},removeClass:function(e){var t,n,i,o,r,a,s=0===arguments.length||"string"==typeof e&&e,l=0,c=this.length;if(ie.isFunction(e))return this.each(function(t){ie(this).removeClass(e.call(this,t,this.className))});if(s)for(t=(e||"").match(ve)||[];c>l;l++)if(n=this[l],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(ut," "):"")){for(r=0;o=t[r++];)for(;i.indexOf(" "+o+" ")>=0;)i=i.replace(" "+o+" "," ");a=e?ie.trim(i):"",n.className!==a&&(n.className=a)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):this.each(ie.isFunction(e)?function(n){ie(this).toggleClass(e.call(this,n,this.className,t),t)}:function(){if("string"===n)for(var t,i=0,o=ie(this),r=e.match(ve)||[];t=r[i++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else(n===De||"boolean"===n)&&(this.className&&xe.set(this,"__className__",this.className),this.className=this.className||e===!1?"":xe.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(ut," ").indexOf(t)>=0)return!0;return!1}});var pt=/\r/g;ie.fn.extend({val:function(e){var t,n,i,o=this[0];return arguments.length?(i=ie.isFunction(e),this.each(function(n){var o;1===this.nodeType&&(o=i?e.call(this,n,ie(this).val()):e,null==o?o="":"number"==typeof o?o+="":ie.isArray(o)&&(o=ie.map(o,function(e){return null==e?"":e+""})),t=ie.valHooks[this.type]||ie.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,o,"value")||(this.value=o))})):o?(t=ie.valHooks[o.type]||ie.valHooks[o.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(n=t.get(o,"value"))?n:(n=o.value,"string"==typeof n?n.replace(pt,""):null==n?"":n)):void 0}}),ie.extend({valHooks:{option:{get:function(e){var t=ie.find.attr(e,"value");return null!=t?t:ie.trim(ie.text(e))}},select:{get:function(e){for(var t,n,i=e.options,o=e.selectedIndex,r="select-one"===e.type||0>o,a=r?null:[],s=r?o+1:i.length,l=0>o?s:r?o:0;s>l;l++)if(n=i[l],!(!n.selected&&l!==o||(ee.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&ie.nodeName(n.parentNode,"optgroup"))){if(t=ie(n).val(),r)return t;a.push(t)}return a},set:function(e,t){for(var n,i,o=e.options,r=ie.makeArray(t),a=o.length;a--;)i=o[a],(i.selected=ie.inArray(i.value,r)>=0)&&(n=!0);return n||(e.selectedIndex=-1),r}}}}),ie.each(["radio","checkbox"],function(){ie.valHooks[this]={set:function(e,t){return ie.isArray(t)?e.checked=ie.inArray(ie(e).val(),t)>=0:void 0}},ee.checkOn||(ie.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),ie.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){ie.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),ie.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var ft=ie.now(),ht=/\?/;ie.parseJSON=function(e){return JSON.parse(e+"")},ie.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(i){t=void 0}return(!t||t.getElementsByTagName("parsererror").length)&&ie.error("Invalid XML: "+e),t};var mt=/#.*$/,gt=/([?&])_=[^&]*/,vt=/^(.*?):[ \t]*([^\r\n]*)$/gm,bt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,yt=/^(?:GET|HEAD)$/,wt=/^\/\//,xt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,kt={},Ct={},Tt="*/".concat("*"),_t=o.location.href,St=xt.exec(_t.toLowerCase())||[];ie.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:_t,type:"GET",isLocal:bt.test(St[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Tt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ie.parseJSON,"text xml":ie.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?z(z(e,ie.ajaxSettings),t):z(ie.ajaxSettings,e)},ajaxPrefilter:$(kt),ajaxTransport:$(Ct),ajax:function(e,t){function n(e,t,n,a){var l,d,v,b,w,k=t;2!==y&&(y=2,s&&clearTimeout(s),i=void 0,r=a||"",x.readyState=e>0?4:0,l=e>=200&&300>e||304===e,n&&(b=j(u,x,n)),b=W(u,b,x,l),l?(u.ifModified&&(w=x.getResponseHeader("Last-Modified"),w&&(ie.lastModified[o]=w),w=x.getResponseHeader("etag"),w&&(ie.etag[o]=w)),204===e||"HEAD"===u.type?k="nocontent":304===e?k="notmodified":(k=b.state,d=b.data,v=b.error,l=!v)):(v=k,(e||!k)&&(k="error",0>e&&(e=0))),x.status=e,x.statusText=(t||k)+"",l?h.resolveWith(p,[d,k,x]):h.rejectWith(p,[x,k,v]),x.statusCode(g),g=void 0,c&&f.trigger(l?"ajaxSuccess":"ajaxError",[x,u,l?d:v]),m.fireWith(p,[x,k]),c&&(f.trigger("ajaxComplete",[x,u]),--ie.active||ie.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,o,r,a,s,l,c,d,u=ie.ajaxSetup({},t),p=u.context||u,f=u.context&&(p.nodeType||p.jquery)?ie(p):ie.event,h=ie.Deferred(),m=ie.Callbacks("once memory"),g=u.statusCode||{},v={},b={},y=0,w="canceled",x={readyState:0,getResponseHeader:function(e){var t;if(2===y){if(!a)for(a={};t=vt.exec(r);)a[t[1].toLowerCase()]=t[2];t=a[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===y?r:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return y||(e=b[n]=b[n]||e,v[e]=t),this},overrideMimeType:function(e){return y||(u.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>y)for(t in e)g[t]=[g[t],e[t]];else x.always(e[x.status]);return this},abort:function(e){var t=e||w;return i&&i.abort(t),n(0,t),this}};if(h.promise(x).complete=m.add,x.success=x.done,x.error=x.fail,u.url=((e||u.url||_t)+"").replace(mt,"").replace(wt,St[1]+"//"),u.type=t.method||t.type||u.method||u.type,u.dataTypes=ie.trim(u.dataType||"*").toLowerCase().match(ve)||[""],null==u.crossDomain&&(l=xt.exec(u.url.toLowerCase()),u.crossDomain=!(!l||l[1]===St[1]&&l[2]===St[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(St[3]||("http:"===St[1]?"80":"443")))),u.data&&u.processData&&"string"!=typeof u.data&&(u.data=ie.param(u.data,u.traditional)),B(kt,u,t,x),2===y)return x;c=ie.event&&u.global,c&&0===ie.active++&&ie.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!yt.test(u.type),o=u.url,u.hasContent||(u.data&&(o=u.url+=(ht.test(o)?"&":"?")+u.data,delete u.data),u.cache===!1&&(u.url=gt.test(o)?o.replace(gt,"$1_="+ft++):o+(ht.test(o)?"&":"?")+"_="+ft++)),u.ifModified&&(ie.lastModified[o]&&x.setRequestHeader("If-Modified-Since",ie.lastModified[o]),ie.etag[o]&&x.setRequestHeader("If-None-Match",ie.etag[o])),(u.data&&u.hasContent&&u.contentType!==!1||t.contentType)&&x.setRequestHeader("Content-Type",u.contentType),x.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+Tt+"; q=0.01":""):u.accepts["*"]);for(d in u.headers)x.setRequestHeader(d,u.headers[d]);if(u.beforeSend&&(u.beforeSend.call(p,x,u)===!1||2===y))return x.abort();w="abort";for(d in{success:1,error:1,complete:1})x[d](u[d]);if(i=B(Ct,u,t,x)){x.readyState=1,c&&f.trigger("ajaxSend",[x,u]),u.async&&u.timeout>0&&(s=setTimeout(function(){x.abort("timeout")},u.timeout));try{y=1,i.send(v,n)}catch(k){if(!(2>y))throw k;n(-1,k)}}else n(-1,"No Transport");return x},getJSON:function(e,t,n){return ie.get(e,t,n,"json")},getScript:function(e,t){return ie.get(e,void 0,t,"script")}}),ie.each(["get","post"],function(e,t){ie[t]=function(e,n,i,o){return ie.isFunction(n)&&(o=o||i,i=n,n=void 0),ie.ajax({url:e,type:t,dataType:o,data:n,success:i})}}),ie._evalUrl=function(e){return ie.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},ie.fn.extend({wrapAll:function(e){var t;return ie.isFunction(e)?this.each(function(t){ie(this).wrapAll(e.call(this,t))}):(this[0]&&(t=ie(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return this.each(ie.isFunction(e)?function(t){ie(this).wrapInner(e.call(this,t))}:function(){var t=ie(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=ie.isFunction(e);return this.each(function(n){ie(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){ie.nodeName(this,"body")||ie(this).replaceWith(this.childNodes)}).end()}}),ie.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},ie.expr.filters.visible=function(e){return!ie.expr.filters.hidden(e)};var It=/%20/g,Lt=/\[\]$/,Dt=/\r?\n/g,Nt=/^(?:submit|button|image|reset|file)$/i,Et=/^(?:input|select|textarea|keygen)/i;ie.param=function(e,t){var n,i=[],o=function(e,t){t=ie.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=ie.ajaxSettings&&ie.ajaxSettings.traditional),ie.isArray(e)||e.jquery&&!ie.isPlainObject(e))ie.each(e,function(){o(this.name,this.value)});else for(n in e)U(n,e[n],t,o);return i.join("&").replace(It,"+")},ie.fn.extend({serialize:function(){return ie.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ie.prop(this,"elements");return e?ie.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ie(this).is(":disabled")&&Et.test(this.nodeName)&&!Nt.test(e)&&(this.checked||!Le.test(e))}).map(function(e,t){var n=ie(this).val();return null==n?null:ie.isArray(n)?ie.map(n,function(e){return{name:t.name,value:e.replace(Dt,"\r\n")}}):{name:t.name,value:n.replace(Dt,"\r\n")}}).get()}}),ie.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var At=0,Mt={},Pt={0:200,1223:204},Ot=ie.ajaxSettings.xhr();o.attachEvent&&o.attachEvent("onunload",function(){for(var e in Mt)Mt[e]()}),ee.cors=!!Ot&&"withCredentials"in Ot,ee.ajax=Ot=!!Ot,ie.ajaxTransport(function(e){var t;return ee.cors||Ot&&!e.crossDomain?{send:function(n,i){var o,r=e.xhr(),a=++At;if(r.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)r[o]=e.xhrFields[o];e.mimeType&&r.overrideMimeType&&r.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(o in n)r.setRequestHeader(o,n[o]);t=function(e){return function(){t&&(delete Mt[a],t=r.onload=r.onerror=null,"abort"===e?r.abort():"error"===e?i(r.status,r.statusText):i(Pt[r.status]||r.status,r.statusText,"string"==typeof r.responseText?{text:r.responseText}:void 0,r.getAllResponseHeaders()))}},r.onload=t(),r.onerror=t("error"),t=Mt[a]=t("abort");try{r.send(e.hasContent&&e.data||null)}catch(s){if(t)throw s}},abort:function(){t&&t()}}:void 0}),ie.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return ie.globalEval(e),e}}}),ie.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),ie.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(i,o){t=ie("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&o("error"===e.type?404:200,e.type)}),te.head.appendChild(t[0])},abort:function(){n&&n()}}}});var Ft=[],Ht=/(=)\?(?=&|$)|\?\?/;ie.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Ft.pop()||ie.expando+"_"+ft++;return this[e]=!0,e}}),ie.ajaxPrefilter("json jsonp",function(e,t,n){var i,r,a,s=e.jsonp!==!1&&(Ht.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ht.test(e.data)&&"data");return s||"jsonp"===e.dataTypes[0]?(i=e.jsonpCallback=ie.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(Ht,"$1"+i):e.jsonp!==!1&&(e.url+=(ht.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return a||ie.error(i+" was not called"),a[0]},e.dataTypes[0]="json",r=o[i],o[i]=function(){a=arguments},n.always(function(){o[i]=r,e[i]&&(e.jsonpCallback=t.jsonpCallback,Ft.push(i)),a&&ie.isFunction(r)&&r(a[0]),a=r=void 0}),"script"):void 0}),ie.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||te;var i=de.exec(e),o=!n&&[];return i?[t.createElement(i[1])]:(i=ie.buildFragment([e],t,o),o&&o.length&&ie(o).remove(),ie.merge([],i.childNodes))};var Rt=ie.fn.load;ie.fn.load=function(e,t,n){if("string"!=typeof e&&Rt)return Rt.apply(this,arguments);var i,o,r,a=this,s=e.indexOf(" ");return s>=0&&(i=ie.trim(e.slice(s)),e=e.slice(0,s)),ie.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(o="POST"),a.length>0&&ie.ajax({url:e,type:o,dataType:"html",data:t}).done(function(e){r=arguments,a.html(i?ie("<div>").append(ie.parseHTML(e)).find(i):e)}).complete(n&&function(e,t){a.each(n,r||[e.responseText,t,e])}),this},ie.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ie.fn[t]=function(e){return this.on(t,e)}}),ie.expr.filters.animated=function(e){return ie.grep(ie.timers,function(t){return e===t.elem}).length};var $t=o.document.documentElement;ie.offset={setOffset:function(e,t,n){var i,o,r,a,s,l,c,d=ie.css(e,"position"),u=ie(e),p={};"static"===d&&(e.style.position="relative"),s=u.offset(),r=ie.css(e,"top"),l=ie.css(e,"left"),c=("absolute"===d||"fixed"===d)&&(r+l).indexOf("auto")>-1,c?(i=u.position(),a=i.top,o=i.left):(a=parseFloat(r)||0,o=parseFloat(l)||0),ie.isFunction(t)&&(t=t.call(e,n,s)),null!=t.top&&(p.top=t.top-s.top+a),null!=t.left&&(p.left=t.left-s.left+o),"using"in t?t.using.call(e,p):u.css(p)}},ie.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){ie.offset.setOffset(this,e,t)});var t,n,i=this[0],o={top:0,left:0},r=i&&i.ownerDocument;return r?(t=r.documentElement,ie.contains(t,i)?(typeof i.getBoundingClientRect!==De&&(o=i.getBoundingClientRect()),n=q(r),{top:o.top+n.pageYOffset-t.clientTop,left:o.left+n.pageXOffset-t.clientLeft}):o):void 0},position:function(){if(this[0]){var e,t,n=this[0],i={top:0,left:0};return"fixed"===ie.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),ie.nodeName(e[0],"html")||(i=e.offset()),i.top+=ie.css(e[0],"borderTopWidth",!0),i.left+=ie.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-ie.css(n,"marginTop",!0),left:t.left-i.left-ie.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||$t;e&&!ie.nodeName(e,"html")&&"static"===ie.css(e,"position");)e=e.offsetParent;return e||$t})}}),ie.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;ie.fn[e]=function(i){return we(this,function(e,i,r){var a=q(e);return void 0===r?a?a[t]:e[i]:void(a?a.scrollTo(n?o.pageXOffset:r,n?r:o.pageYOffset):e[i]=r)},e,i,arguments.length,null)}}),ie.each(["top","left"],function(e,t){ie.cssHooks[t]=S(ee.pixelPosition,function(e,n){return n?(n=_(e,t),Ve.test(n)?ie(e).position()[t]+"px":n):void 0})}),ie.each({Height:"height",Width:"width"},function(e,t){ie.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,i){ie.fn[i]=function(i,o){var r=arguments.length&&(n||"boolean"!=typeof i),a=n||(i===!0||o===!0?"margin":"border");return we(this,function(t,n,i){var o;return ie.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===i?ie.css(t,n,a):ie.style(t,n,i,a)},t,r?i:void 0,r,null)}})}),ie.fn.size=function(){return this.length},ie.fn.andSelf=ie.fn.addBack,n(5).cmd&&(i=function(e,t,n){n.exports=ie}.call(t,n,t,e),!(void 0!==i&&(e.exports=i)));var Bt=o.jQuery,zt=o.$;return ie.noConflict=function(e){return o.$===ie&&(o.$=zt),e&&o.jQuery===ie&&(o.jQuery=Bt),ie},typeof r===De&&(o.jQuery=o.$=ie),ie})},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t,n){var i;i=function(e,t,i){var o=n(4);!function(e,t,n){function i(e){return e}function o(e){return r(decodeURIComponent(e.replace(s," ")))}function r(e){return 0===e.indexOf('"')&&(e=e.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")),e}function a(e){return l.json?JSON.parse(e):e}var s=/\+/g,l=e.cookie=function(r,s,c){if(s!==n){if(c=e.extend({},l.defaults,c),null===s&&(c.expires=-1),"number"==typeof c.expires){var d=c.expires,u=c.expires=new Date;u.setDate(u.getDate()+d)}return s=l.json?JSON.stringify(s):String(s),t.cookie=[encodeURIComponent(r),"=",l.raw?s:encodeURIComponent(s),c.expires?"; expires="+c.expires.toUTCString():"",c.path?"; path="+c.path:"",c.domain?"; domain="+c.domain:"",c.secure?"; secure":""].join("")}for(var p=l.raw?i:o,f=t.cookie.split("; "),h=r?null:{},m=0,g=f.length;g>m;m++){var v=f[m].split("="),b=p(v.shift()),y=p(v.join("="));if(r&&r===b){h=a(y);break}r||(h[b]=a(y))}return h};l.defaults={},e.removeCookie=function(t,n){return null!==e.cookie(t)?(e.cookie(t,null,n),!0):!1}}(o,document),i.exports=o}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))},function(e,t){var n={date:{current:function(){return new Date},format:function(e,t){var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in n)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[i]:("00"+n[i]).substr((""+n[i]).length)));return t},today:function(){var e=new Date;return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e},isYesterday:function(e){return e.toDateString()===n.date.yesterday().toDateString()},yesterday:function(){var e=new Date;return e.setDate(e.getDate()-1),e.setHours(0),e.setMinutes(0),e.setSeconds(0),e},isTheDayBeforeYesterday:function(e){return e.toDateString()===n.date.addDay(new Date,-2).toDateString()},addDay:function(e,t){var n=new Date;return n.setFullYear(e.getFullYear()),n.setMonth(e.getMonth()),n.setDate(e.getDate()+t),n.setHours(0),n.setMinutes(0),n.setSeconds(0),n}},arr:{rest:function(e,t){return e.filter(function(e){return t.indexOf(e)<0?e:void 0})}},range:function(e){for(var t=[],n=0;e>n;n++)t.push(n);return t},deepClone:function(e,t){var i=null;t&&(i={})||(i=[]);for(var o in e){if("function"==typeof e[o])return;"object"==typeof e[o]&&(Array.isArray(e[o])?e[o]=e[o].map(function(e){n.deepClone(e,!0)}):e[o]=n.deepClone(e[o])),i[o]=e[o]}return i},"in":function(e,t){return e.indexOf(t)>=0},assign:function(){var e=[].slice.apply(arguments);return e.reduceRight(function(e,t){return n.mixin(t,e)},void 0)},mixin:function(e,t){if("object"==typeof t){if(!Array.isArray(t)){for(var i in t)e[i]=t[i];return e}t.map(function(i,o){n.mixin(e[o],t[o])})}return e},extend:function(e,t){for(var n in t)e[n]=t[n];return e},toObjectFromRiot:function(e){var t={};for(var i in e)e.hasOwnProperty(i)&&"function"!=typeof e[i]&&(n["in"](["parent","root","opts","tags","hidden"],i)||(t[i]=e[i]));return t},htmlParser:{parse:function(e){return e.replace(/<br>/g,"\n")},unparse:function(e){return e.replace(/\\n/g,"<br>")}},formatDateForNote:function(e){var t,i,o=parseInt((new Date).getTime()/1e3),r=parseInt(e.getTime()/1e3);if(i=o-r,t=parseInt(i/86400),n.date.isTheDayBeforeYesterday(e))return"前天";if(n.date.isYesterday(e))return"昨天";if(0===t)return"今天";if(t>2&&4>=t)return t+"天前";var a=new Date(1e3*r);return a.getMonth()+1+"月"+a.getDate()+"日"},formatDateForComments:function(e){var t,n,i,o,r=parseInt((new Date).getTime()/1e3),a=parseInt(e.getTime()/1e3);if(o=r-a,i=parseInt(o/86400),n=parseInt(o/3600),t=parseInt(o/60),i>0&&4>i)return i+"天前";if(0>=i&&n>0)return n+"小时前";if(0>=n&&t>=1)return t+"分钟前";if(1>=t)return"刚刚";var s=new Date(1e3*a);return s.getMonth()+1+"月"+s.getDate()+"日"},getCookie:function(e){for(var t,n=document.cookie.replace(/[ ]/g,""),i=n.split(";"),o=0;o<i.length;o++){var r=i[o].split("=");if(e==r[0]){t=r[1];break}}return t},forbidOperation:function(){var e=$("<div/>"),t=$(window).height(),n=$("body").height();e.addClass("forbidShadow");var i=t>n?t:n;e.css({position:"absolute",top:"0px",left:"0px;",height:i+"px",background:"#000",width:"100%",opacity:"0"}).css("z-index","999"),$("body").append(e)},removeforbidOperation:function(){$(".forbidShadow")&&$(".forbidShadow").remove()},widget:{confirm:function(e){window.app.trigger("confirm",{title:e.title,content:e.content}).one("confirmOk",function(){app.off("confirmOk"),app.off("confirmCancel"),e.callback()}).one("confirmCancel",function(){app.off("confirmOk"),app.off("confirmCancel")})},showImg:function(e){window.app.trigger("showImg",e)},alert:function(e){window.app.trigger("alert",e)},validatify:function(e){if(!Array.isArray(e))throw new Error("validatify expected to be a Array.");var t={meta:{}};return t.addToSet=function(e){if(!e||!e.hasOwnProperty("success"))throw new Error("expected a success flag");if(!e||!e.field)throw new Error("expected a field");if(!e||!e.desc)throw new Error("expected a desc");if(!e||!e.key)throw new Error("expected a key");this.meta[e.key]||(this.meta[e.key]=delete e.key&&e)},t.pass=function(e){this.meta[e]&&delete this.meta[e]},t.raw=function(){var e=this;return Object.keys(e.meta).map(function(t){return e.meta[t]})},t.allOk=function(){return Object.keys(this.meta).length<=0},t.notOk=function(e){return this.meta[e]},t.clear=function(){return this.meta={},this},n.mixin(e,t),e}},generateRandomString:function(e){for(var t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],n="",i=0;e>i;i++){var o=Math.floor(62*Math.random());n+=t[o]}return n},uploadImgFile:function(e,t){if(e.size>2097152)return void alert("图片大小不能超过2M");var n=new FormData;n.append("file",e),$.ajax({url:__app.settings.api.url+"/file/upload",type:"POST",data:n,processData:!1,contentType:!1,success:function(e){var n=__app.settings.api.url+"/file?media_id="+e.media_id;t(null,n)},error:function(e){t(e,null)}})}};window._||(window._=n),e.exports=n},function(e,t){var n=(__page||{},function(e){this.state=e});n.prototype.getUrl=function(){var e=window.location.hash||"";return this.state.url+e},n.prototype.getBaseUrl=function(){return this.state.baseUrl},n.prototype.setTitle=function(e){this.state.title=e,document&&(document.title=e)},n.prototype.saveTop=function(e){this.state.top=e,document&&(document.top=e)},n.prototype.getTop=function(){return this.state.top},n.prototype.getUser=function(){return this.state.user},n.prototype.getUser=function(){return this.state.user},__page.holder=function(){return __page._holder||(__page._holder=new n(__page)),__page._holder},e.exports=__page.holder()},function(e,t,n){var i=n(1),o=n(4),r=n(7),a={name:"thing",fetched:!1,idAttribute:"_id",url:"/thing/"},s=function(e,t){i.observable(e),e._m=r.extend({},a),e._m=r.extend(e._m,t);var n=e._m;e.fetched=function(e){return"undefined"==typeof e?n.fetched:n.fetched=e},e.has=function(e){return null!=this.get(e)},e.isNew=function(){return!this.has(n.idAttribute)},e.toObject=function(){var e={};for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e},e.fetch=function(t,i){"undefined"==typeof i&&"object"==typeof t&&(i=t,t=null);var a=n;if(i&&(a=r.extend({},n))&&r.extend(a,i),t||(t=this[n.idAttribute]),!t)return console.error("fail to fetch: no id"),!1;var s=a.url+"_"+t,l=o.ajax({type:a.method||"GET",url:s});return l.done(function(t,n,o){t.status?e.trigger("fetch",t.result,i):e.trigger("fetch-error",t,i)}).fail(function(t,n,o){e.trigger("error",o,i)}).always(function(){}),l},e.append=function(t,i){"undefined"==typeof i&&"object"==typeof t&&(i=t,t=null);var a=n;if(i&&(a=r.extend({},n))&&r.extend(a,i),t||(t=this[n.idAttribute]),!t)return console.error("fail to append: no id"),!1;var s=a.url+"_"+t,l=o.ajax({type:a.method||"GET",url:s});return l.done(function(t,n,o){t.status?e.trigger("append",t.result,i):e.trigger("append-error",t,i)}).fail(function(t,n,o){e.trigger("error",o,i)}).always(function(){}),l};var s=function(e){var t=[];for(var n in e)t.push(n+"="+e[n]);return t.join("&")};return e.save=function(t,i){var a=n;i&&(a=r.extend({},n))&&r.extend(a,i);var l=this.isNew()?"POST":"PUT",c=this.isNew()?a.url:a.url+"_"+this[n.idAttribute],d=this.toObject(),u=s(d.query||{});""!=u&&(c+="?"+u);var p=o.ajax({type:l,url:c,data:d});return p.done(function(t,n,o){t.status?(e.fetched(!0),e.trigger("save",t.result,i)):e.trigger("save-error",t,i)}).fail(function(t,n,o){e.trigger("error",o,i)}).always(function(){}),p},e.get=function(e){return this[e]},e.set=function(e,t,n){if("myobj"==e&&"object"==typeof t)r.extend(this,t);else if("randomNotePic"==e&&"object"==typeof t)r.extend(this,t);else if("object"==t)this[e]=t;else{var i=this[e];this[e]=t,n&&n.silent||(this.trigger("change:"+e,this,t,i),this.trigger("change",this))}},e},l={name:"collection",url:"/thing/filter"},c=function(e,t){i.observable(e),e._m=r.extend({},l),e._m=r.extend(e._m,t);var n=e._m;return e.fetched=function(e){return"undefined"==typeof e?n.fetched:n.fetched=e},e.fetch=function(t){var i=n;t&&(i=r.extend({},n))&&r.extend(i,t);var a=n.filter||{},s=i.url,l=o.ajax({type:i.method||"POST",url:s,data:{filter:a}});return l.done(function(n,i,o){n.status?(e.items=n.result,e.fetched(!0),e.trigger("fetch",n.result,t)):e.trigger("fetch-error",n,t)}).fail(function(n,i,o){e.trigger("error",o,t)}).always(function(){}),l},e.append=function(t){var i=n;t&&(i=r.extend({},n))&&r.extend(i,t);var a=n.filter||{},s=i.url,l=o.ajax({type:i.method||"POST",url:s,data:{filter:a}});return l.done(function(n,i,o){n.status?(e.items=n.result,e.fetched(!0),e.trigger("append",n.result,t)):e.trigger("append-error",n,t)}).fail(function(n,i,o){e.trigger("error",o,t)}).always(function(){}),l},e},d=function(e,t){e.hidden=!0,e.ready=!1,e.mask=!1;var n=function(t){e.hidden=!t,e.mask=!t,e.update({hidden:e.hidden})};e.on("show",function(e){n(e)});var i=function(t){e.ready=t,e.update({ready:e.ready})};return e.on("ready",function(e){i(e)}),e.on("refresh",function(){console.info("start refreshing")}),e},u={modelable:function(e,t){return s(e,t)},collectable:function(e,t){return c(e,t)},presentable:function(e,t){return d(e,t)},viewable:function(e){var t=r.extend({},e);return t.init=function(e){if(this.mount(e),!this.tag)throw new Error("tag is not set");this.tag.on("view-route-to",function(){t.parent.trigger("view-route-to",t)}),this.tag.on("view-route-back",function(){t.parent.trigger("view-route-back",t)}),this.tag.on("model-changed",function(e,n,i){t.parent.trigger("app-changed",e,n,i)})},t.setParent=function(e){this.parent=e},t.leave=function(e,t){e.tag.trigger("leave",t.tag)},t.enter=function(e,t){t.tag.trigger("enter",e&&e.tag,e&&e.context)},t.reenter=function(){this.tag.trigger("reenter",this.context)},t.open=function(){this.tag.trigger("open")},t.close=function(){this.tag.trigger("close")},t.show=function(e){this.tag.trigger("show",e)},t.equalRoute=function(e){var t=this.context&&this.context.req.query.route,n=e&&e.context.req.query.route;return n===t},t},emptyFn:function(){}};e.exports=u},function(e,t,n){var i=n(4);i.fn.simslider=function(e){function t(){c>=l-1?(s.find(">ul").css({left:"0%"}),c=0,u.docs&&(s.find(".bannerdocs").find("li").removeClass("docsihov"),s.find(".bannerdocs").find("li:eq("+c+")").addClass("docsihov"))):(s.find(">ul").css({left:"-"+100*(c+1)+"%"}),u.docs&&(s.find(".bannerdocs").find("li").removeClass("docsihov"),s.find(".bannerdocs").find("li:eq("+(c+1)+")").addClass("docsihov")),c++)}function n(){0>=c?(s.find(">ul").css({left:"-"+100*(l-1)+"%"}),c=l-1,u.docs&&(s.find(".bannerdocs").find("li").removeClass("docsihov"),s.find(".bannerdocs").find("li:eq("+c+")").addClass("docsihov"))):(s.find(">ul").css({left:"-"+100*(c-1)+"%"}),u.docs&&(s.find(".bannerdocs").find("li").removeClass("docsihov"),s.find(".bannerdocs").find("li:eq("+(c-1)+")").addClass("docsihov")),
c--)}function o(e){var e=e||window.event;p=e.originalEvent.targetTouches[0].pageX}function r(e){e.preventDefault();var e=e||window.event;f=e.originalEvent.targetTouches[0].pageX}function a(){p-f>100?t():f-p>100&&n()}var s=this,l=this.find(">ul>li").length,c=0,d={docs:!0,docscolor:"white"},u=i.extend(d,e);this.css({width:"100%"}),this.find(">ul").css({width:100*l+"%",position:"relative",overflow:"hidden"}),this.find(">ul>li").css({width:parseFloat(100/l).toFixed(6)+"%"}),setInterval(t,5e3);var p,f;if(s.on("touchstart",o),s.on("touchmove",r),s.on("touchend",a),u.docs){for(var h="<div class='bannerdocs' style='width:100%;position:absolute;bottom:6px'><ul style='width:"+11*l+"px'>",m=0;l>m;m++)h+=0!=m?"<li class='docsidef' style='display:block;width:6px;height:6px;border-radius:50em;margin-right:5px;'></li>":"<li class='docsihov docsidef' style='display:block;width:6px;height:6px;border-radius:50em;margin-right:5px;'></li>";h+="</ul></div>",s.append(h)}},e.exports=null},function(e,t,n){var i=n(12);n(20);e.exports=i},function(e,t,n){var i=n(13),o=i.domain();o.restApi({baseUrl:__app.settings.api.url}),e.exports=o},function(e,t,n){var i=n(14);e.exports=i},function(e,t,n){var i={version:"WIP",settings:{}},o=n(15),r=n(16);o.extend(i,r);var a=n(17);o.extend(i,a);var s=n(18);o.extend(i,s);var l=n(19);o.extend(i,l);var c=function(){this._actions={},this._restApiFactories={},this._wsApiFactories={}};c.prototype.action=function(e){var t=this._actions[e];return t?t:this._actions[e]=new i.Action(this,e)},c.prototype.actions=function(){return this._actions},c.prototype.restApi=function(e,t){var n="object"==typeof e||"object"==typeof t,o="string"!=typeof e,r=o?"default":e,a=o?e:t;if(n){var s=!!this._restApiFactories[r];!s&&(this._restApiFactories[r]=new i.RestApiFactory(a)),s&&this._restApiFactories[r].options(a)}return this._restApiFactories[r]},c.prototype.wsApi=function(e,t){var n="string"!=typeof e,i=n?"default":e;return this._wsApiFactories[i]},i.domain=function(){return new c},e.exports=i},function(e,t){var n={};n.extend=function(e,t){for(var n in t)e[n]=t[n];return e},n.getArguments=function(e){return Array.prototype.slice.call(e,0)},n.remove=function(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)};var i={};n.nextId=function(e){return i[e]||(i[e]=1),i[e]++},e.exports=n},function(e,t,n){var i={},o=n(15),r=500,a=[{code:100,msg:"unknown error"},{code:101,msg:"ajax request timeout"},{code:102,msg:"ajax request abort"},{code:200,msg:"server side error"},{code:201,msg:"ajax parser error"},{code:500,msg:"wrong biz code, custom error code should be >500"}],s=function(e,t){for(var n=0;n<t.length;n++){var i=t[n];e[""+i.code]=i}},l={};s(l,a);var c={unknown:"100",error:"200",wrongcode:""+r},d={timeout:"101",abort:"102",error:"200",parsererror:"201"};o.extend(c,d);var u=function(e,t){this.code=e,this.msg=t};u.prototype.toString=function(){return"code: "+this.code+", msg: "+this.msg};var p={};p.codes=c,p.ajaxError=function(e,t){var n=e&&c[e]?c[e]:c.unknown,i=l[n];return new u(i.code,t||i.msg)},p.bizError=function(e,t){var n=new u(e,t);return r>e&&console.error("wrong biz error code: "+JSON.stringify(n)),n},i.ApiError=u,i.ApiErrorFactory=p,e.exports=i},function(e,t,n){var i={version:"WIP",settings:{}},o=n(15),r=n(16).ApiErrorFactory,a=$&&$.ajax||n(4),s={dataType:"json"},l=function(e){this._options=o.extend({},s),this.options(e||{})};l.defaultOptions=s,l.prototype.options=function(e){o.extend(this._options,e)};var c=function(e,t){e[t]=function(e){var n=new d(this._options),i=n.o;return i.method=t,i.url=(i.baseUrl||"")+e,n}};c(l.prototype,"get"),c(l.prototype,"post"),c(l.prototype,"put"),c(l.prototype,"delete");var d=function(e){this.o=o.extend({},e||{})},u=function(e,t){e[t]=function(e){return this.o[t]=e,this}};d.prototype.drive=function(e){return this.o.action=e,this},u(d.prototype,"done"),u(d.prototype,"fail"),u(d.prototype,"success"),u(d.prototype,"error"),u(d.prototype,"always"),d.prototype.onDone=function(e,t,n){if(e&&e.errcode){var i=r.bizError(e.errcode,e.errmsg);this.o.fail(i)}else e&&"undefined"!=typeof e.result?this.o.done(e.result):this.o.done(e)},d.prototype.onFail=function(e,t,n){var i=r.ajaxError(t,n);this.o.fail(i)},d.prototype.send=function(e){var t=a({type:this.o.method,url:this.o.url,dataType:this.o.dataType,data:e||null});if(this.o.action){var n=this.o.action;this.done(function(e){n.done(e)}).fail(function(e){n.fail(e)})}return this.o.done||this.o.fail?(t.done(this.onDone.bind(this)),t.fail(this.onFail.bind(this))):(this.o.success&&t.done(this.o.success),this.o.error&&t.fail(this.o.error)),this.o.always&&t.always(this.o.always),t},i.RestApi=d,i.RestApiFactory=l,e.exports=i},function(e,t){var n={};e.exports=n},function(e,t,n){var i={},o=n(15),r=n(1).observable,a=function(e,t,n){var i=[t];Array.prototype.push.apply(i,n),e.trigger.apply(e,i)},s=function(e,t,n,i){for(var o=n[i],r=o.length,a=null,s=0;r>s;s++)a=o[s],t.on(i,a.bind(e))},l=function(e,t){this.id=o.nextId(e.name()),this.action=e,this.inputs=t,this.outputs=null,this.error=null,this.executed=!1;var n=this._events=r({}),i=this.action._listeners;s(this,n,i,"execute"),s(this,n,i,"unexecute"),s(this,n,i,"done"),s(this,n,i,"fail"),s(this,n,i,"always")};l.prototype.execute=function(){a(this._events,"execute",this.inputs)},l.prototype.unexecute=function(){a(this._events,"unexecute",this.inputs)},l.prototype.onDone=function(e){return this._events.on("done",e.bind(this)),this},l.prototype.onFail=function(e){return this._events.on("fail",e.bind(this)),this},l.prototype.onAlways=function(e){return this._events.on("always",e.bind(this)),this},l.prototype.done=function(){var e=o.getArguments(arguments);this.outputs=e,this.executed=!0,a(this._events,"done",e),a(this._events,"always",e)},l.prototype.fail=function(){var e=o.getArguments(arguments);this.error=e[0],this.executed=!0,a(this._events,"fail",e),a(this._events,"always",e)};var c=function(e,t){this._domain=e,this._name=t,this._events=r({}),this._listeners={execute:[],unexecute:[],done:[],fail:[],always:[]}};c.prototype.name=function(e){return e?(this._name=e,this):this._name},c.prototype.onExecute=function(e){return this._listeners.execute.push(e),this},c.prototype.onUnexecute=function(e){return this._listeners.unexecute.push(e),this},c.prototype.onDone=function(e){return this._listeners.done.push(e),this},c.prototype.onFail=function(e){return this._listeners.fail.push(e),this},c.prototype.onAlways=function(e){return this._listeners.always.push(e),this},c.prototype.offDone=function(e){return o.remove(this._listeners.done,e),this},c.prototype.offFail=function(e){return o.remove(this._listeners.fail,e),this},c.prototype.offAlways=function(e){return o.remove(this._listeners.always,e),this},c.prototype.execute=function(){var e=new l(this,o.getArguments(arguments));return e.execute(),e},c.prototype.newInvocation=function(){return new l(this,o.getArguments(arguments))},i.Action=c,i.ActionInvocation=l,e.exports=i},function(e,t,n){var i=n(12);n(21),n(22),n(23),e.exports=i.actions()},function(e,t,n){var i=n(12),o=i.restApi();i.action("startBot").onExecute(function(e){o.post("/bot/start").drive(this).send(e)}),i.action("stopBot").onExecute(function(e){o.get("/bot/stop/"+e.openid).drive(this).send()}),i.action("syncContacts").onExecute(function(e){o.post("/bot/sync/contacts").drive(this).send(e)}),i.action("syncGroups").onExecute(function(e){o.post("/bot/sync/groups").drive(this).send(e)}),i.action("loadBotByMediaId").onExecute(function(e){o.get("/bot/"+e.botId).drive(this).send()}),i.action("saveTagsById").onExecute(function(e){o.post("/bot/tags/user/"+e.id).drive(this).send(e)}),i.action("broadcastTxt").onExecute(function(e){o.post("/bot/broadcastTxt").drive(this).send(e)}),i.action("broadcastImg").onExecute(function(e){o.post("/bot/broadcastImg").drive(this).send(e)}),i.action("loadBroadcastHistory").onExecute(function(e){o.get("/bot/broadcastHistory?botId="+e).drive(this).send()}),i.action("loadContacts").onExecute(function(e){o.get("/bot/contacts?botId="+e).drive(this).send()}),i.action("loadGroup").onExecute(function(e){o.get("/bot/group?id="+e.id).drive(this).send()}),i.action("editGroup").onExecute(function(e){o.put("/bot/group/"+e.id).drive(this).send(e)}),i.action("delGroup").onExecute(function(e){o["delete"]("/bot/group?id="+e.groupId).drive(this).send(e)}),i.action("addGroup").onExecute(function(e){o.post("/bot/group").drive(this).send(e)}),i.action("loadGroups").onExecute(function(e){o.get("/bot/groups?tenantId="+e.tenantId+"&operatorId="+e.operatorId).drive(this).send()}),i.action("loadAllMyManageMedia").onExecute(function(e){o.get("/bot/allMyMedia?tenantId="+e.tenantId+"&operatorId="+e.operatorId).drive(this).send()}),i.action("loadAllGroupMediaUsers").onExecute(function(e){o.post("/bot/group/mediaUser").drive(this).send(e)}),i.action("addGroupMembers").onExecute(function(e){o.post("/bot/group/members").drive(this).send(e)}),i.action("delGroupMember").onExecute(function(e){o["delete"]("/bot/group/members?ids="+e.mids+"&groupId="+e.groupId).drive(this).send()}),e.exports=null},function(e,t,n){var i=n(12),o=i.restApi();i.action("findTenants").onExecute(function(e){o.post("/tenant/filter").drive(this).send(e)}),i.action("loadTenantById").onExecute(function(e){o.get("/tenant/_"+e.id).drive(this).send()}),i.action("updateTenantById").onExecute(function(e){o.put("/tenant/_"+e.id).drive(this).send(e)}),i.action("addTenantWechatSite").onExecute(function(e){o.post("/tenant/add-wechatsite").drive(this).send(e)}),i.action("loadAllTenantWechatSite").onExecute(function(e){o.get("/tenant/wechatsite/loadAll?tenant="+e).drive(this).send()}),i.action("loadTenantWechatSite").onExecute(function(e){o.get("/tenant/wechatsite/load?id="+e).drive(this).send()}),i.action("updateTenantWechatSiteById").onExecute(function(e){o.put("/tenant/wechatsite/_"+e.id).drive(this).send(e)}),i.action("loadWechatSiteSettings").onExecute(function(e){o.get("/tenant/wechatsite/settings/load?id="+e).drive(this).send()}),i.action("saveWechatSiteSettings").onExecute(function(e){o.post("/tenant/wechatsite/settings/save").drive(this).send(e)}),i.action("findDistributorsCountByTenantId").onExecute(function(e){o.get("/tenant/sd/distributors/count?tenant="+e.tenant).drive(this).send()}),i.action("findCustomersCountByTenantId").onExecute(function(e){o.get("/tenant/sd/customers/count?tenant="+e.tenant).drive(this).send()}),i.action("findCustomersByTenantId").onExecute(function(e){var t=Object.keys(e.filter).map(function(t){return t+"="+e.filter[t]}).join("&");o.get("/tenant/sd/customers?"+t).drive(this).send()}),i.action("checkout").onExecute(function(e){o.post("/tenant/sd/distributors/checkout").drive(this).send(e)}),i.action("findDistributorsWithPendingPaymentByTenantId").onExecute(function(e){var t=Object.keys(e.filter).map(function(t){return t+"="+e.filter[t]}).join("&");o.get("/tenant/sd/distributors/payment?"+t).drive(this).send()}),i.action("findDistributorsCountWithPendingPaymentByTenantId").onExecute(function(e){o.get("/tenant/sd/distributors/payment/count?tenant="+e.tenant).drive(this).send()}),i.action("findOrderRelatedDistributor").onExecute(function(e){o.get("/tenant/sd/orders/distributor?distributor="+e.distributor+"&status="+e.status).drive(this).send()}),i.action("findDistributorsByTenantId").onExecute(function(e){var t=Object.keys(e.filter).map(function(t){return t+"="+e.filter[t]}).join("&");o.get("/tenant/sd/distributors?"+t).drive(this).send()}),i.action("createOrder").onExecute(function(e){o.post("/tenant/sd/order").drive(this).send(e)}),i.action("createCourse").onExecute(function(e){o.post("/tenant/sd/course").drive(this).send(e)}),i.action("findCourses").onExecute(function(e){o.post("/tenant/sd/courses").drive(this).send(e)}),i.action("loadCourseById").onExecute(function(e){o.get("/tenant/sd/course/_"+e.id).drive(this).send(e)}),i.action("updateCourseById").onExecute(function(e){o.put("/tenant/sd/course/_"+e.id).drive(this).send(e)}),i.action("createCatalog").onExecute(function(e){o.post("/tenant/sd/catalog").drive(this).send(e)}),i.action("loadCatalogById").onExecute(function(e){o.get("/tenant/sd/catalog/_"+e.id).drive(this).send()}),i.action("updateCatalogById").onExecute(function(e){o.put("/tenant/sd/catalog/_"+e.id).drive(this).send(e)}),i.action("fetchSdQrByProductAndWechatSite").onExecute(function(e){o.post("/tenant/sd/catalog/poster").drive(this).send(e)}),i.action("findBespeaks").onExecute(function(e){var t=Object.keys(e.filter).map(function(t){return t+"="+e.filter[t]}).join("&");o.get("/tenant/sd/bespeak?"+t).drive(this).send()}),i.action("updateBespeakById").onExecute(function(e){o.put("/tenant/sd/bespeaks/_"+e.id).drive(this).send(e)}),i.action("findCatalogs").onExecute(function(e){var t=Object.keys(e.filter).map(function(t){return t+"="+e.filter[t]}).join("&");o.get("/tenant/sd/catalog?"+t).drive(this).send()}),i.action("loadPowerActivities").onExecute(function(e){o.get("/marketing/tenant/power/load?tenantId="+e.tenantId).drive(this).send()}),i.action("loadPowerActivity").onExecute(function(e){o.get("/marketing/tenant/power/loadById?id="+e.id).drive(this).send()}),i.action("updatePowerActivity").onExecute(function(e){o.post("/marketing/tenant/power/update").drive(this).send(e)}),i.action("addPowerActivity").onExecute(function(e){o.post("/marketing/tenant/power/add").drive(this).send(e)}),i.action("findOrders").onExecute(function(e){var t=Object.keys(e.filter).map(function(t){return t+"="+e.filter[t]}).join("&");o.get("/tenant/sd/orders?"+t).drive(this).send()}),e.exports=null},function(e,t,n){var i=n(12),o=i.restApi();i.action("findTenantAdlinks").onExecute(function(e){o.get("/adlink/tenant-"+e).drive(this).send()}),i.action("findTenantRecontents").onExecute(function(e){o.get("/recontent/tenant-"+e).drive(this).send()}),i.action("loadAdlink").onExecute(function(e){o.get("/adlink/_"+e).drive(this).send()}),i.action("loadAndEditAdlink").onExecute(function(e){o.get("/adlink/_"+e).drive(this).send()}),i.action("createAdlink").onExecute(function(e){o.post("/adlink/").drive(this).send(e)}),i.action("updateAdlink").onExecute(function(e){o.put("/adlink/_"+e._id).drive(this).send(e)}),e.exports=null},function(e,t){if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(e){"use strict";var t=e.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||1==t[0]&&9==t[1]&&t[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher")}(jQuery),+function(e){"use strict";function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(void 0!==e.style[n])return{end:t[n]};return!1}e.fn.emulateTransitionEnd=function(t){var n=!1,i=this;e(this).one("bsTransitionEnd",function(){n=!0});var o=function(){n||e(i).trigger(e.support.transition.end)};return setTimeout(o,t),this},e(function(){e.support.transition=t(),e.support.transition&&(e.event.special.bsTransitionEnd={bindType:e.support.transition.end,delegateType:e.support.transition.end,handle:function(t){return e(t.target).is(this)?t.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var n=e(this),o=n.data("bs.alert");o||n.data("bs.alert",o=new i(this)),"string"==typeof t&&o[t].call(n)})}var n='[data-dismiss="alert"]',i=function(t){e(t).on("click",n,this.close)};i.VERSION="3.3.5",i.TRANSITION_DURATION=150,i.prototype.close=function(t){function n(){a.detach().trigger("closed.bs.alert").remove()}var o=e(this),r=o.attr("data-target");r||(r=o.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));var a=e(r);t&&t.preventDefault(),a.length||(a=o.closest(".alert")),a.trigger(t=e.Event("close.bs.alert")),t.isDefaultPrevented()||(a.removeClass("in"),e.support.transition&&a.hasClass("fade")?a.one("bsTransitionEnd",n).emulateTransitionEnd(i.TRANSITION_DURATION):n())};var o=e.fn.alert;e.fn.alert=t,e.fn.alert.Constructor=i,e.fn.alert.noConflict=function(){return e.fn.alert=o,this},e(document).on("click.bs.alert.data-api",n,i.prototype.close)}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),o=i.data("bs.button"),r="object"==typeof t&&t;o||i.data("bs.button",o=new n(this,r)),"toggle"==t?o.toggle():t&&o.setState(t)})}var n=function(t,i){this.$element=e(t),this.options=e.extend({},n.DEFAULTS,i),this.isLoading=!1};n.VERSION="3.3.5",n.DEFAULTS={loadingText:"loading..."},n.prototype.setState=function(t){var n="disabled",i=this.$element,o=i.is("input")?"val":"html",r=i.data();t+="Text",null==r.resetText&&i.data("resetText",i[o]()),setTimeout(e.proxy(function(){i[o](null==r[t]?this.options[t]:r[t]),"loadingText"==t?(this.isLoading=!0,i.addClass(n).attr(n,n)):this.isLoading&&(this.isLoading=!1,i.removeClass(n).removeAttr(n))},this),0)},n.prototype.toggle=function(){var e=!0,t=this.$element.closest('[data-toggle="buttons"]');if(t.length){var n=this.$element.find("input");"radio"==n.prop("type")?(n.prop("checked")&&(e=!1),t.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==n.prop("type")&&(n.prop("checked")!==this.$element.hasClass("active")&&(e=!1),this.$element.toggleClass("active")),n.prop("checked",this.$element.hasClass("active")),e&&n.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var i=e.fn.button;e.fn.button=t,e.fn.button.Constructor=n,e.fn.button.noConflict=function(){return e.fn.button=i,this},e(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(n){var i=e(n.target);i.hasClass("btn")||(i=i.closest(".btn")),t.call(i,"toggle"),e(n.target).is('input[type="radio"]')||e(n.target).is('input[type="checkbox"]')||n.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(t){e(t.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(t.type))})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),o=i.data("bs.carousel"),r=e.extend({},n.DEFAULTS,i.data(),"object"==typeof t&&t),a="string"==typeof t?t:r.slide;o||i.data("bs.carousel",o=new n(this,r)),"number"==typeof t?o.to(t):a?o[a]():r.interval&&o.pause().cycle()})}var n=function(t,n){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",e.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",e.proxy(this.pause,this)).on("mouseleave.bs.carousel",e.proxy(this.cycle,this))};n.VERSION="3.3.5",n.TRANSITION_DURATION=600,n.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},n.prototype.keydown=function(e){if(!/input|textarea/i.test(e.target.tagName)){switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return}e.preventDefault()}},n.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},n.prototype.getItemIndex=function(e){return this.$items=e.parent().children(".item"),this.$items.index(e||this.$active)},n.prototype.getItemForDirection=function(e,t){var n=this.getItemIndex(t),i="prev"==e&&0===n||"next"==e&&n==this.$items.length-1;if(i&&!this.options.wrap)return t;var o="prev"==e?-1:1,r=(n+o)%this.$items.length;return this.$items.eq(r)},n.prototype.to=function(e){var t=this,n=this.getItemIndex(this.$active=this.$element.find(".item.active"));return e>this.$items.length-1||0>e?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){t.to(e)}):n==e?this.pause().cycle():this.slide(e>n?"next":"prev",this.$items.eq(e))},n.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},n.prototype.next=function(){return this.sliding?void 0:this.slide("next")},n.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},n.prototype.slide=function(t,i){var o=this.$element.find(".item.active"),r=i||this.getItemForDirection(t,o),a=this.interval,s="next"==t?"left":"right",l=this;if(r.hasClass("active"))return this.sliding=!1;var c=r[0],d=e.Event("slide.bs.carousel",{relatedTarget:c,direction:s});if(this.$element.trigger(d),!d.isDefaultPrevented()){if(this.sliding=!0,a&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var u=e(this.$indicators.children()[this.getItemIndex(r)]);u&&u.addClass("active")}var p=e.Event("slid.bs.carousel",{relatedTarget:c,direction:s});return e.support.transition&&this.$element.hasClass("slide")?(r.addClass(t),r[0].offsetWidth,o.addClass(s),r.addClass(s),o.one("bsTransitionEnd",function(){r.removeClass([t,s].join(" ")).addClass("active"),o.removeClass(["active",s].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger(p)},0)}).emulateTransitionEnd(n.TRANSITION_DURATION)):(o.removeClass("active"),r.addClass("active"),this.sliding=!1,this.$element.trigger(p)),a&&this.cycle(),this}};var i=e.fn.carousel;e.fn.carousel=t,e.fn.carousel.Constructor=n,e.fn.carousel.noConflict=function(){return e.fn.carousel=i,this};var o=function(n){var i,o=e(this),r=e(o.attr("data-target")||(i=o.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""));if(r.hasClass("carousel")){var a=e.extend({},r.data(),o.data()),s=o.attr("data-slide-to");s&&(a.interval=!1),t.call(r,a),s&&r.data("bs.carousel").to(s),n.preventDefault()}};e(document).on("click.bs.carousel.data-api","[data-slide]",o).on("click.bs.carousel.data-api","[data-slide-to]",o),e(window).on("load",function(){e('[data-ride="carousel"]').each(function(){var n=e(this);t.call(n,n.data())})})}(jQuery),+function(e){"use strict";function t(t){var n,i=t.attr("data-target")||(n=t.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"");return e(i)}function n(t){return this.each(function(){var n=e(this),o=n.data("bs.collapse"),r=e.extend({},i.DEFAULTS,n.data(),"object"==typeof t&&t);!o&&r.toggle&&/show|hide/.test(t)&&(r.toggle=!1),o||n.data("bs.collapse",o=new i(this,r)),"string"==typeof t&&o[t]()})}var i=function(t,n){this.$element=e(t),this.options=e.extend({},i.DEFAULTS,n),this.$trigger=e('[data-toggle="collapse"][href="#'+t.id+'"],[data-toggle="collapse"][data-target="#'+t.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};i.VERSION="3.3.5",i.TRANSITION_DURATION=350,i.DEFAULTS={toggle:!0},i.prototype.dimension=function(){var e=this.$element.hasClass("width");return e?"width":"height"},i.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var t,o=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(o&&o.length&&(t=o.data("bs.collapse"),t&&t.transitioning))){var r=e.Event("show.bs.collapse");if(this.$element.trigger(r),!r.isDefaultPrevented()){o&&o.length&&(n.call(o,"hide"),t||o.data("bs.collapse",null));var a=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[a](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var s=function(){this.$element.removeClass("collapsing").addClass("collapse in")[a](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return s.call(this);var l=e.camelCase(["scroll",a].join("-"));this.$element.one("bsTransitionEnd",e.proxy(s,this)).emulateTransitionEnd(i.TRANSITION_DURATION)[a](this.$element[0][l])}}}},i.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=e.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var o=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return e.support.transition?void this.$element[n](0).one("bsTransitionEnd",e.proxy(o,this)).emulateTransitionEnd(i.TRANSITION_DURATION):o.call(this)}}},i.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},i.prototype.getParent=function(){return e(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(e.proxy(function(n,i){var o=e(i);this.addAriaAndCollapsedClass(t(o),o)},this)).end()},i.prototype.addAriaAndCollapsedClass=function(e,t){var n=e.hasClass("in");e.attr("aria-expanded",n),t.toggleClass("collapsed",!n).attr("aria-expanded",n)};var o=e.fn.collapse;e.fn.collapse=n,e.fn.collapse.Constructor=i,e.fn.collapse.noConflict=function(){return e.fn.collapse=o,this},e(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(i){var o=e(this);o.attr("data-target")||i.preventDefault();var r=t(o),a=r.data("bs.collapse"),s=a?"toggle":o.data();n.call(r,s)})}(jQuery),+function(e){"use strict";function t(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var i=n&&e(n);return i&&i.length?i:t.parent()}function n(n){n&&3===n.which||(e(o).remove(),e(r).each(function(){var i=e(this),o=t(i),r={relatedTarget:this};o.hasClass("open")&&(n&&"click"==n.type&&/input|textarea/i.test(n.target.tagName)&&e.contains(o[0],n.target)||(o.trigger(n=e.Event("hide.bs.dropdown",r)),n.isDefaultPrevented()||(i.attr("aria-expanded","false"),o.removeClass("open").trigger("hidden.bs.dropdown",r))))}))}function i(t){return this.each(function(){var n=e(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new a(this)),"string"==typeof t&&i[t].call(n)})}var o=".dropdown-backdrop",r='[data-toggle="dropdown"]',a=function(t){e(t).on("click.bs.dropdown",this.toggle)};a.VERSION="3.3.5",a.prototype.toggle=function(i){var o=e(this);if(!o.is(".disabled, :disabled")){var r=t(o),a=r.hasClass("open");if(n(),!a){"ontouchstart"in document.documentElement&&!r.closest(".navbar-nav").length&&e(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(e(this)).on("click",n);var s={relatedTarget:this};if(r.trigger(i=e.Event("show.bs.dropdown",s)),i.isDefaultPrevented())return;o.trigger("focus").attr("aria-expanded","true"),r.toggleClass("open").trigger("shown.bs.dropdown",s)}return!1}},a.prototype.keydown=function(n){if(/(38|40|27|32)/.test(n.which)&&!/input|textarea/i.test(n.target.tagName)){var i=e(this);if(n.preventDefault(),n.stopPropagation(),!i.is(".disabled, :disabled")){var o=t(i),a=o.hasClass("open");if(!a&&27!=n.which||a&&27==n.which)return 27==n.which&&o.find(r).trigger("focus"),i.trigger("click");var s=" li:not(.disabled):visible a",l=o.find(".dropdown-menu"+s);if(l.length){var c=l.index(n.target);38==n.which&&c>0&&c--,40==n.which&&c<l.length-1&&c++,~c||(c=0),l.eq(c).trigger("focus")}}}};var s=e.fn.dropdown;e.fn.dropdown=i,e.fn.dropdown.Constructor=a,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=s,this},e(document).on("click.bs.dropdown.data-api",n).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",r,a.prototype.toggle).on("keydown.bs.dropdown.data-api",r,a.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",a.prototype.keydown)}(jQuery),+function(e){"use strict";function t(t,i){return this.each(function(){var o=e(this),r=o.data("bs.modal"),a=e.extend({},n.DEFAULTS,o.data(),"object"==typeof t&&t);r||o.data("bs.modal",r=new n(this,a)),"string"==typeof t?r[t](i):a.show&&r.show(i)})}var n=function(t,n){this.options=n,this.$body=e(document.body),this.$element=e(t),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};n.VERSION="3.3.5",n.TRANSITION_DURATION=300,n.BACKDROP_TRANSITION_DURATION=150,n.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},n.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},n.prototype.show=function(t){var i=this,o=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(o),this.isShown||o.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){i.$element.one("mouseup.dismiss.bs.modal",function(t){e(t.target).is(i.$element)&&(i.ignoreBackdropClick=!0)})}),this.backdrop(function(){var o=e.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(i.$body),i.$element.show().scrollTop(0),i.adjustDialog(),o&&i.$element[0].offsetWidth,i.$element.addClass("in"),i.enforceFocus();var r=e.Event("shown.bs.modal",{relatedTarget:t});o?i.$dialog.one("bsTransitionEnd",function(){i.$element.trigger("focus").trigger(r)}).emulateTransitionEnd(n.TRANSITION_DURATION):i.$element.trigger("focus").trigger(r)}))},n.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",e.proxy(this.hideModal,this)).emulateTransitionEnd(n.TRANSITION_DURATION):this.hideModal())},n.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},n.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},n.prototype.resize=function(){this.isShown?e(window).on("resize.bs.modal",e.proxy(this.handleUpdate,this)):e(window).off("resize.bs.modal")},n.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.$body.removeClass("modal-open"),e.resetAdjustments(),e.resetScrollbar(),e.$element.trigger("hidden.bs.modal")})},n.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},n.prototype.backdrop=function(t){var i=this,o=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var r=e.support.transition&&o;if(this.$backdrop=e(document.createElement("div")).addClass("modal-backdrop "+o).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",e.proxy(function(e){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),r&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;r?this.$backdrop.one("bsTransitionEnd",t).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION):t()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var a=function(){i.removeBackdrop(),t&&t()};e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",a).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION):a()}else t&&t()},n.prototype.handleUpdate=function(){
this.adjustDialog()},n.prototype.adjustDialog=function(){var e=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&e?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!e?this.scrollbarWidth:""})},n.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},n.prototype.checkScrollbar=function(){var e=window.innerWidth;if(!e){var t=document.documentElement.getBoundingClientRect();e=t.right-Math.abs(t.left)}this.bodyIsOverflowing=document.body.clientWidth<e,this.scrollbarWidth=this.measureScrollbar()},n.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",e+this.scrollbarWidth)},n.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},n.prototype.measureScrollbar=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",this.$body.append(e);var t=e.offsetWidth-e.clientWidth;return this.$body[0].removeChild(e),t};var i=e.fn.modal;e.fn.modal=t,e.fn.modal.Constructor=n,e.fn.modal.noConflict=function(){return e.fn.modal=i,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(n){var i=e(this),o=i.attr("href"),r=e(i.attr("data-target")||o&&o.replace(/.*(?=#[^\s]+$)/,"")),a=r.data("bs.modal")?"toggle":e.extend({remote:!/#/.test(o)&&o},r.data(),i.data());i.is("a")&&n.preventDefault(),r.one("show.bs.modal",function(e){e.isDefaultPrevented()||r.one("hidden.bs.modal",function(){i.is(":visible")&&i.trigger("focus")})}),t.call(r,a,this)})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),o=i.data("bs.tooltip"),r="object"==typeof t&&t;(o||!/destroy|hide/.test(t))&&(o||i.data("bs.tooltip",o=new n(this,r)),"string"==typeof t&&o[t]())})}var n=function(e,t){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",e,t)};n.VERSION="3.3.5",n.TRANSITION_DURATION=150,n.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},n.prototype.init=function(t,n,i){if(this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&e(e.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var o=this.options.trigger.split(" "),r=o.length;r--;){var a=o[r];if("click"==a)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=a){var s="hover"==a?"mouseenter":"focusin",l="hover"==a?"mouseleave":"focusout";this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},n.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,i){n[e]!=i&&(t[e]=i)}),t},n.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),t instanceof e.Event&&(n.inState["focusin"==t.type?"focus":"hover"]=!0),n.tip().hasClass("in")||"in"==n.hoverState?void(n.hoverState="in"):(clearTimeout(n.timeout),n.hoverState="in",n.options.delay&&n.options.delay.show?void(n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show)):n.show())},n.prototype.isInStateTrue=function(){for(var e in this.inState)if(this.inState[e])return!0;return!1},n.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),t instanceof e.Event&&(n.inState["focusout"==t.type?"focus":"hover"]=!1),n.isInStateTrue()?void 0:(clearTimeout(n.timeout),n.hoverState="out",n.options.delay&&n.options.delay.hide?void(n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide)):n.hide())},n.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);var i=e.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(t.isDefaultPrevented()||!i)return;var o=this,r=this.tip(),a=this.getUID(this.type);this.setContent(),r.attr("id",a),this.$element.attr("aria-describedby",a),this.options.animation&&r.addClass("fade");var s="function"==typeof this.options.placement?this.options.placement.call(this,r[0],this.$element[0]):this.options.placement,l=/\s?auto?\s?/i,c=l.test(s);c&&(s=s.replace(l,"")||"top"),r.detach().css({top:0,left:0,display:"block"}).addClass(s).data("bs."+this.type,this),this.options.container?r.appendTo(this.options.container):r.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var d=this.getPosition(),u=r[0].offsetWidth,p=r[0].offsetHeight;if(c){var f=s,h=this.getPosition(this.$viewport);s="bottom"==s&&d.bottom+p>h.bottom?"top":"top"==s&&d.top-p<h.top?"bottom":"right"==s&&d.right+u>h.width?"left":"left"==s&&d.left-u<h.left?"right":s,r.removeClass(f).addClass(s)}var m=this.getCalculatedOffset(s,d,u,p);this.applyPlacement(m,s);var g=function(){var e=o.hoverState;o.$element.trigger("shown.bs."+o.type),o.hoverState=null,"out"==e&&o.leave(o)};e.support.transition&&this.$tip.hasClass("fade")?r.one("bsTransitionEnd",g).emulateTransitionEnd(n.TRANSITION_DURATION):g()}},n.prototype.applyPlacement=function(t,n){var i=this.tip(),o=i[0].offsetWidth,r=i[0].offsetHeight,a=parseInt(i.css("margin-top"),10),s=parseInt(i.css("margin-left"),10);isNaN(a)&&(a=0),isNaN(s)&&(s=0),t.top+=a,t.left+=s,e.offset.setOffset(i[0],e.extend({using:function(e){i.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),i.addClass("in");var l=i[0].offsetWidth,c=i[0].offsetHeight;"top"==n&&c!=r&&(t.top=t.top+r-c);var d=this.getViewportAdjustedDelta(n,t,l,c);d.left?t.left+=d.left:t.top+=d.top;var u=/top|bottom/.test(n),p=u?2*d.left-o+l:2*d.top-r+c,f=u?"offsetWidth":"offsetHeight";i.offset(t),this.replaceArrow(p,i[0][f],u)},n.prototype.replaceArrow=function(e,t,n){this.arrow().css(n?"left":"top",50*(1-e/t)+"%").css(n?"top":"left","")},n.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},n.prototype.hide=function(t){function i(){"in"!=o.hoverState&&r.detach(),o.$element.removeAttr("aria-describedby").trigger("hidden.bs."+o.type),t&&t()}var o=this,r=e(this.$tip),a=e.Event("hide.bs."+this.type);return this.$element.trigger(a),a.isDefaultPrevented()?void 0:(r.removeClass("in"),e.support.transition&&r.hasClass("fade")?r.one("bsTransitionEnd",i).emulateTransitionEnd(n.TRANSITION_DURATION):i(),this.hoverState=null,this)},n.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},n.prototype.hasContent=function(){return this.getTitle()},n.prototype.getPosition=function(t){t=t||this.$element;var n=t[0],i="BODY"==n.tagName,o=n.getBoundingClientRect();null==o.width&&(o=e.extend({},o,{width:o.right-o.left,height:o.bottom-o.top}));var r=i?{top:0,left:0}:t.offset(),a={scroll:i?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},s=i?{width:e(window).width(),height:e(window).height()}:null;return e.extend({},o,a,s,r)},n.prototype.getCalculatedOffset=function(e,t,n,i){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-n/2}:"top"==e?{top:t.top-i,left:t.left+t.width/2-n/2}:"left"==e?{top:t.top+t.height/2-i/2,left:t.left-n}:{top:t.top+t.height/2-i/2,left:t.left+t.width}},n.prototype.getViewportAdjustedDelta=function(e,t,n,i){var o={top:0,left:0};if(!this.$viewport)return o;var r=this.options.viewport&&this.options.viewport.padding||0,a=this.getPosition(this.$viewport);if(/right|left/.test(e)){var s=t.top-r-a.scroll,l=t.top+r-a.scroll+i;s<a.top?o.top=a.top-s:l>a.top+a.height&&(o.top=a.top+a.height-l)}else{var c=t.left-r,d=t.left+r+n;c<a.left?o.left=a.left-c:d>a.right&&(o.left=a.left+a.width-d)}return o},n.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||("function"==typeof n.title?n.title.call(t[0]):n.title)},n.prototype.getUID=function(e){do e+=~~(1e6*Math.random());while(document.getElementById(e));return e},n.prototype.tip=function(){if(!this.$tip&&(this.$tip=e(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},n.prototype.enable=function(){this.enabled=!0},n.prototype.disable=function(){this.enabled=!1},n.prototype.toggleEnabled=function(){this.enabled=!this.enabled},n.prototype.toggle=function(t){var n=this;t&&(n=e(t.currentTarget).data("bs."+this.type),n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n))),t?(n.inState.click=!n.inState.click,n.isInStateTrue()?n.enter(n):n.leave(n)):n.tip().hasClass("in")?n.leave(n):n.enter(n)},n.prototype.destroy=function(){var e=this;clearTimeout(this.timeout),this.hide(function(){e.$element.off("."+e.type).removeData("bs."+e.type),e.$tip&&e.$tip.detach(),e.$tip=null,e.$arrow=null,e.$viewport=null})};var i=e.fn.tooltip;e.fn.tooltip=t,e.fn.tooltip.Constructor=n,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=i,this}}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),o=i.data("bs.popover"),r="object"==typeof t&&t;(o||!/destroy|hide/.test(t))&&(o||i.data("bs.popover",o=new n(this,r)),"string"==typeof t&&o[t]())})}var n=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");n.VERSION="3.3.5",n.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),n.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),n.prototype.constructor=n,n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof n?"html":"append":"text"](n),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},n.prototype.hasContent=function(){return this.getTitle()||this.getContent()},n.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var i=e.fn.popover;e.fn.popover=t,e.fn.popover.Constructor=n,e.fn.popover.noConflict=function(){return e.fn.popover=i,this}}(jQuery),+function(e){"use strict";function t(n,i){this.$body=e(document.body),this.$scrollElement=e(e(n).is(document.body)?window:n),this.options=e.extend({},t.DEFAULTS,i),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",e.proxy(this.process,this)),this.refresh(),this.process()}function n(n){return this.each(function(){var i=e(this),o=i.data("bs.scrollspy"),r="object"==typeof n&&n;o||i.data("bs.scrollspy",o=new t(this,r)),"string"==typeof n&&o[n]()})}t.VERSION="3.3.5",t.DEFAULTS={offset:10},t.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},t.prototype.refresh=function(){var t=this,n="offset",i=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),e.isWindow(this.$scrollElement[0])||(n="position",i=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var t=e(this),o=t.data("target")||t.attr("href"),r=/^#./.test(o)&&e(o);return r&&r.length&&r.is(":visible")&&[[r[n]().top+i,o]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},t.prototype.process=function(){var e,t=this.$scrollElement.scrollTop()+this.options.offset,n=this.getScrollHeight(),i=this.options.offset+n-this.$scrollElement.height(),o=this.offsets,r=this.targets,a=this.activeTarget;if(this.scrollHeight!=n&&this.refresh(),t>=i)return a!=(e=r[r.length-1])&&this.activate(e);if(a&&t<o[0])return this.activeTarget=null,this.clear();for(e=o.length;e--;)a!=r[e]&&t>=o[e]&&(void 0===o[e+1]||t<o[e+1])&&this.activate(r[e])},t.prototype.activate=function(t){this.activeTarget=t,this.clear();var n=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',i=e(n).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate.bs.scrollspy")},t.prototype.clear=function(){e(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var i=e.fn.scrollspy;e.fn.scrollspy=n,e.fn.scrollspy.Constructor=t,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=i,this},e(window).on("load.bs.scrollspy.data-api",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);n.call(t,t.data())})})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),o=i.data("bs.tab");o||i.data("bs.tab",o=new n(this)),"string"==typeof t&&o[t]()})}var n=function(t){this.element=e(t)};n.VERSION="3.3.5",n.TRANSITION_DURATION=150,n.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),i=t.data("target");if(i||(i=t.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var o=n.find(".active:last a"),r=e.Event("hide.bs.tab",{relatedTarget:t[0]}),a=e.Event("show.bs.tab",{relatedTarget:o[0]});if(o.trigger(r),t.trigger(a),!a.isDefaultPrevented()&&!r.isDefaultPrevented()){var s=e(i);this.activate(t.closest("li"),n),this.activate(s,s.parent(),function(){o.trigger({type:"hidden.bs.tab",relatedTarget:t[0]}),t.trigger({type:"shown.bs.tab",relatedTarget:o[0]})})}}},n.prototype.activate=function(t,i,o){function r(){a.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),t.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),s?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu").length&&t.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),o&&o()}var a=i.find("> .active"),s=o&&e.support.transition&&(a.length&&a.hasClass("fade")||!!i.find("> .fade").length);a.length&&s?a.one("bsTransitionEnd",r).emulateTransitionEnd(n.TRANSITION_DURATION):r(),a.removeClass("in")};var i=e.fn.tab;e.fn.tab=t,e.fn.tab.Constructor=n,e.fn.tab.noConflict=function(){return e.fn.tab=i,this};var o=function(n){n.preventDefault(),t.call(e(this),"show")};e(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',o).on("click.bs.tab.data-api",'[data-toggle="pill"]',o)}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var i=e(this),o=i.data("bs.affix"),r="object"==typeof t&&t;o||i.data("bs.affix",o=new n(this,r)),"string"==typeof t&&o[t]()})}var n=function(t,i){this.options=e.extend({},n.DEFAULTS,i),this.$target=e(this.options.target).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(t),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};n.VERSION="3.3.5",n.RESET="affix affix-top affix-bottom",n.DEFAULTS={offset:0,target:window},n.prototype.getState=function(e,t,n,i){var o=this.$target.scrollTop(),r=this.$element.offset(),a=this.$target.height();if(null!=n&&"top"==this.affixed)return n>o?"top":!1;if("bottom"==this.affixed)return null!=n?o+this.unpin<=r.top?!1:"bottom":e-i>=o+a?!1:"bottom";var s=null==this.affixed,l=s?o:r.top,c=s?a:t;return null!=n&&n>=o?"top":null!=i&&l+c>=e-i?"bottom":!1},n.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(n.RESET).addClass("affix");var e=this.$target.scrollTop(),t=this.$element.offset();return this.pinnedOffset=t.top-e},n.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},n.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=this.$element.height(),i=this.options.offset,o=i.top,r=i.bottom,a=Math.max(e(document).height(),e(document.body).height());"object"!=typeof i&&(r=o=i),"function"==typeof o&&(o=i.top(this.$element)),"function"==typeof r&&(r=i.bottom(this.$element));var s=this.getState(a,t,o,r);if(this.affixed!=s){null!=this.unpin&&this.$element.css("top","");var l="affix"+(s?"-"+s:""),c=e.Event(l+".bs.affix");if(this.$element.trigger(c),c.isDefaultPrevented())return;this.affixed=s,this.unpin="bottom"==s?this.getPinnedOffset():null,this.$element.removeClass(n.RESET).addClass(l).trigger(l.replace("affix","affixed")+".bs.affix")}"bottom"==s&&this.$element.offset({top:a-t-r})}};var i=e.fn.affix;e.fn.affix=t,e.fn.affix.Constructor=n,e.fn.affix.noConflict=function(){return e.fn.affix=i,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var n=e(this),i=n.data();i.offset=i.offset||{},null!=i.offsetBottom&&(i.offset.bottom=i.offsetBottom),null!=i.offsetTop&&(i.offset.top=i.offsetTop),t.call(n,i)})})}(jQuery)},function(e,t,n){var i,o,r;!function(a){o=[n(4)],i=a,r="function"==typeof i?i.apply(t,o):i,!(void 0!==r&&(e.exports=r))}(function(e){"use strict";var t,i=function(){var t=function(e){return function(t){return e===t}},n=function(e,t){return e===t},i=function(e){return function(t,n){return t[e]===n[e]}},o=function(){return!0},r=function(){return!1},a=function(e){return function(){return!e.apply(e,arguments)}},s=function(e,t){return function(n){return e(n)&&t(n)}},l=function(e){return e},c=function(e,t){return function(){return e[t].apply(e,arguments)}},d=0,u=function(e){var t=++d+"";return e?e+t:t},p=function(t){var n=e(document);return{top:t.top+n.scrollTop(),left:t.left+n.scrollLeft(),width:t.right-t.left,height:t.bottom-t.top}},f=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t},h=function(e,t){return t=t||"",t+e.split(".").map(function(e){return e.substring(0,1).toUpperCase()+e.substring(1)}).join("")};return{eq:t,eq2:n,peq2:i,ok:o,fail:r,self:l,not:a,and:s,invoke:c,uniqueId:u,rect2bnd:p,invertObject:f,namespaceToCamel:h}}(),o=function(){var t=function(e){return e[0]},n=function(e){return e[e.length-1]},o=function(e){return e.slice(0,e.length-1)},r=function(e){return e.slice(1)},a=function(e,t){for(var n=0,i=e.length;i>n;n++){var o=e[n];if(t(o))return o}},s=function(e,t){for(var n=0,i=e.length;i>n;n++)if(!t(e[n]))return!1;return!0},l=function(t,n){return e.inArray(n,t)},c=function(e,t){return-1!==l(e,t)},d=function(e,t){return t=t||i.self,e.reduce(function(e,n){return e+t(n)},0)},u=function(e){for(var t=[],n=-1,i=e.length;++n<i;)t[n]=e[n];return t},p=function(e){return!e||!e.length},f=function(e,i){if(!e.length)return[];var o=r(e);return o.reduce(function(e,t){var o=n(e);return i(n(o),t)?o[o.length]=t:e[e.length]=[t],e},[[t(e)]])},h=function(e){for(var t=[],n=0,i=e.length;i>n;n++)e[n]&&t.push(e[n]);return t},m=function(e){for(var t=[],n=0,i=e.length;i>n;n++)c(t,e[n])||t.push(e[n]);return t},g=function(e,t){var n=l(e,t);return-1===n?null:e[n+1]},v=function(e,t){var n=l(e,t);return-1===n?null:e[n-1]};return{head:t,last:n,initial:o,tail:r,prev:v,next:g,find:a,contains:c,all:s,sum:d,from:u,isEmpty:p,clusterBy:f,compact:h,unique:m}}(),r=n(26),a=function(t){var n="Comic Sans MS"===t?"Courier New":"Comic Sans MS",i=e("<div>").css({position:"absolute",left:"-9999px",top:"-9999px",fontSize:"200px"}).text("mmmmmmmmmwwwwwww").appendTo(document.body),o=i.css("fontFamily",n).width(),r=i.css("fontFamily",t+","+n).width();return i.remove(),o!==r},s=navigator.userAgent,l=/MSIE|Trident/i.test(s);if(l){var c=/MSIE (\d+[.]\d+)/.exec(s);c&&(t=parseFloat(c[1])),c=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(s),c&&(t=parseFloat(c[1]))}var d={isMac:navigator.appVersion.indexOf("Mac")>-1,isMSIE:l,isFF:/firefox/i.test(s),isWebkit:/webkit/i.test(s),isSafari:/safari/i.test(s),browserVersion:t,jqueryVersion:parseFloat(e.fn.jquery),isSupportAmd:r,hasCodeMirror:r?27:!!window.CodeMirror,isFontInstalled:a,isW3CRangeSupport:!!document.createRange},u=String.fromCharCode(160),p="\ufeff",f=function(){var t=function(t){return t&&e(t).hasClass("note-editable")},n=function(t){return t&&e(t).hasClass("note-control-sizing")},r=function(e){return e=e.toUpperCase(),function(t){return t&&t.nodeName.toUpperCase()===e}},a=function(e){return e&&3===e.nodeType},s=function(e){return e&&1===e.nodeType},l=function(e){return e&&/^BR|^IMG|^HR|^IFRAME|^BUTTON/.test(e.nodeName.toUpperCase())},c=function(e){return t(e)?!1:e&&/^DIV|^P|^LI|^H[1-7]/.test(e.nodeName.toUpperCase())},h=function(e){return e&&/^H[1-7]/.test(e.nodeName.toUpperCase())},m=r("PRE"),g=r("LI"),v=function(e){return c(e)&&!g(e)},b=r("TABLE"),y=function(e){return!(T(e)||w(e)||x(e)||c(e)||b(e)||C(e))},w=function(e){return e&&/^UL|^OL/.test(e.nodeName.toUpperCase())},x=r("HR"),k=function(e){return e&&/^TD|^TH/.test(e.nodeName.toUpperCase())},C=r("BLOCKQUOTE"),T=function(e){return k(e)||C(e)||t(e)},_=r("A"),S=function(e){return y(e)&&!!O(e,c)},I=function(e){return y(e)&&!O(e,c)},L=r("BODY"),D=function(e,t){return e.nextSibling===t||e.previousSibling===t},N=function(e,t){t=t||i.ok;var n=[];return e.previousSibling&&t(e.previousSibling)&&n.push(e.previousSibling),n.push(e),e.nextSibling&&t(e.nextSibling)&&n.push(e.nextSibling),n},E=d.isMSIE&&d.browserVersion<11?"&nbsp;":"<br>",A=function(e){return a(e)?e.nodeValue.length:e.childNodes.length},M=function(e){var t=A(e);return 0===t?!0:a(e)||1!==t||e.innerHTML!==E?!(!o.all(e.childNodes,a)||""!==e.innerHTML):!0},P=function(e){l(e)||A(e)||(e.innerHTML=E)},O=function(e,n){for(;e;){if(n(e))return e;if(t(e))break;e=e.parentNode}return null},F=function(e,n){for(e=e.parentNode;e&&1===A(e);){if(n(e))return e;if(t(e))break;e=e.parentNode}return null},H=function(e,n){n=n||i.fail;var o=[];return O(e,function(e){return t(e)||o.push(e),n(e)}),o},R=function(e,t){var n=H(e);return o.last(n.filter(t))},$=function(t,n){for(var i=H(t),o=n;o;o=o.parentNode)if(e.inArray(o,i)>-1)return o;return null},B=function(e,t){t=t||i.fail;for(var n=[];e&&!t(e);)n.push(e),e=e.previousSibling;return n},z=function(e,t){t=t||i.fail;for(var n=[];e&&!t(e);)n.push(e),e=e.nextSibling;return n},j=function(e,t){var n=[];return t=t||i.ok,function o(i){e!==i&&t(i)&&n.push(i);for(var r=0,a=i.childNodes.length;a>r;r++)o(i.childNodes[r])}(e),n},W=function(t,n){var i=t.parentNode,o=e("<"+n+">")[0];return i.insertBefore(o,t),o.appendChild(t),o},U=function(e,t){var n=t.nextSibling,i=t.parentNode;return n?i.insertBefore(e,n):i.appendChild(e),e},q=function(t,n){return e.each(n,function(e,n){t.appendChild(n)}),t},V=function(e){return 0===e.offset},G=function(e){return e.offset===A(e.node)},K=function(e){return V(e)||G(e)},X=function(e,t){for(;e&&e!==t;){if(0!==Z(e))return!1;e=e.parentNode}return!0},Y=function(e,t){for(;e&&e!==t;){if(Z(e)!==A(e.parentNode)-1)return!1;e=e.parentNode}return!0},Q=function(e,t){return V(e)&&X(e.node,t)},J=function(e,t){return G(e)&&Y(e.node,t)},Z=function(e){for(var t=0;e=e.previousSibling;)t+=1;return t},ee=function(e){return!!(e&&e.childNodes&&e.childNodes.length)},te=function(e,n){var i,o;if(0===e.offset){if(t(e.node))return null;i=e.node.parentNode,o=Z(e.node)}else ee(e.node)?(i=e.node.childNodes[e.offset-1],o=A(i)):(i=e.node,o=n?0:e.offset-1);return{node:i,offset:o}},ne=function(e,n){var i,o;if(A(e.node)===e.offset){if(t(e.node))return null;i=e.node.parentNode,o=Z(e.node)+1}else ee(e.node)?(i=e.node.childNodes[e.offset],o=0):(i=e.node,o=n?A(e.node):e.offset+1);return{node:i,offset:o}},ie=function(e,t){return e.node===t.node&&e.offset===t.offset},oe=function(e){if(a(e.node)||!ee(e.node)||M(e.node))return!0;var t=e.node.childNodes[e.offset-1],n=e.node.childNodes[e.offset];return!(t&&!l(t)||n&&!l(n))},re=function(e,t){for(;e;){if(t(e))return e;e=te(e)}return null},ae=function(e,t){for(;e;){if(t(e))return e;e=ne(e)}return null},se=function(e){if(!a(e.node))return!1;var t=e.node.nodeValue.charAt(e.offset-1);return t&&" "!==t&&t!==u},le=function(e,t,n,i){for(var o=e;o&&(n(o),!ie(o,t));){var r=i&&e.node!==o.node&&t.node!==o.node;o=ne(o,r)}},ce=function(e,t){var n=H(t,i.eq(e));return n.map(Z).reverse()},de=function(e,t){for(var n=e,i=0,o=t.length;o>i;i++)n=n.childNodes.length<=t[i]?n.childNodes[n.childNodes.length-1]:n.childNodes[t[i]];return n},ue=function(e,t){var n=t&&t.isSkipPaddingBlankHTML,i=t&&t.isNotSplitEdgePoint;if(K(e)&&(a(e.node)||i)){if(V(e))return e.node;if(G(e))return e.node.nextSibling}if(a(e.node))return e.node.splitText(e.offset);var o=e.node.childNodes[e.offset],r=U(e.node.cloneNode(!1),e.node);return q(r,z(o)),n||(P(e.node),P(r)),r},pe=function(e,t,n){var o=H(t.node,i.eq(e));return o.length?1===o.length?ue(t,n):o.reduce(function(e,i){return e===t.node&&(e=ue(t,n)),ue({node:i,offset:e?f.position(e):A(i)},n)}):null},fe=function(e,t){var n,i,r=t?c:T,a=H(e.node,r),s=o.last(a)||e.node;r(s)?(n=a[a.length-2],i=s):(n=s,i=n.parentNode);var l=n&&pe(n,e,{isSkipPaddingBlankHTML:t,isNotSplitEdgePoint:t});return l||i!==e.node||(l=e.node.childNodes[e.offset]),{rightNode:l,container:i}},he=function(e){return document.createElement(e)},me=function(e){return document.createTextNode(e)},ge=function(e,t){if(e&&e.parentNode){if(e.removeNode)return e.removeNode(t);var n=e.parentNode;if(!t){var i,o,r=[];for(i=0,o=e.childNodes.length;o>i;i++)r.push(e.childNodes[i]);for(i=0,o=r.length;o>i;i++)n.insertBefore(r[i],e)}n.removeChild(e)}},ve=function(e,n){for(;e&&!t(e)&&n(e);){var i=e.parentNode;ge(e),e=i}},be=function(e,t){if(e.nodeName.toUpperCase()===t.toUpperCase())return e;var n=he(t);return e.style.cssText&&(n.style.cssText=e.style.cssText),q(n,o.from(e.childNodes)),U(n,e),ge(e),n},ye=r("TEXTAREA"),we=function(e,t){var n=ye(e[0])?e.val():e.html();return t?n.replace(/[\n\r]/g,""):n},xe=function(t,n){var i=we(t);if(n){var o=/<(\/?)(\b(?!!)[^>\s]*)(.*?)(\s*\/?>)/g;i=i.replace(o,function(e,t,n){n=n.toUpperCase();var i=/^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(n)&&!!t,o=/^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(n);return e+(i||o?"\n":"")}),i=e.trim(i)}return i},ke=function(t){var n=e(t),i=n.offset(),o=n.outerHeight(!0);return{left:i.left,top:i.top+o}},Ce=function(e,t){Object.keys(t).forEach(function(n){e.on(n,t[n])})},Te=function(e,t){Object.keys(t).forEach(function(n){e.off(n,t[n])})};return{NBSP_CHAR:u,ZERO_WIDTH_NBSP_CHAR:p,blank:E,emptyPara:"<p>"+E+"</p>",makePredByNodeName:r,isEditable:t,isControlSizing:n,isText:a,isElement:s,isVoid:l,isPara:c,isPurePara:v,isHeading:h,isInline:y,isBlock:i.not(y),isBodyInline:I,isBody:L,isParaInline:S,isPre:m,isList:w,isTable:b,isCell:k,isBlockquote:C,isBodyContainer:T,isAnchor:_,isDiv:r("DIV"),isLi:g,isBR:r("BR"),isSpan:r("SPAN"),isB:r("B"),isU:r("U"),isS:r("S"),isI:r("I"),isImg:r("IMG"),isTextarea:ye,isEmpty:M,isEmptyAnchor:i.and(_,M),isClosestSibling:D,withClosestSiblings:N,nodeLength:A,isLeftEdgePoint:V,isRightEdgePoint:G,isEdgePoint:K,isLeftEdgeOf:X,isRightEdgeOf:Y,isLeftEdgePointOf:Q,isRightEdgePointOf:J,prevPoint:te,nextPoint:ne,isSamePoint:ie,isVisiblePoint:oe,prevPointUntil:re,nextPointUntil:ae,isCharPoint:se,walkPoint:le,ancestor:O,singleChildAncestor:F,listAncestor:H,lastAncestor:R,listNext:z,listPrev:B,listDescendant:j,commonAncestor:$,wrap:W,insertAfter:U,appendChildNodes:q,position:Z,hasChildren:ee,makeOffsetPath:ce,fromOffsetPath:de,splitTree:pe,splitPoint:fe,create:he,createText:me,remove:ge,removeWhile:ve,replace:be,html:xe,value:we,posFromPlaceholder:ke,attachEvents:Ce,detachEvents:Te}}(),h=function(t,n){var r=this,a=e.summernote.ui;return this.memos={},this.modules={},this.layoutInfo={},this.options=n,this.initialize=function(){return this.layoutInfo=a.createLayout(t,n),this._initialize(),t.hide(),this},this.destroy=function(){this._destroy(),t.removeData("summernote"),a.removeLayout(t,this.layoutInfo)},this.reset=function(){this.code(f.emptyPara),this._destroy(),this._initialize()},this._initialize=function(){var t=e.extend({},this.options.buttons);Object.keys(t).forEach(function(e){r.memo("button."+e,t[e])});var n=e.extend({},this.options.modules,e.summernote.plugins||{});Object.keys(n).forEach(function(e){r.module(e,n[e],!0)}),Object.keys(this.modules).forEach(function(e){r.initializeModule(e)})},this._destroy=function(){Object.keys(this.modules).reverse().forEach(function(e){r.removeModule(e)}),Object.keys(this.memos).forEach(function(e){r.removeMemo(e)})},this.code=function(e){var n=this.invoke("codeview.isActivated");return void 0===e?(this.invoke("codeview.sync"),n?this.layoutInfo.codable.val():this.layoutInfo.editable.html()):(n?this.layoutInfo.codable.val(e):this.layoutInfo.editable.html(e),t.val(e),void this.triggerEvent("change",e))},this.isDisabled=function(){return"false"===this.layoutInfo.editable.attr("contenteditable")},this.enable=function(){this.layoutInfo.editable.attr("contenteditable",!0),this.invoke("toolbar.activate",!0)},this.disable=function(){this.invoke("codeview.isActivated")&&this.invoke("codeview.deactivate"),this.layoutInfo.editable.attr("contenteditable",!1),this.invoke("toolbar.deactivate",!0)},this.triggerEvent=function(){var e=o.head(arguments),n=o.tail(o.from(arguments)),r=this.options.callbacks[i.namespaceToCamel(e,"on")];r&&r.apply(t[0],n),t.trigger("summernote."+e,n)},this.initializeModule=function(e){var n=this.modules[e];n.shouldInitialize=n.shouldInitialize||i.ok,n.shouldInitialize()&&(n.initialize&&n.initialize(),n.events&&f.attachEvents(t,n.events))},this.module=function(e,t,n){return 1===arguments.length?this.modules[e]:(this.modules[e]=new t(this),void(n||this.initializeModule(e)))},this.removeModule=function(e){var n=this.modules[e];n.shouldInitialize()&&(n.events&&f.detachEvents(t,n.events),n.destroy&&n.destroy()),delete this.modules[e]},this.memo=function(e,t){return 1===arguments.length?this.memos[e]:void(this.memos[e]=t)},this.removeMemo=function(e){this.memos[e]&&this.memos[e].destroy&&this.memos[e].destroy(),delete this.memos[e]},this.createInvokeHandler=function(t,n){return function(i){i.preventDefault(),r.invoke(t,n||e(i.target).closest("[data-value]").data("value"))}},this.invoke=function(){var e=o.head(arguments),t=o.tail(o.from(arguments)),n=e.split("."),i=n.length>1,r=i&&o.head(n),a=i?o.last(n):o.head(n),s=this.modules[r||"editor"];return!r&&this[a]?this[a].apply(this,t):s&&s[a]&&s.shouldInitialize()?s[a].apply(s,t):void 0;
},this.initialize()};e.summernote=e.summernote||{lang:{}},e.fn.extend({summernote:function(){var t=e.type(o.head(arguments)),n="string"===t,i="object"===t,r=i?o.head(arguments):{};r=e.extend({},e.summernote.options,r),r.langInfo=e.extend(!0,{},e.summernote.lang["en-US"],e.summernote.lang[r.lang]),this.each(function(t,n){var i=e(n);if(!i.data("summernote")){var o=new h(i,r);i.data("summernote",o),i.data("summernote").triggerEvent("init",o.layoutInfo)}});var a=this.first();if(a.length){var s=a.data("summernote");if(n)return s.invoke.apply(s,o.from(arguments));r.focus&&s.invoke("editor.focus")}return this}});var m=function(t,n,i,o){this.render=function(r){var a=e(t);if(i&&i.contents&&a.html(i.contents),i&&i.className&&a.addClass(i.className),i&&i.data&&e.each(i.data,function(e,t){a.attr("data-"+e,t)}),i&&i.click&&a.on("click",i.click),n){var s=a.find(".note-children-container");n.forEach(function(e){e.render(s.length?s:a)})}return o&&o(a,i),i&&i.callback&&i.callback(a),r&&r.append(a),a}},g={create:function(t,n){return function(){var i=e.isArray(arguments[0])?arguments[0]:[],o="object"==typeof arguments[1]?arguments[1]:arguments[0];return o&&o.children&&(i=o.children),new m(t,i,o,n)}}},v=g.create('<div class="note-editor note-frame panel panel-default"/>'),b=g.create('<div class="note-toolbar panel-heading"/>'),y=g.create('<div class="note-editing-area"/>'),w=g.create('<textarea class="note-codable"/>'),x=g.create('<div class="note-editable panel-body" contentEditable="true"/>'),k=g.create(['<div class="note-statusbar">','  <div class="note-resizebar">','    <div class="note-icon-bar"/>','    <div class="note-icon-bar"/>','    <div class="note-icon-bar"/>',"  </div>","</div>"].join("")),C=g.create('<div class="note-editor"/>'),T=g.create('<div class="note-editable" contentEditable="true"/>'),_=g.create('<div class="note-btn-group btn-group">'),S=g.create('<button type="button" class="note-btn btn btn-default btn-sm">',function(e,t){t&&t.tooltip&&e.attr({title:t.tooltip}).tooltip({container:"body",trigger:"hover",placement:"bottom"})}),I=g.create('<div class="dropdown-menu">',function(t,n){var i=e.isArray(n.items)?n.items.map(function(e){var t="string"==typeof e?e:e.value||"",i=n.template?n.template(e):e;return'<li><a href="#" data-value="'+t+'">'+i+"</a></li>"}).join(""):n.items;t.html(i)}),L=g.create('<div class="dropdown-menu note-check">',function(t,n){var i=e.isArray(n.items)?n.items.map(function(e){var t="string"==typeof e?e:e.value||"",i=n.template?n.template(e):e;return'<li><a href="#" data-value="'+t+'">'+A(n.checkClassName)+" "+i+"</a></li>"}).join(""):n.items;t.html(i)}),D=g.create('<div class="note-color-palette"/>',function(e,t){for(var n=[],i=0,o=t.colors.length;o>i;i++){for(var r=t.eventName,a=t.colors[i],s=[],l=0,c=a.length;c>l;l++){var d=a[l];s.push(['<button type="button" class="note-color-btn"','style="background-color:',d,'" ','data-event="',r,'" ','data-value="',d,'" ','title="',d,'" ','data-toggle="button" tabindex="-1"></button>'].join(""))}n.push('<div class="note-color-row">'+s.join("")+"</div>")}e.html(n.join("")),e.find(".note-color-btn").tooltip({container:"body",trigger:"hover",placement:"bottom"})}),N=g.create('<div class="modal" aria-hidden="false" tabindex="-1"/>',function(e,t){t.fade&&e.addClass("fade"),e.html(['<div class="modal-dialog">','  <div class="modal-content">',t.title?'    <div class="modal-header">      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>      <h4 class="modal-title">'+t.title+"</h4>    </div>":"",'    <div class="modal-body">'+t.body+"</div>",t.footer?'    <div class="modal-footer">'+t.footer+"</div>":"","  </div>","</div>"].join(""))}),E=g.create(['<div class="note-popover popover in">','  <div class="arrow"/>','  <div class="popover-content note-children-container"/>',"</div>"].join(""),function(e,t){var n="undefined"!=typeof t.direction?t.direction:"bottom";e.addClass(n),t.hideArrow&&e.find(".arrow").hide()}),A=function(e,t){return t=t||"i","<"+t+' class="'+e+'"/>'},M={editor:v,toolbar:b,editingArea:y,codable:w,editable:x,statusbar:k,airEditor:C,airEditable:T,buttonGroup:_,button:S,dropdown:I,dropdownCheck:L,palette:D,dialog:N,popover:E,icon:A,toggleBtn:function(e,t){e.toggleClass("disabled",!t),e.attr("disabled",!t)},toggleBtnActive:function(e,t){e.toggleClass("active",t)},onDialogShown:function(e,t){e.one("shown.bs.modal",t)},onDialogHidden:function(e,t){e.one("hidden.bs.modal",t)},showDialog:function(e){e.modal("show")},hideDialog:function(e){e.modal("hide")},createLayout:function(e,t){var n=(t.airMode?M.airEditor([M.editingArea([M.airEditable()])]):M.editor([M.toolbar(),M.editingArea([M.codable(),M.editable()]),M.statusbar()])).render();return n.insertAfter(e),{note:e,editor:n,toolbar:n.find(".note-toolbar"),editingArea:n.find(".note-editing-area"),editable:n.find(".note-editable"),codable:n.find(".note-codable"),statusbar:n.find(".note-statusbar")}},removeLayout:function(e,t){e.html(t.editable.html()),t.editor.remove(),e.show()}};e.extend(e.summernote.lang,{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",clear:"Remove Font Style",height:"Line Height",name:"Font Family",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",size:"Font Size"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",shapeRounded:"Shape: Rounded",shapeCircle:"Shape: Circle",shapeThumbnail:"Shape: Thumbnail",shapeNone:"Shape: None",dragImageHere:"Drag image or text here",dropImage:"Drop image or Text",selectFromFiles:"Select from files",maximumFileSize:"Maximum file size",maximumFileSizeError:"Maximum file size exceeded.",url:"Image URL",remove:"Remove Image"},video:{video:"Video",videoLink:"Video Link",insert:"Insert Video",url:"Video URL?",providers:"(YouTube, Vimeo, Vine, Instagram, DailyMotion or Youku)"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},table:{table:"Table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",normal:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"Background Color",foreground:"Foreground Color",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style",extraKeys:"Extra keys"},help:{insertParagraph:"Insert Paragraph",undo:"Undoes the last command",redo:"Redoes the last command",tab:"Tab",untab:"Untab",bold:"Set a bold style",italic:"Set a italic style",underline:"Set a underline style",strikethrough:"Set a strikethrough style",removeFormat:"Clean a style",justifyLeft:"Set left align",justifyCenter:"Set center align",justifyRight:"Set right align",justifyFull:"Set full align",insertUnorderedList:"Toggle unordered list",insertOrderedList:"Toggle ordered list",outdent:"Outdent on current paragraph",indent:"Indent on current paragraph",formatPara:"Change current block's format as a paragraph(P tag)",formatH1:"Change current block's format as H1",formatH2:"Change current block's format as H2",formatH3:"Change current block's format as H3",formatH4:"Change current block's format as H4",formatH5:"Change current block's format as H5",formatH6:"Change current block's format as H6",insertHorizontalRule:"Insert horizontal rule","linkDialog.show":"Show Link Dialog"},history:{undo:"Undo",redo:"Redo"},specialChar:{specialChar:"SPECIAL CHARACTERS",select:"Select Special characters"}}});var P,O=function(){var e={BACKSPACE:8,TAB:9,ENTER:13,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,B:66,E:69,I:73,J:74,K:75,L:76,R:82,S:83,U:85,V:86,Y:89,Z:90,SLASH:191,LEFTBRACKET:219,BACKSLASH:220,RIGHTBRACKET:221};return{isEdit:function(t){return o.contains([e.BACKSPACE,e.TAB,e.ENTER,e.SPACe],t)},isMove:function(t){return o.contains([e.LEFT,e.UP,e.RIGHT,e.DOWN],t)},nameFromCode:i.invertObject(e),code:e}}(),F=function(){var t=function(e,t){var n,i,r=e.parentElement(),a=document.body.createTextRange(),s=o.from(r.childNodes);for(n=0;n<s.length;n++)if(!f.isText(s[n])){if(a.moveToElementText(s[n]),a.compareEndPoints("StartToStart",e)>=0)break;i=s[n]}if(0!==n&&f.isText(s[n-1])){var l=document.body.createTextRange(),c=null;l.moveToElementText(i||r),l.collapse(!i),c=i?i.nextSibling:r.firstChild;var d=e.duplicate();d.setEndPoint("StartToStart",l);for(var u=d.text.replace(/[\r\n]/g,"").length;u>c.nodeValue.length&&c.nextSibling;)u-=c.nodeValue.length,c=c.nextSibling;c.nodeValue,t&&c.nextSibling&&f.isText(c.nextSibling)&&u===c.nodeValue.length&&(u-=c.nodeValue.length,c=c.nextSibling),r=c,n=u}return{cont:r,offset:n}},n=function(e){var t=function(e,n){var r,a;if(f.isText(e)){var s=f.listPrev(e,i.not(f.isText)),l=o.last(s).previousSibling;r=l||e.parentNode,n+=o.sum(o.tail(s),f.nodeLength),a=!l}else{if(r=e.childNodes[n]||e,f.isText(r))return t(r,0);n=0,a=!1}return{node:r,collapseToStart:a,offset:n}},n=document.body.createTextRange(),r=t(e.node,e.offset);return n.moveToElementText(r.node),n.collapse(r.collapseToStart),n.moveStart("character",r.offset),n},r=function(t,a,s,l){this.sc=t,this.so=a,this.ec=s,this.eo=l;var c=function(){if(d.isW3CRangeSupport){var e=document.createRange();return e.setStart(t,a),e.setEnd(s,l),e}var i=n({node:t,offset:a});return i.setEndPoint("EndToEnd",n({node:s,offset:l})),i};this.getPoints=function(){return{sc:t,so:a,ec:s,eo:l}},this.getStartPoint=function(){return{node:t,offset:a}},this.getEndPoint=function(){return{node:s,offset:l}},this.select=function(){var e=c();if(d.isW3CRangeSupport){var t=document.getSelection();t.rangeCount>0&&t.removeAllRanges(),t.addRange(e)}else e.select();return this},this.scrollIntoView=function(e){return e[0].scrollTop+e.height()<this.sc.offsetTop&&(e[0].scrollTop+=Math.abs(e[0].scrollTop+e.height()-this.sc.offsetTop)),this},this.normalize=function(){var e=function(e,t){if(f.isVisiblePoint(e)&&!f.isEdgePoint(e)||f.isVisiblePoint(e)&&f.isRightEdgePoint(e)&&!t||f.isVisiblePoint(e)&&f.isLeftEdgePoint(e)&&t||f.isVisiblePoint(e)&&f.isBlock(e.node)&&f.isEmpty(e.node))return e;var n=f.ancestor(e.node,f.isBlock);if((f.isLeftEdgePointOf(e,n)||f.isVoid(f.prevPoint(e).node))&&!t||(f.isRightEdgePointOf(e,n)||f.isVoid(f.nextPoint(e).node))&&t){if(f.isVisiblePoint(e))return e;t=!t}var i=t?f.nextPointUntil(f.nextPoint(e),f.isVisiblePoint):f.prevPointUntil(f.prevPoint(e),f.isVisiblePoint);return i||e},t=e(this.getEndPoint(),!1),n=this.isCollapsed()?t:e(this.getStartPoint(),!0);return new r(n.node,n.offset,t.node,t.offset)},this.nodes=function(e,t){e=e||i.ok;var n=t&&t.includeAncestor,r=t&&t.fullyContains,a=this.getStartPoint(),s=this.getEndPoint(),l=[],c=[];return f.walkPoint(a,s,function(t){if(!f.isEditable(t.node)){var i;r?(f.isLeftEdgePoint(t)&&c.push(t.node),f.isRightEdgePoint(t)&&o.contains(c,t.node)&&(i=t.node)):i=n?f.ancestor(t.node,e):t.node,i&&e(i)&&l.push(i)}},!0),o.unique(l)},this.commonAncestor=function(){return f.commonAncestor(t,s)},this.expand=function(e){var n=f.ancestor(t,e),i=f.ancestor(s,e);if(!n&&!i)return new r(t,a,s,l);var o=this.getPoints();return n&&(o.sc=n,o.so=0),i&&(o.ec=i,o.eo=f.nodeLength(i)),new r(o.sc,o.so,o.ec,o.eo)},this.collapse=function(e){return e?new r(t,a,t,a):new r(s,l,s,l)},this.splitText=function(){var e=t===s,n=this.getPoints();return f.isText(s)&&!f.isEdgePoint(this.getEndPoint())&&s.splitText(l),f.isText(t)&&!f.isEdgePoint(this.getStartPoint())&&(n.sc=t.splitText(a),n.so=0,e&&(n.ec=n.sc,n.eo=l-a)),new r(n.sc,n.so,n.ec,n.eo)},this.deleteContents=function(){if(this.isCollapsed())return this;var t=this.splitText(),n=t.nodes(null,{fullyContains:!0}),i=f.prevPointUntil(t.getStartPoint(),function(e){return!o.contains(n,e.node)}),a=[];return e.each(n,function(e,t){var n=t.parentNode;i.node!==n&&1===f.nodeLength(n)&&a.push(n),f.remove(t,!1)}),e.each(a,function(e,t){f.remove(t,!1)}),new r(i.node,i.offset,i.node,i.offset).normalize()};var u=function(e){return function(){var n=f.ancestor(t,e);return!!n&&n===f.ancestor(s,e)}};this.isOnEditable=u(f.isEditable),this.isOnList=u(f.isList),this.isOnAnchor=u(f.isAnchor),this.isOnCell=u(f.isCell),this.isLeftEdgeOf=function(e){if(!f.isLeftEdgePoint(this.getStartPoint()))return!1;var t=f.ancestor(this.sc,e);return t&&f.isLeftEdgeOf(this.sc,t)},this.isCollapsed=function(){return t===s&&a===l},this.wrapBodyInlineWithPara=function(){if(f.isBodyContainer(t)&&f.isEmpty(t))return t.innerHTML=f.emptyPara,new r(t.firstChild,0,t.firstChild,0);var e=this.normalize();if(f.isParaInline(t)||f.isPara(t))return e;var n;if(f.isInline(e.sc)){var a=f.listAncestor(e.sc,i.not(f.isInline));n=o.last(a),f.isInline(n)||(n=a[a.length-2]||e.sc.childNodes[e.so])}else n=e.sc.childNodes[e.so>0?e.so-1:0];var s=f.listPrev(n,f.isParaInline).reverse();if(s=s.concat(f.listNext(n.nextSibling,f.isParaInline)),s.length){var l=f.wrap(o.head(s),"p");f.appendChildNodes(l,o.tail(s))}return this.normalize()},this.insertNode=function(e){var t=this.wrapBodyInlineWithPara().deleteContents(),n=f.splitPoint(t.getStartPoint(),f.isInline(e));return n.rightNode?n.rightNode.parentNode.insertBefore(e,n.rightNode):n.container.appendChild(e),e},this.pasteHTML=function(t){var n=e("<div></div>").html(t)[0],i=o.from(n.childNodes),r=this.wrapBodyInlineWithPara().deleteContents();return i.reverse().map(function(e){return r.insertNode(e)}).reverse()},this.toString=function(){var e=c();return d.isW3CRangeSupport?e.toString():e.text},this.getWordRange=function(e){var t=this.getEndPoint();if(!f.isCharPoint(t))return this;var n=f.prevPointUntil(t,function(e){return!f.isCharPoint(e)});return e&&(t=f.nextPointUntil(t,function(e){return!f.isCharPoint(e)})),new r(n.node,n.offset,t.node,t.offset)},this.bookmark=function(e){return{s:{path:f.makeOffsetPath(e,t),offset:a},e:{path:f.makeOffsetPath(e,s),offset:l}}},this.paraBookmark=function(e){return{s:{path:o.tail(f.makeOffsetPath(o.head(e),t)),offset:a},e:{path:o.tail(f.makeOffsetPath(o.last(e),s)),offset:l}}},this.getClientRects=function(){var e=c();return e.getClientRects()}};return{create:function(e,n,i,o){if(arguments.length)2===arguments.length&&(i=e,o=n);else if(d.isW3CRangeSupport){var a=document.getSelection();if(!a||0===a.rangeCount)return null;if(f.isBody(a.anchorNode))return null;var s=a.getRangeAt(0);e=s.startContainer,n=s.startOffset,i=s.endContainer,o=s.endOffset}else{var l=document.selection.createRange(),c=l.duplicate();c.collapse(!1);var u=l;u.collapse(!0);var p=t(u,!0),h=t(c,!1);f.isText(p.node)&&f.isLeftEdgePoint(p)&&f.isTextNode(h.node)&&f.isRightEdgePoint(h)&&h.node.nextSibling===p.node&&(p=h),e=p.cont,n=p.offset,i=h.cont,o=h.offset}return new r(e,n,i,o)},createFromNode:function(e){var t=e,n=0,i=e,o=f.nodeLength(i);return f.isVoid(t)&&(n=f.listPrev(t).length-1,t=t.parentNode),f.isBR(i)?(o=f.listPrev(i).length-1,i=i.parentNode):f.isVoid(i)&&(o=f.listPrev(i).length,i=i.parentNode),this.create(t,n,i,o)},createFromNodeBefore:function(e){return this.createFromNode(e).collapse(!0)},createFromNodeAfter:function(e){return this.createFromNode(e).collapse()},createFromBookmark:function(e,t){var n=f.fromOffsetPath(e,t.s.path),i=t.s.offset,o=f.fromOffsetPath(e,t.e.path),a=t.e.offset;return new r(n,i,o,a)},createFromParaBookmark:function(e,t){var n=e.s.offset,i=e.e.offset,a=f.fromOffsetPath(o.head(t),e.s.path),s=f.fromOffsetPath(o.last(t),e.e.path);return new r(a,n,s,i)}}}(),H=function(){var t=function(t){return e.Deferred(function(n){e.extend(new FileReader,{onload:function(e){var t=e.target.result;n.resolve(t)},onerror:function(){n.reject(this)}}).readAsDataURL(t)}).promise()},n=function(t){return e.Deferred(function(n){var i=e("<img>");i.one("load",function(){i.off("error abort"),n.resolve(i)}).one("error abort",function(){i.off("load").detach(),n.reject(i)}).css({display:"none"}).appendTo(document.body).attr("src",t)}).promise()};return{readFileAsDataURL:t,createImage:n}}(),R=function(e){var t=[],n=-1,i=e[0],o=function(){var t=F.create(),n={s:{path:[],offset:0},e:{path:[],offset:0}};return{contents:e.html(),bookmark:t?t.bookmark(i):n}},r=function(t){null!==t.contents&&e.html(t.contents),null!==t.bookmark&&F.createFromBookmark(i,t.bookmark).select()};this.rewind=function(){e.html()!==t[n].contents&&this.recordUndo(),n=0,r(t[n])},this.reset=function(){t=[],n=-1,e.html(""),this.recordUndo()},this.undo=function(){e.html()!==t[n].contents&&this.recordUndo(),n>0&&(n--,r(t[n]))},this.redo=function(){t.length-1>n&&(n++,r(t[n]))},this.recordUndo=function(){n++,t.length>n&&(t=t.slice(0,n)),t.push(o())}},$=function(){var t=function(t,n){if(d.jqueryVersion<1.9){var i={};return e.each(n,function(e,n){i[n]=t.css(n)}),i}return t.css.call(t,n)};this.fromNode=function(e){var n=["font-family","font-size","text-align","list-style-type","line-height"],i=t(e,n)||{};return i["font-size"]=parseInt(i["font-size"],10),i},this.stylePara=function(t,n){e.each(t.nodes(f.isPara,{includeAncestor:!0}),function(t,i){e(i).css(n)})},this.styleNodes=function(t,n){t=t.splitText();var r=n&&n.nodeName||"SPAN",a=!(!n||!n.expandClosestSibling),s=!(!n||!n.onlyPartialContains);if(t.isCollapsed())return[t.insertNode(f.create(r))];var l=f.makePredByNodeName(r),c=t.nodes(f.isText,{fullyContains:!0}).map(function(e){return f.singleChildAncestor(e,l)||f.wrap(e,r)});if(a){if(s){var d=t.nodes();l=i.and(l,function(e){return o.contains(d,e)})}return c.map(function(t){var n=f.withClosestSiblings(t,l),i=o.head(n),r=o.tail(n);return e.each(r,function(e,t){f.appendChildNodes(i,t.childNodes),f.remove(t)}),o.head(n)})}return c},this.current=function(t){var n=e(f.isElement(t.sc)?t.sc:t.sc.parentNode),i=this.fromNode(n);try{i=e.extend(i,{"font-bold":document.queryCommandState("bold")?"bold":"normal","font-italic":document.queryCommandState("italic")?"italic":"normal","font-underline":document.queryCommandState("underline")?"underline":"normal","font-subscript":document.queryCommandState("subscript")?"subscript":"normal","font-superscript":document.queryCommandState("superscript")?"superscript":"normal","font-strikethrough":document.queryCommandState("strikethrough")?"strikethrough":"normal"})}catch(o){}if(t.isOnList()){var r=["circle","disc","disc-leading-zero","square"],a=e.inArray(i["list-style-type"],r)>-1;i["list-style"]=a?"unordered":"ordered"}else i["list-style"]="none";var s=f.ancestor(t.sc,f.isPara);if(s&&s.style["line-height"])i["line-height"]=s.style.lineHeight;else{var l=parseInt(i["line-height"],10)/parseInt(i["font-size"],10);i["line-height"]=l.toFixed(1)}return i.anchor=t.isOnAnchor()&&f.ancestor(t.sc,f.isAnchor),i.ancestors=f.listAncestor(t.sc,f.isEditable),i.range=t,i}},B=function(){this.insertOrderedList=function(){this.toggleList("OL")},this.insertUnorderedList=function(){this.toggleList("UL")},this.indent=function(){var t=this,n=F.create().wrapBodyInlineWithPara(),r=n.nodes(f.isPara,{includeAncestor:!0}),a=o.clusterBy(r,i.peq2("parentNode"));e.each(a,function(n,i){var r=o.head(i);f.isLi(r)?t.wrapList(i,r.parentNode.nodeName):e.each(i,function(t,n){e(n).css("marginLeft",function(e,t){return(parseInt(t,10)||0)+25})})}),n.select()},this.outdent=function(){var t=this,n=F.create().wrapBodyInlineWithPara(),r=n.nodes(f.isPara,{includeAncestor:!0}),a=o.clusterBy(r,i.peq2("parentNode"));e.each(a,function(n,i){var r=o.head(i);f.isLi(r)?t.releaseList([i]):e.each(i,function(t,n){e(n).css("marginLeft",function(e,t){return t=parseInt(t,10)||0,t>25?t-25:""})})}),n.select()},this.toggleList=function(t){var n=this,r=F.create().wrapBodyInlineWithPara(),a=r.nodes(f.isPara,{includeAncestor:!0}),s=r.paraBookmark(a),l=o.clusterBy(a,i.peq2("parentNode"));if(o.find(a,f.isPurePara)){var c=[];e.each(l,function(e,i){c=c.concat(n.wrapList(i,t))}),a=c}else{var d=r.nodes(f.isList,{includeAncestor:!0}).filter(function(n){return!e.nodeName(n,t)});d.length?e.each(d,function(e,n){f.replace(n,t)}):a=this.releaseList(l,!0)}F.createFromParaBookmark(s,a).select()},this.wrapList=function(e,t){var n=o.head(e),i=o.last(e),r=f.isList(n.previousSibling)&&n.previousSibling,a=f.isList(i.nextSibling)&&i.nextSibling,s=r||f.insertAfter(f.create(t||"UL"),i);return e=e.map(function(e){return f.isPurePara(e)?f.replace(e,"LI"):e}),f.appendChildNodes(s,e),a&&(f.appendChildNodes(s,o.from(a.childNodes)),f.remove(a)),e},this.releaseList=function(t,n){var i=[];return e.each(t,function(t,r){var a=o.head(r),s=o.last(r),l=n?f.lastAncestor(a,f.isList):a.parentNode,c=l.childNodes.length>1?f.splitTree(l,{node:s.parentNode,offset:f.position(s)+1},{isSkipPaddingBlankHTML:!0}):null,d=f.splitTree(l,{node:a.parentNode,offset:f.position(a)},{isSkipPaddingBlankHTML:!0});r=n?f.listDescendant(d,f.isLi):o.from(d.childNodes).filter(f.isLi),(n||!f.isList(l.parentNode))&&(r=r.map(function(e){return f.replace(e,"P")})),e.each(o.from(r).reverse(),function(e,t){f.insertAfter(t,l)});var u=o.compact([l,d,c]);e.each(u,function(t,n){var i=[n].concat(f.listDescendant(n,f.isList));e.each(i.reverse(),function(e,t){f.nodeLength(t)||f.remove(t,!0)})}),i=i.concat(r)}),i}},z=function(){var t=new B;this.insertTab=function(e,t,n){var i=f.createText(new Array(n+1).join(f.NBSP_CHAR));t=t.deleteContents(),t.insertNode(i,!0),t=F.create(i,n),t.select()},this.insertParagraph=function(n){var i=F.create();i=i.deleteContents(),i=i.wrapBodyInlineWithPara();var o,r=f.ancestor(i.sc,f.isPara);if(r){if(f.isEmpty(r)&&f.isLi(r))return void t.toggleList(r.parentNode.nodeName);if(f.isEmpty(r)&&f.isPara(r)&&f.isBlockquote(r.parentNode))f.insertAfter(r,r.parentNode),o=r;else{o=f.splitTree(r,i.getStartPoint());var a=f.listDescendant(r,f.isEmptyAnchor);a=a.concat(f.listDescendant(o,f.isEmptyAnchor)),e.each(a,function(e,t){f.remove(t)}),(f.isHeading(o)||f.isPre(o))&&f.isEmpty(o)&&(o=f.replace(o,"p"))}}else{var s=i.sc.childNodes[i.so];o=e(f.emptyPara)[0],s?i.sc.insertBefore(o,s):i.sc.appendChild(o)}F.create(o,0).normalize().select().scrollIntoView(n)}},j=function(){this.tab=function(e,t){var n=f.ancestor(e.commonAncestor(),f.isCell),i=f.ancestor(n,f.isTable),r=f.listDescendant(i,f.isCell),a=o[t?"prev":"next"](r,n);a&&F.create(a,0).select()},this.createTable=function(t,n,i){for(var o,r=[],a=0;t>a;a++)r.push("<td>"+f.blank+"</td>");o=r.join("");for(var s,l=[],c=0;n>c;c++)l.push("<tr>"+o+"</tr>");s=l.join("");var d=e("<table>"+s+"</table>");return i&&i.tableClassName&&d.addClass(i.tableClassName),d[0]}},W="bogus",U=function(t){var n=this,i=t.layoutInfo.note,r=t.layoutInfo.editor,a=t.layoutInfo.editable,s=t.options,l=s.langInfo,c=new $,u=new j,p=new z,h=new B,m=new R(a);this.initialize=function(){a.on("keydown",function(e){e.keyCode===O.code.ENTER&&t.triggerEvent("enter",e),t.triggerEvent("keydown",e),s.shortcuts&&!e.isDefaultPrevented()&&n.handleKeyMap(e)}).on("keyup",function(e){t.triggerEvent("keyup",e)}).on("focus",function(e){t.triggerEvent("focus",e)}).on("blur",function(e){t.triggerEvent("blur",e)}).on("mousedown",function(e){t.triggerEvent("mousedown",e)}).on("mouseup",function(e){t.triggerEvent("mouseup",e)}).on("scroll",function(e){t.triggerEvent("scroll",e)}).on("paste",function(e){t.triggerEvent("paste",e)});var e=d.isMSIE?"DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted":"input";a.on(e,function(){t.triggerEvent("change",a.html())}),r.on("focusin",function(e){t.triggerEvent("focusin",e)}).on("focusout",function(e){t.triggerEvent("focusout",e)}),!s.airMode&&s.height&&a.outerHeight(s.height),!s.airMode&&s.maxHeight&&a.css("max-height",s.maxHeight),!s.airMode&&s.minHeight&&a.css("min-height",s.minHeight),a.html(f.html(i)||f.emptyPara),m.recordUndo()},this.destroy=function(){a.off()},this.handleKeyMap=function(e){var n=s.keyMap[d.isMac?"mac":"pc"],i=[];e.metaKey&&i.push("CMD"),e.ctrlKey&&!e.altKey&&i.push("CTRL"),e.shiftKey&&i.push("SHIFT");var o=O.nameFromCode[e.keyCode];o&&i.push(o);var r=n[i.join("+")];r?(e.preventDefault(),t.invoke(r)):O.isEdit(e.keyCode)&&this.afterCommand()},this.createRange=function(){return this.focus(),F.create()},this.saveRange=function(e){this.focus(),a.data("range",F.create()),e&&F.create().collapse().select()},this.restoreRange=function(){var e=a.data("range");e&&(e.select(),this.focus())},this.saveTarget=function(e){a.data("target",e)},this.clearTarget=function(){a.removeData("target")},this.restoreTarget=function(){return a.data("target")},this.currentStyle=function(){var e=F.create();return e&&(e=e.normalize()),e?c.current(e):c.fromNode(a)},this.styleFromNode=function(e){return c.fromNode(e)},this.undo=function(){t.triggerEvent("before.command",a.html()),m.undo(),t.triggerEvent("change",a.html())},t.memo("help.undo",l.help.undo),this.redo=function(){t.triggerEvent("before.command",a.html()),m.redo(),t.triggerEvent("change",a.html())},t.memo("help.redo",l.help.redo);for(var g=this.beforeCommand=function(){t.triggerEvent("before.command",a.html()),n.focus()},v=this.afterCommand=function(e){m.recordUndo(),e||t.triggerEvent("change",a.html())},b=["bold","italic","underline","strikethrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","justifyFull","formatBlock","removeFormat","backColor","foreColor","fontName"],y=0,w=b.length;w>y;y++)this[b[y]]=function(e){return function(t){g(),document.execCommand(e,!1,t),v(!0)}}(b[y]),t.memo("help."+b[y],l.help[b[y]]);this.tab=function(){var e=this.createRange();e.isCollapsed()&&e.isOnCell()?u.tab(e):(g(),p.insertTab(a,e,s.tabSize),v())},t.memo("help.tab",l.help.tab),this.untab=function(){var e=this.createRange();e.isCollapsed()&&e.isOnCell()&&u.tab(e,!0)},t.memo("help.untab",l.help.untab),this.wrapCommand=function(e){return function(){g(),e.apply(n,arguments),v()}},this.insertParagraph=this.wrapCommand(function(){p.insertParagraph(a)}),t.memo("help.insertParagraph",l.help.insertParagraph),this.insertOrderedList=this.wrapCommand(function(){h.insertOrderedList(a)}),t.memo("help.insertOrderedList",l.help.insertOrderedList),this.insertUnorderedList=this.wrapCommand(function(){h.insertUnorderedList(a)}),t.memo("help.insertUnorderedList",l.help.insertUnorderedList),this.indent=this.wrapCommand(function(){h.indent(a)}),t.memo("help.indent",l.help.indent),this.outdent=this.wrapCommand(function(){h.outdent(a)}),t.memo("help.outdent",l.help.outdent),this.insertImage=function(e,n){return H.createImage(e,n).then(function(e){g(),"function"==typeof n?n(e):("string"==typeof n&&e.attr("data-filename",n),e.css("width",Math.min(a.width(),e.width()))),e.show(),F.create().insertNode(e[0]),F.createFromNodeAfter(e[0]).select(),v()}).fail(function(){t.triggerEvent("image.upload.error")})},this.insertImages=function(i){e.each(i,function(e,i){var o=i.name;s.maximumImageFileSize&&s.maximumImageFileSize<i.size?t.triggerEvent("image.upload.error",l.image.maximumFileSizeError):H.readFileAsDataURL(i).then(function(e){return n.insertImage(e,o)}).fail(function(){t.triggerEvent("image.upload.error")})})},this.insertImagesOrCallback=function(e){var n=s.callbacks;n.onImageUpload?t.triggerEvent("image.upload",e):this.insertImages(e)},this.insertNode=this.wrapCommand(function(e){F.create().insertNode(e),F.createFromNodeAfter(e).select()}),this.insertText=this.wrapCommand(function(e){var t=F.create().insertNode(f.createText(e));F.create(t,f.nodeLength(t)).select()}),this.getSelectedText=function(){var e=this.createRange();return e.isOnAnchor()&&(e=F.createFromNode(f.ancestor(e.sc,f.isAnchor))),e.toString()},this.pasteHTML=this.wrapCommand(function(e){var t=F.create().pasteHTML(e);F.createFromNodeAfter(o.last(t)).select()}),this.formatBlock=this.wrapCommand(function(e){e=d.isMSIE?"<"+e+">":e,document.execCommand("FormatBlock",!1,e)}),this.formatPara=function(){this.formatBlock("P")},t.memo("help.formatPara",l.help.formatPara);for(var y=1;6>=y;y++)this["formatH"+y]=function(e){return function(){this.formatBlock("H"+e)}}(y),t.memo("help.formatH"+y,l.help["formatH"+y]);this.fontSize=function(t){this.focus();var n=F.create();if(n&&n.isCollapsed()){var i=c.styleNodes(n),r=o.head(i);e(i).css({"font-size":t+"px"}),r&&!f.nodeLength(r)&&(r.innerHTML=f.ZERO_WIDTH_NBSP_CHAR,F.createFromNodeAfter(r.firstChild).select(),a.data(W,r))}else g(),e(c.styleNodes(n)).css({"font-size":t+"px"}),v()},this.insertHorizontalRule=this.wrapCommand(function(){var t=F.create(),n=t.insertNode(e("<HR/>")[0]);n.nextSibling&&F.create(n.nextSibling,0).normalize().select()}),t.memo("help.insertHorizontalRule",l.help.insertHorizontalRule),this.removeBogus=function(){var e=a.data(W);if(e){var t=o.find(o.from(e.childNodes),f.isText),n=t.nodeValue.indexOf(f.ZERO_WIDTH_NBSP_CHAR);-1!==n&&t.deleteData(n,1),f.isEmpty(e)&&f.remove(e),a.removeData(W)}},this.lineHeight=this.wrapCommand(function(e){c.stylePara(F.create(),{lineHeight:e})}),this.unlink=function(){var e=this.createRange();if(e.isOnAnchor()){var t=f.ancestor(e.sc,f.isAnchor);e=F.createFromNode(t),e.select(),g(),document.execCommand("unlink"),v()}},this.createLink=this.wrapCommand(function(t){var n=t.url,i=t.text,r=t.isNewWindow,a=t.range||this.createRange(),l=a.toString()!==i;s.onCreateLink&&(n=s.onCreateLink(n));var d=[];if(l){var u=a.insertNode(e("<A>"+i+"</A>")[0]);d.push(u)}else d=c.styleNodes(a,{nodeName:"A",expandClosestSibling:!0,onlyPartialContains:!0});e.each(d,function(t,i){e(i).attr("href",n),r?e(i).attr("target","_blank"):e(i).removeAttr("target")});var p=F.createFromNodeBefore(o.head(d)),f=p.getStartPoint(),h=F.createFromNodeAfter(o.last(d)),m=h.getEndPoint();F.create(f.node,f.offset,m.node,m.offset).select()}),this.getLinkInfo=function(){this.focus();var t=F.create().expand(f.isAnchor),n=e(o.head(t.nodes(f.isAnchor)));return{range:t,text:t.toString(),isNewWindow:n.length?"_blank"===n.attr("target"):!1,url:n.length?n.attr("href"):""}},this.color=this.wrapCommand(function(e){var t=e.foreColor,n=e.backColor;t&&document.execCommand("foreColor",!1,t),n&&document.execCommand("backColor",!1,n)}),this.insertTable=this.wrapCommand(function(e){var t=e.split("x"),n=F.create().deleteContents();n.insertNode(u.createTable(t[0],t[1],s))}),this.floatMe=this.wrapCommand(function(t){var n=e(this.restoreTarget());n.css("float",t)}),this.resize=this.wrapCommand(function(t){var n=e(this.restoreTarget());n.css({width:100*t+"%",height:""})}),this.resizeTo=function(e,t,n){var i;if(n){var o=e.y/e.x,r=t.data("ratio");i={width:r>o?e.x:e.y/r,height:r>o?e.x*r:e.y}}else i={width:e.x,height:e.y};t.css(i)},this.removeMedia=this.wrapCommand(function(){var n=e(this.restoreTarget()).detach();t.triggerEvent("media.delete",n,a)}),this.hasFocus=function(){return a.is(":focus")},this.focus=function(){this.hasFocus()||(a.focus(),!this.hasFocus()&&d.isFF&&F.createFromNode(a[0]).normalize().collapse().select())},this.isEmpty=function(){return f.isEmpty(a[0])||f.emptyPara===a.html()},this.empty=function(){t.invoke("code",f.emptyPara)}},q=function(t){var n=this,i=t.layoutInfo.editable;this.events={"summernote.keydown":function(e,i){n.needKeydownHook()&&(i.ctrlKey||i.metaKey)&&i.keyCode===O.code.V&&(t.invoke("editor.saveRange"),n.$paste.focus(),setTimeout(function(){n.pasteByHook()},0))}},this.needKeydownHook=function(){return d.isMSIE&&d.browserVersion>10||d.isFF},this.initialize=function(){this.needKeydownHook()?(this.$paste=e("<div />").attr("contenteditable",!0).css({position:"absolute",left:-1e5,opacity:0}),i.before(this.$paste),this.$paste.on("paste",function(e){t.triggerEvent("paste",e)})):i.on("paste",this.pasteByEvent)},this.destroy=function(){this.needKeydownHook()&&(this.$paste.remove(),
this.$paste=null)},this.pasteByHook=function(){var n=this.$paste[0].firstChild;if(f.isImg(n)){for(var i=n.src,o=atob(i.split(",")[1]),r=new Uint8Array(o.length),a=0;a<o.length;a++)r[a]=o.charCodeAt(a);var s=new Blob([r],{type:"image/png"});s.name="clipboard.png",t.invoke("editor.restoreRange"),t.invoke("editor.focus"),t.invoke("editor.insertImagesOrCallback",[s])}else{var l=e("<div />").html(this.$paste.html()).html();t.invoke("editor.restoreRange"),t.invoke("editor.focus"),l&&t.invoke("editor.pasteHTML",l)}this.$paste.empty()},this.pasteByEvent=function(e){var n=e.originalEvent.clipboardData;if(n&&n.items&&n.items.length){var i=o.head(n.items);"file"===i.kind&&-1!==i.type.indexOf("image/")&&t.invoke("editor.insertImagesOrCallback",[i.getAsFile()]),t.invoke("editor.afterCommand")}}},V=function(t){var n=e(document),i=t.layoutInfo.editor,o=t.layoutInfo.editable,r=t.options,a=r.langInfo,s=e(['<div class="note-dropzone">','  <div class="note-dropzone-message"/>',"</div>"].join("")).prependTo(i);this.initialize=function(){r.disableDragAndDrop?n.on("drop",function(e){e.preventDefault()}):this.attachDragAndDropEvent()},this.attachDragAndDropEvent=function(){var r=e(),l=s.find(".note-dropzone-message");n.on("dragenter",function(e){var n=t.invoke("codeview.isActivated"),o=i.width()>0&&i.height()>0;n||r.length||!o||(i.addClass("dragover"),s.width(i.width()),s.height(i.height()),l.text(a.image.dragImageHere)),r=r.add(e.target)}).on("dragleave",function(e){r=r.not(e.target),r.length||i.removeClass("dragover")}).on("drop",function(){r=e(),i.removeClass("dragover")}),s.on("dragenter",function(){s.addClass("hover"),l.text(a.image.dropImage)}).on("dragleave",function(){s.removeClass("hover"),l.text(a.image.dragImageHere)}),s.on("drop",function(n){var i=n.originalEvent.dataTransfer;i&&i.files&&i.files.length?(n.preventDefault(),o.focus(),t.invoke("editor.insertImagesOrCallback",i.files)):e.each(i.types,function(n,o){var r=i.getData(o);o.toLowerCase().indexOf("text")>-1?t.invoke("editor.pasteHTML",r):e(r).each(function(){t.invoke("editor.insertNode",this)})})}).on("dragover",!1)}};d.hasCodeMirror&&(d.isSupportAmd?!function(){var e=[n(27)];(function(e){P=e}).apply(null,e)}():P=window.CodeMirror);var G=function(e){var t=e.layoutInfo.editor,n=e.layoutInfo.editable,i=e.layoutInfo.codable,o=e.options;this.sync=function(){var e=this.isActivated();e&&d.hasCodeMirror&&i.data("cmEditor").save()},this.isActivated=function(){return t.hasClass("codeview")},this.toggle=function(){this.isActivated()?this.deactivate():this.activate(),e.triggerEvent("codeview.toggled")},this.activate=function(){if(i.val(f.html(n,o.prettifyHtml)),i.height(n.height()),e.invoke("toolbar.updateCodeview",!0),t.addClass("codeview"),i.focus(),d.hasCodeMirror){var r=P.fromTextArea(i[0],o.codemirror);if(o.codemirror.tern){var a=new P.TernServer(o.codemirror.tern);r.ternServer=a,r.on("cursorActivity",function(e){a.updateArgHints(e)})}r.setSize(null,n.outerHeight()),i.data("cmEditor",r)}},this.deactivate=function(){if(d.hasCodeMirror){var r=i.data("cmEditor");i.val(r.getValue()),r.toTextArea()}var a=f.value(i,o.prettifyHtml)||f.emptyPara,s=n.html()!==a;n.html(a),n.height(o.height?i.height():"auto"),t.removeClass("codeview"),s&&e.triggerEvent("change",n.html(),n),n.focus(),e.invoke("toolbar.updateCodeview",!1)},this.destroy=function(){this.isActivated()&&this.deactivate()}},K=24,X=function(t){var n=e(document),i=t.layoutInfo.statusbar,o=t.layoutInfo.editable,r=t.options;this.initialize=function(){r.airMode||r.disableResizeEditor||i.on("mousedown",function(e){e.preventDefault(),e.stopPropagation();var t=o.offset().top-n.scrollTop();n.on("mousemove",function(e){var n=e.clientY-(t+K);n=r.minheight>0?Math.max(n,r.minheight):n,n=r.maxHeight>0?Math.min(n,r.maxHeight):n,o.height(n)}).one("mouseup",function(){n.off("mousemove")})})},this.destroy=function(){i.off()}},Y=function(t){var n=t.layoutInfo.editor,i=t.layoutInfo.toolbar,o=t.layoutInfo.editable,r=t.layoutInfo.codable,a=e(window),s=e("html, body");this.toggle=function(){var e=function(e){o.css("height",e.h),r.css("height",e.h),r.data("cmeditor")&&r.data("cmeditor").setsize(null,e.h)};n.toggleClass("fullscreen");var l=n.hasClass("fullscreen");l?(o.data("orgHeight",o.css("height")),a.on("resize",function(){e({h:a.height()-i.outerHeight()})}).trigger("resize"),s.css("overflow","hidden")):(a.off("resize"),e({h:o.data("orgHeight")}),s.css("overflow","visible")),t.invoke("toolbar.updateFullscreen",l)}},Q=function(t){var n=this,i=e(document),o=t.layoutInfo.editingArea,r=t.options;this.events={"summernote.mousedown":function(e,t){n.update(t.target)&&t.preventDefault()},"summernote.keyup summernote.scroll summernote.change summernote.dialog.shown":function(){n.update()}},this.initialize=function(){this.$handle=e(['<div class="note-handle">','<div class="note-control-selection">','<div class="note-control-selection-bg"></div>','<div class="note-control-holder note-control-nw"></div>','<div class="note-control-holder note-control-ne"></div>','<div class="note-control-holder note-control-sw"></div>','<div class="',r.disableResizeImage?"note-control-holder":"note-control-sizing",' note-control-se"></div>',r.disableResizeImage?"":'<div class="note-control-selection-info"></div>',"</div>","</div>"].join("")).prependTo(o),this.$handle.on("mousedown",function(e){if(f.isControlSizing(e.target)){e.preventDefault(),e.stopPropagation();var o=n.$handle.find(".note-control-selection").data("target"),r=o.offset(),a=i.scrollTop();i.on("mousemove",function(e){t.invoke("editor.resizeTo",{x:e.clientX-r.left,y:e.clientY-(r.top-a)},o,!e.shiftKey),n.update(o[0])}).one("mouseup",function(e){e.preventDefault(),i.off("mousemove"),t.invoke("editor.afterCommand")}),o.data("ratio")||o.data("ratio",o.height()/o.width())}})},this.destroy=function(){this.$handle.remove()},this.update=function(n){var i=f.isImg(n),o=this.$handle.find(".note-control-selection");if(t.invoke("imagePopover.update",n),i){var r=e(n),a=r.position(),s={w:r.outerWidth(!0),h:r.outerHeight(!0)};o.css({display:"block",left:a.left,top:a.top,width:s.w,height:s.h}).data("target",r);var l=s.w+"x"+s.h;o.find(".note-control-selection-info").text(l),t.invoke("editor.saveTarget",n)}else this.hide();return i},this.hide=function(){t.invoke("editor.clearTarget"),this.$handle.children().hide()}},J=function(t){var n=this,i="http://",r=/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|mailto:[A-Z0-9._%+-]+@)?(www\.)?(.+)$/i;this.events={"summernote.keyup":function(e,t){t.isDefaultPrevented()||n.handleKeyup(t)},"summernote.keydown":function(e,t){n.handleKeydown(t)}},this.initialize=function(){this.lastWordRange=null},this.destroy=function(){this.lastWordRange=null},this.replace=function(){if(this.lastWordRange){var n=this.lastWordRange.toString(),o=n.match(r);if(o&&(o[1]||o[2])){var a=o[1]?n:i+n,s=e("<a />").html(n).attr("href",a)[0];this.lastWordRange.insertNode(s),this.lastWordRange=null,t.invoke("editor.focus")}}},this.handleKeydown=function(e){if(o.contains([O.code.ENTER,O.code.SPACE],e.keyCode)){var n=t.invoke("editor.createRange").getWordRange();this.lastWordRange=n}},this.handleKeyup=function(e){o.contains([O.code.ENTER,O.code.SPACE],e.keyCode)&&this.replace()}},Z=function(e){var t=e.layoutInfo.note;this.events={"summernote.change":function(){t.val(e.invoke("code"))}},this.shouldInitialize=function(){return f.isTextarea(t[0])}},ee=function(t){var n=this,i=t.layoutInfo.editingArea,o=t.options;this.events={"summernote.init summernote.change":function(){n.update()},"summernote.codeview.toggled":function(){n.update()}},this.shouldInitialize=function(){return!!o.placeholder},this.initialize=function(){this.$placeholder=e('<div class="note-placeholder">'),this.$placeholder.on("click",function(){t.invoke("focus")}).text(o.placeholder).prependTo(i)},this.destroy=function(){this.$placeholder.remove()},this.update=function(){var e=!t.invoke("codeview.isActivated")&&t.invoke("editor.isEmpty");this.$placeholder.toggle(e)}},te=function(t){var n=this,r=e.summernote.ui,a=t.layoutInfo.toolbar,s=t.options,l=s.langInfo,c=i.invertObject(s.keyMap[d.isMac?"mac":"pc"]),u=this.representShortcut=function(e){var t=c[e];return d.isMac&&(t=t.replace("CMD","⌘").replace("SHIFT","⇧")),t=t.replace("BACKSLASH","\\").replace("SLASH","/").replace("LEFTBRACKET","[").replace("RIGHTBRACKET","]")," ("+t+")"};this.initialize=function(){this.addToolbarButtons(),this.addImagePopoverButtons(),this.addLinkPopoverButtons()},this.addToolbarButtons=function(){t.memo("button.style",function(){return r.buttonGroup([r.button({className:"dropdown-toggle",contents:r.icon(s.icons.magic)+" "+r.icon(s.icons.caret,"span"),tooltip:l.style.style,data:{toggle:"dropdown"}}),r.dropdown({className:"dropdown-style",items:t.options.styleTags,template:function(e){"string"==typeof e&&(e={tag:e,title:e});var t=e.tag,n=e.title,i=e.style?' style="'+e.style+'" ':"",o=e.className?' className="'+e.className+'"':"";return"<"+t+i+o+">"+n+"</"+t+">"},click:t.createInvokeHandler("editor.formatBlock")})]).render()}),t.memo("button.bold",function(){return r.button({className:"note-btn-bold",contents:r.icon(s.icons.bold),tooltip:l.font.bold+u("bold"),click:t.createInvokeHandler("editor.bold")}).render()}),t.memo("button.italic",function(){return r.button({className:"note-btn-italic",contents:r.icon(s.icons.italic),tooltip:l.font.italic+u("italic"),click:t.createInvokeHandler("editor.italic")}).render()}),t.memo("button.underline",function(){return r.button({className:"note-btn-underline",contents:r.icon(s.icons.underline),tooltip:l.font.underline+u("underline"),click:t.createInvokeHandler("editor.underline")}).render()}),t.memo("button.clear",function(){return r.button({contents:r.icon(s.icons.eraser),tooltip:l.font.clear+u("removeFormat"),click:t.createInvokeHandler("editor.removeFormat")}).render()}),t.memo("button.strikethrough",function(){return r.button({className:"note-btn-strikethrough",contents:r.icon(s.icons.strikethrough),tooltip:l.font.strikethrough+u("strikethrough"),click:t.createInvokeHandler("editor.strikethrough")}).render()}),t.memo("button.superscript",function(){return r.button({className:"note-btn-superscript",contents:r.icon(s.icons.superscript),tooltip:l.font.superscript,click:t.createInvokeHandler("editor.superscript")}).render()}),t.memo("button.subscript",function(){return r.button({className:"note-btn-subscript",contents:r.icon(s.icons.subscript),tooltip:l.font.subscript,click:t.createInvokeHandler("editor.subscript")}).render()}),t.memo("button.fontname",function(){return r.buttonGroup([r.button({className:"dropdown-toggle",contents:'<span class="note-current-fontname"/> '+r.icon(s.icons.caret,"span"),tooltip:l.font.name,data:{toggle:"dropdown"}}),r.dropdownCheck({className:"dropdown-fontname",checkClassName:s.icons.menuCheck,items:s.fontNames.filter(function(e){return d.isFontInstalled(e)||o.contains(s.fontNamesIgnoreCheck,e)}),template:function(e){return'<span style="font-family:'+e+'">'+e+"</span>"},click:t.createInvokeHandler("editor.fontName")})]).render()}),t.memo("button.fontsize",function(){return r.buttonGroup([r.button({className:"dropdown-toggle",contents:'<span class="note-current-fontsize"/>'+r.icon(s.icons.caret,"span"),tooltip:l.font.size,data:{toggle:"dropdown"}}),r.dropdownCheck({className:"dropdown-fontsize",checkClassName:s.icons.menuCheck,items:s.fontSizes,click:t.createInvokeHandler("editor.fontSize")})]).render()}),t.memo("button.color",function(){return r.buttonGroup({className:"note-color",children:[r.button({className:"note-current-color-button",contents:r.icon(s.icons.font+" note-recent-color"),tooltip:l.color.recent,click:t.createInvokeHandler("editor.color"),callback:function(e){var t=e.find(".note-recent-color");t.css({"background-color":"yellow"}),e.data("value",{backColor:"yellow"})}}),r.button({className:"dropdown-toggle",contents:r.icon(s.icons.caret,"span"),tooltip:l.color.more,data:{toggle:"dropdown"}}),r.dropdown({items:["<li>",'<div class="btn-group">','  <div class="note-palette-title">'+l.color.background+"</div>","  <div>",'    <button type="button" class="note-color-reset btn btn-default" data-event="backColor" data-value="inherit">',l.color.transparent,"    </button>","  </div>",'  <div class="note-holder" data-event="backColor"/>',"</div>",'<div class="btn-group">','  <div class="note-palette-title">'+l.color.foreground+"</div>","  <div>",'    <button type="button" class="note-color-reset btn btn-default" data-event="removeFormat" data-value="foreColor">',l.color.resetToDefault,"    </button>","  </div>",'  <div class="note-holder" data-event="foreColor"/>',"</div>","</li>"].join(""),callback:function(t){t.find(".note-holder").each(function(){var t=e(this);t.append(r.palette({colors:s.colors,eventName:t.data("event")}).render())})},click:function(n){var i=e(n.target),o=i.data("event"),r=i.data("value");if(o&&r){var a="backColor"===o?"background-color":"color",s=i.closest(".note-color").find(".note-recent-color"),l=i.closest(".note-color").find(".note-current-color-button"),c=l.data("value");c[o]=r,s.css(a,r),l.data("value",c),t.invoke("editor."+o,r)}}})]}).render()}),t.memo("button.ol",function(){return r.button({contents:r.icon(s.icons.unorderedlist),tooltip:l.lists.unordered+u("insertUnorderedList"),click:t.createInvokeHandler("editor.insertUnorderedList")}).render()}),t.memo("button.ul",function(){return r.button({contents:r.icon(s.icons.orderedlist),tooltip:l.lists.ordered+u("insertOrderedList"),click:t.createInvokeHandler("editor.insertOrderedList")}).render()});var a=r.button({contents:r.icon(s.icons.alignLeft),tooltip:l.paragraph.left+u("justifyLeft"),click:t.createInvokeHandler("editor.justifyLeft")}),c=r.button({contents:r.icon(s.icons.alignCenter),tooltip:l.paragraph.center+u("justifyCenter"),click:t.createInvokeHandler("editor.justifyCenter")}),p=r.button({contents:r.icon(s.icons.alignRight),tooltip:l.paragraph.right+u("justifyRight"),click:t.createInvokeHandler("editor.justifyRight")}),f=r.button({contents:r.icon(s.icons.alignJustify),tooltip:l.paragraph.justify+u("justifyFull"),click:t.createInvokeHandler("editor.justifyFull")}),h=r.button({contents:r.icon(s.icons.outdent),tooltip:l.paragraph.outdent+u("outdent"),click:t.createInvokeHandler("editor.outdent")}),m=r.button({contents:r.icon(s.icons.indent),tooltip:l.paragraph.indent+u("indent"),click:t.createInvokeHandler("editor.indent")});t.memo("button.justifyLeft",i.invoke(a,"render")),t.memo("button.justifyCenter",i.invoke(c,"render")),t.memo("button.justifyRight",i.invoke(p,"render")),t.memo("button.justifyFull",i.invoke(f,"render")),t.memo("button.outdent",i.invoke(h,"render")),t.memo("button.indent",i.invoke(m,"render")),t.memo("button.paragraph",function(){return r.buttonGroup([r.button({className:"dropdown-toggle",contents:r.icon(s.icons.align)+" "+r.icon(s.icons.caret,"span"),tooltip:l.paragraph.paragraph,data:{toggle:"dropdown"}}),r.dropdown([r.buttonGroup({className:"note-align",children:[a,c,p,f]}),r.buttonGroup({className:"note-list",children:[h,m]})])]).render()}),t.memo("button.height",function(){return r.buttonGroup([r.button({className:"dropdown-toggle",contents:r.icon(s.icons.textHeight)+" "+r.icon(s.icons.caret,"span"),tooltip:l.font.height,data:{toggle:"dropdown"}}),r.dropdownCheck({items:s.lineHeights,checkClassName:s.icons.menuCheck,className:"dropdown-line-height",click:t.createInvokeHandler("editor.lineHeight")})]).render()}),t.memo("button.table",function(){return r.buttonGroup([r.button({className:"dropdown-toggle",contents:r.icon(s.icons.table)+" "+r.icon(s.icons.caret,"span"),tooltip:l.table.table,data:{toggle:"dropdown"}}),r.dropdown({className:"note-table",items:['<div class="note-dimension-picker">','  <div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"/>','  <div class="note-dimension-picker-highlighted"/>','  <div class="note-dimension-picker-unhighlighted"/>',"</div>",'<div class="note-dimension-display">1 x 1</div>'].join("")})],{callback:function(e){var i=e.find(".note-dimension-picker-mousecatcher");i.css({width:s.insertTableMaxSize.col+"em",height:s.insertTableMaxSize.row+"em"}).mousedown(t.createInvokeHandler("editor.insertTable")).on("mousemove",n.tableMoveHandler)}}).render()}),t.memo("button.link",function(){return r.button({contents:r.icon(s.icons.link),tooltip:l.link.link,click:t.createInvokeHandler("linkDialog.show")}).render()}),t.memo("button.picture",function(){return r.button({contents:r.icon(s.icons.picture),tooltip:l.image.image,click:t.createInvokeHandler("imageDialog.show")}).render()}),t.memo("button.video",function(){return r.button({contents:r.icon(s.icons.video),tooltip:l.video.video,click:t.createInvokeHandler("videoDialog.show")}).render()}),t.memo("button.hr",function(){return r.button({contents:r.icon(s.icons.minus),tooltip:l.hr.insert+u("insertHorizontalRule"),click:t.createInvokeHandler("editor.insertHorizontalRule")}).render()}),t.memo("button.fullscreen",function(){return r.button({className:"btn-fullscreen",contents:r.icon(s.icons.arrowsAlt),tooltip:l.options.fullscreen,click:t.createInvokeHandler("fullscreen.toggle")}).render()}),t.memo("button.codeview",function(){return r.button({className:"btn-codeview",contents:r.icon(s.icons.code),tooltip:l.options.codeview,click:t.createInvokeHandler("codeview.toggle")}).render()}),t.memo("button.redo",function(){return r.button({contents:r.icon(s.icons.redo),tooltip:l.history.redo+u("redo"),click:t.createInvokeHandler("editor.redo")}).render()}),t.memo("button.undo",function(){return r.button({contents:r.icon(s.icons.undo),tooltip:l.history.undo+u("undo"),click:t.createInvokeHandler("editor.undo")}).render()}),t.memo("button.help",function(){return r.button({contents:r.icon(s.icons.question),tooltip:l.options.help,click:t.createInvokeHandler("helpDialog.show")}).render()})},this.addImagePopoverButtons=function(){t.memo("button.imageSize100",function(){return r.button({contents:'<span class="note-fontsize-10">100%</span>',tooltip:l.image.resizeFull,click:t.createInvokeHandler("editor.resize","1")}).render()}),t.memo("button.imageSize50",function(){return r.button({contents:'<span class="note-fontsize-10">50%</span>',tooltip:l.image.resizeHalf,click:t.createInvokeHandler("editor.resize","0.5")}).render()}),t.memo("button.imageSize25",function(){return r.button({contents:'<span class="note-fontsize-10">25%</span>',tooltip:l.image.resizeQuarter,click:t.createInvokeHandler("editor.resize","0.25")}).render()}),t.memo("button.floatLeft",function(){return r.button({contents:r.icon(s.icons.alignLeft),tooltip:l.image.floatLeft,click:t.createInvokeHandler("editor.floatMe","left")}).render()}),t.memo("button.floatRight",function(){return r.button({contents:r.icon(s.icons.alignRight),tooltip:l.image.floatRight,click:t.createInvokeHandler("editor.floatMe","right")}).render()}),t.memo("button.floatNone",function(){return r.button({contents:r.icon(s.icons.alignJustify),tooltip:l.image.floatNone,click:t.createInvokeHandler("editor.floatMe","none")}).render()}),t.memo("button.removeMedia",function(){return r.button({contents:r.icon(s.icons.trash),tooltip:l.image.remove,click:t.createInvokeHandler("editor.removeMedia")}).render()})},this.addLinkPopoverButtons=function(){t.memo("button.linkDialogShow",function(){return r.button({contents:r.icon(s.icons.link),tooltip:l.link.edit,click:t.createInvokeHandler("linkDialog.show")}).render()}),t.memo("button.unlink",function(){return r.button({contents:r.icon(s.icons.unlink),tooltip:l.link.unlink,click:t.createInvokeHandler("editor.unlink")}).render()})},this.build=function(e,n){for(var i=0,o=n.length;o>i;i++){for(var a=n[i],s=a[0],l=a[1],c=r.buttonGroup({className:"note-"+s}).render(),d=0,u=l.length;u>d;d++){var p=t.memo("button."+l[d]);p&&c.append("function"==typeof p?p():p)}c.appendTo(e)}},this.updateCurrentStyle=function(){var n=t.invoke("editor.currentStyle");if(this.updateBtnStates({".note-btn-bold":function(){return"bold"===n["font-bold"]},".note-btn-italic":function(){return"italic"===n["font-italic"]},".note-btn-underline":function(){return"underline"===n["font-underline"]},".note-btn-subscript":function(){return"subscript"===n["font-subscript"]},".note-btn-superscript":function(){return"superscript"===n["font-superscript"]},".note-btn-strikethrough":function(){return"strikethrough"===n["font-strikethrough"]}}),n["font-family"]){var i=n["font-family"].split(",").map(function(e){return e.replace(/[\'\"]/g,"").replace(/\s+$/,"").replace(/^\s+/,"")}),r=o.find(i,function(e){return d.isFontInstalled(e)||o.contains(s.fontNamesIgnoreCheck,e)});a.find(".dropdown-fontname li a").each(function(){var t=e(this).data("value")+""==r+"";this.className=t?"checked":""}),a.find(".note-current-fontname").text(r)}if(n["font-size"]){var l=n["font-size"];a.find(".dropdown-fontsize li a").each(function(){var t=e(this).data("value")+""==l+"";this.className=t?"checked":""}),a.find(".note-current-fontsize").text(l)}if(n["line-height"]){var c=n["line-height"];a.find(".dropdown-line-height li a").each(function(){var t=e(this).data("value")+""==c+"";this.className=t?"checked":""})}},this.updateBtnStates=function(t){e.each(t,function(e,t){r.toggleBtnActive(a.find(e),t())})},this.tableMoveHandler=function(t){var n,i=18,o=e(t.target.parentNode),r=o.next(),a=o.find(".note-dimension-picker-mousecatcher"),l=o.find(".note-dimension-picker-highlighted"),c=o.find(".note-dimension-picker-unhighlighted");if(void 0===t.offsetX){var d=e(t.target).offset();n={x:t.pageX-d.left,y:t.pageY-d.top}}else n={x:t.offsetX,y:t.offsetY};var u={c:Math.ceil(n.x/i)||1,r:Math.ceil(n.y/i)||1};l.css({width:u.c+"em",height:u.r+"em"}),a.data("value",u.c+"x"+u.r),3<u.c&&u.c<s.insertTableMaxSize.col&&c.css({width:u.c+1+"em"}),3<u.r&&u.r<s.insertTableMaxSize.row&&c.css({height:u.r+1+"em"}),r.html(u.c+" x "+u.r)}},ne=function(t){var n=e.summernote.ui,i=t.layoutInfo.note,o=t.layoutInfo.toolbar,r=t.options;this.shouldInitialize=function(){return!r.airMode},this.initialize=function(){r.toolbar=r.toolbar||[],r.toolbar.length?t.invoke("buttons.build",o,r.toolbar):o.hide(),r.toolbarContainer&&o.appendTo(r.toolbarContainer),i.on("summernote.keyup summernote.mouseup summernote.change",function(){t.invoke("buttons.updateCurrentStyle")}),t.invoke("buttons.updateCurrentStyle")},this.destroy=function(){o.children().remove()},this.updateFullscreen=function(e){n.toggleBtnActive(o.find(".btn-fullscreen"),e)},this.updateCodeview=function(e){n.toggleBtnActive(o.find(".btn-codeview"),e),e?this.deactivate():this.activate()},this.activate=function(e){var t=o.find("button");e||(t=t.not(".btn-codeview")),n.toggleBtn(t,!0)},this.deactivate=function(e){var t=o.find("button");e||(t=t.not(".btn-codeview")),n.toggleBtn(t,!1)}},ie=function(t){var n=this,i=e.summernote.ui,o=t.layoutInfo.editor,r=t.options,a=r.langInfo;this.initialize=function(){var t=r.dialogsInBody?e(document.body):o,n='<div class="form-group"><label>'+a.link.textToDisplay+'</label><input class="note-link-text form-control" type="text" /></div><div class="form-group"><label>'+a.link.url+'</label><input class="note-link-url form-control" type="text" value="http://" /></div>'+(r.disableLinkTarget?"":'<div class="checkbox"><label><input type="checkbox" checked> '+a.link.openInNewWindow+"</label></div>"),s='<button href="#" class="btn btn-primary note-link-btn disabled" disabled>'+a.link.insert+"</button>";this.$dialog=i.dialog({className:"link-dialog",title:a.link.insert,fade:r.dialogsFade,body:n,footer:s}).render().appendTo(t)},this.destroy=function(){i.hideDialog(this.$dialog),this.$dialog.remove()},this.bindEnterKey=function(e,t){e.on("keypress",function(e){e.keyCode===O.code.ENTER&&t.trigger("click")})},this.showLinkDialog=function(o){return e.Deferred(function(e){var r=n.$dialog.find(".note-link-text"),a=n.$dialog.find(".note-link-url"),s=n.$dialog.find(".note-link-btn"),l=n.$dialog.find("input[type=checkbox]");i.onDialogShown(n.$dialog,function(){t.triggerEvent("dialog.shown"),r.val(o.text),r.on("input",function(){i.toggleBtn(s,r.val()&&a.val()),o.text=r.val()}),o.url||(o.url=o.text||"http://",i.toggleBtn(s,o.text)),a.on("input",function(){i.toggleBtn(s,r.val()&&a.val()),o.text||r.val(a.val())}).val(o.url).trigger("focus"),n.bindEnterKey(a,s),n.bindEnterKey(r,s),l.prop("checked",o.isNewWindow),s.one("click",function(t){t.preventDefault(),e.resolve({range:o.range,url:a.val(),text:r.val(),isNewWindow:l.is(":checked")}),n.$dialog.modal("hide")})}),i.onDialogHidden(n.$dialog,function(){r.off("input keypress"),a.off("input keypress"),s.off("click"),"pending"===e.state()&&e.reject()}),i.showDialog(n.$dialog)}).promise()},this.show=function(){var e=t.invoke("editor.getLinkInfo");t.invoke("editor.saveRange"),this.showLinkDialog(e).then(function(e){t.invoke("editor.restoreRange"),t.invoke("editor.createLink",e)}).fail(function(){t.invoke("editor.restoreRange")})},t.memo("help.linkDialog.show",r.langInfo.help["linkDialog.show"])},oe=function(t){var n=this,i=e.summernote.ui,r=t.options;this.events={"summernote.keyup summernote.mouseup summernote.change summernote.scroll":function(){n.update()},"summernote.dialog.shown":function(){n.hide()}},this.shouldInitialize=function(){return!o.isEmpty(r.popover.link)},this.initialize=function(){this.$popover=i.popover({className:"note-link-popover",callback:function(e){var t=e.find(".popover-content");t.prepend('<span><a target="_blank"></a>&nbsp;</span>')}}).render().appendTo("body");var e=this.$popover.find(".popover-content");t.invoke("buttons.build",e,r.popover.link)},this.destroy=function(){this.$popover.remove()},this.update=function(){if(!t.invoke("editor.hasFocus"))return void this.hide();var n=t.invoke("editor.createRange");if(n.isCollapsed()&&n.isOnAnchor()){var i=f.ancestor(n.sc,f.isAnchor),o=e(i).attr("href");this.$popover.find("a").attr("href",o).html(o);var r=f.posFromPlaceholder(i);this.$popover.css({display:"block",left:r.left,top:r.top})}else this.hide()},this.hide=function(){this.$popover.hide()}},re=function(t){var n=this,i=e.summernote.ui,o=t.layoutInfo.editor,r=t.options,a=r.langInfo;this.initialize=function(){var t=r.dialogsInBody?e(document.body):o,n="";if(r.maximumImageFileSize){var s=Math.floor(Math.log(r.maximumImageFileSize)/Math.log(1024)),l=1*(r.maximumImageFileSize/Math.pow(1024,s)).toFixed(2)+" "+" KMGTP"[s]+"B";n="<small>"+a.image.maximumFileSize+" : "+l+"</small>"}var c='<div class="form-group note-group-select-from-files"><label>'+a.image.selectFromFiles+'</label><input class="note-image-input form-control" type="file" name="files" accept="image/*" multiple="multiple" />'+n+'</div><div class="form-group" style="overflow:auto;"><label>'+a.image.url+'</label><input class="note-image-url form-control col-md-12" type="text" /></div>',d='<button href="#" class="btn btn-primary note-image-btn disabled" disabled>'+a.image.insert+"</button>";this.$dialog=i.dialog({title:a.image.insert,fade:r.dialogsFade,body:c,footer:d}).render().appendTo(t)},this.destroy=function(){i.hideDialog(this.$dialog),this.$dialog.remove()},this.bindEnterKey=function(e,t){e.on("keypress",function(e){e.keyCode===O.code.ENTER&&t.trigger("click")})},this.show=function(){t.invoke("editor.saveRange"),this.showImageDialog().then(function(e){i.hideDialog(n.$dialog),t.invoke("editor.restoreRange"),"string"==typeof e?t.invoke("editor.insertImage",e):t.invoke("editor.insertImagesOrCallback",e)}).fail(function(){t.invoke("editor.restoreRange")})},this.showImageDialog=function(){return e.Deferred(function(e){var o=n.$dialog.find(".note-image-input"),r=n.$dialog.find(".note-image-url"),a=n.$dialog.find(".note-image-btn");i.onDialogShown(n.$dialog,function(){t.triggerEvent("dialog.shown"),o.replaceWith(o.clone().on("change",function(){e.resolve(this.files||this.value)}).val("")),a.click(function(t){t.preventDefault(),e.resolve(r.val())}),r.on("keyup paste",function(){var e=r.val();i.toggleBtn(a,e)}).val("").trigger("focus"),n.bindEnterKey(r,a)}),i.onDialogHidden(n.$dialog,function(){o.off("change"),r.off("keyup paste keypress"),a.off("click"),"pending"===e.state()&&e.reject()}),i.showDialog(n.$dialog)})}},ae=function(t){var n=e.summernote.ui,i=t.options;this.shouldInitialize=function(){return!o.isEmpty(i.popover.image)},this.initialize=function(){this.$popover=n.popover({className:"note-image-popover"}).render().appendTo("body");var e=this.$popover.find(".popover-content");t.invoke("buttons.build",e,i.popover.image)},this.destroy=function(){this.$popover.remove()},this.update=function(e){if(f.isImg(e)){var t=f.posFromPlaceholder(e);this.$popover.css({display:"block",left:t.left,top:t.top})}else this.hide()},this.hide=function(){this.$popover.hide()}},se=function(t){var n=this,i=e.summernote.ui,o=t.layoutInfo.editor,r=t.options,a=r.langInfo;this.initialize=function(){var t=r.dialogsInBody?e(document.body):o,n='<div class="form-group row-fluid"><label>'+a.video.url+' <small class="text-muted">'+a.video.providers+'</small></label><input class="note-video-url form-control span12" type="text" /></div>',s='<button href="#" class="btn btn-primary note-video-btn disabled" disabled>'+a.video.insert+"</button>";this.$dialog=i.dialog({title:a.video.insert,fade:r.dialogsFade,body:n,footer:s}).render().appendTo(t)},this.destroy=function(){i.hideDialog(this.$dialog),this.$dialog.remove()},this.bindEnterKey=function(e,t){e.on("keypress",function(e){e.keyCode===O.code.ENTER&&t.trigger("click")})},this.createVideoNode=function(t){var n,i=/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/,o=t.match(i),r=/\/\/instagram.com\/p\/(.[a-zA-Z0-9_-]*)/,a=t.match(r),s=/\/\/vine.co\/v\/(.[a-zA-Z0-9]*)/,l=t.match(s),c=/\/\/(player.)?vimeo.com\/([a-z]*\/)*([0-9]{6,11})[?]?.*/,d=t.match(c),u=/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/,p=t.match(u),f=/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/,h=t.match(f),m=/^.+.(mp4|m4v)$/,g=t.match(m),v=/^.+.(ogg|ogv)$/,b=t.match(v),y=/^.+.(webm)$/,w=t.match(y);if(o&&11===o[1].length){var x=o[1];n=e("<iframe>").attr("frameborder",0).attr("src","//www.youtube.com/embed/"+x).attr("width","640").attr("height","360")}else if(a&&a[0].length)n=e("<iframe>").attr("frameborder",0).attr("src",a[0]+"/embed/").attr("width","612").attr("height","710").attr("scrolling","no").attr("allowtransparency","true");else if(l&&l[0].length)n=e("<iframe>").attr("frameborder",0).attr("src",l[0]+"/embed/simple").attr("width","600").attr("height","600").attr("class","vine-embed");else if(d&&d[3].length)n=e("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("src","//player.vimeo.com/video/"+d[3]).attr("width","640").attr("height","360");else if(p&&p[2].length)n=e("<iframe>").attr("frameborder",0).attr("src","//www.dailymotion.com/embed/video/"+p[2]).attr("width","640").attr("height","360");else if(h&&h[1].length)n=e("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("height","498").attr("width","510").attr("src","//player.youku.com/embed/"+h[1]);else{if(!(g||b||w))return!1;n=e("<video controls>").attr("src",t).attr("width","640").attr("height","360")}return n.addClass("note-video-clip"),n[0]},this.show=function(){var e=t.invoke("editor.getSelectedText");t.invoke("editor.saveRange"),this.showVideoDialog(e).then(function(e){i.hideDialog(n.$dialog),t.invoke("editor.restoreRange");var o=n.createVideoNode(e);o&&t.invoke("editor.insertNode",o)}).fail(function(){t.invoke("editor.restoreRange")})},this.showVideoDialog=function(o){return e.Deferred(function(e){var r=n.$dialog.find(".note-video-url"),a=n.$dialog.find(".note-video-btn");i.onDialogShown(n.$dialog,function(){t.triggerEvent("dialog.shown"),r.val(o).on("input",function(){i.toggleBtn(a,r.val())}).trigger("focus"),a.click(function(t){t.preventDefault(),e.resolve(r.val())}),n.bindEnterKey(r,a)}),i.onDialogHidden(n.$dialog,function(){r.off("input"),a.off("click"),"pending"===e.state()&&e.reject()}),i.showDialog(n.$dialog)})}},le=function(t){var n=this,i=e.summernote.ui,o=t.layoutInfo.editor,r=t.options,a=r.langInfo;
this.createShortCutList=function(){var n=r.keyMap[d.isMac?"mac":"pc"];return Object.keys(n).map(function(i){var o=n[i],r=e('<div><div class="help-list-item"/></div>');return r.append(e("<label><kbd>"+i+"</kdb></label>").css({width:180,"margin-right":10})).append(e("<span/>").html(t.memo("help."+o)||o)),r.html()}).join("")},this.initialize=function(){var t=r.dialogsInBody?e(document.body):o,n=['<p class="text-center">','<a href="//summernote.org/" target="_blank">Summernote 0.7.3</a> · ','<a href="//github.com/summernote/summernote" target="_blank">Project</a> · ','<a href="//github.com/summernote/summernote/issues" target="_blank">Issues</a>',"</p>"].join("");this.$dialog=i.dialog({title:a.options.help,fade:r.dialogsFade,body:this.createShortCutList(),footer:n,callback:function(e){e.find(".modal-body").css({"max-height":300,overflow:"scroll"})}}).render().appendTo(t)},this.destroy=function(){i.hideDialog(this.$dialog),this.$dialog.remove()},this.showHelpDialog=function(){return e.Deferred(function(e){i.onDialogShown(n.$dialog,function(){t.triggerEvent("dialog.shown"),e.resolve()}),i.showDialog(n.$dialog)}).promise()},this.show=function(){t.invoke("editor.saveRange"),this.showHelpDialog().then(function(){t.invoke("editor.restoreRange")})}},ce=function(t){var n=this,r=e.summernote.ui,a=t.options,s=20;this.events={"summernote.keyup summernote.mouseup summernote.scroll":function(){n.update()},"summernote.change summernote.dialog.shown":function(){n.hide()},"summernote.focusout":function(e,t){d.isFF||t.relatedTarget&&f.ancestor(t.relatedTarget,i.eq(n.$popover[0]))||n.hide()}},this.shouldInitialize=function(){return a.airMode&&!o.isEmpty(a.popover.air)},this.initialize=function(){this.$popover=r.popover({className:"note-air-popover"}).render().appendTo("body");var e=this.$popover.find(".popover-content");t.invoke("buttons.build",e,a.popover.air)},this.destroy=function(){this.$popover.remove()},this.update=function(){var e=t.invoke("editor.currentStyle");if(e.range&&!e.range.isCollapsed()){var n=o.last(e.range.getClientRects());if(n){var r=i.rect2bnd(n);this.$popover.css({display:"block",left:Math.max(r.left+r.width/2,0)-s,top:r.top+r.height})}}else this.hide()},this.hide=function(){this.$popover.hide()}},de=function(t){var n=this,r=e.summernote.ui,a=5,s=t.options.hint||[],l=t.options.hintDirection||"bottom",c=e.isArray(s)?s:[s];this.events={"summernote.keyup":function(e,t){t.isDefaultPrevented()||n.handleKeyup(t)},"summernote.keydown":function(e,t){n.handleKeydown(t)},"summernote.dialog.shown":function(){n.hide()}},this.shouldInitialize=function(){return c.length>0},this.initialize=function(){this.lastWordRange=null,this.$popover=r.popover({className:"note-hint-popover",hideArrow:!0,direction:""}).render().appendTo("body"),this.$popover.hide(),this.$content=this.$popover.find(".popover-content"),this.$content.on("click",".note-hint-item",function(){n.$content.find(".active").removeClass("active"),e(this).addClass("active"),n.replace()})},this.destroy=function(){this.$popover.remove()},this.selectItem=function(e){this.$content.find(".active").removeClass("active"),e.addClass("active"),this.$content[0].scrollTop=e[0].offsetTop-this.$content.innerHeight()/2},this.moveDown=function(){var e=this.$content.find(".note-hint-item.active"),t=e.next();if(t.length)this.selectItem(t);else{var n=e.parent().next();n.length||(n=this.$content.find(".note-hint-group").first()),this.selectItem(n.find(".note-hint-item").first())}},this.moveUp=function(){var e=this.$content.find(".note-hint-item.active"),t=e.prev();if(t.length)this.selectItem(t);else{var n=e.parent().prev();n.length||(n=this.$content.find(".note-hint-group").last()),this.selectItem(n.find(".note-hint-item").last())}},this.replace=function(){var e=this.$content.find(".note-hint-item.active");if(e.length){var n=this.nodeFromItem(e);this.lastWordRange.insertNode(n),F.createFromNode(n).collapse().select(),this.lastWordRange=null,this.hide(),t.invoke("editor.focus")}},this.nodeFromItem=function(e){var t=c[e.data("index")],n=e.data("item"),i=t.content?t.content(n):n;return"string"==typeof i&&(i=f.createText(i)),i},this.createItemTemplates=function(t,n){var i=c[t];return n.map(function(n,o){var r=e('<div class="note-hint-item"/>');return r.append(i.template?i.template(n):n+""),r.data({index:t,item:n}),0===t&&0===o&&r.addClass("active"),r})},this.handleKeydown=function(e){this.$popover.is(":visible")&&(e.keyCode===O.code.ENTER?(e.preventDefault(),this.replace()):e.keyCode===O.code.UP?(e.preventDefault(),this.moveUp()):e.keyCode===O.code.DOWN&&(e.preventDefault(),this.moveDown()))},this.searchKeyword=function(e,t,n){var i=c[e];if(i&&i.match.test(t)&&i.search){var o=i.match.exec(t);i.search(o[1],n)}else n()},this.createGroup=function(t,i){var o=e('<div class="note-hint-group note-hint-group-'+t+'"/>');return this.searchKeyword(t,i,function(e){e=e||[],e.length&&(o.html(n.createItemTemplates(t,e)),n.show())}),o},this.handleKeyup=function(e){if(o.contains([O.code.ENTER,O.code.UP,O.code.DOWN],e.keyCode)){if(e.keyCode===O.code.ENTER&&this.$popover.is(":visible"))return}else{var r=t.invoke("editor.createRange").getWordRange(),s=r.toString();if(c.length&&s){this.$content.empty();var d=i.rect2bnd(o.last(r.getClientRects()));d&&(this.$popover.hide(),this.lastWordRange=r,c.forEach(function(e,t){e.match.test(s)&&n.createGroup(t,s).appendTo(n.$content)}),"top"===l?this.$popover.css({left:d.left,top:d.top-this.$popover.outerHeight()-a}):this.$popover.css({left:d.left,top:d.top+d.height+a}))}else this.hide()}},this.show=function(){this.$popover.show()},this.hide=function(){this.$popover.hide()}};e.summernote=e.extend(e.summernote,{version:"0.7.3",ui:M,plugins:{},options:{modules:{editor:U,clipboard:q,dropzone:V,codeview:G,statusbar:X,fullscreen:Y,handle:Q,hintPopover:de,autoLink:J,autoSync:Z,placeholder:ee,buttons:te,toolbar:ne,linkDialog:ie,linkPopover:oe,imageDialog:re,imagePopover:ae,videoDialog:se,helpDialog:le,airPopover:ce},buttons:{},lang:"en-US",toolbar:[["style",["style"]],["font",["bold","underline","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["view",["fullscreen","codeview","help"]]],popover:{image:[["imagesize",["imageSize100","imageSize50","imageSize25"]],["float",["floatLeft","floatRight","floatNone"]],["remove",["removeMedia"]]],link:[["link",["linkDialogShow","unlink"]]],air:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]]]},airMode:!1,width:null,height:null,focus:!1,tabSize:4,styleWithSpan:!0,shortcuts:!0,textareaAutoSync:!0,direction:null,styleTags:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],fontNames:["Arial","Arial Black","Comic Sans MS","Courier New","Helvetica Neue","Helvetica","Impact","Lucida Grande","Tahoma","Times New Roman","Verdana"],fontSizes:["8","9","10","11","12","14","18","24","36"],colors:[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],lineHeights:["1.0","1.2","1.4","1.5","1.6","1.8","2.0","3.0"],tableClassName:"table table-bordered",insertTableMaxSize:{col:10,row:10},dialogsInBody:!1,dialogsFade:!1,maximumImageFileSize:null,callbacks:{onInit:null,onFocus:null,onBlur:null,onEnter:null,onKeyup:null,onKeydown:null,onSubmit:null,onImageUpload:null,onImageUploadError:null},codemirror:{mode:"text/html",htmlMode:!0,lineNumbers:!0},keyMap:{pc:{ENTER:"insertParagraph","CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule","CTRL+K":"linkDialog.show"},mac:{ENTER:"insertParagraph","CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule","CMD+K":"linkDialog.show"}},icons:{align:"fa fa-align-left",alignCenter:"fa fa-align-center",alignJustify:"fa fa-align-justify",alignLeft:"fa fa-align-left",alignRight:"fa fa-align-right",indent:"fa fa-indent",outdent:"fa fa-outdent",arrowsAlt:"fa fa-arrows-alt",bold:"fa fa-bold",caret:"caret",circle:"fa fa-circle",close:"fa fa-close",code:"fa fa-code",eraser:"fa fa-eraser",font:"fa fa-font",frame:"fa fa-frame",italic:"fa fa-italic",link:"fa fa-link",unlink:"fa fa-chain-broken",magic:"fa fa-magic",menuCheck:"fa fa-check",minus:"fa fa-minus",orderedlist:"fa fa-list-ol",pencil:"fa fa-pencil",picture:"fa fa-picture-o",question:"fa fa-question",redo:"fa fa-repeat",square:"fa fa-square",strikethrough:"fa fa-strikethrough",subscript:"fa fa-subscript",superscript:"fa fa-superscript",table:"fa fa-table",textHeight:"fa fa-text-height",trash:"fa fa-trash",underline:"fa fa-underline",undo:"fa fa-undo",unorderedlist:"fa fa-list-ul",video:"fa fa-youtube-play"}}})})},function(e,t){(function(t){e.exports=t}).call(t,{})},function(e,t,n){!function(t){e.exports=t()}(function(){"use strict";function e(n,i){if(!(this instanceof e))return new e(n,i);this.options=i=i?Ro(i):{},Ro(ea,i,!1),f(i);var o=i.value;"string"==typeof o&&(o=new Ta(o,i.mode,null,i.lineSeparator)),this.doc=o;var r=new e.inputStyles[i.inputStyle](this),a=this.display=new t(n,o,r);a.wrapper.CodeMirror=this,c(this),s(this),i.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),i.autofocus&&!Dr&&a.input.focus(),v(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new Eo,keySeq:null,specialChars:null};var l=this;yr&&11>wr&&setTimeout(function(){l.display.input.reset(!0)},20),jt(this),Yo(),wt(this),this.curOp.forceUpdate=!0,Yi(this,o),i.autofocus&&!Dr||l.hasFocus()?setTimeout($o(vn,this),20):bn(this);for(var d in ta)ta.hasOwnProperty(d)&&ta[d](this,i[d],na);k(this),i.finishInit&&i.finishInit(this);for(var u=0;u<aa.length;++u)aa[u](this);kt(this),xr&&i.lineWrapping&&"optimizelegibility"==getComputedStyle(a.lineDiv).textRendering&&(a.lineDiv.style.textRendering="auto")}function t(e,t,n){var i=this;this.input=n,i.scrollbarFiller=Wo("div",null,"CodeMirror-scrollbar-filler"),i.scrollbarFiller.setAttribute("cm-not-content","true"),i.gutterFiller=Wo("div",null,"CodeMirror-gutter-filler"),i.gutterFiller.setAttribute("cm-not-content","true"),i.lineDiv=Wo("div",null,"CodeMirror-code"),i.selectionDiv=Wo("div",null,null,"position: relative; z-index: 1"),i.cursorDiv=Wo("div",null,"CodeMirror-cursors"),i.measure=Wo("div",null,"CodeMirror-measure"),i.lineMeasure=Wo("div",null,"CodeMirror-measure"),i.lineSpace=Wo("div",[i.measure,i.lineMeasure,i.selectionDiv,i.cursorDiv,i.lineDiv],null,"position: relative; outline: none"),i.mover=Wo("div",[Wo("div",[i.lineSpace],"CodeMirror-lines")],null,"position: relative"),i.sizer=Wo("div",[i.mover],"CodeMirror-sizer"),i.sizerWidth=null,i.heightForcer=Wo("div",null,null,"position: absolute; height: "+Oa+"px; width: 1px;"),i.gutters=Wo("div",null,"CodeMirror-gutters"),i.lineGutter=null,i.scroller=Wo("div",[i.sizer,i.heightForcer,i.gutters],"CodeMirror-scroll"),i.scroller.setAttribute("tabIndex","-1"),i.wrapper=Wo("div",[i.scrollbarFiller,i.gutterFiller,i.scroller],"CodeMirror"),yr&&8>wr&&(i.gutters.style.zIndex=-1,i.scroller.style.paddingRight=0),xr||gr&&Dr||(i.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(i.wrapper):e(i.wrapper)),i.viewFrom=i.viewTo=t.first,i.reportedViewFrom=i.reportedViewTo=t.first,i.view=[],i.renderedView=null,i.externalMeasured=null,i.viewOffset=0,i.lastWrapHeight=i.lastWrapWidth=0,i.updateLineNumbers=null,i.nativeBarWidth=i.barHeight=i.barWidth=0,i.scrollbarsClipped=!1,i.lineNumWidth=i.lineNumInnerWidth=i.lineNumChars=null,i.alignWidgets=!1,i.cachedCharWidth=i.cachedTextHeight=i.cachedPaddingH=null,i.maxLine=null,i.maxLineLength=0,i.maxLineChanged=!1,i.wheelDX=i.wheelDY=i.wheelStartX=i.wheelStartY=null,i.shift=!1,i.selForContextMenu=null,i.activeTouch=null,n.init(i)}function n(t){t.doc.mode=e.getMode(t.options,t.doc.modeOption),i(t)}function i(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.frontier=e.doc.first,$e(e,100),e.state.modeGen++,e.curOp&&Ot(e)}function o(e){e.options.lineWrapping?(Ja(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(Qa(e.display.wrapper,"CodeMirror-wrap"),p(e)),a(e),Ot(e),st(e),setTimeout(function(){b(e)},100)}function r(e){var t=bt(e.display),n=e.options.lineWrapping,i=n&&Math.max(5,e.display.scroller.clientWidth/yt(e.display)-3);return function(o){if(ki(e.doc,o))return 0;var r=0;if(o.widgets)for(var a=0;a<o.widgets.length;a++)o.widgets[a].height&&(r+=o.widgets[a].height);return n?r+(Math.ceil(o.text.length/i)||1)*t:r+t}}function a(e){var t=e.doc,n=r(e);t.iter(function(e){var t=n(e);t!=e.height&&eo(e,t)})}function s(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),st(e)}function l(e){c(e),Ot(e),setTimeout(function(){x(e)},20)}function c(e){var t=e.display.gutters,n=e.options.gutters;Uo(t);for(var i=0;i<n.length;++i){var o=n[i],r=t.appendChild(Wo("div",null,"CodeMirror-gutter "+o));"CodeMirror-linenumbers"==o&&(e.display.lineGutter=r,r.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=i?"":"none",d(e)}function d(e){var t=e.display.gutters.offsetWidth;e.display.sizer.style.marginLeft=t+"px"}function u(e){if(0==e.height)return 0;for(var t,n=e.text.length,i=e;t=mi(i);){var o=t.find(0,!0);i=o.from.line,n+=o.from.ch-o.to.ch}for(i=e;t=gi(i);){var o=t.find(0,!0);n-=i.text.length-o.from.ch,i=o.to.line,n+=i.text.length-o.to.ch}return n}function p(e){var t=e.display,n=e.doc;t.maxLine=Qi(n,n.first),t.maxLineLength=u(t.maxLine),t.maxLineChanged=!0,n.iter(function(e){var n=u(e);n>t.maxLineLength&&(t.maxLineLength=n,t.maxLine=e)})}function f(e){var t=Po(e.gutters,"CodeMirror-linenumbers");-1==t&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):t>-1&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(t,1))}function h(e){var t=e.display,n=t.gutters.offsetWidth,i=Math.round(e.doc.height+Ue(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?n:0,docHeight:i,scrollHeight:i+Ve(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:n}}function m(e,t,n){this.cm=n;var i=this.vert=Wo("div",[Wo("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),o=this.horiz=Wo("div",[Wo("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");e(i),e(o),Na(i,"scroll",function(){i.clientHeight&&t(i.scrollTop,"vertical")}),Na(o,"scroll",function(){o.clientWidth&&t(o.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,yr&&8>wr&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}function g(){}function v(t){t.display.scrollbars&&(t.display.scrollbars.clear(),t.display.scrollbars.addClass&&Qa(t.display.wrapper,t.display.scrollbars.addClass)),t.display.scrollbars=new e.scrollbarModel[t.options.scrollbarStyle](function(e){t.display.wrapper.insertBefore(e,t.display.scrollbarFiller),Na(e,"mousedown",function(){t.state.focused&&setTimeout(function(){t.display.input.focus()},0)}),e.setAttribute("cm-not-content","true")},function(e,n){"horizontal"==n?rn(t,e):on(t,e)},t),t.display.scrollbars.addClass&&Ja(t.display.wrapper,t.display.scrollbars.addClass)}function b(e,t){t||(t=h(e));var n=e.display.barWidth,i=e.display.barHeight;y(e,t);for(var o=0;4>o&&n!=e.display.barWidth||i!=e.display.barHeight;o++)n!=e.display.barWidth&&e.options.lineWrapping&&E(e),y(e,h(e)),n=e.display.barWidth,i=e.display.barHeight}function y(e,t){var n=e.display,i=n.scrollbars.update(t);n.sizer.style.paddingRight=(n.barWidth=i.right)+"px",n.sizer.style.paddingBottom=(n.barHeight=i.bottom)+"px",n.heightForcer.style.borderBottom=i.bottom+"px solid transparent",i.right&&i.bottom?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=i.bottom+"px",n.scrollbarFiller.style.width=i.right+"px"):n.scrollbarFiller.style.display="",i.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=i.bottom+"px",n.gutterFiller.style.width=t.gutterWidth+"px"):n.gutterFiller.style.display=""}function w(e,t,n){var i=n&&null!=n.top?Math.max(0,n.top):e.scroller.scrollTop;i=Math.floor(i-We(e));var o=n&&null!=n.bottom?n.bottom:i+e.wrapper.clientHeight,r=no(t,i),a=no(t,o);if(n&&n.ensure){var s=n.ensure.from.line,l=n.ensure.to.line;r>s?(r=s,a=no(t,io(Qi(t,s))+e.wrapper.clientHeight)):Math.min(l,t.lastLine())>=a&&(r=no(t,io(Qi(t,l))-e.wrapper.clientHeight),a=l)}return{from:r,to:Math.max(a,r+1)}}function x(e){var t=e.display,n=t.view;if(t.alignWidgets||t.gutters.firstChild&&e.options.fixedGutter){for(var i=T(t)-t.scroller.scrollLeft+e.doc.scrollLeft,o=t.gutters.offsetWidth,r=i+"px",a=0;a<n.length;a++)if(!n[a].hidden){e.options.fixedGutter&&n[a].gutter&&(n[a].gutter.style.left=r);var s=n[a].alignable;if(s)for(var l=0;l<s.length;l++)s[l].style.left=r}e.options.fixedGutter&&(t.gutters.style.left=i+o+"px")}}function k(e){if(!e.options.lineNumbers)return!1;var t=e.doc,n=C(e.options,t.first+t.size-1),i=e.display;if(n.length!=i.lineNumChars){var o=i.measure.appendChild(Wo("div",[Wo("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),r=o.firstChild.offsetWidth,a=o.offsetWidth-r;return i.lineGutter.style.width="",i.lineNumInnerWidth=Math.max(r,i.lineGutter.offsetWidth-a)+1,i.lineNumWidth=i.lineNumInnerWidth+a,i.lineNumChars=i.lineNumInnerWidth?n.length:-1,i.lineGutter.style.width=i.lineNumWidth+"px",d(e),!0}return!1}function C(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function T(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function _(e,t,n){var i=e.display;this.viewport=t,this.visible=w(i,e.doc,t),this.editorIsHidden=!i.wrapper.offsetWidth,this.wrapperHeight=i.wrapper.clientHeight,this.wrapperWidth=i.wrapper.clientWidth,this.oldDisplayWidth=Ge(e),this.force=n,this.dims=M(e),this.events=[]}function S(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=Ve(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=Ve(e)+"px",t.scrollbarsClipped=!0)}function I(e,t){var n=e.display,i=e.doc;if(t.editorIsHidden)return Ht(e),!1;if(!t.force&&t.visible.from>=n.viewFrom&&t.visible.to<=n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo)&&n.renderedView==n.view&&0==zt(e))return!1;k(e)&&(Ht(e),t.dims=M(e));var o=i.first+i.size,r=Math.max(t.visible.from-e.options.viewportMargin,i.first),a=Math.min(o,t.visible.to+e.options.viewportMargin);n.viewFrom<r&&r-n.viewFrom<20&&(r=Math.max(i.first,n.viewFrom)),n.viewTo>a&&n.viewTo-a<20&&(a=Math.min(o,n.viewTo)),Hr&&(r=wi(e.doc,r),a=xi(e.doc,a));var s=r!=n.viewFrom||a!=n.viewTo||n.lastWrapHeight!=t.wrapperHeight||n.lastWrapWidth!=t.wrapperWidth;Bt(e,r,a),n.viewOffset=io(Qi(e.doc,n.viewFrom)),e.display.mover.style.top=n.viewOffset+"px";var l=zt(e);if(!s&&0==l&&!t.force&&n.renderedView==n.view&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo))return!1;var c=Vo();return l>4&&(n.lineDiv.style.display="none"),P(e,n.updateLineNumbers,t.dims),l>4&&(n.lineDiv.style.display=""),n.renderedView=n.view,c&&Vo()!=c&&c.offsetHeight&&c.focus(),Uo(n.cursorDiv),Uo(n.selectionDiv),n.gutters.style.height=n.sizer.style.minHeight=0,s&&(n.lastWrapHeight=t.wrapperHeight,n.lastWrapWidth=t.wrapperWidth,$e(e,400)),n.updateLineNumbers=null,!0}function L(e,t){for(var n=t.viewport,i=!0;(i&&e.options.lineWrapping&&t.oldDisplayWidth!=Ge(e)||(n&&null!=n.top&&(n={top:Math.min(e.doc.height+Ue(e.display)-Ke(e),n.top)}),t.visible=w(e.display,e.doc,n),!(t.visible.from>=e.display.viewFrom&&t.visible.to<=e.display.viewTo)))&&I(e,t);i=!1){E(e);var o=h(e);Pe(e),b(e,o),N(e,o)}t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function D(e,t){var n=new _(e,t);if(I(e,n)){E(e),L(e,n);var i=h(e);Pe(e),b(e,i),N(e,i),n.finish()}}function N(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+Ve(e)+"px"}function E(e){for(var t=e.display,n=t.lineDiv.offsetTop,i=0;i<t.view.length;i++){var o,r=t.view[i];if(!r.hidden){if(yr&&8>wr){var a=r.node.offsetTop+r.node.offsetHeight;o=a-n,n=a}else{var s=r.node.getBoundingClientRect();o=s.bottom-s.top}var l=r.line.height-o;if(2>o&&(o=bt(t)),(l>.001||-.001>l)&&(eo(r.line,o),A(r.line),r.rest))for(var c=0;c<r.rest.length;c++)A(r.rest[c])}}}function A(e){if(e.widgets)for(var t=0;t<e.widgets.length;++t)e.widgets[t].height=e.widgets[t].node.parentNode.offsetHeight}function M(e){for(var t=e.display,n={},i={},o=t.gutters.clientLeft,r=t.gutters.firstChild,a=0;r;r=r.nextSibling,++a)n[e.options.gutters[a]]=r.offsetLeft+r.clientLeft+o,i[e.options.gutters[a]]=r.clientWidth;return{fixedPos:T(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:i,wrapperWidth:t.wrapper.clientWidth}}function P(e,t,n){function i(t){var n=t.nextSibling;return xr&&Nr&&e.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),n}for(var o=e.display,r=e.options.lineNumbers,a=o.lineDiv,s=a.firstChild,l=o.view,c=o.viewFrom,d=0;d<l.length;d++){var u=l[d];if(u.hidden);else if(u.node&&u.node.parentNode==a){for(;s!=u.node;)s=i(s);var p=r&&null!=t&&c>=t&&u.lineNumber;u.changes&&(Po(u.changes,"gutter")>-1&&(p=!1),O(e,u,c,n)),p&&(Uo(u.lineNumber),u.lineNumber.appendChild(document.createTextNode(C(e.options,c)))),s=u.node.nextSibling}else{var f=W(e,u,c,n);a.insertBefore(f,s)}c+=u.size}for(;s;)s=i(s)}function O(e,t,n,i){for(var o=0;o<t.changes.length;o++){var r=t.changes[o];"text"==r?$(e,t):"gutter"==r?z(e,t,n,i):"class"==r?B(t):"widget"==r&&j(e,t,i)}t.changes=null}function F(e){return e.node==e.text&&(e.node=Wo("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),yr&&8>wr&&(e.node.style.zIndex=2)),e.node}function H(e){var t=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;if(t&&(t+=" CodeMirror-linebackground"),e.background)t?e.background.className=t:(e.background.parentNode.removeChild(e.background),e.background=null);else if(t){var n=F(e);e.background=n.insertBefore(Wo("div",null,t),n.firstChild)}}function R(e,t){var n=e.display.externalMeasured;return n&&n.line==t.line?(e.display.externalMeasured=null,t.measure=n.measure,n.built):Ri(e,t)}function $(e,t){var n=t.text.className,i=R(e,t);t.text==t.node&&(t.node=i.pre),t.text.parentNode.replaceChild(i.pre,t.text),t.text=i.pre,i.bgClass!=t.bgClass||i.textClass!=t.textClass?(t.bgClass=i.bgClass,t.textClass=i.textClass,B(t)):n&&(t.text.className=n)}function B(e){H(e),e.line.wrapClass?F(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className="");var t=e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass;e.text.className=t||""}function z(e,t,n,i){if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass){var o=F(t);t.gutterBackground=Wo("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px; width: "+i.gutterTotalWidth+"px"),o.insertBefore(t.gutterBackground,t.text)}var r=t.line.gutterMarkers;if(e.options.lineNumbers||r){var o=F(t),a=t.gutter=Wo("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px");if(e.display.input.setUneditable(a),o.insertBefore(a,t.text),t.line.gutterClass&&(a.className+=" "+t.line.gutterClass),!e.options.lineNumbers||r&&r["CodeMirror-linenumbers"]||(t.lineNumber=a.appendChild(Wo("div",C(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+i.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),r)for(var s=0;s<e.options.gutters.length;++s){var l=e.options.gutters[s],c=r.hasOwnProperty(l)&&r[l];c&&a.appendChild(Wo("div",[c],"CodeMirror-gutter-elt","left: "+i.gutterLeft[l]+"px; width: "+i.gutterWidth[l]+"px"))}}}function j(e,t,n){t.alignable&&(t.alignable=null);for(var i,o=t.node.firstChild;o;o=i){var i=o.nextSibling;"CodeMirror-linewidget"==o.className&&t.node.removeChild(o)}U(e,t,n)}function W(e,t,n,i){var o=R(e,t);return t.text=t.node=o.pre,o.bgClass&&(t.bgClass=o.bgClass),o.textClass&&(t.textClass=o.textClass),B(t),z(e,t,n,i),U(e,t,i),t.node}function U(e,t,n){if(q(e,t.line,t,n,!0),t.rest)for(var i=0;i<t.rest.length;i++)q(e,t.rest[i],t,n,!1)}function q(e,t,n,i,o){if(t.widgets)for(var r=F(n),a=0,s=t.widgets;a<s.length;++a){var l=s[a],c=Wo("div",[l.node],"CodeMirror-linewidget");l.handleMouseEvents||c.setAttribute("cm-ignore-events","true"),V(l,c,n,i),e.display.input.setUneditable(c),o&&l.above?r.insertBefore(c,n.gutter||n.text):r.appendChild(c),_o(l,"redraw")}}function V(e,t,n,i){if(e.noHScroll){(n.alignable||(n.alignable=[])).push(t);var o=i.wrapperWidth;t.style.left=i.fixedPos+"px",e.coverGutter||(o-=i.gutterTotalWidth,t.style.paddingLeft=i.gutterTotalWidth+"px"),t.style.width=o+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-i.gutterTotalWidth+"px"))}function G(e){return Rr(e.line,e.ch)}function K(e,t){return $r(e,t)<0?t:e}function X(e,t){return $r(e,t)<0?e:t}function Y(e){e.state.focused||(e.display.input.focus(),vn(e))}function Q(e,t,n,i,o){var r=e.doc;e.display.shift=!1,i||(i=r.sel);var a=e.state.pasteIncoming||"paste"==o,s=r.splitLines(t),l=null;if(a&&i.ranges.length>1)if(Br&&Br.join("\n")==t){if(i.ranges.length%Br.length==0){l=[];for(var c=0;c<Br.length;c++)l.push(r.splitLines(Br[c]))}}else s.length==i.ranges.length&&(l=Oo(s,function(e){return[e]}));for(var c=i.ranges.length-1;c>=0;c--){var d=i.ranges[c],u=d.from(),p=d.to();d.empty()&&(n&&n>0?u=Rr(u.line,u.ch-n):e.state.overwrite&&!a&&(p=Rr(p.line,Math.min(Qi(r,p.line).text.length,p.ch+Mo(s).length))));var f=e.curOp.updateInput,h={from:u,to:p,text:l?l[c%l.length]:s,origin:o||(a?"paste":e.state.cutIncoming?"cut":"+input")};Sn(e.doc,h),_o(e,"inputRead",e,h)}t&&!a&&Z(e,t),Rn(e),e.curOp.updateInput=f,e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=!1}function J(e,t){var n=e.clipboardData&&e.clipboardData.getData("text/plain");return n?(e.preventDefault(),t.isReadOnly()||t.options.disableInput||Dt(t,function(){Q(t,n,0,null,"paste")}),!0):void 0}function Z(e,t){if(e.options.electricChars&&e.options.smartIndent)for(var n=e.doc.sel,i=n.ranges.length-1;i>=0;i--){var o=n.ranges[i];if(!(o.head.ch>100||i&&n.ranges[i-1].head.line==o.head.line)){var r=e.getModeAt(o.head),a=!1;if(r.electricChars){for(var s=0;s<r.electricChars.length;s++)if(t.indexOf(r.electricChars.charAt(s))>-1){a=Bn(e,o.head.line,"smart");break}}else r.electricInput&&r.electricInput.test(Qi(e.doc,o.head.line).text.slice(0,o.head.ch))&&(a=Bn(e,o.head.line,"smart"));a&&_o(e,"electricInput",e,o.head.line)}}}function ee(e){for(var t=[],n=[],i=0;i<e.doc.sel.ranges.length;i++){var o=e.doc.sel.ranges[i].head.line,r={anchor:Rr(o,0),head:Rr(o+1,0)};n.push(r),t.push(e.getRange(r.anchor,r.head))}return{text:t,ranges:n}}function te(e){e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("spellcheck","false")}function ne(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new Eo,this.inaccurateSelection=!1,this.hasSelection=!1,this.composing=null}function ie(){var e=Wo("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none"),t=Wo("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return xr?e.style.width="1000px":e.setAttribute("wrap","off"),Lr&&(e.style.border="1px solid black"),te(e),t}function oe(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Eo,this.gracePeriod=!1}function re(e,t){var n=Ze(e,t.line);if(!n||n.hidden)return null;var i=Qi(e.doc,t.line),o=Ye(n,i,t.line),r=oo(i),a="left";if(r){var s=dr(r,t.ch);a=s%2?"right":"left"}var l=nt(o.map,t.ch,a);return l.offset="right"==l.collapse?l.end:l.start,l}function ae(e,t){return t&&(e.bad=!0),e}function se(e,t,n){var i;if(t==e.display.lineDiv){if(i=e.display.lineDiv.childNodes[n],!i)return ae(e.clipPos(Rr(e.display.viewTo-1)),!0);t=null,n=0}else for(i=t;;i=i.parentNode){if(!i||i==e.display.lineDiv)return null;if(i.parentNode&&i.parentNode==e.display.lineDiv)break}for(var o=0;o<e.display.view.length;o++){var r=e.display.view[o];if(r.node==i)return le(r,t,n)}}function le(e,t,n){function i(t,n,i){for(var o=-1;o<(d?d.length:0);o++)for(var r=0>o?c.map:d[o],a=0;a<r.length;a+=3){var s=r[a+2];if(s==t||s==n){var l=to(0>o?e.line:e.rest[o]),u=r[a]+i;return(0>i||s!=t)&&(u=r[a+(i?1:0)]),Rr(l,u)}}}var o=e.text.firstChild,r=!1;if(!t||!Ka(o,t))return ae(Rr(to(e.line),0),!0);if(t==o&&(r=!0,t=o.childNodes[n],n=0,!t)){var a=e.rest?Mo(e.rest):e.line;return ae(Rr(to(a),a.text.length),r)}var s=3==t.nodeType?t:null,l=t;for(s||1!=t.childNodes.length||3!=t.firstChild.nodeType||(s=t.firstChild,n&&(n=s.nodeValue.length));l.parentNode!=o;)l=l.parentNode;var c=e.measure,d=c.maps,u=i(s,l,n);if(u)return ae(u,r);for(var p=l.nextSibling,f=s?s.nodeValue.length-n:0;p;p=p.nextSibling){if(u=i(p,p.firstChild,0))return ae(Rr(u.line,u.ch-f),r);f+=p.textContent.length}for(var h=l.previousSibling,f=n;h;h=h.previousSibling){if(u=i(h,h.firstChild,-1))return ae(Rr(u.line,u.ch+f),r);f+=p.textContent.length}}function ce(e,t,n,i,o){function r(e){return function(t){return t.id==e}}function a(t){if(1==t.nodeType){var n=t.getAttribute("cm-text");if(null!=n)return""==n&&(n=t.textContent.replace(/\u200b/g,"")),void(s+=n);var d,u=t.getAttribute("cm-marker");if(u){var p=e.findMarks(Rr(i,0),Rr(o+1,0),r(+u));return void(p.length&&(d=p[0].find())&&(s+=Ji(e.doc,d.from,d.to).join(c)))}if("false"==t.getAttribute("contenteditable"))return;for(var f=0;f<t.childNodes.length;f++)a(t.childNodes[f]);/^(pre|div|p)$/i.test(t.nodeName)&&(l=!0)}else if(3==t.nodeType){var h=t.nodeValue;if(!h)return;l&&(s+=c,
l=!1),s+=h}}for(var s="",l=!1,c=e.doc.lineSeparator();a(t),t!=n;)t=t.nextSibling;return s}function de(e,t){this.ranges=e,this.primIndex=t}function ue(e,t){this.anchor=e,this.head=t}function pe(e,t){var n=e[t];e.sort(function(e,t){return $r(e.from(),t.from())}),t=Po(e,n);for(var i=1;i<e.length;i++){var o=e[i],r=e[i-1];if($r(r.to(),o.from())>=0){var a=X(r.from(),o.from()),s=K(r.to(),o.to()),l=r.empty()?o.from()==o.head:r.from()==r.head;t>=i&&--t,e.splice(--i,2,new ue(l?s:a,l?a:s))}}return new de(e,t)}function fe(e,t){return new de([new ue(e,t||e)],0)}function he(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function me(e,t){if(t.line<e.first)return Rr(e.first,0);var n=e.first+e.size-1;return t.line>n?Rr(n,Qi(e,n).text.length):ge(t,Qi(e,t.line).text.length)}function ge(e,t){var n=e.ch;return null==n||n>t?Rr(e.line,t):0>n?Rr(e.line,0):e}function ve(e,t){return t>=e.first&&t<e.first+e.size}function be(e,t){for(var n=[],i=0;i<t.length;i++)n[i]=me(e,t[i]);return n}function ye(e,t,n,i){if(e.cm&&e.cm.display.shift||e.extend){var o=t.anchor;if(i){var r=$r(n,o)<0;r!=$r(i,o)<0?(o=n,n=i):r!=$r(n,i)<0&&(n=i)}return new ue(o,n)}return new ue(i||n,n)}function we(e,t,n,i){Se(e,new de([ye(e,e.sel.primary(),t,n)],0),i)}function xe(e,t,n){for(var i=[],o=0;o<e.sel.ranges.length;o++)i[o]=ye(e,e.sel.ranges[o],t[o],null);var r=pe(i,e.sel.primIndex);Se(e,r,n)}function ke(e,t,n,i){var o=e.sel.ranges.slice(0);o[t]=n,Se(e,pe(o,e.sel.primIndex),i)}function Ce(e,t,n,i){Se(e,fe(t,n),i)}function Te(e,t,n){var i={ranges:t.ranges,update:function(t){this.ranges=[];for(var n=0;n<t.length;n++)this.ranges[n]=new ue(me(e,t[n].anchor),me(e,t[n].head))},origin:n&&n.origin};return Ma(e,"beforeSelectionChange",e,i),e.cm&&Ma(e.cm,"beforeSelectionChange",e.cm,i),i.ranges!=t.ranges?pe(i.ranges,i.ranges.length-1):t}function _e(e,t,n){var i=e.history.done,o=Mo(i);o&&o.ranges?(i[i.length-1]=t,Ie(e,t,n)):Se(e,t,n)}function Se(e,t,n){Ie(e,t,n),po(e,e.sel,e.cm?e.cm.curOp.id:NaN,n)}function Ie(e,t,n){(Do(e,"beforeSelectionChange")||e.cm&&Do(e.cm,"beforeSelectionChange"))&&(t=Te(e,t,n));var i=n&&n.bias||($r(t.primary().head,e.sel.primary().head)<0?-1:1);Le(e,Ne(e,t,i,!0)),n&&n.scroll===!1||!e.cm||Rn(e.cm)}function Le(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0,Lo(e.cm)),_o(e,"cursorActivity",e))}function De(e){Le(e,Ne(e,e.sel,null,!1),Ha)}function Ne(e,t,n,i){for(var o,r=0;r<t.ranges.length;r++){var a=t.ranges[r],s=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[r],l=Ae(e,a.anchor,s&&s.anchor,n,i),c=Ae(e,a.head,s&&s.head,n,i);(o||l!=a.anchor||c!=a.head)&&(o||(o=t.ranges.slice(0,r)),o[r]=new ue(l,c))}return o?pe(o,t.primIndex):t}function Ee(e,t,n,i,o){var r=Qi(e,t.line);if(r.markedSpans)for(var a=0;a<r.markedSpans.length;++a){var s=r.markedSpans[a],l=s.marker;if((null==s.from||(l.inclusiveLeft?s.from<=t.ch:s.from<t.ch))&&(null==s.to||(l.inclusiveRight?s.to>=t.ch:s.to>t.ch))){if(o&&(Ma(l,"beforeCursorEnter"),l.explicitlyCleared)){if(r.markedSpans){--a;continue}break}if(!l.atomic)continue;if(n){var c,d=l.find(0>i?1:-1);if((0>i?l.inclusiveRight:l.inclusiveLeft)&&(d=Me(e,d,-i,d&&d.line==t.line?r:null)),d&&d.line==t.line&&(c=$r(d,n))&&(0>i?0>c:c>0))return Ee(e,d,t,i,o)}var u=l.find(0>i?-1:1);return(0>i?l.inclusiveLeft:l.inclusiveRight)&&(u=Me(e,u,i,u.line==t.line?r:null)),u?Ee(e,u,t,i,o):null}}return t}function Ae(e,t,n,i,o){var r=i||1,a=Ee(e,t,n,r,o)||!o&&Ee(e,t,n,r,!0)||Ee(e,t,n,-r,o)||!o&&Ee(e,t,n,-r,!0);return a?a:(e.cantEdit=!0,Rr(e.first,0))}function Me(e,t,n,i){return 0>n&&0==t.ch?t.line>e.first?me(e,Rr(t.line-1)):null:n>0&&t.ch==(i||Qi(e,t.line)).text.length?t.line<e.first+e.size-1?Rr(t.line+1,0):null:new Rr(t.line,t.ch+n)}function Pe(e){e.display.input.showSelection(e.display.input.prepareSelection())}function Oe(e,t){for(var n=e.doc,i={},o=i.cursors=document.createDocumentFragment(),r=i.selection=document.createDocumentFragment(),a=0;a<n.sel.ranges.length;a++)if(t!==!1||a!=n.sel.primIndex){var s=n.sel.ranges[a];if(!(s.from().line>=e.display.viewTo||s.to().line<e.display.viewFrom)){var l=s.empty();(l||e.options.showCursorWhenSelecting)&&Fe(e,s.head,o),l||He(e,s,r)}}return i}function Fe(e,t,n){var i=ft(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),o=n.appendChild(Wo("div"," ","CodeMirror-cursor"));if(o.style.left=i.left+"px",o.style.top=i.top+"px",o.style.height=Math.max(0,i.bottom-i.top)*e.options.cursorHeight+"px",i.other){var r=n.appendChild(Wo("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));r.style.display="",r.style.left=i.other.left+"px",r.style.top=i.other.top+"px",r.style.height=.85*(i.other.bottom-i.other.top)+"px"}}function He(e,t,n){function i(e,t,n,i){0>t&&(t=0),t=Math.round(t),i=Math.round(i),s.appendChild(Wo("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(null==n?d-e:n)+"px; height: "+(i-t)+"px"))}function o(t,n,o){function r(n,i){return pt(e,Rr(t,n),"div",u,i)}var s,l,u=Qi(a,t),p=u.text.length;return tr(oo(u),n||0,null==o?p:o,function(e,t,a){var u,f,h,m=r(e,"left");if(e==t)u=m,f=h=m.left;else{if(u=r(t-1,"right"),"rtl"==a){var g=m;m=u,u=g}f=m.left,h=u.right}null==n&&0==e&&(f=c),u.top-m.top>3&&(i(f,m.top,null,m.bottom),f=c,m.bottom<u.top&&i(f,m.bottom,null,u.top)),null==o&&t==p&&(h=d),(!s||m.top<s.top||m.top==s.top&&m.left<s.left)&&(s=m),(!l||u.bottom>l.bottom||u.bottom==l.bottom&&u.right>l.right)&&(l=u),c+1>f&&(f=c),i(f,u.top,h-f,u.bottom)}),{start:s,end:l}}var r=e.display,a=e.doc,s=document.createDocumentFragment(),l=qe(e.display),c=l.left,d=Math.max(r.sizerWidth,Ge(e)-r.sizer.offsetLeft)-l.right,u=t.from(),p=t.to();if(u.line==p.line)o(u.line,u.ch,p.ch);else{var f=Qi(a,u.line),h=Qi(a,p.line),m=bi(f)==bi(h),g=o(u.line,u.ch,m?f.text.length+1:null).end,v=o(p.line,m?0:null,p.ch).start;m&&(g.top<v.top-2?(i(g.right,g.top,null,g.bottom),i(c,v.top,v.left,v.bottom)):i(g.right,g.top,v.left-g.right,g.bottom)),g.bottom<v.top&&i(c,g.bottom,null,v.top)}n.appendChild(s)}function Re(e){if(e.state.focused){var t=e.display;clearInterval(t.blinker);var n=!0;t.cursorDiv.style.visibility="",e.options.cursorBlinkRate>0?t.blinker=setInterval(function(){t.cursorDiv.style.visibility=(n=!n)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden")}}function $e(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.viewTo&&e.state.highlight.set(t,$o(Be,e))}function Be(e){var t=e.doc;if(t.frontier<t.first&&(t.frontier=t.first),!(t.frontier>=e.display.viewTo)){var n=+new Date+e.options.workTime,i=la(t.mode,je(e,t.frontier)),o=[];t.iter(t.frontier,Math.min(t.first+t.size,e.display.viewTo+500),function(r){if(t.frontier>=e.display.viewFrom){var a=r.styles,s=r.text.length>e.options.maxHighlightLength,l=Pi(e,r,s?la(t.mode,i):i,!0);r.styles=l.styles;var c=r.styleClasses,d=l.classes;d?r.styleClasses=d:c&&(r.styleClasses=null);for(var u=!a||a.length!=r.styles.length||c!=d&&(!c||!d||c.bgClass!=d.bgClass||c.textClass!=d.textClass),p=0;!u&&p<a.length;++p)u=a[p]!=r.styles[p];u&&o.push(t.frontier),r.stateAfter=s?i:la(t.mode,i)}else r.text.length<=e.options.maxHighlightLength&&Fi(e,r.text,i),r.stateAfter=t.frontier%5==0?la(t.mode,i):null;return++t.frontier,+new Date>n?($e(e,e.options.workDelay),!0):void 0}),o.length&&Dt(e,function(){for(var t=0;t<o.length;t++)Ft(e,o[t],"text")})}}function ze(e,t,n){for(var i,o,r=e.doc,a=n?-1:t-(e.doc.mode.innerMode?1e3:100),s=t;s>a;--s){if(s<=r.first)return r.first;var l=Qi(r,s-1);if(l.stateAfter&&(!n||s<=r.frontier))return s;var c=Ba(l.text,null,e.options.tabSize);(null==o||i>c)&&(o=s-1,i=c)}return o}function je(e,t,n){var i=e.doc,o=e.display;if(!i.mode.startState)return!0;var r=ze(e,t,n),a=r>i.first&&Qi(i,r-1).stateAfter;return a=a?la(i.mode,a):ca(i.mode),i.iter(r,t,function(n){Fi(e,n.text,a);var s=r==t-1||r%5==0||r>=o.viewFrom&&r<o.viewTo;n.stateAfter=s?la(i.mode,a):null,++r}),n&&(i.frontier=r),a}function We(e){return e.lineSpace.offsetTop}function Ue(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function qe(e){if(e.cachedPaddingH)return e.cachedPaddingH;var t=qo(e.measure,Wo("pre","x")),n=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,i={left:parseInt(n.paddingLeft),right:parseInt(n.paddingRight)};return isNaN(i.left)||isNaN(i.right)||(e.cachedPaddingH=i),i}function Ve(e){return Oa-e.display.nativeBarWidth}function Ge(e){return e.display.scroller.clientWidth-Ve(e)-e.display.barWidth}function Ke(e){return e.display.scroller.clientHeight-Ve(e)-e.display.barHeight}function Xe(e,t,n){var i=e.options.lineWrapping,o=i&&Ge(e);if(!t.measure.heights||i&&t.measure.width!=o){var r=t.measure.heights=[];if(i){t.measure.width=o;for(var a=t.text.firstChild.getClientRects(),s=0;s<a.length-1;s++){var l=a[s],c=a[s+1];Math.abs(l.bottom-c.bottom)>2&&r.push((l.bottom+c.top)/2-n.top)}}r.push(n.bottom-n.top)}}function Ye(e,t,n){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(var i=0;i<e.rest.length;i++)if(e.rest[i]==t)return{map:e.measure.maps[i],cache:e.measure.caches[i]};for(var i=0;i<e.rest.length;i++)if(to(e.rest[i])>n)return{map:e.measure.maps[i],cache:e.measure.caches[i],before:!0}}function Qe(e,t){t=bi(t);var n=to(t),i=e.display.externalMeasured=new Mt(e.doc,t,n);i.lineN=n;var o=i.built=Ri(e,i);return i.text=o.pre,qo(e.display.lineMeasure,o.pre),i}function Je(e,t,n,i){return tt(e,et(e,t),n,i)}function Ze(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[Rt(e,t)];var n=e.display.externalMeasured;return n&&t>=n.lineN&&t<n.lineN+n.size?n:void 0}function et(e,t){var n=to(t),i=Ze(e,n);i&&!i.text?i=null:i&&i.changes&&(O(e,i,n,M(e)),e.curOp.forceUpdate=!0),i||(i=Qe(e,t));var o=Ye(i,t,n);return{line:t,view:i,rect:null,map:o.map,cache:o.cache,before:o.before,hasHeights:!1}}function tt(e,t,n,i,o){t.before&&(n=-1);var r,a=n+(i||"");return t.cache.hasOwnProperty(a)?r=t.cache[a]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(Xe(e,t.view,t.rect),t.hasHeights=!0),r=it(e,t,n,i),r.bogus||(t.cache[a]=r)),{left:r.left,right:r.right,top:o?r.rtop:r.top,bottom:o?r.rbottom:r.bottom}}function nt(e,t,n){for(var i,o,r,a,s=0;s<e.length;s+=3){var l=e[s],c=e[s+1];if(l>t?(o=0,r=1,a="left"):c>t?(o=t-l,r=o+1):(s==e.length-3||t==c&&e[s+3]>t)&&(r=c-l,o=r-1,t>=c&&(a="right")),null!=o){if(i=e[s+2],l==c&&n==(i.insertLeft?"left":"right")&&(a=n),"left"==n&&0==o)for(;s&&e[s-2]==e[s-3]&&e[s-1].insertLeft;)i=e[(s-=3)+2],a="left";if("right"==n&&o==c-l)for(;s<e.length-3&&e[s+3]==e[s+4]&&!e[s+5].insertLeft;)i=e[(s+=3)+2],a="right";break}}return{node:i,start:o,end:r,collapse:a,coverStart:l,coverEnd:c}}function it(e,t,n,i){var o,r=nt(t.map,n,i),a=r.node,s=r.start,l=r.end,c=r.collapse;if(3==a.nodeType){for(var d=0;4>d;d++){for(;s&&jo(t.line.text.charAt(r.coverStart+s));)--s;for(;r.coverStart+l<r.coverEnd&&jo(t.line.text.charAt(r.coverStart+l));)++l;if(yr&&9>wr&&0==s&&l==r.coverEnd-r.coverStart)o=a.parentNode.getBoundingClientRect();else if(yr&&e.options.lineWrapping){var u=Ua(a,s,l).getClientRects();o=u.length?u["right"==i?u.length-1:0]:Ur}else o=Ua(a,s,l).getBoundingClientRect()||Ur;if(o.left||o.right||0==s)break;l=s,s-=1,c="right"}yr&&11>wr&&(o=ot(e.display.measure,o))}else{s>0&&(c=i="right");var u;o=e.options.lineWrapping&&(u=a.getClientRects()).length>1?u["right"==i?u.length-1:0]:a.getBoundingClientRect()}if(yr&&9>wr&&!s&&(!o||!o.left&&!o.right)){var p=a.parentNode.getClientRects()[0];o=p?{left:p.left,right:p.left+yt(e.display),top:p.top,bottom:p.bottom}:Ur}for(var f=o.top-t.rect.top,h=o.bottom-t.rect.top,m=(f+h)/2,g=t.view.measure.heights,d=0;d<g.length-1&&!(m<g[d]);d++);var v=d?g[d-1]:0,b=g[d],y={left:("right"==c?o.right:o.left)-t.rect.left,right:("left"==c?o.left:o.right)-t.rect.left,top:v,bottom:b};return o.left||o.right||(y.bogus=!0),e.options.singleCursorHeightPerLine||(y.rtop=f,y.rbottom=h),y}function ot(e,t){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!er(e))return t;var n=screen.logicalXDPI/screen.deviceXDPI,i=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*n,right:t.right*n,top:t.top*i,bottom:t.bottom*i}}function rt(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function at(e){e.display.externalMeasure=null,Uo(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)rt(e.display.view[t])}function st(e){at(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function lt(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function ct(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function dt(e,t,n,i){if(t.widgets)for(var o=0;o<t.widgets.length;++o)if(t.widgets[o].above){var r=_i(t.widgets[o]);n.top+=r,n.bottom+=r}if("line"==i)return n;i||(i="local");var a=io(t);if("local"==i?a+=We(e.display):a-=e.display.viewOffset,"page"==i||"window"==i){var s=e.display.lineSpace.getBoundingClientRect();a+=s.top+("window"==i?0:ct());var l=s.left+("window"==i?0:lt());n.left+=l,n.right+=l}return n.top+=a,n.bottom+=a,n}function ut(e,t,n){if("div"==n)return t;var i=t.left,o=t.top;if("page"==n)i-=lt(),o-=ct();else if("local"==n||!n){var r=e.display.sizer.getBoundingClientRect();i+=r.left,o+=r.top}var a=e.display.lineSpace.getBoundingClientRect();return{left:i-a.left,top:o-a.top}}function pt(e,t,n,i,o){return i||(i=Qi(e.doc,t.line)),dt(e,i,Je(e,i,t.ch,o),n)}function ft(e,t,n,i,o,r){function a(t,a){var s=tt(e,o,t,a?"right":"left",r);return a?s.left=s.right:s.right=s.left,dt(e,i,s,n)}function s(e,t){var n=l[t],i=n.level%2;return e==nr(n)&&t&&n.level<l[t-1].level?(n=l[--t],e=ir(n)-(n.level%2?0:1),i=!0):e==ir(n)&&t<l.length-1&&n.level<l[t+1].level&&(n=l[++t],e=nr(n)-n.level%2,i=!1),i&&e==n.to&&e>n.from?a(e-1):a(e,i)}i=i||Qi(e.doc,t.line),o||(o=et(e,i));var l=oo(i),c=t.ch;if(!l)return a(c);var d=dr(l,c),u=s(c,d);return null!=as&&(u.other=s(c,as)),u}function ht(e,t){var n=0,t=me(e.doc,t);e.options.lineWrapping||(n=yt(e.display)*t.ch);var i=Qi(e.doc,t.line),o=io(i)+We(e.display);return{left:n,right:n,top:o,bottom:o+i.height}}function mt(e,t,n,i){var o=Rr(e,t);return o.xRel=i,n&&(o.outside=!0),o}function gt(e,t,n){var i=e.doc;if(n+=e.display.viewOffset,0>n)return mt(i.first,0,!0,-1);var o=no(i,n),r=i.first+i.size-1;if(o>r)return mt(i.first+i.size-1,Qi(i,r).text.length,!0,1);0>t&&(t=0);for(var a=Qi(i,o);;){var s=vt(e,a,o,t,n),l=gi(a),c=l&&l.find(0,!0);if(!l||!(s.ch>c.from.ch||s.ch==c.from.ch&&s.xRel>0))return s;o=to(a=c.to.line)}}function vt(e,t,n,i,o){function r(i){var o=ft(e,Rr(n,i),"line",t,c);return s=!0,a>o.bottom?o.left-l:a<o.top?o.left+l:(s=!1,o.left)}var a=o-io(t),s=!1,l=2*e.display.wrapper.clientWidth,c=et(e,t),d=oo(t),u=t.text.length,p=or(t),f=rr(t),h=r(p),m=s,g=r(f),v=s;if(i>g)return mt(n,f,v,1);for(;;){if(d?f==p||f==pr(t,p,1):1>=f-p){for(var b=h>i||g-i>=i-h?p:f,y=i-(b==p?h:g);jo(t.text.charAt(b));)++b;var w=mt(n,b,b==p?m:v,-1>y?-1:y>1?1:0);return w}var x=Math.ceil(u/2),k=p+x;if(d){k=p;for(var C=0;x>C;++C)k=pr(t,k,1)}var T=r(k);T>i?(f=k,g=T,(v=s)&&(g+=1e3),u=x):(p=k,h=T,m=s,u-=x)}}function bt(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==zr){zr=Wo("pre");for(var t=0;49>t;++t)zr.appendChild(document.createTextNode("x")),zr.appendChild(Wo("br"));zr.appendChild(document.createTextNode("x"))}qo(e.measure,zr);var n=zr.offsetHeight/50;return n>3&&(e.cachedTextHeight=n),Uo(e.measure),n||1}function yt(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=Wo("span","xxxxxxxxxx"),n=Wo("pre",[t]);qo(e.measure,n);var i=t.getBoundingClientRect(),o=(i.right-i.left)/10;return o>2&&(e.cachedCharWidth=o),o||10}function wt(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Vr},qr?qr.ops.push(e.curOp):e.curOp.ownsGroup=qr={ops:[e.curOp],delayedCallbacks:[]}}function xt(e){var t=e.delayedCallbacks,n=0;do{for(;n<t.length;n++)t[n].call(null);for(var i=0;i<e.ops.length;i++){var o=e.ops[i];if(o.cursorActivityHandlers)for(;o.cursorActivityCalled<o.cursorActivityHandlers.length;)o.cursorActivityHandlers[o.cursorActivityCalled++].call(null,o.cm)}}while(n<t.length)}function kt(e){var t=e.curOp,n=t.ownsGroup;if(n)try{xt(n)}finally{qr=null;for(var i=0;i<n.ops.length;i++)n.ops[i].cm.curOp=null;Ct(n)}}function Ct(e){for(var t=e.ops,n=0;n<t.length;n++)Tt(t[n]);for(var n=0;n<t.length;n++)_t(t[n]);for(var n=0;n<t.length;n++)St(t[n]);for(var n=0;n<t.length;n++)It(t[n]);for(var n=0;n<t.length;n++)Lt(t[n])}function Tt(e){var t=e.cm,n=t.display;S(t),e.updateMaxLine&&p(t),e.mustUpdate=e.viewChanged||e.forceUpdate||null!=e.scrollTop||e.scrollToPos&&(e.scrollToPos.from.line<n.viewFrom||e.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&t.options.lineWrapping,e.update=e.mustUpdate&&new _(t,e.mustUpdate&&{top:e.scrollTop,ensure:e.scrollToPos},e.forceUpdate)}function _t(e){e.updatedDisplay=e.mustUpdate&&I(e.cm,e.update)}function St(e){var t=e.cm,n=t.display;e.updatedDisplay&&E(t),e.barMeasure=h(t),n.maxLineChanged&&!t.options.lineWrapping&&(e.adjustWidthTo=Je(t,n.maxLine,n.maxLine.text.length).left+3,t.display.sizerWidth=e.adjustWidthTo,e.barMeasure.scrollWidth=Math.max(n.scroller.clientWidth,n.sizer.offsetLeft+e.adjustWidthTo+Ve(t)+t.display.barWidth),e.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+e.adjustWidthTo-Ge(t))),(e.updatedDisplay||e.selectionChanged)&&(e.preparedSelection=n.input.prepareSelection())}function It(e){var t=e.cm;null!=e.adjustWidthTo&&(t.display.sizer.style.minWidth=e.adjustWidthTo+"px",e.maxScrollLeft<t.doc.scrollLeft&&rn(t,Math.min(t.display.scroller.scrollLeft,e.maxScrollLeft),!0),t.display.maxLineChanged=!1),e.preparedSelection&&t.display.input.showSelection(e.preparedSelection),(e.updatedDisplay||e.startHeight!=t.doc.height)&&b(t,e.barMeasure),e.updatedDisplay&&N(t,e.barMeasure),e.selectionChanged&&Re(t),t.state.focused&&e.updateInput&&t.display.input.reset(e.typing),!e.focus||e.focus!=Vo()||document.hasFocus&&!document.hasFocus()||Y(e.cm)}function Lt(e){var t=e.cm,n=t.display,i=t.doc;if(e.updatedDisplay&&L(t,e.update),null==n.wheelStartX||null==e.scrollTop&&null==e.scrollLeft&&!e.scrollToPos||(n.wheelStartX=n.wheelStartY=null),null==e.scrollTop||n.scroller.scrollTop==e.scrollTop&&!e.forceScroll||(i.scrollTop=Math.max(0,Math.min(n.scroller.scrollHeight-n.scroller.clientHeight,e.scrollTop)),n.scrollbars.setScrollTop(i.scrollTop),n.scroller.scrollTop=i.scrollTop),null==e.scrollLeft||n.scroller.scrollLeft==e.scrollLeft&&!e.forceScroll||(i.scrollLeft=Math.max(0,Math.min(n.scroller.scrollWidth-n.scroller.clientWidth,e.scrollLeft)),n.scrollbars.setScrollLeft(i.scrollLeft),n.scroller.scrollLeft=i.scrollLeft,x(t)),e.scrollToPos){var o=Pn(t,me(i,e.scrollToPos.from),me(i,e.scrollToPos.to),e.scrollToPos.margin);e.scrollToPos.isCursor&&t.state.focused&&Mn(t,o)}var r=e.maybeHiddenMarkers,a=e.maybeUnhiddenMarkers;if(r)for(var s=0;s<r.length;++s)r[s].lines.length||Ma(r[s],"hide");if(a)for(var s=0;s<a.length;++s)a[s].lines.length&&Ma(a[s],"unhide");n.wrapper.offsetHeight&&(i.scrollTop=t.display.scroller.scrollTop),e.changeObjs&&Ma(t,"changes",t,e.changeObjs),e.update&&e.update.finish()}function Dt(e,t){if(e.curOp)return t();wt(e);try{return t()}finally{kt(e)}}function Nt(e,t){return function(){if(e.curOp)return t.apply(e,arguments);wt(e);try{return t.apply(e,arguments)}finally{kt(e)}}}function Et(e){return function(){if(this.curOp)return e.apply(this,arguments);wt(this);try{return e.apply(this,arguments)}finally{kt(this)}}}function At(e){return function(){var t=this.cm;if(!t||t.curOp)return e.apply(this,arguments);wt(t);try{return e.apply(this,arguments)}finally{kt(t)}}}function Mt(e,t,n){this.line=t,this.rest=yi(t),this.size=this.rest?to(Mo(this.rest))-n+1:1,this.node=this.text=null,this.hidden=ki(e,t)}function Pt(e,t,n){for(var i,o=[],r=t;n>r;r=i){var a=new Mt(e.doc,Qi(e.doc,r),r);i=r+a.size,o.push(a)}return o}function Ot(e,t,n,i){null==t&&(t=e.doc.first),null==n&&(n=e.doc.first+e.doc.size),i||(i=0);var o=e.display;if(i&&n<o.viewTo&&(null==o.updateLineNumbers||o.updateLineNumbers>t)&&(o.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=o.viewTo)Hr&&wi(e.doc,t)<o.viewTo&&Ht(e);else if(n<=o.viewFrom)Hr&&xi(e.doc,n+i)>o.viewFrom?Ht(e):(o.viewFrom+=i,o.viewTo+=i);else if(t<=o.viewFrom&&n>=o.viewTo)Ht(e);else if(t<=o.viewFrom){var r=$t(e,n,n+i,1);r?(o.view=o.view.slice(r.index),o.viewFrom=r.lineN,o.viewTo+=i):Ht(e)}else if(n>=o.viewTo){var r=$t(e,t,t,-1);r?(o.view=o.view.slice(0,r.index),o.viewTo=r.lineN):Ht(e)}else{var a=$t(e,t,t,-1),s=$t(e,n,n+i,1);a&&s?(o.view=o.view.slice(0,a.index).concat(Pt(e,a.lineN,s.lineN)).concat(o.view.slice(s.index)),o.viewTo+=i):Ht(e)}var l=o.externalMeasured;l&&(n<l.lineN?l.lineN+=i:t<l.lineN+l.size&&(o.externalMeasured=null))}function Ft(e,t,n){e.curOp.viewChanged=!0;var i=e.display,o=e.display.externalMeasured;if(o&&t>=o.lineN&&t<o.lineN+o.size&&(i.externalMeasured=null),!(t<i.viewFrom||t>=i.viewTo)){var r=i.view[Rt(e,t)];if(null!=r.node){var a=r.changes||(r.changes=[]);-1==Po(a,n)&&a.push(n)}}}function Ht(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function Rt(e,t){if(t>=e.display.viewTo)return null;if(t-=e.display.viewFrom,0>t)return null;for(var n=e.display.view,i=0;i<n.length;i++)if(t-=n[i].size,0>t)return i}function $t(e,t,n,i){var o,r=Rt(e,t),a=e.display.view;if(!Hr||n==e.doc.first+e.doc.size)return{index:r,lineN:n};for(var s=0,l=e.display.viewFrom;r>s;s++)l+=a[s].size;if(l!=t){if(i>0){if(r==a.length-1)return null;o=l+a[r].size-t,r++}else o=l-t;t+=o,n+=o}for(;wi(e.doc,n)!=n;){if(r==(0>i?0:a.length-1))return null;n+=i*a[r-(0>i?1:0)].size,r+=i}return{index:r,lineN:n}}function Bt(e,t,n){var i=e.display,o=i.view;0==o.length||t>=i.viewTo||n<=i.viewFrom?(i.view=Pt(e,t,n),i.viewFrom=t):(i.viewFrom>t?i.view=Pt(e,t,i.viewFrom).concat(i.view):i.viewFrom<t&&(i.view=i.view.slice(Rt(e,t))),i.viewFrom=t,i.viewTo<n?i.view=i.view.concat(Pt(e,i.viewTo,n)):i.viewTo>n&&(i.view=i.view.slice(0,Rt(e,n)))),i.viewTo=n}function zt(e){for(var t=e.display.view,n=0,i=0;i<t.length;i++){var o=t[i];o.hidden||o.node&&!o.changes||++n}return n}function jt(e){function t(){o.activeTouch&&(r=setTimeout(function(){o.activeTouch=null},1e3),a=o.activeTouch,a.end=+new Date)}function n(e){if(1!=e.touches.length)return!1;var t=e.touches[0];return t.radiusX<=1&&t.radiusY<=1}function i(e,t){if(null==t.left)return!0;var n=t.left-e.left,i=t.top-e.top;return n*n+i*i>400}var o=e.display;Na(o.scroller,"mousedown",Nt(e,Gt)),yr&&11>wr?Na(o.scroller,"dblclick",Nt(e,function(t){if(!Io(e,t)){var n=Vt(e,t);if(n&&!Jt(e,t)&&!qt(e.display,t)){Ia(t);var i=e.findWordAt(n);we(e.doc,i.anchor,i.head)}}})):Na(o.scroller,"dblclick",function(t){Io(e,t)||Ia(t)}),Or||Na(o.scroller,"contextmenu",function(t){yn(e,t)});var r,a={end:0};Na(o.scroller,"touchstart",function(t){if(!Io(e,t)&&!n(t)){clearTimeout(r);var i=+new Date;o.activeTouch={start:i,moved:!1,prev:i-a.end<=300?a:null},1==t.touches.length&&(o.activeTouch.left=t.touches[0].pageX,o.activeTouch.top=t.touches[0].pageY)}}),Na(o.scroller,"touchmove",function(){o.activeTouch&&(o.activeTouch.moved=!0)}),Na(o.scroller,"touchend",function(n){var r=o.activeTouch;if(r&&!qt(o,n)&&null!=r.left&&!r.moved&&new Date-r.start<300){var a,s=e.coordsChar(o.activeTouch,"page");a=!r.prev||i(r,r.prev)?new ue(s,s):!r.prev.prev||i(r,r.prev.prev)?e.findWordAt(s):new ue(Rr(s.line,0),me(e.doc,Rr(s.line+1,0))),e.setSelection(a.anchor,a.head),e.focus(),Ia(n)}t()}),Na(o.scroller,"touchcancel",t),Na(o.scroller,"scroll",function(){o.scroller.clientHeight&&(on(e,o.scroller.scrollTop),rn(e,o.scroller.scrollLeft,!0),Ma(e,"scroll",e))}),Na(o.scroller,"mousewheel",function(t){an(e,t)}),Na(o.scroller,"DOMMouseScroll",function(t){an(e,t)}),Na(o.wrapper,"scroll",function(){o.wrapper.scrollTop=o.wrapper.scrollLeft=0}),o.dragFunctions={enter:function(t){Io(e,t)||Da(t)},over:function(t){Io(e,t)||(tn(e,t),Da(t))},start:function(t){en(e,t)},drop:Nt(e,Zt),leave:function(t){Io(e,t)||nn(e)}};var s=o.input.getField();Na(s,"keyup",function(t){hn.call(e,t)}),Na(s,"keydown",Nt(e,pn)),Na(s,"keypress",Nt(e,mn)),Na(s,"focus",$o(vn,e)),Na(s,"blur",$o(bn,e))}function Wt(t,n,i){var o=i&&i!=e.Init;if(!n!=!o){var r=t.display.dragFunctions,a=n?Na:Aa;a(t.display.scroller,"dragstart",r.start),a(t.display.scroller,"dragenter",r.enter),a(t.display.scroller,"dragover",r.over),a(t.display.scroller,"dragleave",r.leave),a(t.display.scroller,"drop",r.drop)}}function Ut(e){var t=e.display;t.lastWrapHeight==t.wrapper.clientHeight&&t.lastWrapWidth==t.wrapper.clientWidth||(t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize())}function qt(e,t){for(var n=ko(t);n!=e.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==e.sizer&&n!=e.mover)return!0}function Vt(e,t,n,i){var o=e.display;if(!n&&"true"==ko(t).getAttribute("cm-not-content"))return null;var r,a,s=o.lineSpace.getBoundingClientRect();try{r=t.clientX-s.left,a=t.clientY-s.top}catch(t){return null}var l,c=gt(e,r,a);if(i&&1==c.xRel&&(l=Qi(e.doc,c.line).text).length==c.ch){var d=Ba(l,l.length,e.options.tabSize)-l.length;c=Rr(c.line,Math.max(0,Math.round((r-qe(e.display).left)/yt(e.display))-d))}return c}function Gt(e){var t=this,n=t.display;if(!(Io(t,e)||n.activeTouch&&n.input.supportsTouch())){if(n.shift=e.shiftKey,qt(n,e))return void(xr||(n.scroller.draggable=!1,setTimeout(function(){n.scroller.draggable=!0},100)));if(!Jt(t,e)){var i=Vt(t,e);switch(window.focus(),Co(e)){case 1:t.state.selectingText?t.state.selectingText(e):i?Kt(t,e,i):ko(e)==n.scroller&&Ia(e);break;case 2:xr&&(t.state.lastMiddleDown=+new Date),i&&we(t.doc,i),setTimeout(function(){n.input.focus()},20),Ia(e);break;case 3:Or?yn(t,e):gn(t)}}}}function Kt(e,t,n){yr?setTimeout($o(Y,e),0):e.curOp.focus=Vo();var i,o=+new Date;Wr&&Wr.time>o-400&&0==$r(Wr.pos,n)?i="triple":jr&&jr.time>o-400&&0==$r(jr.pos,n)?(i="double",Wr={time:o,pos:n}):(i="single",jr={time:o,pos:n});var r,a=e.doc.sel,s=Nr?t.metaKey:t.ctrlKey;e.options.dragDrop&&es&&!e.isReadOnly()&&"single"==i&&(r=a.contains(n))>-1&&($r((r=a.ranges[r]).from(),n)<0||n.xRel>0)&&($r(r.to(),n)>0||n.xRel<0)?Xt(e,t,n,s):Yt(e,t,n,i,s)}function Xt(e,t,n,i){var o=e.display,r=+new Date,a=Nt(e,function(s){xr&&(o.scroller.draggable=!1),e.state.draggingText=!1,Aa(document,"mouseup",a),Aa(o.scroller,"drop",a),Math.abs(t.clientX-s.clientX)+Math.abs(t.clientY-s.clientY)<10&&(Ia(s),!i&&+new Date-200<r&&we(e.doc,n),xr||yr&&9==wr?setTimeout(function(){document.body.focus(),o.input.focus()},20):o.input.focus())});xr&&(o.scroller.draggable=!0),e.state.draggingText=a,o.scroller.dragDrop&&o.scroller.dragDrop(),Na(document,"mouseup",a),Na(o.scroller,"drop",a)}function Yt(e,t,n,i,o){function r(t){if(0!=$r(g,t))if(g=t,"rect"==i){for(var o=[],r=e.options.tabSize,a=Ba(Qi(c,n.line).text,n.ch,r),s=Ba(Qi(c,t.line).text,t.ch,r),l=Math.min(a,s),f=Math.max(a,s),h=Math.min(n.line,t.line),m=Math.min(e.lastLine(),Math.max(n.line,t.line));m>=h;h++){var v=Qi(c,h).text,b=za(v,l,r);l==f?o.push(new ue(Rr(h,b),Rr(h,b))):v.length>b&&o.push(new ue(Rr(h,b),Rr(h,za(v,f,r))))}o.length||o.push(new ue(n,n)),Se(c,pe(p.ranges.slice(0,u).concat(o),u),{origin:"*mouse",scroll:!1}),e.scrollIntoView(t)}else{var y=d,w=y.anchor,x=t;if("single"!=i){if("double"==i)var k=e.findWordAt(t);else var k=new ue(Rr(t.line,0),me(c,Rr(t.line+1,0)));$r(k.anchor,w)>0?(x=k.head,w=X(y.from(),k.anchor)):(x=k.anchor,w=K(y.to(),k.head))}var o=p.ranges.slice(0);o[u]=new ue(me(c,w),x),Se(c,pe(o,u),Ra)}}function a(t){var n=++b,o=Vt(e,t,!0,"rect"==i);if(o)if(0!=$r(o,g)){e.curOp.focus=Vo(),r(o);var s=w(l,c);(o.line>=s.to||o.line<s.from)&&setTimeout(Nt(e,function(){b==n&&a(t)}),150)}else{var d=t.clientY<v.top?-20:t.clientY>v.bottom?20:0;d&&setTimeout(Nt(e,function(){b==n&&(l.scroller.scrollTop+=d,a(t))}),50)}}function s(t){e.state.selectingText=!1,b=1/0,Ia(t),l.input.focus(),Aa(document,"mousemove",y),Aa(document,"mouseup",x),c.history.lastSelOrigin=null}var l=e.display,c=e.doc;Ia(t);var d,u,p=c.sel,f=p.ranges;if(o&&!t.shiftKey?(u=c.sel.contains(n),d=u>-1?f[u]:new ue(n,n)):(d=c.sel.primary(),u=c.sel.primIndex),Er?t.shiftKey&&t.metaKey:t.altKey)i="rect",o||(d=new ue(n,n)),n=Vt(e,t,!0,!0),u=-1;else if("double"==i){var h=e.findWordAt(n);d=e.display.shift||c.extend?ye(c,d,h.anchor,h.head):h}else if("triple"==i){var m=new ue(Rr(n.line,0),me(c,Rr(n.line+1,0)));d=e.display.shift||c.extend?ye(c,d,m.anchor,m.head):m}else d=ye(c,d,n);o?-1==u?(u=f.length,Se(c,pe(f.concat([d]),u),{scroll:!1,origin:"*mouse"})):f.length>1&&f[u].empty()&&"single"==i&&!t.shiftKey?(Se(c,pe(f.slice(0,u).concat(f.slice(u+1)),0),{scroll:!1,origin:"*mouse"}),p=c.sel):ke(c,u,d,Ra):(u=0,Se(c,new de([d],0),Ra),p=c.sel);var g=n,v=l.wrapper.getBoundingClientRect(),b=0,y=Nt(e,function(e){Co(e)?a(e):s(e)}),x=Nt(e,s);e.state.selectingText=x,Na(document,"mousemove",y),Na(document,"mouseup",x)}function Qt(e,t,n,i){try{var o=t.clientX,r=t.clientY}catch(t){return!1}if(o>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;i&&Ia(t);var a=e.display,s=a.lineDiv.getBoundingClientRect();if(r>s.bottom||!Do(e,n))return xo(t);r-=s.top-a.viewOffset;for(var l=0;l<e.options.gutters.length;++l){var c=a.gutters.childNodes[l];if(c&&c.getBoundingClientRect().right>=o){var d=no(e.doc,r),u=e.options.gutters[l];return Ma(e,n,e,d,u,t),xo(t)}}}function Jt(e,t){return Qt(e,t,"gutterClick",!0)}function Zt(e){var t=this;if(nn(t),!Io(t,e)&&!qt(t.display,e)){Ia(e),yr&&(Gr=+new Date);var n=Vt(t,e,!0),i=e.dataTransfer.files;if(n&&!t.isReadOnly())if(i&&i.length&&window.FileReader&&window.File)for(var o=i.length,r=Array(o),a=0,s=function(e,i){if(!t.options.allowDropFileTypes||-1!=Po(t.options.allowDropFileTypes,e.type)){var s=new FileReader;s.onload=Nt(t,function(){var e=s.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(e)&&(e=""),r[i]=e,++a==o){n=me(t.doc,n);var l={from:n,to:n,text:t.doc.splitLines(r.join(t.doc.lineSeparator())),origin:"paste"};Sn(t.doc,l),_e(t.doc,fe(n,Zr(l)))}}),s.readAsText(e)}},l=0;o>l;++l)s(i[l],l);else{if(t.state.draggingText&&t.doc.sel.contains(n)>-1)return t.state.draggingText(e),void setTimeout(function(){t.display.input.focus()},20);try{var r=e.dataTransfer.getData("Text");if(r){if(t.state.draggingText&&!(Nr?e.altKey:e.ctrlKey))var c=t.listSelections();if(Ie(t.doc,fe(n,n)),c)for(var l=0;l<c.length;++l)An(t.doc,"",c[l].anchor,c[l].head,"drag");t.replaceSelection(r,"around","paste"),t.display.input.focus()}}catch(e){}}}}function en(e,t){if(yr&&(!e.state.draggingText||+new Date-Gr<100))return void Da(t);if(!Io(e,t)&&!qt(e.display,t)&&(t.dataTransfer.setData("Text",e.getSelection()),t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setDragImage&&!_r)){var n=Wo("img",null,null,"position: fixed; left: 0; top: 0;");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",Tr&&(n.width=n.height=1,e.display.wrapper.appendChild(n),n._top=n.offsetTop),t.dataTransfer.setDragImage(n,0,0),Tr&&n.parentNode.removeChild(n)}}function tn(e,t){var n=Vt(e,t);if(n){var i=document.createDocumentFragment();Fe(e,n,i),e.display.dragCursor||(e.display.dragCursor=Wo("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),e.display.lineSpace.insertBefore(e.display.dragCursor,e.display.cursorDiv)),qo(e.display.dragCursor,i)}}function nn(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function on(e,t){Math.abs(e.doc.scrollTop-t)<2||(e.doc.scrollTop=t,gr||D(e,{top:t}),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t),e.display.scrollbars.setScrollTop(t),gr&&D(e),$e(e,100))}function rn(e,t,n){(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)||(t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,x(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t));
}function an(e,t){var n=Yr(t),i=n.x,o=n.y,r=e.display,a=r.scroller,s=a.scrollWidth>a.clientWidth,l=a.scrollHeight>a.clientHeight;if(i&&s||o&&l){if(o&&Nr&&xr)e:for(var c=t.target,d=r.view;c!=a;c=c.parentNode)for(var u=0;u<d.length;u++)if(d[u].node==c){e.display.currentWheelTarget=c;break e}if(i&&!gr&&!Tr&&null!=Xr)return o&&l&&on(e,Math.max(0,Math.min(a.scrollTop+o*Xr,a.scrollHeight-a.clientHeight))),rn(e,Math.max(0,Math.min(a.scrollLeft+i*Xr,a.scrollWidth-a.clientWidth))),(!o||o&&l)&&Ia(t),void(r.wheelStartX=null);if(o&&null!=Xr){var p=o*Xr,f=e.doc.scrollTop,h=f+r.wrapper.clientHeight;0>p?f=Math.max(0,f+p-50):h=Math.min(e.doc.height,h+p+50),D(e,{top:f,bottom:h})}20>Kr&&(null==r.wheelStartX?(r.wheelStartX=a.scrollLeft,r.wheelStartY=a.scrollTop,r.wheelDX=i,r.wheelDY=o,setTimeout(function(){if(null!=r.wheelStartX){var e=a.scrollLeft-r.wheelStartX,t=a.scrollTop-r.wheelStartY,n=t&&r.wheelDY&&t/r.wheelDY||e&&r.wheelDX&&e/r.wheelDX;r.wheelStartX=r.wheelStartY=null,n&&(Xr=(Xr*Kr+n)/(Kr+1),++Kr)}},200)):(r.wheelDX+=i,r.wheelDY+=o))}}function sn(e,t,n){if("string"==typeof t&&(t=da[t],!t))return!1;e.display.input.ensurePolled();var i=e.display.shift,o=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),n&&(e.display.shift=!1),o=t(e)!=Fa}finally{e.display.shift=i,e.state.suppressEdits=!1}return o}function ln(e,t,n){for(var i=0;i<e.state.keyMaps.length;i++){var o=pa(t,e.state.keyMaps[i],n,e);if(o)return o}return e.options.extraKeys&&pa(t,e.options.extraKeys,n,e)||pa(t,e.options.keyMap,n,e)}function cn(e,t,n,i){var o=e.state.keySeq;if(o){if(fa(t))return"handled";Qr.set(50,function(){e.state.keySeq==o&&(e.state.keySeq=null,e.display.input.reset())}),t=o+" "+t}var r=ln(e,t,i);return"multi"==r&&(e.state.keySeq=t),"handled"==r&&_o(e,"keyHandled",e,t,n),"handled"!=r&&"multi"!=r||(Ia(n),Re(e)),o&&!r&&/\'$/.test(t)?(Ia(n),!0):!!r}function dn(e,t){var n=ha(t,!0);return n?t.shiftKey&&!e.state.keySeq?cn(e,"Shift-"+n,t,function(t){return sn(e,t,!0)})||cn(e,n,t,function(t){return("string"==typeof t?/^go[A-Z]/.test(t):t.motion)?sn(e,t):void 0}):cn(e,n,t,function(t){return sn(e,t)}):!1}function un(e,t,n){return cn(e,"'"+n+"'",t,function(t){return sn(e,t,!0)})}function pn(e){var t=this;if(t.curOp.focus=Vo(),!Io(t,e)){yr&&11>wr&&27==e.keyCode&&(e.returnValue=!1);var n=e.keyCode;t.display.shift=16==n||e.shiftKey;var i=dn(t,e);Tr&&(Jr=i?n:null,!i&&88==n&&!is&&(Nr?e.metaKey:e.ctrlKey)&&t.replaceSelection("",null,"cut")),18!=n||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||fn(t)}}function fn(e){function t(e){18!=e.keyCode&&e.altKey||(Qa(n,"CodeMirror-crosshair"),Aa(document,"keyup",t),Aa(document,"mouseover",t))}var n=e.display.lineDiv;Ja(n,"CodeMirror-crosshair"),Na(document,"keyup",t),Na(document,"mouseover",t)}function hn(e){16==e.keyCode&&(this.doc.sel.shift=!1),Io(this,e)}function mn(e){var t=this;if(!(qt(t.display,e)||Io(t,e)||e.ctrlKey&&!e.altKey||Nr&&e.metaKey)){var n=e.keyCode,i=e.charCode;if(Tr&&n==Jr)return Jr=null,void Ia(e);if(!Tr||e.which&&!(e.which<10)||!dn(t,e)){var o=String.fromCharCode(null==i?n:i);un(t,e,o)||t.display.input.onKeyPress(e)}}}function gn(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,bn(e))},100)}function vn(e){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(Ma(e,"focus",e),e.state.focused=!0,Ja(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),xr&&setTimeout(function(){e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),Re(e))}function bn(e){e.state.delayingBlurEvent||(e.state.focused&&(Ma(e,"blur",e),e.state.focused=!1,Qa(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function yn(e,t){qt(e.display,t)||wn(e,t)||Io(e,t,"contextmenu")||e.display.input.onContextMenu(t)}function wn(e,t){return Do(e,"gutterContextMenu")?Qt(e,t,"gutterContextMenu",!1):!1}function xn(e,t){if($r(e,t.from)<0)return e;if($r(e,t.to)<=0)return Zr(t);var n=e.line+t.text.length-(t.to.line-t.from.line)-1,i=e.ch;return e.line==t.to.line&&(i+=Zr(t).ch-t.to.ch),Rr(n,i)}function kn(e,t){for(var n=[],i=0;i<e.sel.ranges.length;i++){var o=e.sel.ranges[i];n.push(new ue(xn(o.anchor,t),xn(o.head,t)))}return pe(n,e.sel.primIndex)}function Cn(e,t,n){return e.line==t.line?Rr(n.line,e.ch-t.ch+n.ch):Rr(n.line+(e.line-t.line),e.ch)}function Tn(e,t,n){for(var i=[],o=Rr(e.first,0),r=o,a=0;a<t.length;a++){var s=t[a],l=Cn(s.from,o,r),c=Cn(Zr(s),o,r);if(o=s.to,r=c,"around"==n){var d=e.sel.ranges[a],u=$r(d.head,d.anchor)<0;i[a]=new ue(u?c:l,u?l:c)}else i[a]=new ue(l,l)}return new de(i,e.sel.primIndex)}function _n(e,t,n){var i={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){this.canceled=!0}};return n&&(i.update=function(t,n,i,o){t&&(this.from=me(e,t)),n&&(this.to=me(e,n)),i&&(this.text=i),void 0!==o&&(this.origin=o)}),Ma(e,"beforeChange",e,i),e.cm&&Ma(e.cm,"beforeChange",e.cm,i),i.canceled?null:{from:i.from,to:i.to,text:i.text,origin:i.origin}}function Sn(e,t,n){if(e.cm){if(!e.cm.curOp)return Nt(e.cm,Sn)(e,t,n);if(e.cm.state.suppressEdits)return}if(!(Do(e,"beforeChange")||e.cm&&Do(e.cm,"beforeChange"))||(t=_n(e,t,!0))){var i=Fr&&!n&&li(e,t.from,t.to);if(i)for(var o=i.length-1;o>=0;--o)In(e,{from:i[o].from,to:i[o].to,text:o?[""]:t.text});else In(e,t)}}function In(e,t){if(1!=t.text.length||""!=t.text[0]||0!=$r(t.from,t.to)){var n=kn(e,t);co(e,t,n,e.cm?e.cm.curOp.id:NaN),Nn(e,t,n,ri(e,t));var i=[];Xi(e,function(e,n){n||-1!=Po(i,e.history)||(wo(e.history,t),i.push(e.history)),Nn(e,t,null,ri(e,t))})}}function Ln(e,t,n){if(!e.cm||!e.cm.state.suppressEdits){for(var i,o=e.history,r=e.sel,a="undo"==t?o.done:o.undone,s="undo"==t?o.undone:o.done,l=0;l<a.length&&(i=a[l],n?!i.ranges||i.equals(e.sel):i.ranges);l++);if(l!=a.length){for(o.lastOrigin=o.lastSelOrigin=null;i=a.pop(),i.ranges;){if(fo(i,s),n&&!i.equals(e.sel))return void Se(e,i,{clearRedo:!1});r=i}var c=[];fo(r,s),s.push({changes:c,generation:o.generation}),o.generation=i.generation||++o.maxGeneration;for(var d=Do(e,"beforeChange")||e.cm&&Do(e.cm,"beforeChange"),l=i.changes.length-1;l>=0;--l){var u=i.changes[l];if(u.origin=t,d&&!_n(e,u,!1))return void(a.length=0);c.push(ao(e,u));var p=l?kn(e,u):Mo(a);Nn(e,u,p,si(e,u)),!l&&e.cm&&e.cm.scrollIntoView({from:u.from,to:Zr(u)});var f=[];Xi(e,function(e,t){t||-1!=Po(f,e.history)||(wo(e.history,u),f.push(e.history)),Nn(e,u,null,si(e,u))})}}}}function Dn(e,t){if(0!=t&&(e.first+=t,e.sel=new de(Oo(e.sel.ranges,function(e){return new ue(Rr(e.anchor.line+t,e.anchor.ch),Rr(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){Ot(e.cm,e.first,e.first-t,t);for(var n=e.cm.display,i=n.viewFrom;i<n.viewTo;i++)Ft(e.cm,i,"gutter")}}function Nn(e,t,n,i){if(e.cm&&!e.cm.curOp)return Nt(e.cm,Nn)(e,t,n,i);if(t.to.line<e.first)return void Dn(e,t.text.length-1-(t.to.line-t.from.line));if(!(t.from.line>e.lastLine())){if(t.from.line<e.first){var o=t.text.length-1-(e.first-t.from.line);Dn(e,o),t={from:Rr(e.first,0),to:Rr(t.to.line+o,t.to.ch),text:[Mo(t.text)],origin:t.origin}}var r=e.lastLine();t.to.line>r&&(t={from:t.from,to:Rr(r,Qi(e,r).text.length),text:[t.text[0]],origin:t.origin}),t.removed=Ji(e,t.from,t.to),n||(n=kn(e,t)),e.cm?En(e.cm,t,i):Vi(e,t,i),Ie(e,n,Ha)}}function En(e,t,n){var i=e.doc,o=e.display,a=t.from,s=t.to,l=!1,c=a.line;e.options.lineWrapping||(c=to(bi(Qi(i,a.line))),i.iter(c,s.line+1,function(e){return e==o.maxLine?(l=!0,!0):void 0})),i.sel.contains(t.from,t.to)>-1&&Lo(e),Vi(i,t,n,r(e)),e.options.lineWrapping||(i.iter(c,a.line+t.text.length,function(e){var t=u(e);t>o.maxLineLength&&(o.maxLine=e,o.maxLineLength=t,o.maxLineChanged=!0,l=!1)}),l&&(e.curOp.updateMaxLine=!0)),i.frontier=Math.min(i.frontier,a.line),$e(e,400);var d=t.text.length-(s.line-a.line)-1;t.full?Ot(e):a.line!=s.line||1!=t.text.length||qi(e.doc,t)?Ot(e,a.line,s.line+1,d):Ft(e,a.line,"text");var p=Do(e,"changes"),f=Do(e,"change");if(f||p){var h={from:a,to:s,text:t.text,removed:t.removed,origin:t.origin};f&&_o(e,"change",e,h),p&&(e.curOp.changeObjs||(e.curOp.changeObjs=[])).push(h)}e.display.selForContextMenu=null}function An(e,t,n,i,o){if(i||(i=n),$r(i,n)<0){var r=i;i=n,n=r}"string"==typeof t&&(t=e.splitLines(t)),Sn(e,{from:n,to:i,text:t,origin:o})}function Mn(e,t){if(!Io(e,"scrollCursorIntoView")){var n=e.display,i=n.sizer.getBoundingClientRect(),o=null;if(t.top+i.top<0?o=!0:t.bottom+i.top>(window.innerHeight||document.documentElement.clientHeight)&&(o=!1),null!=o&&!Ir){var r=Wo("div","​",null,"position: absolute; top: "+(t.top-n.viewOffset-We(e.display))+"px; height: "+(t.bottom-t.top+Ve(e)+n.barHeight)+"px; left: "+t.left+"px; width: 2px;");e.display.lineSpace.appendChild(r),r.scrollIntoView(o),e.display.lineSpace.removeChild(r)}}}function Pn(e,t,n,i){null==i&&(i=0);for(var o=0;5>o;o++){var r=!1,a=ft(e,t),s=n&&n!=t?ft(e,n):a,l=Fn(e,Math.min(a.left,s.left),Math.min(a.top,s.top)-i,Math.max(a.left,s.left),Math.max(a.bottom,s.bottom)+i),c=e.doc.scrollTop,d=e.doc.scrollLeft;if(null!=l.scrollTop&&(on(e,l.scrollTop),Math.abs(e.doc.scrollTop-c)>1&&(r=!0)),null!=l.scrollLeft&&(rn(e,l.scrollLeft),Math.abs(e.doc.scrollLeft-d)>1&&(r=!0)),!r)break}return a}function On(e,t,n,i,o){var r=Fn(e,t,n,i,o);null!=r.scrollTop&&on(e,r.scrollTop),null!=r.scrollLeft&&rn(e,r.scrollLeft)}function Fn(e,t,n,i,o){var r=e.display,a=bt(e.display);0>n&&(n=0);var s=e.curOp&&null!=e.curOp.scrollTop?e.curOp.scrollTop:r.scroller.scrollTop,l=Ke(e),c={};o-n>l&&(o=n+l);var d=e.doc.height+Ue(r),u=a>n,p=o>d-a;if(s>n)c.scrollTop=u?0:n;else if(o>s+l){var f=Math.min(n,(p?d:o)-l);f!=s&&(c.scrollTop=f)}var h=e.curOp&&null!=e.curOp.scrollLeft?e.curOp.scrollLeft:r.scroller.scrollLeft,m=Ge(e)-(e.options.fixedGutter?r.gutters.offsetWidth:0),g=i-t>m;return g&&(i=t+m),10>t?c.scrollLeft=0:h>t?c.scrollLeft=Math.max(0,t-(g?0:10)):i>m+h-3&&(c.scrollLeft=i+(g?0:10)-m),c}function Hn(e,t,n){null==t&&null==n||$n(e),null!=t&&(e.curOp.scrollLeft=(null==e.curOp.scrollLeft?e.doc.scrollLeft:e.curOp.scrollLeft)+t),null!=n&&(e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc.scrollTop:e.curOp.scrollTop)+n)}function Rn(e){$n(e);var t=e.getCursor(),n=t,i=t;e.options.lineWrapping||(n=t.ch?Rr(t.line,t.ch-1):t,i=Rr(t.line,t.ch+1)),e.curOp.scrollToPos={from:n,to:i,margin:e.options.cursorScrollMargin,isCursor:!0}}function $n(e){var t=e.curOp.scrollToPos;if(t){e.curOp.scrollToPos=null;var n=ht(e,t.from),i=ht(e,t.to),o=Fn(e,Math.min(n.left,i.left),Math.min(n.top,i.top)-t.margin,Math.max(n.right,i.right),Math.max(n.bottom,i.bottom)+t.margin);e.scrollTo(o.scrollLeft,o.scrollTop)}}function Bn(e,t,n,i){var o,r=e.doc;null==n&&(n="add"),"smart"==n&&(r.mode.indent?o=je(e,t):n="prev");var a=e.options.tabSize,s=Qi(r,t),l=Ba(s.text,null,a);s.stateAfter&&(s.stateAfter=null);var c,d=s.text.match(/^\s*/)[0];if(i||/\S/.test(s.text)){if("smart"==n&&(c=r.mode.indent(o,s.text.slice(d.length),s.text),c==Fa||c>150)){if(!i)return;n="prev"}}else c=0,n="not";"prev"==n?c=t>r.first?Ba(Qi(r,t-1).text,null,a):0:"add"==n?c=l+e.options.indentUnit:"subtract"==n?c=l-e.options.indentUnit:"number"==typeof n&&(c=l+n),c=Math.max(0,c);var u="",p=0;if(e.options.indentWithTabs)for(var f=Math.floor(c/a);f;--f)p+=a,u+="	";if(c>p&&(u+=Ao(c-p)),u!=d)return An(r,u,Rr(t,0),Rr(t,d.length),"+input"),s.stateAfter=null,!0;for(var f=0;f<r.sel.ranges.length;f++){var h=r.sel.ranges[f];if(h.head.line==t&&h.head.ch<d.length){var p=Rr(t,d.length);ke(r,f,new ue(p,p));break}}}function zn(e,t,n,i){var o=t,r=t;return"number"==typeof t?r=Qi(e,he(e,t)):o=to(t),null==o?null:(i(r,o)&&e.cm&&Ft(e.cm,o,n),r)}function jn(e,t){for(var n=e.doc.sel.ranges,i=[],o=0;o<n.length;o++){for(var r=t(n[o]);i.length&&$r(r.from,Mo(i).to)<=0;){var a=i.pop();if($r(a.from,r.from)<0){r.from=a.from;break}}i.push(r)}Dt(e,function(){for(var t=i.length-1;t>=0;t--)An(e.doc,"",i[t].from,i[t].to,"+delete");Rn(e)})}function Wn(e,t,n,i,o){function r(){var t=s+n;return t<e.first||t>=e.first+e.size?!1:(s=t,d=Qi(e,t))}function a(e){var t=(o?pr:fr)(d,l,n,!0);if(null==t){if(e||!r())return!1;l=o?(0>n?rr:or)(d):0>n?d.text.length:0}else l=t;return!0}var s=t.line,l=t.ch,c=n,d=Qi(e,s);if("char"==i)a();else if("column"==i)a(!0);else if("word"==i||"group"==i)for(var u=null,p="group"==i,f=e.cm&&e.cm.getHelper(t,"wordChars"),h=!0;!(0>n)||a(!h);h=!1){var m=d.text.charAt(l)||"\n",g=Bo(m,f)?"w":p&&"\n"==m?"n":!p||/\s/.test(m)?null:"p";if(!p||h||g||(g="s"),u&&u!=g){0>n&&(n=1,a());break}if(g&&(u=g),n>0&&!a(!h))break}var v=Ae(e,Rr(s,l),t,c,!0);return $r(t,v)||(v.hitSide=!0),v}function Un(e,t,n,i){var o,r=e.doc,a=t.left;if("page"==i){var s=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);o=t.top+n*(s-(0>n?1.5:.5)*bt(e.display))}else"line"==i&&(o=n>0?t.bottom+3:t.top-3);for(;;){var l=gt(e,a,o);if(!l.outside)break;if(0>n?0>=o:o>=r.height){l.hitSide=!0;break}o+=5*n}return l}function qn(t,n,i,o){e.defaults[t]=n,i&&(ta[t]=o?function(e,t,n){n!=na&&i(e,t,n)}:i)}function Vn(e){for(var t,n,i,o,r=e.split(/-(?!$)/),e=r[r.length-1],a=0;a<r.length-1;a++){var s=r[a];if(/^(cmd|meta|m)$/i.test(s))o=!0;else if(/^a(lt)?$/i.test(s))t=!0;else if(/^(c|ctrl|control)$/i.test(s))n=!0;else{if(!/^s(hift)$/i.test(s))throw new Error("Unrecognized modifier name: "+s);i=!0}}return t&&(e="Alt-"+e),n&&(e="Ctrl-"+e),o&&(e="Cmd-"+e),i&&(e="Shift-"+e),e}function Gn(e){return"string"==typeof e?ua[e]:e}function Kn(e,t,n,i,o){if(i&&i.shared)return Xn(e,t,n,i,o);if(e.cm&&!e.cm.curOp)return Nt(e.cm,Kn)(e,t,n,i,o);var r=new va(e,o),a=$r(t,n);if(i&&Ro(i,r,!1),a>0||0==a&&r.clearWhenEmpty!==!1)return r;if(r.replacedWith&&(r.collapsed=!0,r.widgetNode=Wo("span",[r.replacedWith],"CodeMirror-widget"),i.handleMouseEvents||r.widgetNode.setAttribute("cm-ignore-events","true"),i.insertLeft&&(r.widgetNode.insertLeft=!0)),r.collapsed){if(vi(e,t.line,t,n,r)||t.line!=n.line&&vi(e,n.line,t,n,r))throw new Error("Inserting collapsed marker partially overlapping an existing one");Hr=!0}r.addToHistory&&co(e,{from:t,to:n,origin:"markText"},e.sel,NaN);var s,l=t.line,c=e.cm;if(e.iter(l,n.line+1,function(e){c&&r.collapsed&&!c.options.lineWrapping&&bi(e)==c.display.maxLine&&(s=!0),r.collapsed&&l!=t.line&&eo(e,0),ni(e,new Zn(r,l==t.line?t.ch:null,l==n.line?n.ch:null)),++l}),r.collapsed&&e.iter(t.line,n.line+1,function(t){ki(e,t)&&eo(t,0)}),r.clearOnEnter&&Na(r,"beforeCursorEnter",function(){r.clear()}),r.readOnly&&(Fr=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory()),r.collapsed&&(r.id=++ga,r.atomic=!0),c){if(s&&(c.curOp.updateMaxLine=!0),r.collapsed)Ot(c,t.line,n.line+1);else if(r.className||r.title||r.startStyle||r.endStyle||r.css)for(var d=t.line;d<=n.line;d++)Ft(c,d,"text");r.atomic&&De(c.doc),_o(c,"markerAdded",c,r)}return r}function Xn(e,t,n,i,o){i=Ro(i),i.shared=!1;var r=[Kn(e,t,n,i,o)],a=r[0],s=i.widgetNode;return Xi(e,function(e){s&&(i.widgetNode=s.cloneNode(!0)),r.push(Kn(e,me(e,t),me(e,n),i,o));for(var l=0;l<e.linked.length;++l)if(e.linked[l].isParent)return;a=Mo(r)}),new ba(r,a)}function Yn(e){return e.findMarks(Rr(e.first,0),e.clipPos(Rr(e.lastLine())),function(e){return e.parent})}function Qn(e,t){for(var n=0;n<t.length;n++){var i=t[n],o=i.find(),r=e.clipPos(o.from),a=e.clipPos(o.to);if($r(r,a)){var s=Kn(e,r,a,i.primary,i.primary.type);i.markers.push(s),s.parent=i}}}function Jn(e){for(var t=0;t<e.length;t++){var n=e[t],i=[n.primary.doc];Xi(n.primary.doc,function(e){i.push(e)});for(var o=0;o<n.markers.length;o++){var r=n.markers[o];-1==Po(i,r.doc)&&(r.parent=null,n.markers.splice(o--,1))}}}function Zn(e,t,n){this.marker=e,this.from=t,this.to=n}function ei(e,t){if(e)for(var n=0;n<e.length;++n){var i=e[n];if(i.marker==t)return i}}function ti(e,t){for(var n,i=0;i<e.length;++i)e[i]!=t&&(n||(n=[])).push(e[i]);return n}function ni(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}function ii(e,t,n){if(e)for(var i,o=0;o<e.length;++o){var r=e[o],a=r.marker,s=null==r.from||(a.inclusiveLeft?r.from<=t:r.from<t);if(s||r.from==t&&"bookmark"==a.type&&(!n||!r.marker.insertLeft)){var l=null==r.to||(a.inclusiveRight?r.to>=t:r.to>t);(i||(i=[])).push(new Zn(a,r.from,l?null:r.to))}}return i}function oi(e,t,n){if(e)for(var i,o=0;o<e.length;++o){var r=e[o],a=r.marker,s=null==r.to||(a.inclusiveRight?r.to>=t:r.to>t);if(s||r.from==t&&"bookmark"==a.type&&(!n||r.marker.insertLeft)){var l=null==r.from||(a.inclusiveLeft?r.from<=t:r.from<t);(i||(i=[])).push(new Zn(a,l?null:r.from-t,null==r.to?null:r.to-t))}}return i}function ri(e,t){if(t.full)return null;var n=ve(e,t.from.line)&&Qi(e,t.from.line).markedSpans,i=ve(e,t.to.line)&&Qi(e,t.to.line).markedSpans;if(!n&&!i)return null;var o=t.from.ch,r=t.to.ch,a=0==$r(t.from,t.to),s=ii(n,o,a),l=oi(i,r,a),c=1==t.text.length,d=Mo(t.text).length+(c?o:0);if(s)for(var u=0;u<s.length;++u){var p=s[u];if(null==p.to){var f=ei(l,p.marker);f?c&&(p.to=null==f.to?null:f.to+d):p.to=o}}if(l)for(var u=0;u<l.length;++u){var p=l[u];if(null!=p.to&&(p.to+=d),null==p.from){var f=ei(s,p.marker);f||(p.from=d,c&&(s||(s=[])).push(p))}else p.from+=d,c&&(s||(s=[])).push(p)}s&&(s=ai(s)),l&&l!=s&&(l=ai(l));var h=[s];if(!c){var m,g=t.text.length-2;if(g>0&&s)for(var u=0;u<s.length;++u)null==s[u].to&&(m||(m=[])).push(new Zn(s[u].marker,null,null));for(var u=0;g>u;++u)h.push(m);h.push(l)}return h}function ai(e){for(var t=0;t<e.length;++t){var n=e[t];null!=n.from&&n.from==n.to&&n.marker.clearWhenEmpty!==!1&&e.splice(t--,1)}return e.length?e:null}function si(e,t){var n=go(e,t),i=ri(e,t);if(!n)return i;if(!i)return n;for(var o=0;o<n.length;++o){var r=n[o],a=i[o];if(r&&a)e:for(var s=0;s<a.length;++s){for(var l=a[s],c=0;c<r.length;++c)if(r[c].marker==l.marker)continue e;r.push(l)}else a&&(n[o]=a)}return n}function li(e,t,n){var i=null;if(e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;!n.readOnly||i&&-1!=Po(i,n)||(i||(i=[])).push(n)}}),!i)return null;for(var o=[{from:t,to:n}],r=0;r<i.length;++r)for(var a=i[r],s=a.find(0),l=0;l<o.length;++l){var c=o[l];if(!($r(c.to,s.from)<0||$r(c.from,s.to)>0)){var d=[l,1],u=$r(c.from,s.from),p=$r(c.to,s.to);(0>u||!a.inclusiveLeft&&!u)&&d.push({from:c.from,to:s.from}),(p>0||!a.inclusiveRight&&!p)&&d.push({from:s.to,to:c.to}),o.splice.apply(o,d),l+=d.length-1}}return o}function ci(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}}function di(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}}function ui(e){return e.inclusiveLeft?-1:0}function pi(e){return e.inclusiveRight?1:0}function fi(e,t){var n=e.lines.length-t.lines.length;if(0!=n)return n;var i=e.find(),o=t.find(),r=$r(i.from,o.from)||ui(e)-ui(t);if(r)return-r;var a=$r(i.to,o.to)||pi(e)-pi(t);return a?a:t.id-e.id}function hi(e,t){var n,i=Hr&&e.markedSpans;if(i)for(var o,r=0;r<i.length;++r)o=i[r],o.marker.collapsed&&null==(t?o.from:o.to)&&(!n||fi(n,o.marker)<0)&&(n=o.marker);return n}function mi(e){return hi(e,!0)}function gi(e){return hi(e,!1)}function vi(e,t,n,i,o){var r=Qi(e,t),a=Hr&&r.markedSpans;if(a)for(var s=0;s<a.length;++s){var l=a[s];if(l.marker.collapsed){var c=l.marker.find(0),d=$r(c.from,n)||ui(l.marker)-ui(o),u=$r(c.to,i)||pi(l.marker)-pi(o);if(!(d>=0&&0>=u||0>=d&&u>=0)&&(0>=d&&($r(c.to,n)>0||l.marker.inclusiveRight&&o.inclusiveLeft)||d>=0&&($r(c.from,i)<0||l.marker.inclusiveLeft&&o.inclusiveRight)))return!0}}}function bi(e){for(var t;t=mi(e);)e=t.find(-1,!0).line;return e}function yi(e){for(var t,n;t=gi(e);)e=t.find(1,!0).line,(n||(n=[])).push(e);return n}function wi(e,t){var n=Qi(e,t),i=bi(n);return n==i?t:to(i)}function xi(e,t){if(t>e.lastLine())return t;var n,i=Qi(e,t);if(!ki(e,i))return t;for(;n=gi(i);)i=n.find(1,!0).line;return to(i)+1}function ki(e,t){var n=Hr&&t.markedSpans;if(n)for(var i,o=0;o<n.length;++o)if(i=n[o],i.marker.collapsed){if(null==i.from)return!0;if(!i.marker.widgetNode&&0==i.from&&i.marker.inclusiveLeft&&Ci(e,t,i))return!0}}function Ci(e,t,n){if(null==n.to){var i=n.marker.find(1,!0);return Ci(e,i.line,ei(i.line.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==t.text.length)return!0;for(var o,r=0;r<t.markedSpans.length;++r)if(o=t.markedSpans[r],o.marker.collapsed&&!o.marker.widgetNode&&o.from==n.to&&(null==o.to||o.to!=n.from)&&(o.marker.inclusiveLeft||n.marker.inclusiveRight)&&Ci(e,t,o))return!0}function Ti(e,t,n){io(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&Hn(e,null,n)}function _i(e){if(null!=e.height)return e.height;var t=e.doc.cm;if(!t)return 0;if(!Ka(document.body,e.node)){var n="position: relative;";e.coverGutter&&(n+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(n+="width: "+t.display.wrapper.clientWidth+"px;"),qo(t.display.measure,Wo("div",[e.node],null,n))}return e.height=e.node.parentNode.offsetHeight}function Si(e,t,n,i){var o=new ya(e,n,i),r=e.cm;return r&&o.noHScroll&&(r.display.alignWidgets=!0),zn(e,t,"widget",function(t){var n=t.widgets||(t.widgets=[]);if(null==o.insertAt?n.push(o):n.splice(Math.min(n.length-1,Math.max(0,o.insertAt)),0,o),o.line=t,r&&!ki(e,t)){var i=io(t)<e.scrollTop;eo(t,t.height+_i(o)),i&&Hn(r,null,o.height),r.curOp.forceUpdate=!0}return!0}),o}function Ii(e,t,n,i){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),null!=e.order&&(e.order=null),ci(e),di(e,n);var o=i?i(e):1;o!=e.height&&eo(e,o)}function Li(e){e.parent=null,ci(e)}function Di(e,t){if(e)for(;;){var n=e.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;e=e.slice(0,n.index)+e.slice(n.index+n[0].length);var i=n[1]?"bgClass":"textClass";null==t[i]?t[i]=n[2]:new RegExp("(?:^|s)"+n[2]+"(?:$|s)").test(t[i])||(t[i]+=" "+n[2])}return e}function Ni(t,n){if(t.blankLine)return t.blankLine(n);if(t.innerMode){var i=e.innerMode(t,n);return i.mode.blankLine?i.mode.blankLine(i.state):void 0}}function Ei(t,n,i,o){for(var r=0;10>r;r++){o&&(o[0]=e.innerMode(t,i).mode);var a=t.token(n,i);if(n.pos>n.start)return a}throw new Error("Mode "+t.name+" failed to advance stream.")}function Ai(e,t,n,i){function o(e){return{start:u.start,end:u.pos,string:u.current(),type:r||null,state:e?la(a.mode,d):d}}var r,a=e.doc,s=a.mode;t=me(a,t);var l,c=Qi(a,t.line),d=je(e,t.line,n),u=new ma(c.text,e.options.tabSize);for(i&&(l=[]);(i||u.pos<t.ch)&&!u.eol();)u.start=u.pos,r=Ei(s,u,d),i&&l.push(o(!0));return i?l:o()}function Mi(e,t,n,i,o,r,a){var s=n.flattenSpans;null==s&&(s=e.options.flattenSpans);var l,c=0,d=null,u=new ma(t,e.options.tabSize),p=e.options.addModeClass&&[null];for(""==t&&Di(Ni(n,i),r);!u.eol();){if(u.pos>e.options.maxHighlightLength?(s=!1,a&&Fi(e,t,i,u.pos),u.pos=t.length,l=null):l=Di(Ei(n,u,i,p),r),p){var f=p[0].name;f&&(l="m-"+(l?f+" "+l:f))}if(!s||d!=l){for(;c<u.start;)c=Math.min(u.start,c+5e4),o(c,d);d=l}u.start=u.pos}for(;c<u.pos;){var h=Math.min(u.pos,c+5e4);o(h,d),c=h}}function Pi(e,t,n,i){var o=[e.state.modeGen],r={};Mi(e,t.text,e.doc.mode,n,function(e,t){o.push(e,t)},r,i);for(var a=0;a<e.state.overlays.length;++a){var s=e.state.overlays[a],l=1,c=0;Mi(e,t.text,s.mode,!0,function(e,t){for(var n=l;e>c;){var i=o[l];i>e&&o.splice(l,1,e,o[l+1],i),l+=2,c=Math.min(e,i)}if(t)if(s.opaque)o.splice(n,l-n,e,"cm-overlay "+t),l=n+2;else for(;l>n;n+=2){var r=o[n+1];o[n+1]=(r?r+" ":"")+"cm-overlay "+t}},r)}return{styles:o,classes:r.bgClass||r.textClass?r:null}}function Oi(e,t,n){if(!t.styles||t.styles[0]!=e.state.modeGen){var i=je(e,to(t)),o=Pi(e,t,t.text.length>e.options.maxHighlightLength?la(e.doc.mode,i):i);t.stateAfter=i,t.styles=o.styles,o.classes?t.styleClasses=o.classes:t.styleClasses&&(t.styleClasses=null),n===e.doc.frontier&&e.doc.frontier++}return t.styles}function Fi(e,t,n,i){var o=e.doc.mode,r=new ma(t,e.options.tabSize);for(r.start=r.pos=i||0,""==t&&Ni(o,n);!r.eol();)Ei(o,r,n),r.start=r.pos}function Hi(e,t){if(!e||/^\s*$/.test(e))return null;var n=t.addModeClass?ka:xa;return n[e]||(n[e]=e.replace(/\S+/g,"cm-$&"))}function Ri(e,t){var n=Wo("span",null,null,xr?"padding-right: .1px":null),i={pre:Wo("pre",[n],"CodeMirror-line"),content:n,col:0,pos:0,cm:e,splitSpaces:(yr||xr)&&e.getOption("lineWrapping")};t.measure={};for(var o=0;o<=(t.rest?t.rest.length:0);o++){var r,a=o?t.rest[o-1]:t.line;i.pos=0,i.addToken=Bi,Zo(e.display.measure)&&(r=oo(a))&&(i.addToken=ji(i.addToken,r)),i.map=[];var s=t!=e.display.externalMeasured&&to(a);Ui(a,i,Oi(e,a,s)),a.styleClasses&&(a.styleClasses.bgClass&&(i.bgClass=Ko(a.styleClasses.bgClass,i.bgClass||"")),a.styleClasses.textClass&&(i.textClass=Ko(a.styleClasses.textClass,i.textClass||""))),0==i.map.length&&i.map.push(0,0,i.content.appendChild(Jo(e.display.measure))),0==o?(t.measure.map=i.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(i.map),(t.measure.caches||(t.measure.caches=[])).push({}))}return xr&&/\bcm-tab\b/.test(i.content.lastChild.className)&&(i.content.className="cm-tab-wrap-hack"),Ma(e,"renderLine",e,t.line,i.pre),i.pre.className&&(i.textClass=Ko(i.pre.className,i.textClass||"")),i}function $i(e){var t=Wo("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function Bi(e,t,n,i,o,r,a){if(t){var s=e.splitSpaces?t.replace(/ {3,}/g,zi):t,l=e.cm.state.specialChars,c=!1;if(l.test(t))for(var d=document.createDocumentFragment(),u=0;;){l.lastIndex=u;var p=l.exec(t),f=p?p.index-u:t.length-u;if(f){var h=document.createTextNode(s.slice(u,u+f));yr&&9>wr?d.appendChild(Wo("span",[h])):d.appendChild(h),e.map.push(e.pos,e.pos+f,h),e.col+=f,e.pos+=f}if(!p)break;if(u+=f+1,"	"==p[0]){var m=e.cm.options.tabSize,g=m-e.col%m,h=d.appendChild(Wo("span",Ao(g),"cm-tab"));h.setAttribute("role","presentation"),h.setAttribute("cm-text","	"),e.col+=g}else if("\r"==p[0]||"\n"==p[0]){var h=d.appendChild(Wo("span","\r"==p[0]?"␍":"␤","cm-invalidchar"));h.setAttribute("cm-text",p[0]),e.col+=1}else{var h=e.cm.options.specialCharPlaceholder(p[0]);h.setAttribute("cm-text",p[0]),yr&&9>wr?d.appendChild(Wo("span",[h])):d.appendChild(h),e.col+=1}e.map.push(e.pos,e.pos+1,h),e.pos++}else{e.col+=t.length;var d=document.createTextNode(s);e.map.push(e.pos,e.pos+t.length,d),yr&&9>wr&&(c=!0),e.pos+=t.length}if(n||i||o||c||a){var v=n||"";i&&(v+=i),o&&(v+=o);var b=Wo("span",[d],v,a);return r&&(b.title=r),e.content.appendChild(b)}e.content.appendChild(d)}}function zi(e){for(var t=" ",n=0;n<e.length-2;++n)t+=n%2?" ":" ";return t+=" "}function ji(e,t){return function(n,i,o,r,a,s,l){o=o?o+" cm-force-border":"cm-force-border";for(var c=n.pos,d=c+i.length;;){for(var u=0;u<t.length;u++){var p=t[u];if(p.to>c&&p.from<=c)break}if(p.to>=d)return e(n,i,o,r,a,s,l);e(n,i.slice(0,p.to-c),o,r,null,s,l),r=null,i=i.slice(p.to-c),c=p.to}}}function Wi(e,t,n,i){var o=!i&&n.widgetNode;o&&e.map.push(e.pos,e.pos+t,o),!i&&e.cm.display.input.needsContentAttribute&&(o||(o=e.content.appendChild(document.createElement("span"))),o.setAttribute("cm-marker",n.id)),o&&(e.cm.display.input.setUneditable(o),e.content.appendChild(o)),e.pos+=t}function Ui(e,t,n){var i=e.markedSpans,o=e.text,r=0;if(i)for(var a,s,l,c,d,u,p,f=o.length,h=0,m=1,g="",v=0;;){if(v==h){l=c=d=u=s="",p=null,v=1/0;for(var b,y=[],w=0;w<i.length;++w){var x=i[w],k=x.marker;"bookmark"==k.type&&x.from==h&&k.widgetNode?y.push(k):x.from<=h&&(null==x.to||x.to>h||k.collapsed&&x.to==h&&x.from==h)?(null!=x.to&&x.to!=h&&v>x.to&&(v=x.to,c=""),k.className&&(l+=" "+k.className),k.css&&(s=(s?s+";":"")+k.css),k.startStyle&&x.from==h&&(d+=" "+k.startStyle),k.endStyle&&x.to==v&&(b||(b=[])).push(k.endStyle,x.to),k.title&&!u&&(u=k.title),k.collapsed&&(!p||fi(p.marker,k)<0)&&(p=x)):x.from>h&&v>x.from&&(v=x.from)}if(b)for(var w=0;w<b.length;w+=2)b[w+1]==v&&(c+=" "+b[w]);if(!p||p.from==h)for(var w=0;w<y.length;++w)Wi(t,0,y[w]);if(p&&(p.from||0)==h){if(Wi(t,(null==p.to?f+1:p.to)-h,p.marker,null==p.from),null==p.to)return;p.to==h&&(p=!1)}}if(h>=f)break;for(var C=Math.min(f,v);;){if(g){var T=h+g.length;if(!p){var _=T>C?g.slice(0,C-h):g;t.addToken(t,_,a?a+l:l,d,h+_.length==v?c:"",u,s)}if(T>=C){g=g.slice(C-h),h=C;break}h=T,d=""}g=o.slice(r,r=n[m++]),a=Hi(n[m++],t.cm.options)}}else for(var m=1;m<n.length;m+=2)t.addToken(t,o.slice(r,r=n[m]),Hi(n[m+1],t.cm.options))}function qi(e,t){return 0==t.from.ch&&0==t.to.ch&&""==Mo(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function Vi(e,t,n,i){function o(e){return n?n[e]:null}function r(e,n,o){Ii(e,n,o,i),_o(e,"change",e,t)}function a(e,t){for(var n=e,r=[];t>n;++n)r.push(new wa(c[n],o(n),i));return r}var s=t.from,l=t.to,c=t.text,d=Qi(e,s.line),u=Qi(e,l.line),p=Mo(c),f=o(c.length-1),h=l.line-s.line;if(t.full)e.insert(0,a(0,c.length)),e.remove(c.length,e.size-c.length);else if(qi(e,t)){var m=a(0,c.length-1);r(u,u.text,f),h&&e.remove(s.line,h),m.length&&e.insert(s.line,m)}else if(d==u)if(1==c.length)r(d,d.text.slice(0,s.ch)+p+d.text.slice(l.ch),f);else{var m=a(1,c.length-1);m.push(new wa(p+d.text.slice(l.ch),f,i)),r(d,d.text.slice(0,s.ch)+c[0],o(0)),e.insert(s.line+1,m)}else if(1==c.length)r(d,d.text.slice(0,s.ch)+c[0]+u.text.slice(l.ch),o(0)),e.remove(s.line+1,h);else{r(d,d.text.slice(0,s.ch)+c[0],o(0)),r(u,p+u.text.slice(l.ch),f);var m=a(1,c.length-1);h>1&&e.remove(s.line+1,h-1),e.insert(s.line+1,m)}_o(e,"change",e,t)}function Gi(e){this.lines=e,this.parent=null;for(var t=0,n=0;t<e.length;++t)e[t].parent=this,n+=e[t].height;this.height=n}function Ki(e){this.children=e;for(var t=0,n=0,i=0;i<e.length;++i){var o=e[i];t+=o.chunkSize(),n+=o.height,o.parent=this}this.size=t,this.height=n,this.parent=null}function Xi(e,t,n){function i(e,o,r){if(e.linked)for(var a=0;a<e.linked.length;++a){var s=e.linked[a];if(s.doc!=o){var l=r&&s.sharedHist;n&&!l||(t(s.doc,l),i(s.doc,e,l))}}}i(e,null,!0)}function Yi(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,a(e),n(e),e.options.lineWrapping||p(e),e.options.mode=t.modeOption,Ot(e)}function Qi(e,t){if(t-=e.first,0>t||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(var n=e;!n.lines;)for(var i=0;;++i){var o=n.children[i],r=o.chunkSize();if(r>t){n=o;break}t-=r}return n.lines[t]}function Ji(e,t,n){var i=[],o=t.line;return e.iter(t.line,n.line+1,function(e){var r=e.text;o==n.line&&(r=r.slice(0,n.ch)),o==t.line&&(r=r.slice(t.ch)),i.push(r),++o}),i}function Zi(e,t,n){var i=[];return e.iter(t,n,function(e){i.push(e.text)}),i}function eo(e,t){var n=t-e.height;if(n)for(var i=e;i;i=i.parent)i.height+=n}function to(e){if(null==e.parent)return null;for(var t=e.parent,n=Po(t.lines,e),i=t.parent;i;t=i,i=i.parent)for(var o=0;i.children[o]!=t;++o)n+=i.children[o].chunkSize();return n+t.first}function no(e,t){var n=e.first;e:do{for(var i=0;i<e.children.length;++i){var o=e.children[i],r=o.height;if(r>t){e=o;continue e}t-=r,n+=o.chunkSize()}return n}while(!e.lines);for(var i=0;i<e.lines.length;++i){var a=e.lines[i],s=a.height;if(s>t)break;t-=s}return n+i}function io(e){e=bi(e);for(var t=0,n=e.parent,i=0;i<n.lines.length;++i){var o=n.lines[i];if(o==e)break;t+=o.height}for(var r=n.parent;r;n=r,r=n.parent)for(var i=0;i<r.children.length;++i){var a=r.children[i];if(a==n)break;t+=a.height}return t}function oo(e){var t=e.order;return null==t&&(t=e.order=ss(e.text)),t}function ro(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function ao(e,t){var n={from:G(t.from),to:Zr(t),text:Ji(e,t.from,t.to)};return ho(e,n,t.from.line,t.to.line+1),Xi(e,function(e){ho(e,n,t.from.line,t.to.line+1)},!0),n}function so(e){for(;e.length;){var t=Mo(e);if(!t.ranges)break;e.pop()}}function lo(e,t){return t?(so(e.done),Mo(e.done)):e.done.length&&!Mo(e.done).ranges?Mo(e.done):e.done.length>1&&!e.done[e.done.length-2].ranges?(e.done.pop(),Mo(e.done)):void 0}function co(e,t,n,i){var o=e.history;o.undone.length=0;var r,a=+new Date;if((o.lastOp==i||o.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&e.cm&&o.lastModTime>a-e.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))&&(r=lo(o,o.lastOp==i))){var s=Mo(r.changes);0==$r(t.from,t.to)&&0==$r(t.from,s.to)?s.to=Zr(t):r.changes.push(ao(e,t));
}else{var l=Mo(o.done);for(l&&l.ranges||fo(e.sel,o.done),r={changes:[ao(e,t)],generation:o.generation},o.done.push(r);o.done.length>o.undoDepth;)o.done.shift(),o.done[0].ranges||o.done.shift()}o.done.push(n),o.generation=++o.maxGeneration,o.lastModTime=o.lastSelTime=a,o.lastOp=o.lastSelOp=i,o.lastOrigin=o.lastSelOrigin=t.origin,s||Ma(e,"historyAdded")}function uo(e,t,n,i){var o=t.charAt(0);return"*"==o||"+"==o&&n.ranges.length==i.ranges.length&&n.somethingSelected()==i.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500)}function po(e,t,n,i){var o=e.history,r=i&&i.origin;n==o.lastSelOp||r&&o.lastSelOrigin==r&&(o.lastModTime==o.lastSelTime&&o.lastOrigin==r||uo(e,r,Mo(o.done),t))?o.done[o.done.length-1]=t:fo(t,o.done),o.lastSelTime=+new Date,o.lastSelOrigin=r,o.lastSelOp=n,i&&i.clearRedo!==!1&&so(o.undone)}function fo(e,t){var n=Mo(t);n&&n.ranges&&n.equals(e)||t.push(e)}function ho(e,t,n,i){var o=t["spans_"+e.id],r=0;e.iter(Math.max(e.first,n),Math.min(e.first+e.size,i),function(n){n.markedSpans&&((o||(o=t["spans_"+e.id]={}))[r]=n.markedSpans),++r})}function mo(e){if(!e)return null;for(var t,n=0;n<e.length;++n)e[n].marker.explicitlyCleared?t||(t=e.slice(0,n)):t&&t.push(e[n]);return t?t.length?t:null:e}function go(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var i=0,o=[];i<t.text.length;++i)o.push(mo(n[i]));return o}function vo(e,t,n){for(var i=0,o=[];i<e.length;++i){var r=e[i];if(r.ranges)o.push(n?de.prototype.deepCopy.call(r):r);else{var a=r.changes,s=[];o.push({changes:s});for(var l=0;l<a.length;++l){var c,d=a[l];if(s.push({from:d.from,to:d.to,text:d.text}),t)for(var u in d)(c=u.match(/^spans_(\d+)$/))&&Po(t,Number(c[1]))>-1&&(Mo(s)[u]=d[u],delete d[u])}}}return o}function bo(e,t,n,i){n<e.line?e.line+=i:t<e.line&&(e.line=t,e.ch=0)}function yo(e,t,n,i){for(var o=0;o<e.length;++o){var r=e[o],a=!0;if(r.ranges){r.copied||(r=e[o]=r.deepCopy(),r.copied=!0);for(var s=0;s<r.ranges.length;s++)bo(r.ranges[s].anchor,t,n,i),bo(r.ranges[s].head,t,n,i)}else{for(var s=0;s<r.changes.length;++s){var l=r.changes[s];if(n<l.from.line)l.from=Rr(l.from.line+i,l.from.ch),l.to=Rr(l.to.line+i,l.to.ch);else if(t<=l.to.line){a=!1;break}}a||(e.splice(0,o+1),o=0)}}}function wo(e,t){var n=t.from.line,i=t.to.line,o=t.text.length-(i-n)-1;yo(e.done,n,i,o),yo(e.undone,n,i,o)}function xo(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function ko(e){return e.target||e.srcElement}function Co(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),Nr&&e.ctrlKey&&1==t&&(t=3),t}function To(e,t,n){var i=e._handlers&&e._handlers[t];return n?i&&i.length>0?i.slice():Ea:i||Ea}function _o(e,t){function n(e){return function(){e.apply(null,r)}}var i=To(e,t,!1);if(i.length){var o,r=Array.prototype.slice.call(arguments,2);qr?o=qr.delayedCallbacks:Pa?o=Pa:(o=Pa=[],setTimeout(So,0));for(var a=0;a<i.length;++a)o.push(n(i[a]))}}function So(){var e=Pa;Pa=null;for(var t=0;t<e.length;++t)e[t]()}function Io(e,t,n){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),Ma(e,n||t.type,e,t),xo(t)||t.codemirrorIgnore}function Lo(e){var t=e._handlers&&e._handlers.cursorActivity;if(t)for(var n=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),i=0;i<t.length;++i)-1==Po(n,t[i])&&n.push(t[i])}function Do(e,t){return To(e,t).length>0}function No(e){e.prototype.on=function(e,t){Na(this,e,t)},e.prototype.off=function(e,t){Aa(this,e,t)}}function Eo(){this.id=null}function Ao(e){for(;ja.length<=e;)ja.push(Mo(ja)+" ");return ja[e]}function Mo(e){return e[e.length-1]}function Po(e,t){for(var n=0;n<e.length;++n)if(e[n]==t)return n;return-1}function Oo(e,t){for(var n=[],i=0;i<e.length;i++)n[i]=t(e[i],i);return n}function Fo(){}function Ho(e,t){var n;return Object.create?n=Object.create(e):(Fo.prototype=e,n=new Fo),t&&Ro(t,n),n}function Ro(e,t,n){t||(t={});for(var i in e)!e.hasOwnProperty(i)||n===!1&&t.hasOwnProperty(i)||(t[i]=e[i]);return t}function $o(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function Bo(e,t){return t?t.source.indexOf("\\w")>-1&&Va(e)?!0:t.test(e):Va(e)}function zo(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function jo(e){return e.charCodeAt(0)>=768&&Ga.test(e)}function Wo(e,t,n,i){var o=document.createElement(e);if(n&&(o.className=n),i&&(o.style.cssText=i),"string"==typeof t)o.appendChild(document.createTextNode(t));else if(t)for(var r=0;r<t.length;++r)o.appendChild(t[r]);return o}function Uo(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function qo(e,t){return Uo(e).appendChild(t)}function Vo(){for(var e=document.activeElement;e&&e.root&&e.root.activeElement;)e=e.root.activeElement;return e}function Go(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}function Ko(e,t){for(var n=e.split(" "),i=0;i<n.length;i++)n[i]&&!Go(n[i]).test(t)&&(t+=" "+n[i]);return t}function Xo(e){if(document.body.getElementsByClassName)for(var t=document.body.getElementsByClassName("CodeMirror"),n=0;n<t.length;n++){var i=t[n].CodeMirror;i&&e(i)}}function Yo(){Za||(Qo(),Za=!0)}function Qo(){var e;Na(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,Xo(Ut)},100))}),Na(window,"blur",function(){Xo(bn)})}function Jo(e){if(null==Xa){var t=Wo("span","​");qo(e,Wo("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(Xa=t.offsetWidth<=1&&t.offsetHeight>2&&!(yr&&8>wr))}var n=Xa?Wo("span","​"):Wo("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return n.setAttribute("cm-text",""),n}function Zo(e){if(null!=Ya)return Ya;var t=qo(e,document.createTextNode("AخA")),n=Ua(t,0,1).getBoundingClientRect();if(!n||n.left==n.right)return!1;var i=Ua(t,1,2).getBoundingClientRect();return Ya=i.right-n.right<3}function er(e){if(null!=os)return os;var t=qo(e,Wo("span","x")),n=t.getBoundingClientRect(),i=Ua(t,0,1).getBoundingClientRect();return os=Math.abs(n.left-i.left)>1}function tr(e,t,n,i){if(!e)return i(t,n,"ltr");for(var o=!1,r=0;r<e.length;++r){var a=e[r];(a.from<n&&a.to>t||t==n&&a.to==t)&&(i(Math.max(a.from,t),Math.min(a.to,n),1==a.level?"rtl":"ltr"),o=!0)}o||i(t,n,"ltr")}function nr(e){return e.level%2?e.to:e.from}function ir(e){return e.level%2?e.from:e.to}function or(e){var t=oo(e);return t?nr(t[0]):0}function rr(e){var t=oo(e);return t?ir(Mo(t)):e.text.length}function ar(e,t){var n=Qi(e.doc,t),i=bi(n);i!=n&&(t=to(i));var o=oo(i),r=o?o[0].level%2?rr(i):or(i):0;return Rr(t,r)}function sr(e,t){for(var n,i=Qi(e.doc,t);n=gi(i);)i=n.find(1,!0).line,t=null;var o=oo(i),r=o?o[0].level%2?or(i):rr(i):i.text.length;return Rr(null==t?to(i):t,r)}function lr(e,t){var n=ar(e,t.line),i=Qi(e.doc,n.line),o=oo(i);if(!o||0==o[0].level){var r=Math.max(0,i.text.search(/\S/)),a=t.line==n.line&&t.ch<=r&&t.ch;return Rr(n.line,a?0:r)}return n}function cr(e,t,n){var i=e[0].level;return t==i?!0:n==i?!1:n>t}function dr(e,t){as=null;for(var n,i=0;i<e.length;++i){var o=e[i];if(o.from<t&&o.to>t)return i;if(o.from==t||o.to==t){if(null!=n)return cr(e,o.level,e[n].level)?(o.from!=o.to&&(as=n),i):(o.from!=o.to&&(as=i),n);n=i}}return n}function ur(e,t,n,i){if(!i)return t+n;do t+=n;while(t>0&&jo(e.text.charAt(t)));return t}function pr(e,t,n,i){var o=oo(e);if(!o)return fr(e,t,n,i);for(var r=dr(o,t),a=o[r],s=ur(e,t,a.level%2?-n:n,i);;){if(s>a.from&&s<a.to)return s;if(s==a.from||s==a.to)return dr(o,s)==r?s:(a=o[r+=n],n>0==a.level%2?a.to:a.from);if(a=o[r+=n],!a)return null;s=n>0==a.level%2?ur(e,a.to,-1,i):ur(e,a.from,1,i)}}function fr(e,t,n,i){var o=t+n;if(i)for(;o>0&&jo(e.text.charAt(o));)o+=n;return 0>o||o>e.text.length?null:o}var hr=navigator.userAgent,mr=navigator.platform,gr=/gecko\/\d/i.test(hr),vr=/MSIE \d/.test(hr),br=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(hr),yr=vr||br,wr=yr&&(vr?document.documentMode||6:br[1]),xr=/WebKit\//.test(hr),kr=xr&&/Qt\/\d+\.\d+/.test(hr),Cr=/Chrome\//.test(hr),Tr=/Opera\//.test(hr),_r=/Apple Computer/.test(navigator.vendor),Sr=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(hr),Ir=/PhantomJS/.test(hr),Lr=/AppleWebKit/.test(hr)&&/Mobile\/\w+/.test(hr),Dr=Lr||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(hr),Nr=Lr||/Mac/.test(mr),Er=/\bCrOS\b/.test(hr),Ar=/win/i.test(mr),Mr=Tr&&hr.match(/Version\/(\d*\.\d*)/);Mr&&(Mr=Number(Mr[1])),Mr&&Mr>=15&&(Tr=!1,xr=!0);var Pr=Nr&&(kr||Tr&&(null==Mr||12.11>Mr)),Or=gr||yr&&wr>=9,Fr=!1,Hr=!1;m.prototype=Ro({update:function(e){var t=e.scrollWidth>e.clientWidth+1,n=e.scrollHeight>e.clientHeight+1,i=e.nativeBarWidth;if(n){this.vert.style.display="block",this.vert.style.bottom=t?i+"px":"0";var o=e.viewHeight-(t?i:0);this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+o)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(t){this.horiz.style.display="block",this.horiz.style.right=n?i+"px":"0",this.horiz.style.left=e.barLeft+"px";var r=e.viewWidth-e.barLeft-(n?i:0);this.horiz.firstChild.style.width=e.scrollWidth-e.clientWidth+r+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&e.clientHeight>0&&(0==i&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:n?i:0,bottom:t?i:0}},setScrollLeft:function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz)},setScrollTop:function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert)},zeroWidthHack:function(){var e=Nr&&!Sr?"12px":"18px";this.horiz.style.height=this.vert.style.width=e,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new Eo,this.disableVert=new Eo},enableZeroWidthBar:function(e,t){function n(){var i=e.getBoundingClientRect(),o=document.elementFromPoint(i.left+1,i.bottom-1);o!=e?e.style.pointerEvents="none":t.set(1e3,n)}e.style.pointerEvents="auto",t.set(1e3,n)},clear:function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)}},m.prototype),g.prototype=Ro({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},g.prototype),e.scrollbarModel={"native":m,"null":g},_.prototype.signal=function(e,t){Do(e,t)&&this.events.push(arguments)},_.prototype.finish=function(){for(var e=0;e<this.events.length;e++)Ma.apply(null,this.events[e])};var Rr=e.Pos=function(e,t){return this instanceof Rr?(this.line=e,void(this.ch=t)):new Rr(e,t)},$r=e.cmpPos=function(e,t){return e.line-t.line||e.ch-t.ch},Br=null;ne.prototype=Ro({init:function(e){function t(e){if(!Io(i,e)){if(i.somethingSelected())Br=i.getSelections(),n.inaccurateSelection&&(n.prevInput="",n.inaccurateSelection=!1,r.value=Br.join("\n"),Wa(r));else{if(!i.options.lineWiseCopyCut)return;var t=ee(i);Br=t.text,"cut"==e.type?i.setSelections(t.ranges,null,Ha):(n.prevInput="",r.value=t.text.join("\n"),Wa(r))}"cut"==e.type&&(i.state.cutIncoming=!0)}}var n=this,i=this.cm,o=this.wrapper=ie(),r=this.textarea=o.firstChild;e.wrapper.insertBefore(o,e.wrapper.firstChild),Lr&&(r.style.width="0px"),Na(r,"input",function(){yr&&wr>=9&&n.hasSelection&&(n.hasSelection=null),n.poll()}),Na(r,"paste",function(e){Io(i,e)||J(e,i)||(i.state.pasteIncoming=!0,n.fastPoll())}),Na(r,"cut",t),Na(r,"copy",t),Na(e.scroller,"paste",function(t){qt(e,t)||Io(i,t)||(i.state.pasteIncoming=!0,n.focus())}),Na(e.lineSpace,"selectstart",function(t){qt(e,t)||Ia(t)}),Na(r,"compositionstart",function(){var e=i.getCursor("from");n.composing&&n.composing.range.clear(),n.composing={start:e,range:i.markText(e,i.getCursor("to"),{className:"CodeMirror-composing"})}}),Na(r,"compositionend",function(){n.composing&&(n.poll(),n.composing.range.clear(),n.composing=null)})},prepareSelection:function(){var e=this.cm,t=e.display,n=e.doc,i=Oe(e);if(e.options.moveInputWithCursor){var o=ft(e,n.sel.primary().head,"div"),r=t.wrapper.getBoundingClientRect(),a=t.lineDiv.getBoundingClientRect();i.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,o.top+a.top-r.top)),i.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,o.left+a.left-r.left))}return i},showSelection:function(e){var t=this.cm,n=t.display;qo(n.cursorDiv,e.cursors),qo(n.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},reset:function(e){if(!this.contextMenuPending){var t,n,i=this.cm,o=i.doc;if(i.somethingSelected()){this.prevInput="";var r=o.sel.primary();t=is&&(r.to().line-r.from().line>100||(n=i.getSelection()).length>1e3);var a=t?"-":n||i.getSelection();this.textarea.value=a,i.state.focused&&Wa(this.textarea),yr&&wr>=9&&(this.hasSelection=a)}else e||(this.prevInput=this.textarea.value="",yr&&wr>=9&&(this.hasSelection=null));this.inaccurateSelection=t}},getField:function(){return this.textarea},supportsTouch:function(){return!1},focus:function(){if("nocursor"!=this.cm.options.readOnly&&(!Dr||Vo()!=this.textarea))try{this.textarea.focus()}catch(e){}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var e=this;e.pollingFast||e.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},fastPoll:function(){function e(){var i=n.poll();i||t?(n.pollingFast=!1,n.slowPoll()):(t=!0,n.polling.set(60,e))}var t=!1,n=this;n.pollingFast=!0,n.polling.set(20,e)},poll:function(){var e=this.cm,t=this.textarea,n=this.prevInput;if(this.contextMenuPending||!e.state.focused||ns(t)&&!n&&!this.composing||e.isReadOnly()||e.options.disableInput||e.state.keySeq)return!1;var i=t.value;if(i==n&&!e.somethingSelected())return!1;if(yr&&wr>=9&&this.hasSelection===i||Nr&&/[\uf700-\uf7ff]/.test(i))return e.display.input.reset(),!1;if(e.doc.sel==e.display.selForContextMenu){var o=i.charCodeAt(0);if(8203!=o||n||(n="​"),8666==o)return this.reset(),this.cm.execCommand("undo")}for(var r=0,a=Math.min(n.length,i.length);a>r&&n.charCodeAt(r)==i.charCodeAt(r);)++r;var s=this;return Dt(e,function(){Q(e,i.slice(r),n.length-r,null,s.composing?"*compose":null),i.length>1e3||i.indexOf("\n")>-1?t.value=s.prevInput="":s.prevInput=i,s.composing&&(s.composing.range.clear(),s.composing.range=e.markText(s.composing.start,e.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},ensurePolled:function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},onKeyPress:function(){yr&&wr>=9&&(this.hasSelection=null),this.fastPoll()},onContextMenu:function(e){function t(){if(null!=a.selectionStart){var e=o.somethingSelected(),t="​"+(e?a.value:"");a.value="⇚",a.value=t,i.prevInput=e?"":"​",a.selectionStart=1,a.selectionEnd=t.length,r.selForContextMenu=o.doc.sel}}function n(){if(i.contextMenuPending=!1,i.wrapper.style.cssText=u,a.style.cssText=d,yr&&9>wr&&r.scrollbars.setScrollTop(r.scroller.scrollTop=l),null!=a.selectionStart){(!yr||yr&&9>wr)&&t();var e=0,n=function(){r.selForContextMenu==o.doc.sel&&0==a.selectionStart&&a.selectionEnd>0&&"​"==i.prevInput?Nt(o,da.selectAll)(o):e++<10?r.detectingSelectAll=setTimeout(n,500):r.input.reset()};r.detectingSelectAll=setTimeout(n,200)}}var i=this,o=i.cm,r=o.display,a=i.textarea,s=Vt(o,e),l=r.scroller.scrollTop;if(s&&!Tr){var c=o.options.resetSelectionOnContextMenu;c&&-1==o.doc.sel.contains(s)&&Nt(o,Se)(o.doc,fe(s),Ha);var d=a.style.cssText,u=i.wrapper.style.cssText;i.wrapper.style.cssText="position: absolute";var p=i.wrapper.getBoundingClientRect();if(a.style.cssText="position: absolute; width: 30px; height: 30px; top: "+(e.clientY-p.top-5)+"px; left: "+(e.clientX-p.left-5)+"px; z-index: 1000; background: "+(yr?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",xr)var f=window.scrollY;if(r.input.focus(),xr&&window.scrollTo(null,f),r.input.reset(),o.somethingSelected()||(a.value=i.prevInput=" "),i.contextMenuPending=!0,r.selForContextMenu=o.doc.sel,clearTimeout(r.detectingSelectAll),yr&&wr>=9&&t(),Or){Da(e);var h=function(){Aa(window,"mouseup",h),setTimeout(n,20)};Na(window,"mouseup",h)}else setTimeout(n,50)}},readOnlyChanged:function(e){e||this.reset()},setUneditable:Fo,needsContentAttribute:!1},ne.prototype),oe.prototype=Ro({init:function(e){function t(e){if(!Io(i,e)){if(i.somethingSelected())Br=i.getSelections(),"cut"==e.type&&i.replaceSelection("",null,"cut");else{if(!i.options.lineWiseCopyCut)return;var t=ee(i);Br=t.text,"cut"==e.type&&i.operation(function(){i.setSelections(t.ranges,0,Ha),i.replaceSelection("",null,"cut")})}if(e.clipboardData&&!Lr)e.preventDefault(),e.clipboardData.clearData(),e.clipboardData.setData("text/plain",Br.join("\n"));else{var n=ie(),o=n.firstChild;i.display.lineSpace.insertBefore(n,i.display.lineSpace.firstChild),o.value=Br.join("\n");var r=document.activeElement;Wa(o),setTimeout(function(){i.display.lineSpace.removeChild(n),r.focus()},50)}}}var n=this,i=n.cm,o=n.div=e.lineDiv;te(o),Na(o,"paste",function(e){Io(i,e)||J(e,i)}),Na(o,"compositionstart",function(e){var t=e.data;if(n.composing={sel:i.doc.sel,data:t,startData:t},t){var o=i.doc.sel.primary(),r=i.getLine(o.head.line),a=r.indexOf(t,Math.max(0,o.head.ch-t.length));a>-1&&a<=o.head.ch&&(n.composing.sel=fe(Rr(o.head.line,a),Rr(o.head.line,a+t.length)))}}),Na(o,"compositionupdate",function(e){n.composing.data=e.data}),Na(o,"compositionend",function(e){var t=n.composing;t&&(e.data==t.startData||/\u200b/.test(e.data)||(t.data=e.data),setTimeout(function(){t.handled||n.applyComposition(t),n.composing==t&&(n.composing=null)},50))}),Na(o,"touchstart",function(){n.forceCompositionEnd()}),Na(o,"input",function(){n.composing||!i.isReadOnly()&&n.pollContent()||Dt(n.cm,function(){Ot(i)})}),Na(o,"copy",t),Na(o,"cut",t)},prepareSelection:function(){var e=Oe(this.cm,!1);return e.focus=this.cm.state.focused,e},showSelection:function(e){e&&this.cm.display.view.length&&(e.focus&&this.showPrimarySelection(),this.showMultipleSelections(e))},showPrimarySelection:function(){var e=window.getSelection(),t=this.cm.doc.sel.primary(),n=se(this.cm,e.anchorNode,e.anchorOffset),i=se(this.cm,e.focusNode,e.focusOffset);if(!n||n.bad||!i||i.bad||0!=$r(X(n,i),t.from())||0!=$r(K(n,i),t.to())){var o=re(this.cm,t.from()),r=re(this.cm,t.to());if(o||r){var a=this.cm.display.view,s=e.rangeCount&&e.getRangeAt(0);if(o){if(!r){var l=a[a.length-1].measure,c=l.maps?l.maps[l.maps.length-1]:l.map;r={node:c[c.length-1],offset:c[c.length-2]-c[c.length-3]}}}else o={node:a[0].measure.map[2],offset:0};try{var d=Ua(o.node,o.offset,r.offset,r.node)}catch(u){}d&&(!gr&&this.cm.state.focused?(e.collapse(o.node,o.offset),d.collapsed||e.addRange(d)):(e.removeAllRanges(),e.addRange(d)),s&&null==e.anchorNode?e.addRange(s):gr&&this.startGracePeriod()),this.rememberSelection()}}},startGracePeriod:function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){e.cm.curOp.selectionChanged=!0})},20)},showMultipleSelections:function(e){qo(this.cm.display.cursorDiv,e.cursors),qo(this.cm.display.selectionDiv,e.selection)},rememberSelection:function(){var e=window.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},selectionInEditor:function(){var e=window.getSelection();if(!e.rangeCount)return!1;var t=e.getRangeAt(0).commonAncestorContainer;return Ka(this.div,t)},focus:function(){"nocursor"!=this.cm.options.readOnly&&this.div.focus()},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return!0},receivedFocus:function(){function e(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,e))}var t=this;this.selectionInEditor()?this.pollSelection():Dt(this.cm,function(){t.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,e)},selectionChanged:function(){var e=window.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var e=window.getSelection(),t=this.cm;this.rememberSelection();var n=se(t,e.anchorNode,e.anchorOffset),i=se(t,e.focusNode,e.focusOffset);n&&i&&Dt(t,function(){Se(t.doc,fe(n,i),Ha),(n.bad||i.bad)&&(t.curOp.selectionChanged=!0)})}},pollContent:function(){var e=this.cm,t=e.display,n=e.doc.sel.primary(),i=n.from(),o=n.to();if(i.line<t.viewFrom||o.line>t.viewTo-1)return!1;var r;if(i.line==t.viewFrom||0==(r=Rt(e,i.line)))var a=to(t.view[0].line),s=t.view[0].node;else var a=to(t.view[r].line),s=t.view[r-1].node.nextSibling;var l=Rt(e,o.line);if(l==t.view.length-1)var c=t.viewTo-1,d=t.lineDiv.lastChild;else var c=to(t.view[l+1].line)-1,d=t.view[l+1].node.previousSibling;for(var u=e.doc.splitLines(ce(e,s,d,a,c)),p=Ji(e.doc,Rr(a,0),Rr(c,Qi(e.doc,c).text.length));u.length>1&&p.length>1;)if(Mo(u)==Mo(p))u.pop(),p.pop(),c--;else{if(u[0]!=p[0])break;u.shift(),p.shift(),a++}for(var f=0,h=0,m=u[0],g=p[0],v=Math.min(m.length,g.length);v>f&&m.charCodeAt(f)==g.charCodeAt(f);)++f;for(var b=Mo(u),y=Mo(p),w=Math.min(b.length-(1==u.length?f:0),y.length-(1==p.length?f:0));w>h&&b.charCodeAt(b.length-h-1)==y.charCodeAt(y.length-h-1);)++h;u[u.length-1]=b.slice(0,b.length-h),u[0]=u[0].slice(f);var x=Rr(a,f),k=Rr(c,p.length?Mo(p).length-h:0);return u.length>1||u[0]||$r(x,k)?(An(e.doc,u,x,k,"+input"),!0):void 0},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){this.composing&&!this.composing.handled&&(this.applyComposition(this.composing),this.composing.handled=!0,this.div.blur(),this.div.focus())},applyComposition:function(e){this.cm.isReadOnly()?Nt(this.cm,Ot)(this.cm):e.data&&e.data!=e.startData&&Nt(this.cm,Q)(this.cm,e.data,0,e.sel)},setUneditable:function(e){e.contentEditable="false"},onKeyPress:function(e){e.preventDefault(),this.cm.isReadOnly()||Nt(this.cm,Q)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0)},readOnlyChanged:function(e){this.div.contentEditable=String("nocursor"!=e)},onContextMenu:Fo,resetPosition:Fo,needsContentAttribute:!0},oe.prototype),e.inputStyles={textarea:ne,contenteditable:oe},de.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(e){if(e==this)return!0;if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(var t=0;t<this.ranges.length;t++){var n=this.ranges[t],i=e.ranges[t];if(0!=$r(n.anchor,i.anchor)||0!=$r(n.head,i.head))return!1}return!0},deepCopy:function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new ue(G(this.ranges[t].anchor),G(this.ranges[t].head));return new de(e,this.primIndex)},somethingSelected:function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},contains:function(e,t){t||(t=e);for(var n=0;n<this.ranges.length;n++){var i=this.ranges[n];if($r(t,i.from())>=0&&$r(e,i.to())<=0)return n}return-1}},ue.prototype={from:function(){return X(this.anchor,this.head)},to:function(){return K(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var zr,jr,Wr,Ur={left:0,right:0,top:0,bottom:0},qr=null,Vr=0,Gr=0,Kr=0,Xr=null;yr?Xr=-.53:gr?Xr=15:Cr?Xr=-.7:_r&&(Xr=-1/3);var Yr=function(e){var t=e.wheelDeltaX,n=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==n&&e.detail&&e.axis==e.VERTICAL_AXIS?n=e.detail:null==n&&(n=e.wheelDelta),{x:t,y:n}};e.wheelEventPixels=function(e){var t=Yr(e);return t.x*=Xr,t.y*=Xr,t};var Qr=new Eo,Jr=null,Zr=e.changeEnd=function(e){return e.text?Rr(e.from.line+e.text.length-1,Mo(e.text).length+(1==e.text.length?e.from.ch:0)):e.to};e.prototype={constructor:e,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,t){var n=this.options,i=n[e];n[e]==t&&"mode"!=e||(n[e]=t,ta.hasOwnProperty(e)&&Nt(this,ta[e])(this,t,i))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](Gn(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,n=0;n<t.length;++n)if(t[n]==e||t[n].name==e)return t.splice(n,1),!0},addOverlay:Et(function(t,n){var i=t.token?t:e.getMode(this.options,t);if(i.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:i,modeSpec:t,opaque:n&&n.opaque}),this.state.modeGen++,Ot(this)}),removeOverlay:Et(function(e){for(var t=this.state.overlays,n=0;n<t.length;++n){var i=t[n].modeSpec;if(i==e||"string"==typeof e&&i.name==e)return t.splice(n,1),this.state.modeGen++,void Ot(this)}}),indentLine:Et(function(e,t,n){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),ve(this.doc,e)&&Bn(this,e,t,n)}),indentSelection:Et(function(e){for(var t=this.doc.sel.ranges,n=-1,i=0;i<t.length;i++){var o=t[i];if(o.empty())o.head.line>n&&(Bn(this,o.head.line,e,!0),n=o.head.line,i==this.doc.sel.primIndex&&Rn(this));else{var r=o.from(),a=o.to(),s=Math.max(n,r.line);n=Math.min(this.lastLine(),a.line-(a.ch?0:1))+1;for(var l=s;n>l;++l)Bn(this,l,e);var c=this.doc.sel.ranges;0==r.ch&&t.length==c.length&&c[i].from().ch>0&&ke(this.doc,i,new ue(r,c[i].to()),Ha)}}}),getTokenAt:function(e,t){return Ai(this,e,t)},getLineTokens:function(e,t){return Ai(this,Rr(e),t,!0)},getTokenTypeAt:function(e){e=me(this.doc,e);var t,n=Oi(this,Qi(this.doc,e.line)),i=0,o=(n.length-1)/2,r=e.ch;if(0==r)t=n[2];else for(;;){var a=i+o>>1;if((a?n[2*a-1]:0)>=r)o=a;else{if(!(n[2*a+1]<r)){t=n[2*a+2];break}i=a+1}}var s=t?t.indexOf("cm-overlay "):-1;return 0>s?t:0==s?null:t.slice(0,s-1)},getModeAt:function(t){var n=this.doc.mode;return n.innerMode?e.innerMode(n,this.getTokenAt(t).state).mode:n},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var n=[];if(!sa.hasOwnProperty(t))return n;var i=sa[t],o=this.getModeAt(e);if("string"==typeof o[t])i[o[t]]&&n.push(i[o[t]]);else if(o[t])for(var r=0;r<o[t].length;r++){var a=i[o[t][r]];a&&n.push(a)}else o.helperType&&i[o.helperType]?n.push(i[o.helperType]):i[o.name]&&n.push(i[o.name]);for(var r=0;r<i._global.length;r++){var s=i._global[r];s.pred(o,this)&&-1==Po(n,s.val)&&n.push(s.val)}return n},getStateAfter:function(e,t){var n=this.doc;return e=he(n,null==e?n.first+n.size-1:e),je(this,e+1,t)},cursorCoords:function(e,t){var n,i=this.doc.sel.primary();return n=null==e?i.head:"object"==typeof e?me(this.doc,e):e?i.from():i.to(),ft(this,n,t||"page")},charCoords:function(e,t){return pt(this,me(this.doc,e),t||"page")},coordsChar:function(e,t){return e=ut(this,e,t||"page"),gt(this,e.left,e.top)},lineAtHeight:function(e,t){return e=ut(this,{top:e,left:0},t||"page").top,no(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t){var n,i=!1;if("number"==typeof e){var o=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>o&&(e=o,i=!0),n=Qi(this.doc,e)}else n=e;return dt(this,n,{top:0,left:0},t||"page").top+(i?this.doc.height-io(n):0)},defaultTextHeight:function(){return bt(this.display)},defaultCharWidth:function(){return yt(this.display)},setGutterMarker:Et(function(e,t,n){return zn(this.doc,e,"gutter",function(e){var i=e.gutterMarkers||(e.gutterMarkers={});return i[t]=n,!n&&zo(i)&&(e.gutterMarkers=null),!0})}),clearGutter:Et(function(e){var t=this,n=t.doc,i=n.first;n.iter(function(n){n.gutterMarkers&&n.gutterMarkers[e]&&(n.gutterMarkers[e]=null,Ft(t,i,"gutter"),zo(n.gutterMarkers)&&(n.gutterMarkers=null)),++i})}),lineInfo:function(e){if("number"==typeof e){if(!ve(this.doc,e))return null;var t=e;if(e=Qi(this.doc,e),!e)return null}else{var t=to(e);if(null==t)return null}return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,n,i,o){var r=this.display;e=ft(this,me(this.doc,e));var a=e.bottom,s=e.left;if(t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),r.sizer.appendChild(t),"over"==i)a=e.top;else if("above"==i||"near"==i){var l=Math.max(r.wrapper.clientHeight,this.doc.height),c=Math.max(r.sizer.clientWidth,r.lineSpace.clientWidth);("above"==i||e.bottom+t.offsetHeight>l)&&e.top>t.offsetHeight?a=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=l&&(a=e.bottom),s+t.offsetWidth>c&&(s=c-t.offsetWidth)}t.style.top=a+"px",t.style.left=t.style.right="","right"==o?(s=r.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==o?s=0:"middle"==o&&(s=(r.sizer.clientWidth-t.offsetWidth)/2),t.style.left=s+"px"),n&&On(this,s,a,s+t.offsetWidth,a+t.offsetHeight)},triggerOnKeyDown:Et(pn),triggerOnKeyPress:Et(mn),triggerOnKeyUp:hn,execCommand:function(e){return da.hasOwnProperty(e)?da[e].call(null,this):void 0},triggerElectric:Et(function(e){Z(this,e)}),findPosH:function(e,t,n,i){var o=1;0>t&&(o=-1,t=-t);for(var r=0,a=me(this.doc,e);t>r&&(a=Wn(this.doc,a,o,n,i),!a.hitSide);++r);return a},moveH:Et(function(e,t){var n=this;n.extendSelectionsBy(function(i){return n.display.shift||n.doc.extend||i.empty()?Wn(n.doc,i.head,e,t,n.options.rtlMoveVisually):0>e?i.from():i.to()},$a)}),deleteH:Et(function(e,t){var n=this.doc.sel,i=this.doc;n.somethingSelected()?i.replaceSelection("",null,"+delete"):jn(this,function(n){var o=Wn(i,n.head,e,t,!1);return 0>e?{from:o,to:n.head}:{from:n.head,to:o}})}),findPosV:function(e,t,n,i){var o=1,r=i;0>t&&(o=-1,t=-t);for(var a=0,s=me(this.doc,e);t>a;++a){var l=ft(this,s,"div");if(null==r?r=l.left:l.left=r,s=Un(this,l,o,n),s.hitSide)break}return s},moveV:Et(function(e,t){var n=this,i=this.doc,o=[],r=!n.display.shift&&!i.extend&&i.sel.somethingSelected();if(i.extendSelectionsBy(function(a){if(r)return 0>e?a.from():a.to();var s=ft(n,a.head,"div");null!=a.goalColumn&&(s.left=a.goalColumn),o.push(s.left);var l=Un(n,s,e,t);return"page"==t&&a==i.sel.primary()&&Hn(n,null,pt(n,l,"div").top-s.top),l},$a),o.length)for(var a=0;a<i.sel.ranges.length;a++)i.sel.ranges[a].goalColumn=o[a]}),findWordAt:function(e){var t=this.doc,n=Qi(t,e.line).text,i=e.ch,o=e.ch;if(n){var r=this.getHelper(e,"wordChars");(e.xRel<0||o==n.length)&&i?--i:++o;for(var a=n.charAt(i),s=Bo(a,r)?function(e){return Bo(e,r)}:/\s/.test(a)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!Bo(e)};i>0&&s(n.charAt(i-1));)--i;for(;o<n.length&&s(n.charAt(o));)++o}return new ue(Rr(e.line,i),Rr(e.line,o))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?Ja(this.display.cursorDiv,"CodeMirror-overwrite"):Qa(this.display.cursorDiv,"CodeMirror-overwrite"),Ma(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==Vo()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:Et(function(e,t){null==e&&null==t||$n(this),null!=e&&(this.curOp.scrollLeft=e),null!=t&&(this.curOp.scrollTop=t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-Ve(this)-this.display.barHeight,width:e.scrollWidth-Ve(this)-this.display.barWidth,clientHeight:Ke(this),clientWidth:Ge(this)}},scrollIntoView:Et(function(e,t){if(null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:Rr(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line)$n(this),this.curOp.scrollToPos=e;else{var n=Fn(this,Math.min(e.from.left,e.to.left),Math.min(e.from.top,e.to.top)-e.margin,Math.max(e.from.right,e.to.right),Math.max(e.from.bottom,e.to.bottom)+e.margin);this.scrollTo(n.scrollLeft,n.scrollTop)}}),setSize:Et(function(e,t){function n(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}var i=this;null!=e&&(i.display.wrapper.style.width=n(e)),
null!=t&&(i.display.wrapper.style.height=n(t)),i.options.lineWrapping&&at(this);var o=i.display.viewFrom;i.doc.iter(o,i.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){Ft(i,o,"widget");break}++o}),i.curOp.forceUpdate=!0,Ma(i,"refresh",this)}),operation:function(e){return Dt(this,e)},refresh:Et(function(){var e=this.display.cachedTextHeight;Ot(this),this.curOp.forceUpdate=!0,st(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),d(this),(null==e||Math.abs(e-bt(this.display))>.5)&&a(this),Ma(this,"refresh",this)}),swapDoc:Et(function(e){var t=this.doc;return t.cm=null,Yi(this,e),st(this),this.display.input.reset(),this.scrollTo(e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,_o(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},No(e);var ea=e.defaults={},ta=e.optionHandlers={},na=e.Init={toString:function(){return"CodeMirror.Init"}};qn("value","",function(e,t){e.setValue(t)},!0),qn("mode",null,function(e,t){e.doc.modeOption=t,n(e)},!0),qn("indentUnit",2,n,!0),qn("indentWithTabs",!1),qn("smartIndent",!0),qn("tabSize",4,function(e){i(e),st(e),Ot(e)},!0),qn("lineSeparator",null,function(e,t){if(e.doc.lineSep=t,t){var n=[],i=e.doc.first;e.doc.iter(function(e){for(var o=0;;){var r=e.text.indexOf(t,o);if(-1==r)break;o=r+t.length,n.push(Rr(i,r))}i++});for(var o=n.length-1;o>=0;o--)An(e.doc,t,n[o],Rr(n[o].line,n[o].ch+t.length))}}),qn("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(t,n,i){t.state.specialChars=new RegExp(n.source+(n.test("	")?"":"|	"),"g"),i!=e.Init&&t.refresh()}),qn("specialCharPlaceholder",$i,function(e){e.refresh()},!0),qn("electricChars",!0),qn("inputStyle",Dr?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),qn("rtlMoveVisually",!Ar),qn("wholeLineUpdateBefore",!0),qn("theme","default",function(e){s(e),l(e)},!0),qn("keyMap","default",function(t,n,i){var o=Gn(n),r=i!=e.Init&&Gn(i);r&&r.detach&&r.detach(t,o),o.attach&&o.attach(t,r||null)}),qn("extraKeys",null),qn("lineWrapping",!1,o,!0),qn("gutters",[],function(e){f(e.options),l(e)},!0),qn("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?T(e.display)+"px":"0",e.refresh()},!0),qn("coverGutterNextToScrollbar",!1,function(e){b(e)},!0),qn("scrollbarStyle","native",function(e){v(e),b(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),qn("lineNumbers",!1,function(e){f(e.options),l(e)},!0),qn("firstLineNumber",1,l,!0),qn("lineNumberFormatter",function(e){return e},l,!0),qn("showCursorWhenSelecting",!1,Pe,!0),qn("resetSelectionOnContextMenu",!0),qn("lineWiseCopyCut",!0),qn("readOnly",!1,function(e,t){"nocursor"==t?(bn(e),e.display.input.blur(),e.display.disabled=!0):e.display.disabled=!1,e.display.input.readOnlyChanged(t)}),qn("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),qn("dragDrop",!0,Wt),qn("allowDropFileTypes",null),qn("cursorBlinkRate",530),qn("cursorScrollMargin",0),qn("cursorHeight",1,Pe,!0),qn("singleCursorHeightPerLine",!0,Pe,!0),qn("workTime",100),qn("workDelay",100),qn("flattenSpans",!0,i,!0),qn("addModeClass",!1,i,!0),qn("pollInterval",100),qn("undoDepth",200,function(e,t){e.doc.history.undoDepth=t}),qn("historyEventDelay",1250),qn("viewportMargin",10,function(e){e.refresh()},!0),qn("maxHighlightLength",1e4,i,!0),qn("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),qn("tabindex",null,function(e,t){e.display.input.getField().tabIndex=t||""}),qn("autofocus",null);var ia=e.modes={},oa=e.mimeModes={};e.defineMode=function(t,n){e.defaults.mode||"null"==t||(e.defaults.mode=t),arguments.length>2&&(n.dependencies=Array.prototype.slice.call(arguments,2)),ia[t]=n},e.defineMIME=function(e,t){oa[e]=t},e.resolveMode=function(t){if("string"==typeof t&&oa.hasOwnProperty(t))t=oa[t];else if(t&&"string"==typeof t.name&&oa.hasOwnProperty(t.name)){var n=oa[t.name];"string"==typeof n&&(n={name:n}),t=Ho(n,t),t.name=n.name}else if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return e.resolveMode("application/xml");return"string"==typeof t?{name:t}:t||{name:"null"}},e.getMode=function(t,n){var n=e.resolveMode(n),i=ia[n.name];if(!i)return e.getMode(t,"text/plain");var o=i(t,n);if(ra.hasOwnProperty(n.name)){var r=ra[n.name];for(var a in r)r.hasOwnProperty(a)&&(o.hasOwnProperty(a)&&(o["_"+a]=o[a]),o[a]=r[a])}if(o.name=n.name,n.helperType&&(o.helperType=n.helperType),n.modeProps)for(var a in n.modeProps)o[a]=n.modeProps[a];return o},e.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),e.defineMIME("text/plain","null");var ra=e.modeExtensions={};e.extendMode=function(e,t){var n=ra.hasOwnProperty(e)?ra[e]:ra[e]={};Ro(t,n)},e.defineExtension=function(t,n){e.prototype[t]=n},e.defineDocExtension=function(e,t){Ta.prototype[e]=t},e.defineOption=qn;var aa=[];e.defineInitHook=function(e){aa.push(e)};var sa=e.helpers={};e.registerHelper=function(t,n,i){sa.hasOwnProperty(t)||(sa[t]=e[t]={_global:[]}),sa[t][n]=i},e.registerGlobalHelper=function(t,n,i,o){e.registerHelper(t,n,o),sa[t]._global.push({pred:i,val:o})};var la=e.copyState=function(e,t){if(t===!0)return t;if(e.copyState)return e.copyState(t);var n={};for(var i in t){var o=t[i];o instanceof Array&&(o=o.concat([])),n[i]=o}return n},ca=e.startState=function(e,t,n){return e.startState?e.startState(t,n):!0};e.innerMode=function(e,t){for(;e.innerMode;){var n=e.innerMode(t);if(!n||n.mode==e)break;t=n.state,e=n.mode}return n||{mode:e,state:t}};var da=e.commands={selectAll:function(e){e.setSelection(Rr(e.firstLine(),0),Rr(e.lastLine()),Ha)},singleSelection:function(e){e.setSelection(e.getCursor("anchor"),e.getCursor("head"),Ha)},killLine:function(e){jn(e,function(t){if(t.empty()){var n=Qi(e.doc,t.head.line).text.length;return t.head.ch==n&&t.head.line<e.lastLine()?{from:t.head,to:Rr(t.head.line+1,0)}:{from:t.head,to:Rr(t.head.line,n)}}return{from:t.from(),to:t.to()}})},deleteLine:function(e){jn(e,function(t){return{from:Rr(t.from().line,0),to:me(e.doc,Rr(t.to().line+1,0))}})},delLineLeft:function(e){jn(e,function(e){return{from:Rr(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(e){jn(e,function(t){var n=e.charCoords(t.head,"div").top+5,i=e.coordsChar({left:0,top:n},"div");return{from:i,to:t.from()}})},delWrappedLineRight:function(e){jn(e,function(t){var n=e.charCoords(t.head,"div").top+5,i=e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div");return{from:t.from(),to:i}})},undo:function(e){e.undo()},redo:function(e){e.redo()},undoSelection:function(e){e.undoSelection()},redoSelection:function(e){e.redoSelection()},goDocStart:function(e){e.extendSelection(Rr(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(Rr(e.lastLine()))},goLineStart:function(e){e.extendSelectionsBy(function(t){return ar(e,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(e){e.extendSelectionsBy(function(t){return lr(e,t.head)},{origin:"+move",bias:1})},goLineEnd:function(e){e.extendSelectionsBy(function(t){return sr(e,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:n},"div")},$a)},goLineLeft:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5;return e.coordsChar({left:0,top:n},"div")},$a)},goLineLeftSmart:function(e){e.extendSelectionsBy(function(t){var n=e.charCoords(t.head,"div").top+5,i=e.coordsChar({left:0,top:n},"div");return i.ch<e.getLine(i.line).search(/\S/)?lr(e,t.head):i},$a)},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goGroupRight:function(e){e.moveH(1,"group")},goGroupLeft:function(e){e.moveH(-1,"group")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},delGroupBefore:function(e){e.deleteH(-1,"group")},delGroupAfter:function(e){e.deleteH(1,"group")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("	")},insertSoftTab:function(e){for(var t=[],n=e.listSelections(),i=e.options.tabSize,o=0;o<n.length;o++){var r=n[o].from(),a=Ba(e.getLine(r.line),r.ch,i);t.push(new Array(i-a%i+1).join(" "))}e.replaceSelections(t)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(e){Dt(e,function(){for(var t=e.listSelections(),n=[],i=0;i<t.length;i++){var o=t[i].head,r=Qi(e.doc,o.line).text;if(r)if(o.ch==r.length&&(o=new Rr(o.line,o.ch-1)),o.ch>0)o=new Rr(o.line,o.ch+1),e.replaceRange(r.charAt(o.ch-1)+r.charAt(o.ch-2),Rr(o.line,o.ch-2),o,"+transpose");else if(o.line>e.doc.first){var a=Qi(e.doc,o.line-1).text;a&&e.replaceRange(r.charAt(0)+e.doc.lineSeparator()+a.charAt(a.length-1),Rr(o.line-1,a.length-1),Rr(o.line,1),"+transpose")}n.push(new ue(o,o))}e.setSelections(n)})},newlineAndIndent:function(e){Dt(e,function(){for(var t=e.listSelections().length,n=0;t>n;n++){var i=e.listSelections()[n];e.replaceRange(e.doc.lineSeparator(),i.anchor,i.head,"+input"),e.indentLine(i.from().line+1,null,!0)}Rn(e)})},toggleOverwrite:function(e){e.toggleOverwrite()}},ua=e.keyMap={};ua.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},ua.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},ua.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},ua.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},ua["default"]=Nr?ua.macDefault:ua.pcDefault,e.normalizeKeyMap=function(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];if(/^(name|fallthrough|(de|at)tach)$/.test(n))continue;if("..."==i){delete e[n];continue}for(var o=Oo(n.split(" "),Vn),r=0;r<o.length;r++){var a,s;r==o.length-1?(s=o.join(" "),a=i):(s=o.slice(0,r+1).join(" "),a="...");var l=t[s];if(l){if(l!=a)throw new Error("Inconsistent bindings for "+s)}else t[s]=a}delete e[n]}for(var c in t)e[c]=t[c];return e};var pa=e.lookupKey=function(e,t,n,i){t=Gn(t);var o=t.call?t.call(e,i):t[e];if(o===!1)return"nothing";if("..."===o)return"multi";if(null!=o&&n(o))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return pa(e,t.fallthrough,n,i);for(var r=0;r<t.fallthrough.length;r++){var a=pa(e,t.fallthrough[r],n,i);if(a)return a}}},fa=e.isModifierKey=function(e){var t="string"==typeof e?e:rs[e.keyCode];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t},ha=e.keyName=function(e,t){if(Tr&&34==e.keyCode&&e["char"])return!1;var n=rs[e.keyCode],i=n;return null==i||e.altGraphKey?!1:(e.altKey&&"Alt"!=n&&(i="Alt-"+i),(Pr?e.metaKey:e.ctrlKey)&&"Ctrl"!=n&&(i="Ctrl-"+i),(Pr?e.ctrlKey:e.metaKey)&&"Cmd"!=n&&(i="Cmd-"+i),!t&&e.shiftKey&&"Shift"!=n&&(i="Shift-"+i),i)};e.fromTextArea=function(t,n){function i(){t.value=c.getValue()}if(n=n?Ro(n):{},n.value=t.value,!n.tabindex&&t.tabIndex&&(n.tabindex=t.tabIndex),!n.placeholder&&t.placeholder&&(n.placeholder=t.placeholder),null==n.autofocus){var o=Vo();n.autofocus=o==t||null!=t.getAttribute("autofocus")&&o==document.body}if(t.form&&(Na(t.form,"submit",i),!n.leaveSubmitMethodAlone)){var r=t.form,a=r.submit;try{var s=r.submit=function(){i(),r.submit=a,r.submit(),r.submit=s}}catch(l){}}n.finishInit=function(e){e.save=i,e.getTextArea=function(){return t},e.toTextArea=function(){e.toTextArea=isNaN,i(),t.parentNode.removeChild(e.getWrapperElement()),t.style.display="",t.form&&(Aa(t.form,"submit",i),"function"==typeof t.form.submit&&(t.form.submit=a))}},t.style.display="none";var c=e(function(e){t.parentNode.insertBefore(e,t.nextSibling)},n);return c};var ma=e.StringStream=function(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};ma.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e)var n=t==e;else var n=t&&(e.test?e.test(t):e(t));return n?(++this.pos,t):void 0},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);return t>-1?(this.pos=t,!0):void 0},backUp:function(e){this.pos-=e},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Ba(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Ba(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return Ba(this.string,null,this.tabSize)-(this.lineStart?Ba(this.string,this.lineStart,this.tabSize):0)},match:function(e,t,n){if("string"!=typeof e){var i=this.string.slice(this.pos).match(e);return i&&i.index>0?null:(i&&t!==!1&&(this.pos+=i[0].length),i)}var o=function(e){return n?e.toLowerCase():e},r=this.string.substr(this.pos,e.length);return o(r)==o(e)?(t!==!1&&(this.pos+=e.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}}};var ga=0,va=e.TextMarker=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++ga};No(va),va.prototype.clear=function(){if(!this.explicitlyCleared){var e=this.doc.cm,t=e&&!e.curOp;if(t&&wt(e),Do(this,"clear")){var n=this.find();n&&_o(this,"clear",n.from,n.to)}for(var i=null,o=null,r=0;r<this.lines.length;++r){var a=this.lines[r],s=ei(a.markedSpans,this);e&&!this.collapsed?Ft(e,to(a),"text"):e&&(null!=s.to&&(o=to(a)),null!=s.from&&(i=to(a))),a.markedSpans=ti(a.markedSpans,s),null==s.from&&this.collapsed&&!ki(this.doc,a)&&e&&eo(a,bt(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var r=0;r<this.lines.length;++r){var l=bi(this.lines[r]),c=u(l);c>e.display.maxLineLength&&(e.display.maxLine=l,e.display.maxLineLength=c,e.display.maxLineChanged=!0)}null!=i&&e&&this.collapsed&&Ot(e,i,o+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&De(e.doc)),e&&_o(e,"markerCleared",e,this),t&&kt(e),this.parent&&this.parent.clear()}},va.prototype.find=function(e,t){null==e&&"bookmark"==this.type&&(e=1);for(var n,i,o=0;o<this.lines.length;++o){var r=this.lines[o],a=ei(r.markedSpans,this);if(null!=a.from&&(n=Rr(t?r:to(r),a.from),-1==e))return n;if(null!=a.to&&(i=Rr(t?r:to(r),a.to),1==e))return i}return n&&{from:n,to:i}},va.prototype.changed=function(){var e=this.find(-1,!0),t=this,n=this.doc.cm;e&&n&&Dt(n,function(){var i=e.line,o=to(e.line),r=Ze(n,o);if(r&&(rt(r),n.curOp.selectionChanged=n.curOp.forceUpdate=!0),n.curOp.updateMaxLine=!0,!ki(t.doc,i)&&null!=t.height){var a=t.height;t.height=null;var s=_i(t)-a;s&&eo(i,i.height+s)}})},va.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&-1!=Po(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},va.prototype.detachLine=function(e){if(this.lines.splice(Po(this.lines,e),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}};var ga=0,ba=e.SharedTextMarker=function(e,t){this.markers=e,this.primary=t;for(var n=0;n<e.length;++n)e[n].parent=this};No(ba),ba.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();_o(this,"clear")}},ba.prototype.find=function(e,t){return this.primary.find(e,t)};var ya=e.LineWidget=function(e,t,n){if(n)for(var i in n)n.hasOwnProperty(i)&&(this[i]=n[i]);this.doc=e,this.node=t};No(ya),ya.prototype.clear=function(){var e=this.doc.cm,t=this.line.widgets,n=this.line,i=to(n);if(null!=i&&t){for(var o=0;o<t.length;++o)t[o]==this&&t.splice(o--,1);t.length||(n.widgets=null);var r=_i(this);eo(n,Math.max(0,n.height-r)),e&&Dt(e,function(){Ti(e,n,-r),Ft(e,i,"widget")})}},ya.prototype.changed=function(){var e=this.height,t=this.doc.cm,n=this.line;this.height=null;var i=_i(this)-e;i&&(eo(n,n.height+i),t&&Dt(t,function(){t.curOp.forceUpdate=!0,Ti(t,n,i)}))};var wa=e.Line=function(e,t,n){this.text=e,di(this,t),this.height=n?n(this):1};No(wa),wa.prototype.lineNo=function(){return to(this)};var xa={},ka={};Gi.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n=e,i=e+t;i>n;++n){var o=this.lines[n];this.height-=o.height,Li(o),_o(o,"delete")}this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var i=0;i<t.length;++i)t[i].parent=this},iterN:function(e,t,n){for(var i=e+t;i>e;++e)if(n(this.lines[e]))return!0}},Ki.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var n=0;n<this.children.length;++n){var i=this.children[n],o=i.chunkSize();if(o>e){var r=Math.min(t,o-e),a=i.height;if(i.removeInner(e,r),this.height-=a-i.height,o==r&&(this.children.splice(n--,1),i.parent=null),0==(t-=r))break;e=0}else e-=o}if(this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof Gi))){var s=[];this.collapse(s),this.children=[new Gi(s)],this.children[0].parent=this}},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){this.size+=t.length,this.height+=n;for(var i=0;i<this.children.length;++i){var o=this.children[i],r=o.chunkSize();if(r>=e){if(o.insertInner(e,t,n),o.lines&&o.lines.length>50){for(;o.lines.length>50;){var a=o.lines.splice(o.lines.length-25,25),s=new Gi(a);o.height-=s.height,this.children.splice(i+1,0,s),s.parent=this}this.maybeSpill()}break}e-=r}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=e.children.splice(e.children.length-5,5),n=new Ki(t);if(e.parent){e.size-=n.size,e.height-=n.height;var i=Po(e.parent.children,e);e.parent.children.splice(i+1,0,n)}else{var o=new Ki(e.children);o.parent=e,e.children=[o,n],e=o}n.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iterN:function(e,t,n){for(var i=0;i<this.children.length;++i){var o=this.children[i],r=o.chunkSize();if(r>e){var a=Math.min(t,r-e);if(o.iterN(e,a,n))return!0;if(0==(t-=a))break;e=0}else e-=r}}};var Ca=0,Ta=e.Doc=function(e,t,n,i){if(!(this instanceof Ta))return new Ta(e,t,n,i);null==n&&(n=0),Ki.call(this,[new Gi([new wa("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=n;var o=Rr(n,0);this.sel=fe(o),this.history=new ro(null),this.id=++Ca,this.modeOption=t,this.lineSep=i,this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),Vi(this,{from:o,to:o,text:e}),Se(this,fe(o),Ha)};Ta.prototype=Ho(Ki.prototype,{constructor:Ta,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var n=0,i=0;i<t.length;++i)n+=t[i].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=Zi(this,this.first,this.first+this.size);return e===!1?t:t.join(e||this.lineSeparator())},setValue:At(function(e){var t=Rr(this.first,0),n=this.first+this.size-1;Sn(this,{from:t,to:Rr(n,Qi(this,n).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),Se(this,fe(t))}),replaceRange:function(e,t,n,i){t=me(this,t),n=n?me(this,n):t,An(this,e,t,n,i)},getRange:function(e,t,n){var i=Ji(this,me(this,e),me(this,t));return n===!1?i:i.join(n||this.lineSeparator())},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){return ve(this,e)?Qi(this,e):void 0},getLineNumber:function(e){return to(e)},getLineHandleVisualStart:function(e){return"number"==typeof e&&(e=Qi(this,e)),bi(e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return me(this,e)},getCursor:function(e){var t,n=this.sel.primary();return t=null==e||"head"==e?n.head:"anchor"==e?n.anchor:"end"==e||"to"==e||e===!1?n.to():n.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:At(function(e,t,n){Ce(this,me(this,"number"==typeof e?Rr(e,t||0):e),null,n)}),setSelection:At(function(e,t,n){Ce(this,me(this,e),me(this,t||e),n)}),extendSelection:At(function(e,t,n){we(this,me(this,e),t&&me(this,t),n)}),extendSelections:At(function(e,t){xe(this,be(this,e),t)}),extendSelectionsBy:At(function(e,t){var n=Oo(this.sel.ranges,e);xe(this,be(this,n),t)}),setSelections:At(function(e,t,n){if(e.length){for(var i=0,o=[];i<e.length;i++)o[i]=new ue(me(this,e[i].anchor),me(this,e[i].head));null==t&&(t=Math.min(e.length-1,this.sel.primIndex)),Se(this,pe(o,t),n)}}),addSelection:At(function(e,t,n){var i=this.sel.ranges.slice(0);i.push(new ue(me(this,e),me(this,t||e))),Se(this,pe(i,i.length-1),n)}),getSelection:function(e){for(var t,n=this.sel.ranges,i=0;i<n.length;i++){var o=Ji(this,n[i].from(),n[i].to());t=t?t.concat(o):o}return e===!1?t:t.join(e||this.lineSeparator())},getSelections:function(e){for(var t=[],n=this.sel.ranges,i=0;i<n.length;i++){var o=Ji(this,n[i].from(),n[i].to());e!==!1&&(o=o.join(e||this.lineSeparator())),t[i]=o}return t},replaceSelection:function(e,t,n){for(var i=[],o=0;o<this.sel.ranges.length;o++)i[o]=e;this.replaceSelections(i,t,n||"+input")},replaceSelections:At(function(e,t,n){for(var i=[],o=this.sel,r=0;r<o.ranges.length;r++){var a=o.ranges[r];i[r]={from:a.from(),to:a.to(),text:this.splitLines(e[r]),origin:n}}for(var s=t&&"end"!=t&&Tn(this,i,t),r=i.length-1;r>=0;r--)Sn(this,i[r]);s?_e(this,s):this.cm&&Rn(this.cm)}),undo:At(function(){Ln(this,"undo")}),redo:At(function(){Ln(this,"redo")}),undoSelection:At(function(){Ln(this,"undo",!0)}),redoSelection:At(function(){Ln(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e=this.history,t=0,n=0,i=0;i<e.done.length;i++)e.done[i].ranges||++t;for(var i=0;i<e.undone.length;i++)e.undone[i].ranges||++n;return{undo:t,redo:n}},clearHistory:function(){this.history=new ro(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:vo(this.history.done),undone:vo(this.history.undone)}},setHistory:function(e){var t=this.history=new ro(this.history.maxGeneration);t.done=vo(e.done.slice(0),null,!0),t.undone=vo(e.undone.slice(0),null,!0)},addLineClass:At(function(e,t,n){return zn(this,e,"gutter"==t?"gutter":"class",function(e){var i="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass";if(e[i]){if(Go(n).test(e[i]))return!1;e[i]+=" "+n}else e[i]=n;return!0})}),removeLineClass:At(function(e,t,n){return zn(this,e,"gutter"==t?"gutter":"class",function(e){var i="text"==t?"textClass":"background"==t?"bgClass":"gutter"==t?"gutterClass":"wrapClass",o=e[i];if(!o)return!1;if(null==n)e[i]=null;else{var r=o.match(Go(n));if(!r)return!1;var a=r.index+r[0].length;e[i]=o.slice(0,r.index)+(r.index&&a!=o.length?" ":"")+o.slice(a)||null}return!0})}),addLineWidget:At(function(e,t,n){return Si(this,e,t,n)}),removeLineWidget:function(e){e.clear()},markText:function(e,t,n){return Kn(this,me(this,e),me(this,t),n,n&&n.type||"range")},setBookmark:function(e,t){var n={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return e=me(this,e),Kn(this,e,e,n,"bookmark")},findMarksAt:function(e){e=me(this,e);var t=[],n=Qi(this,e.line).markedSpans;if(n)for(var i=0;i<n.length;++i){var o=n[i];(null==o.from||o.from<=e.ch)&&(null==o.to||o.to>=e.ch)&&t.push(o.marker.parent||o.marker)}return t},findMarks:function(e,t,n){e=me(this,e),t=me(this,t);var i=[],o=e.line;return this.iter(e.line,t.line+1,function(r){var a=r.markedSpans;if(a)for(var s=0;s<a.length;s++){var l=a[s];null!=l.to&&o==e.line&&e.ch>=l.to||null==l.from&&o!=e.line||null!=l.from&&o==t.line&&l.from>=t.ch||n&&!n(l.marker)||i.push(l.marker.parent||l.marker)}++o}),i},getAllMarks:function(){var e=[];return this.iter(function(t){var n=t.markedSpans;if(n)for(var i=0;i<n.length;++i)null!=n[i].from&&e.push(n[i].marker)}),e},posFromIndex:function(e){var t,n=this.first,i=this.lineSeparator().length;return this.iter(function(o){var r=o.text.length+i;return r>e?(t=e,!0):(e-=r,void++n)}),me(this,Rr(n,t))},indexFromPos:function(e){e=me(this,e);var t=e.ch;if(e.line<this.first||e.ch<0)return 0;var n=this.lineSeparator().length;return this.iter(this.first,e.line,function(e){t+=e.text.length+n}),t},copy:function(e){var t=new Ta(Zi(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,n=this.first+this.size;null!=e.from&&e.from>t&&(t=e.from),null!=e.to&&e.to<n&&(n=e.to);var i=new Ta(Zi(this,t,n),e.mode||this.modeOption,t,this.lineSep);return e.sharedHist&&(i.history=this.history),(this.linked||(this.linked=[])).push({doc:i,sharedHist:e.sharedHist}),i.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],Qn(i,Yn(this)),i},unlinkDoc:function(t){if(t instanceof e&&(t=t.doc),this.linked)for(var n=0;n<this.linked.length;++n){var i=this.linked[n];if(i.doc==t){this.linked.splice(n,1),t.unlinkDoc(this),Jn(Yn(this));break}}if(t.history==this.history){var o=[t.id];Xi(t,function(e){o.push(e.id)},!0),t.history=new ro(null),t.history.done=vo(this.history.done,o),t.history.undone=vo(this.history.undone,o)}},iterLinkedDocs:function(e){Xi(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):ts(e)},lineSeparator:function(){return this.lineSep||"\n"}}),Ta.prototype.eachLine=Ta.prototype.iter;var _a="iter insert remove copy getEditor constructor".split(" ");for(var Sa in Ta.prototype)Ta.prototype.hasOwnProperty(Sa)&&Po(_a,Sa)<0&&(e.prototype[Sa]=function(e){return function(){return e.apply(this.doc,arguments)}}(Ta.prototype[Sa]));No(Ta);var Ia=e.e_preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},La=e.e_stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},Da=e.e_stop=function(e){Ia(e),La(e)},Na=e.on=function(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent)e.attachEvent("on"+t,n);else{var i=e._handlers||(e._handlers={}),o=i[t]||(i[t]=[]);o.push(n)}},Ea=[],Aa=e.off=function(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else for(var i=To(e,t,!1),o=0;o<i.length;++o)if(i[o]==n){i.splice(o,1);break}},Ma=e.signal=function(e,t){var n=To(e,t,!0);if(n.length)for(var i=Array.prototype.slice.call(arguments,2),o=0;o<n.length;++o)n[o].apply(null,i)},Pa=null,Oa=30,Fa=e.Pass={toString:function(){return"CodeMirror.Pass"}},Ha={scroll:!1},Ra={origin:"*mouse"},$a={origin:"+move"};Eo.prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)};var Ba=e.countColumn=function(e,t,n,i,o){null==t&&(t=e.search(/[^\s\u00a0]/),-1==t&&(t=e.length));for(var r=i||0,a=o||0;;){var s=e.indexOf("	",r);if(0>s||s>=t)return a+(t-r);a+=s-r,a+=n-a%n,r=s+1}},za=e.findColumn=function(e,t,n){for(var i=0,o=0;;){var r=e.indexOf("	",i);-1==r&&(r=e.length);var a=r-i;if(r==e.length||o+a>=t)return i+Math.min(a,t-o);if(o+=r-i,o+=n-o%n,i=r+1,o>=t)return i}},ja=[""],Wa=function(e){e.select()};Lr?Wa=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:yr&&(Wa=function(e){try{e.select()}catch(t){}});var Ua,qa=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Va=e.isWordChar=function(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||qa.test(e))},Ga=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;
Ua=document.createRange?function(e,t,n,i){var o=document.createRange();return o.setEnd(i||e,n),o.setStart(e,t),o}:function(e,t,n){var i=document.body.createTextRange();try{i.moveToElementText(e.parentNode)}catch(o){return i}return i.collapse(!0),i.moveEnd("character",n),i.moveStart("character",t),i};var Ka=e.contains=function(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do if(11==t.nodeType&&(t=t.host),t==e)return!0;while(t=t.parentNode)};yr&&11>wr&&(Vo=function(){try{return document.activeElement}catch(e){return document.body}});var Xa,Ya,Qa=e.rmClass=function(e,t){var n=e.className,i=Go(t).exec(n);if(i){var o=n.slice(i.index+i[0].length);e.className=n.slice(0,i.index)+(o?i[1]+o:"")}},Ja=e.addClass=function(e,t){var n=e.className;Go(t).test(n)||(e.className+=(n?" ":"")+t)},Za=!1,es=function(){if(yr&&9>wr)return!1;var e=Wo("div");return"draggable"in e||"dragDrop"in e}(),ts=e.splitLines=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],i=e.length;i>=t;){var o=e.indexOf("\n",t);-1==o&&(o=e.length);var r=e.slice(t,"\r"==e.charAt(o-1)?o-1:o),a=r.indexOf("\r");-1!=a?(n.push(r.slice(0,a)),t+=a+1):(n.push(r),t=o+1)}return n}:function(e){return e.split(/\r\n?|\n/)},ns=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(n){}return t&&t.parentElement()==e?0!=t.compareEndPoints("StartToEnd",t):!1},is=function(){var e=Wo("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),os=null,rs=e.keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};!function(){for(var e=0;10>e;e++)rs[e+48]=rs[e+96]=String(e);for(var e=65;90>=e;e++)rs[e]=String.fromCharCode(e);for(var e=1;12>=e;e++)rs[e+111]=rs[e+63235]="F"+e}();var as,ss=function(){function e(e){return 247>=e?n.charAt(e):e>=1424&&1524>=e?"R":e>=1536&&1773>=e?i.charAt(e-1536):e>=1774&&2220>=e?"r":e>=8192&&8203>=e?"w":8204==e?"b":"L"}function t(e,t,n){this.level=e,this.from=t,this.to=n}var n="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",i="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",o=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,r=/[stwN]/,a=/[LRr]/,s=/[Lb1n]/,l=/[1n]/,c="L";return function(n){if(!o.test(n))return!1;for(var i,d=n.length,u=[],p=0;d>p;++p)u.push(i=e(n.charCodeAt(p)));for(var p=0,f=c;d>p;++p){var i=u[p];"m"==i?u[p]=f:f=i}for(var p=0,h=c;d>p;++p){var i=u[p];"1"==i&&"r"==h?u[p]="n":a.test(i)&&(h=i,"r"==i&&(u[p]="R"))}for(var p=1,f=u[0];d-1>p;++p){var i=u[p];"+"==i&&"1"==f&&"1"==u[p+1]?u[p]="1":","!=i||f!=u[p+1]||"1"!=f&&"n"!=f||(u[p]=f),f=i}for(var p=0;d>p;++p){var i=u[p];if(","==i)u[p]="N";else if("%"==i){for(var m=p+1;d>m&&"%"==u[m];++m);for(var g=p&&"!"==u[p-1]||d>m&&"1"==u[m]?"1":"N",v=p;m>v;++v)u[v]=g;p=m-1}}for(var p=0,h=c;d>p;++p){var i=u[p];"L"==h&&"1"==i?u[p]="L":a.test(i)&&(h=i)}for(var p=0;d>p;++p)if(r.test(u[p])){for(var m=p+1;d>m&&r.test(u[m]);++m);for(var b="L"==(p?u[p-1]:c),y="L"==(d>m?u[m]:c),g=b||y?"L":"R",v=p;m>v;++v)u[v]=g;p=m-1}for(var w,x=[],p=0;d>p;)if(s.test(u[p])){var k=p;for(++p;d>p&&s.test(u[p]);++p);x.push(new t(0,k,p))}else{var C=p,T=x.length;for(++p;d>p&&"L"!=u[p];++p);for(var v=C;p>v;)if(l.test(u[v])){v>C&&x.splice(T,0,new t(1,C,v));var _=v;for(++v;p>v&&l.test(u[v]);++v);x.splice(T,0,new t(2,_,v)),C=v}else++v;p>C&&x.splice(T,0,new t(1,C,p))}return 1==x[0].level&&(w=n.match(/^\s+/))&&(x[0].from=w[0].length,x.unshift(new t(0,0,w[0].length))),1==Mo(x).level&&(w=n.match(/\s+$/))&&(Mo(x).to-=w[0].length,x.push(new t(0,d-w[0].length,d))),2==x[0].level&&x.unshift(new t(1,x[0].to,x[0].to)),x[0].level!=Mo(x).level&&x.push(new t(x[0].level,d,d)),x}}();return e.version="5.14.2",e})},function(e,t,n){var i=n(1),o=n(7),r=function(e){console.info("route to be parsed: "+e);var t=[],n="",i=e.split("#"),o=1==i.length?i[0]:i[1],r=o.split("?"),a=r[0]||n,s=r[1]||"",l={};l.route=a,l.expression=-1!=a.indexOf("_"),l.expression?(l.routeKey=a.replace(/_(\w+)/g,"_"),l.paramList=a.match(/_(\w+)/g)):(l.routeKey=a,l.paramList=[]);for(var c=l.paramList.length,d=0;c>d;d++)l.paramList[d]=l.paramList[d].slice(l.paramList[d].indexOf("_")+1);var u={};s&&s.split("&").forEach(function(e){var t=e.split("=");u[t[0]]=t[1]||""}),l.query=u;var p=a.split("/");return l.module=p[0]||"",l.topic=p[1]||"",l.subModule=p[2]||"",l.subTopic=p[3]||"",t.push(l),t},a=function(e){i.observable(this),this.history=[],this.routeMap={},this.routeViewCache={},this.defaultHash=e&&e.defaultHash||""},s={init:function(){var e=this;i.route.parser(r),i.route(e._doRoute.bind(e)),this.on("before-view-route-to",e._doBeforeViewRouteTo.bind(e)),this.on("view-route-to",e._doViewRouteTo.bind(e)),this.on("view-route-back",e._doViewRouteBack.bind(e)),window.prdOrNot?window.onload=function(){e.trigger("init")}:i.compile(function(){e.trigger("init")})},route:function(e,t){var n={};if(n.route=e,n.handler=t,n.expression=-1!=e.indexOf(":"),n.expression){var i=e.match(/_(:\w+)/g);n.routeKey=e.replace(/_(:\w+)/g,"_");for(var o=i.length,r=0;o>r;r++)i[r]=i[r].slice(i[r].indexOf("_:")+2);n.paramNames=i}else n.paramNames=[],n.routeKey=e;this.routeMap[n.routeKey]=n,console.info("a route rule is added:"),console.info(n)},routeView:function(e,t){var n=this;this.route(e,function(e){var i=n.routeViewCache[t.name];i||(i=n.routeViewCache[t.name]=t,i.setParent(n),i.init(e)),i.context=e,n.trigger("before-view-route-to",i),i.route(e)})},currentTrigger:function(){var e=this.currentView&&this.currentView.tag;e&&e.trigger.apply(e,arguments)},_doBeforeViewRouteTo:function(e){this.currentView==e&&this.currentView.equalRoute(e)?this.currentView&&this.currentView.reenter():(this.currentView&&this.currentView.leave(this.currentView,e),e.enter(this.currentView,e))},_doViewRouteTo:function(e){this.currentView&&this.currentView.show(!1),this.lastView=this.currentView,this.currentView=e,this.currentView&&this.currentView.show(!0)},_doViewRouteBack:function(e){this.lastView&&this.lastView.context&&i.route(this.lastView.context.req.route)},_doRoute:function(e){var t=this,n={app:t,req:e},i=t.routeMap[e.routeKey];if(i){var o={};if(i.expression)for(var r=i.paramNames.length,a="",s=0;r>s;s++)a=i.paramNames[s],o[a]=e.paramList[s]||null;e.params=o;var l=i.handler;if(l)try{l(n)}catch(c){console.error(c),console.error("500 on "+e.route+" :"+c.message),t.trigger("500",e,c)}else console.info("404 on "+e.route),t.trigger("404",e)}else console.info("404 on "+e.route),t.trigger("404",e)},emptyFn:function(){}};o.extend(a.prototype,s),e.exports=a}]);