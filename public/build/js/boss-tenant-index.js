webpackJsonp([0,1],[function(t,e,n){var i=n(1);window.riot=i,n(2)();var o=(n(3).init(),n(7)),r=n(28),a=new r({defaultHash:"tenant"});a.routeView("tenant",nest.viewable({name:"tenant",mount:function(t){var e=i.mount("boss-tenant",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",t.req.query)}})),a.routeView("sd",nest.viewable({name:"sd",mount:function(t){var e=i.mount("boss-tenant-sd",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",t.req.query)}})),a.routeView("sd/courses",nest.viewable({name:"sd/courses",mount:function(t){var e=i.mount("boss-tenant-sd-courses",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",t.req.query)}})),a.routeView("sd/bespeaks",nest.viewable({name:"boss-tenant-sd-bespeaks",mount:function(t){var e=i.mount("boss-tenant-sd-bespeaks",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",t.req.query)}})),a.routeView("sd/catalogs",nest.viewable({name:"boss-tenant-sd-catalogs",mount:function(t){var e=i.mount("boss-tenant-sd-catalogs",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",t.req.query)}})),a.routeView("sd/catalogs/add",nest.viewable({name:"boss-tenant-sd-catalogs-add",mount:function(t){var e=i.mount("boss-tenant-sd-catalogs-add",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",t.req.query)}})),a.routeView("sd/catalogs/edit/_:id",nest.viewable({name:"boss-tenant-sd-catalogs-edit",mount:function(t){var e=i.mount("boss-tenant-sd-catalogs-edit",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",t)}})),a.routeView("sd/catalogs/_:id",nest.viewable({name:"boss-tenant-sd-catalogs-detail",mount:function(t){var e=i.mount("boss-tenant-sd-catalogs-detail",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",t)}})),a.routeView("sd/customers",nest.viewable({name:"boss-tenant-sd-customers",mount:function(t){var e=i.mount("boss-tenant-sd-customers",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",t.req.query)}})),a.routeView("sd/splitbill",nest.viewable({name:"boss-tenant-sd-splitbill",mount:function(t){var e=i.mount("boss-tenant-sd-splitbill",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",t.req.query)}})),a.routeView("sd/distributors",nest.viewable({name:"boss-tenant-sd-distributors",mount:function(t){var e=i.mount("boss-tenant-sd-distributors",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",t.req.query)}})),a.routeView("sd/courses/_:id",nest.viewable({name:"boss-tenant-sd-courses-detail",mount:function(t){var e=i.mount("boss-tenant-sd-courses-detail",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",t)}})),a.routeView("sd/courses/add",nest.viewable({name:"sd/courses/add",mount:function(t){var e=i.mount("boss-tenant-sd-courses-add",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",t.req.query)}})),a.routeView("sd/courses/edit/_:id",nest.viewable({name:"boss-tenant-sd-courses-edit",mount:function(t){var e=i.mount("boss-tenant-sd-courses-edit",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",t)}})),a.routeView("sd/courses/edit/details/_:id",nest.viewable({name:"boss-tenant-sd-courses-edit-detail",mount:function(t){var e=i.mount("boss-tenant-sd-courses-edit-detail",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",t)}})),a.routeView("wechatsite",nest.viewable({name:"wechatsite",mount:function(t){var e=i.mount("boss-tenant-wechatsite",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",t.req.query)}})),a.routeView("wechatsite/_:id",nest.viewable({name:"wechatsite/_:id",mount:function(t){var e=i.mount("boss-wechatsite",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",{id:t.req.params.id})}})),a.routeView("wechatsite/edit/_:id",nest.viewable({name:"wechatsite/edit/_:id",mount:function(t){var e=i.mount("boss-wechatsite-edit",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",{id:t.req.params.id})}})),a.routeView("wechatsite/add",nest.viewable({name:"wechatsite/add",mount:function(t){var e=i.mount("boss-wechatsite-add",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",t.req.query)}})),a.routeView("power/list",nest.viewable({name:"power/list",mount:function(t){var e=i.mount("boss-tenant-power-list",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",t.req.query)}})),a.routeView("power/edit/_:id",nest.viewable({name:"power/edit/_:id",mount:function(t){var e=i.mount("boss-tenant-power-edit",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",{id:t.req.params.id})}})),a.routeView("power/add",nest.viewable({name:"power/add",mount:function(t){var e=i.mount("boss-tenant-power-add",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open")}})),a.routeView("sd/orders",nest.viewable({name:"boss-tenant-sd-orders",mount:function(t){var e=i.mount("boss-tenant-sd-orders",{filter:t.req.query,app:this.parent});this.tag=e[0]},route:function(t){this.context=t,this.tag.trigger("open",t.req.query)}})),a.on("init",function(){var t=o.getCookie("attentionUrl"),e=t||window.location.hash;e||(e=a.defaultHash),window.app=a,i.mount("boss-tenant-topbar"),i.mount("confirm"),i.mount("showimg"),i.route(e),t&&o.setCookie("attentionUrl","",-1)}),a.init(),t.exports=a},function(t,e,n){!function(){function e(t){var e={val:t},n=t.split(/\s+in\s+/);return n[1]&&(e.val=x(0)+n[1],n=n[0].slice(x(0).length).trim().split(/,\s*/),e.key=n[0],e.pos=n[1]),e}function n(t,e,n){var i={};return i[t.key]=e,t.pos&&(i[t.pos]=n),i}function i(t,i,o){function r(t,e,n){f.splice(t,0,e),h.splice(t,0,n)}u(t,"each");var s,l=t.outerHTML,c=t.previousSibling,p=t.parentNode,f=[],h=[];o=e(o),i.one("update",function(){p.removeChild(t)}).one("premount",function(){p.stub&&(p=i.root)}).on("update",function(){var t=k(o.val,i);if(t){if(!Array.isArray(t)){var e=JSON.stringify(t);if(e==s)return;s=e,d(h,function(t){t.unmount()}),f=[],h=[],t=Object.keys(t).map(function(e){return n(o,e,t[e])})}d(m(f,t),function(t){var e=f.indexOf(t),n=h[e];n&&(n.unmount(),f.splice(e,1),h.splice(e,1))});var u=p.childNodes,g=[].indexOf.call(u,c);d(t,function(e,c){var d=t.indexOf(e,c),m=f.indexOf(e,c);if(0>d&&(d=t.lastIndexOf(e,c)),0>m&&(m=f.lastIndexOf(e,c)),0>m){!s&&o.key&&(e=n(o,e,d));var v=new a({tmpl:l},{before:u[g+1+d],parent:i,root:p,item:e});return v.mount(),r(d,e,v)}return o.pos&&h[m][o.pos]!=d&&(h[m].one("update",function(t){t[o.pos]=d}),h[m].update()),d!=m?(p.insertBefore(u[g+m+1],u[g+d+1]),r(d,f.splice(m,1)[0],h.splice(m,1)[0])):void 0}),f=t.slice()}})}function o(t,e,n){h(t,function(t){if(1==t.nodeType){var i=v(t);if(i&&!t.getAttribute("each")){var o=new a(i,{root:t,parent:e});e.tags[t.getAttribute("name")||i.name]=o,n.push(o)}d(t.attributes,function(n){/^(name|id)$/.test(n.name)&&(e[n.value]=t)})}})}function r(t,e,n){function o(t,e,i){if(e.indexOf(x(0))>=0){var o={dom:t,expr:e};n.push(p(o,i))}}h(t,function(t){var n=t.nodeType;if(3==n&&"STYLE"!=t.parentNode.tagName&&o(t,t.nodeValue),1==n){var r=t.getAttribute("each");return r?(i(t,e,r),!1):(d(t.attributes,function(e){var n=e.name,i=n.split("__")[1];return o(t,e.value,{attr:i||n,bool:i}),i?(u(t,n),!1):void 0}),v(t)?!1:void 0)}})}function a(t,e){function n(t){d(Object.keys(C),function(t){l[t]=k(C[t],h||s)})}function i(t){if(d(v,function(e){e[t?"mount":"unmount"]()}),h){var e=t?"on":"off";h[e]("update",s.update)[e]("unmount",s.unmount)}}var a,s=w.observable(this),l=g(e.opts)||{},u=f(t.tmpl),h=e.parent,m=[],v=[],b=e.root,y=e.item,x=t.fn,C={};x&&b.riot||(b.riot=!0,p(this,{parent:h,root:b,opts:l,tags:{}},y),d(b.attributes,function(t){C[t.name]=t.value}),this.update=function(t,e){p(s,t,y),n(),s.trigger("update",y),c(m,s,y),s.trigger("updated")},this.mount=function(){if(n(),x&&x.call(s,l),i(!0),r(u,s,m),s.update(),s.trigger("premount"),x)for(;u.firstChild;)b.appendChild(u.firstChild);else a=u.firstChild,b.insertBefore(a,e.before||null);b.stub&&(s.root=b=h.root),s.trigger("mount")},this.unmount=function(){var t=x?b:a,e=t.parentNode;if(e){if(h)e.removeChild(t);else for(;b.firstChild;)b.removeChild(b.firstChild);i(),s.trigger("unmount"),s.off("*"),delete b.riot}},o(u,this,v))}function s(t,e,n,i,o){n[t]=function(t){t=t||window.event,t.which=t.which||t.charCode||t.keyCode,t.target=t.target||t.srcElement,t.currentTarget=n,t.item=o,e.call(i,t)!==!0&&(t.preventDefault&&t.preventDefault(),t.returnValue=!1);var r=o?i.parent:i;r.update()}}function l(t,e,n){t&&(t.insertBefore(n,e),t.removeChild(e))}function c(t,e,n){d(t,function(t){var i=t.dom,o=t.attr,r=k(t.expr,e),a=t.dom.parentNode;if(null==r&&(r=""),a&&"TEXTAREA"==a.tagName&&(r=r.replace(/riot-/g,"")),t.value!==r){if(t.value=r,!o)return i.nodeValue=r;if(u(i,o),"function"==typeof r)s(o,r,i,e,n);else if("if"==o){var c=t.stub;r?c&&l(c.parentNode,c,i):(c=t.stub=c||document.createTextNode(""),l(i.parentNode,i,c))}else if(/^(show|hide)$/.test(o))"hide"==o&&(r=!r),i.style.display=r?"":"none";else if("value"==o)i.value=r;else if("riot-"==o.slice(0,5))o=o.slice(5),r?i.setAttribute(o,r):u(i,o);else{if(t.bool){if(i[o]=r,!r)return;r=o}"object"!=typeof r&&i.setAttribute(o,r)}}})}function d(t,e){for(var n,i=0,o=(t||[]).length;o>i;i++)n=t[i],null!=n&&e(n,i)===!1&&i--;return t}function u(t,e){t.removeAttribute(e)}function p(t,e,n){return e&&d(Object.keys(e),function(n){t[n]=e[n]}),n?p(t,n):t}function f(t){var e=t.trim().slice(1,3).toLowerCase(),n=/td|th/.test(e)?"tr":"tr"==e?"tbody":"div",i=document.createElement(n);return i.stub=!0,i.innerHTML=t,i}function h(t,e){if(t)if(e(t)===!1)h(t.nextSibling,e);else for(t=t.firstChild;t;)h(t,e),t=t.nextSibling}function m(t,e){return t.filter(function(t){return e.indexOf(t)<0})}function g(t){function e(){}return e.prototype=t,new e}function v(t){return T[t.tagName.toLowerCase()]}function b(t){var e=document.createElement("style");e.innerHTML=t,document.head.appendChild(e)}function y(t,e,n){var i=T[e];return i&&t&&(i=new a(i,{root:t,opts:n})),i&&i.mount?(i.mount(),C.push(i),i.on("unmount",function(){C.splice(C.indexOf(i),1)})):void 0}var w={version:"WIP",settings:{}};w.observable=function(t){t=t||{};var e={},n=0;return t.on=function(i,o){return"function"==typeof o&&(o._id="undefined"==typeof o._id?n++:o._id,i.replace(/\S+/g,function(t,n){(e[t]=e[t]||[]).push(o),o.typed=n>0})),t},t.off=function(n,i){return"*"==n?e={}:n.replace(/\S+/g,function(t){if(i)for(var n,o=e[t],r=0;n=o&&o[r];++r)n._id==i._id&&(o.splice(r,1),r--);else e[t]=[]}),t},t.one=function(e,n){return n&&(n.one=1),t.on(e,n)},t.trigger=function(n){for(var i,o=[].slice.call(arguments,1),r=e[n]||[],a=0;i=r[a];++a)i.busy||(i.busy=1,i.apply(t,i.typed?[n].concat(o):o),i.one?(r.splice(a,1),a--):r[a]!==i&&a--,i.busy=0);return t},t},function(t,e){function n(){return a.hash.slice(1)}function i(t){return t.split("/")}function o(t){t.type&&(t=n()),t!=r&&(s.trigger.apply(null,["H"].concat(i(t))),r=t)}if(this.top){var r,a=location,s=t.observable(),l=window,c=t.route=function(t){t[0]?(a.hash=t,o(t)):s.on("H",t)};c.exec=function(t){t.apply(null,i(n()))},c.parser=function(t){i=t},l.addEventListener?l.addEventListener(e,o,!1):l.attachEvent("on"+e,o)}}(w,"hashchange");var x=function(t,e,n){return function(i){return e=w.settings.brackets||t,n!=e&&(n=e.split(" ")),i&&i.test?e==t?i:RegExp(i.source.replace(/\{/g,n[0].replace(/(?=.)/g,"\\")).replace(/\}/g,n[1].replace(/(?=.)/g,"\\")),i.global?"g":""):n[i]}}("{ }"),k=function(){function t(t,n){return t=(t||x(0)+x(1)).replace(x(/\\{/g),"￰").replace(x(/\\}/g),"￱"),n=i(t,x(/{[\s\S]*?}/g)),new Function("d","return "+(n[0]||n[2]||n[3]?"["+n.map(function(t,n){return n%2?e(t,!0):'"'+t.replace(/\n/g,"\\n").replace(/"/g,'\\"')+'"'}).join(",")+'].join("")':e(n[1])).replace(/\uFFF0/g,x(0)).replace(/\uFFF1/g,x(1))+";")}function e(t,e){return t=t.replace(/\n/g," ").replace(x(/^[{ ]+|[ }]+$|\/\*.+?\*\//g),""),/^\s*[\w- "']+ *:/.test(t)?"["+t.replace(/\W*([\w- ]+)\W*:([^,]+)/g,function(t,e,i){return i.replace(/[^&|=!><]+/g,n)+'?"'+e.trim()+'":"",'})+'].join(" ").trim()':n(t,e)}function n(t,e){return t=t.trim(),t?"(function(v){try{v="+(t.replace(r,function(t,e,n){return n?"(d."+n+"===undefined?window."+n+":d."+n+")":t})||"x")+"}finally{return "+(e===!0?'!v&&v!==0?"":v':"v")+"}}).call(d)":""}function i(t,e){var n=[],i=0;return t.replace(e,function(e,o){n.push(t.slice(i,o),e),i=o+e.length}),n.concat(t.slice(i))}var o={},r=/(['"\/]).*?[^\\]\1|\.\w*|\w*:|\b(?:(?:new|typeof|in|instanceof) |(?:this|true|false|null|undefined)\b|function *\()|([a-z_$]\w*)/gi;return function(e,n){return e&&(o[e]=o[e]||t(e))(n)}}(),C=[],T={};w.tag=function(t,e,n,i){"function"==typeof n?i=n:n&&b(n),T[t]={name:t,tmpl:e,fn:i}},w.mount=function(t,e,n){function i(t){var i=e||t.tagName.toLowerCase(),r=y(t,i,n);r&&o.push(r)}"*"==t&&(t=Object.keys(T).join(", ")),"object"==typeof e&&(n=e,e=0);var o=[];return t.tagName?(i(t),o[0]):(d(document.querySelectorAll(t),i),o)},w.update=function(){return d(C,function(t){t.update()})},w.mountTo=w.mount,w.util={brackets:x,tmpl:k},t.exports=w}()},function(t,e){t.exports=function(){riot.tag("accordion",'<nav> <ul class="nav nav-pills nav-stacked"> <li role="presentation" class="{active: useAsDefault}" each="{opts.navs}"> <a href="#{path}">{presentation}</a> </li> </ul> </nav>',"accordion ul{ margin: 0px; padding: 0px; }",function(t){}),riot.tag("add-group-member",'<div class="title_wrap"> <b onclick="{backToView}" style="display: block;width:24px;height:24px;float:left" onclick="{back}"> <i class="glyphicon glyphicon-chevron-left"></i> </b> 添加成员 <b onclick="{submit}" style="display: block;width:80px;height:24px;float:right"> <button type="button" class="btn btn-default" style="display:inline-block;background: #42AC3E; color:white; border: none"> 确认添加 </button> </b> </div> <div> <div class="wrapper" attr="{parent.mediaUsers}"> <div style="margin-bottom: 10px"> <button onclick="{selectContact}" class="{select_contact: status[\'contact\']}"> <span class="glyphicon glyphicon-user" aria-hidden="true"></span> 联系人 </button> <button onclick="{selectGroup}" class="{select_contact: status[\'group\']}"> <span class="glyphicon glyphicon-th" aria-hidden="true"></span> 群组 </button> </div> <div each="{parent.mediaUsers}"> <div class="list_container"> <div style="height:24px;line-height: 24px;margin-bottom: 10px;border-bottom:1px solid #ddd">{media.name}<strong>({mediaUsers.length})</strong></div> <ul class="user_list"> <li onclick="{parent.parent.selectMember}" each="{mediaUsers}" if="{parent.parent.status[contacttype]}" id="{_id}" media="{parent.media._id}" group="{parent.parent.parent.group._id}"> <img riot-src="{parent.parent.app.settings.api.url + \'/file?media_id=\' + headimgurl}"> <p style="overflow: hidden;height:24px">{remark}</p> </li> </ul> </div> </div> </div> </div>',"add-group-member .select_contact{ background: #5B6779; border:1px solid #2E3238; color:white; } add-group-member .list_container{ overflow: scroll; height:500px; } add-group-member .wrapper{ width:90%; margin:0px auto; } add-group-member .user_list{ overflow: hidden; list-style-type: none; margin:0px; padding:0px; color:#888; } add-group-member .user_list >li{ width:100px; float:left; margin:5px 0px; text-align: center; line-height: 30px; position: relative; } add-group-member .user_list >li img{ display: inline-block; width:64px; height:64px; } add-group-member .title_wrap{ height:50px; margin:8px 10px; text-align: center; line-height: 50px; } add-group-member .select{ position: absolute; top:0px; left:17px; background:#42AC3E; width:64px; height:64px; opacity: 0.8; } add-group-member .select div{ font-size: 40px; color:white; margin:8px; }",function(t){function e(t){t.success&&(n.members={},t.data&&t.data.length&&t.data.forEach(function(t){n.parent.groupMembers.unshift(t)}),n.parent.panel.view(),n.parent.update())}var n=this;n.page=__page,n.app=__app,n.nav=0,n.members={},n.init=function(){n.status={},n.status.contact="contact"};var i={"基本信息":0,"成员":1},o=domain.action("addGroupMembers");this.on("mount",function(){o.onDone(e)}),this.on("unmount",function(){o.offDone(e)}),this.selectContact=function(t){return n.status.contact?void delete n.status.contact:void(n.status.contact="contact")}.bind(this),this.selectGroup=function(t){return n.status.group?void delete n.status.group:void(n.status.group="group")}.bind(this),this.clickNav=function(t){n.nav=i[t.target.innerText]}.bind(this),this.addMember=function(t){n.parent.panel.status="add_m",n.parent.update()}.bind(this),this.selectMember=function(t){function e(t){if(n.members[a])o(t),delete n.members[a];else{var e={group:s,media:l,member:a};n.members[a]=e,i(t)}}function i(t){var e=document.createElement("div");e.classList.add("select");var n=document.createElement("div");n.classList.add("glyphicon"),n.classList.add("glyphicon-ok"),e.appendChild(n),t.appendChild(e)}function o(t){t.removeChild(t.childNodes[t.childNodes.length-1])}var r=t.currentTarget,a=r.id,s=r.getAttribute("group"),l=r.getAttribute("media");e(r)}.bind(this),this.submit=function(t){Object.keys(n.members).length&&o.execute({members:n.members})}.bind(this),this.backToView=function(t){n.members={},n.parent.panel.view(),n.parent.update()}.bind(this)}),riot.tag("add-group",'<div class="title_wrap"> <b onclick="{backToView}" style="display: block;width:24px;height:24px;float:left" onclick="{back}"> <i class="glyphicon glyphicon-chevron-left"></i> </b> 添加分组 </div> <form id="form"> <div class="profile"> <div class="profile_item row-fluid form-group"> <div class="primary col-md-5 col-xs-5 col-sm-5"> <label>名称</label> </div> <div class="primary col-md-7 col-xs-7 col-sm-7"> <input id="groupName" class="form-control" type="text" placeholder="请输入名称"> </div> </div> <div class="profile_item row-fluid form-group"> <div class="secondary col-md-5 col-xs-5 col-sm-5"> <label>类型</label> </div> <div class="secondary col-md-7 col-xs-7 col-sm-7"> <label class="radio-inline"> <input type="radio" name="inlineRadioOptions" id="inlineRadio1" value="{app.enums.GroupType.names.Selected}" checked> {app.enums.GroupType.values.selected} </label> <label class="radio-inline" style="color:#ccc"> <input type="radio" name="inlineRadioOptions" id="inlineRadio2" value="{app.enums.GroupType.names.Tagged}" disabled> {app.enums.GroupType.values.tagged} </label> </div> </div> <div class="profile_item row-fluid form-group"> <div class="secondary col-md-5 col-xs-5 col-sm-5"> <label>包含微信号</label> </div> <div class="secondary col-md-7 col-xs-7 col-sm-7"> <button each="{parent.myManageMedia}" onclick="{backToView}" type="button" class="btn btn-default" style="display:inline-block;background: #CCC; color:white; border: none"> {name} </button> </div> </div> <div class="profile_item row-fluid form-group"> <div class="secondary col-md-5 col-xs-5 col-sm-5"> <label>负责人</label> </div> <div class="secondary col-md-7 col-xs-7 col-sm-7"> <label>{page.user.nickname}</label> </div> </div> <div class="profile_item"> <button onclick="{submit}" type="button" class="btn btn-default" style="height:40px;width:160px;background: #42AC3E; color:white; border: none"> <span class="glyphicon glyphicon-ok" aria-hidden="true"></span> 确认 </button>&nbsp&nbsp&nbsp&nbsp <button onclick="{backToView}" type="button" class="btn btn-default" style="display:inline-block;height:40px;width:160px;background: #9D9D9D; color:white; border: none"> <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> 返回 </button> </div> </div> </form>',"add-group .profile{ padding-top:80px; margin:0px auto; width:80% } add-group .profile_item{ margin: 0px auto; text-align: center; margin-bottom: 30px; overflow: hidden; } add-group .profile_item div.secondary label{ font-size: 16px; } add-group .profile_item >div:first-child{ text-align: right; } add-group .profile_item >div:nth-child(2){ text-indent: 3em; text-align: left; } add-group .profile_item label{ font-weight:400; font-size: 24px; } add-group .title_wrap{ height:50px; line-height: 50px; margin:8px 10px; text-align: center; border-bottom: 1px solid #ddd; } add-group .tips_wrapper{ width:100%; position: absolute; top:0px; left:0px; overflow: hidden; margin-top:100px; -webkit-transition: opacity 1s ease-in; -moz-transition: opacity 1s ease-in; -ms-transition: opacity 1s ease-in; -o-transition: opacity 1s ease-in; transition: opacity 1s ease-in; } add-group .tips{ width:60%; margin:0px auto; } add-group .fadeout{ opacity: 0; }",function(t){function e(t){i.parent.groups.unshift(t.data),i.parent.group=t.data,i.parent.groupMembers=[],i.backToView()}function n(t,e,n){function o(t,e){t.classList.add(e)}function r(t,e){e.removeChild(t)}var a=null,s=null;n?(a="alert-success",s="glyphicon-ok"):(a="alert-danger",s="glyphicon-exclamation-sign");var l=document.createElement("div");o(l,"tips_wrapper");var c=document.createElement("div");o(c,"alert"),o(c,a),o(c,"tips"),c.setAttribute("role","alert");var d=document.createElement("span");o(d,"glyphicon"),o(d,s),d.setAttribute("aria-hidden","true");var u=document.createElement("span");o(u,"sr-only"),u.innerText="错误:";var p=document.createElement("span");p.innerText=" "+e,c.append=function(t){return c.appendChild(t),c},c.append(d).append(u).insertBefore(p,u.nextSibling),l.appendChild(c),t.appendChild(l),setTimeout(function(){o(l,"fadeout"),setTimeout(function(){r(l,i.form)},1e3)},1e3)}var i=this;i.app=__app,i.page=__page;var o=domain.action("addGroup");this.backToView=function(t){i.groupName.value="",i.parent.panel.status="view",i.parent.tags["group-left"].init(),i.parent.update()}.bind(this),this.on("mount",function(){o.onDone(e)}),this.on("unmount",function(){o.offDone(e)}),this.submit=function(t){if(!i.groupName.value)return void n(i.form,"请输入名称",!1);var e=document.querySelector('input[name="inlineRadioOptions"]:checked'),r={name:i.groupName.value,type:e.value};o.execute(r)}.bind(this)}),riot.tag("adlink-detail",'<div if="{!hidden}"> <div class="container-fluid"> <div class="row-fluid"> <div class="col-sm-12 col-md-12 col-lg-12" > <div id="adlink-msg" class="alert alert-danger alert-dismissible fade in hidden" style="margin-left: 20px;" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button> <h4></h4> <div id="msgs"></div> </div> </div> </div> <div class="row-fluid"> <div class="col-sm-12 col-md-12 col-lg-12" > <form class="form-horizontal" id="adlink-detail"> <input type="hidden" id="id" name="id" value="{adlink._id}"> <div class="form-group"> <label class="col-sm-2 col-md-2 col-lg-2 control-label">名称</label> <div class="col-sm-10 col-md-10 col-lg-10"> <p class="form-control-static">{adlink.name}</p> </div> </div>       <div class="form-group"> <label class="col-sm-2 col-md-2 col-lg-2 control-label">广告图片</label> <div class="col-sm-10 col-md-10 col-lg-10"> <div class="{hidden: !adlink.adpicUrl}"> <img riot-src="{adlink.adpicUrl}" style="width: 100%;"> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 col-md-2 col-lg-2 control-label">广告链接</label> <div class="col-sm-10"> <p class="form-control-static">{adlink.url}</p> </div> </div> <div class="form-group"> <label class="col-sm-2 col-md-2 col-lg-2 control-label">客服电话</label> <div class="col-sm-10 col-md-10 col-lg-10"> <div class="input-group"> <p class="form-control-static">{adlink.phone}</p> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 col-md-2 col-lg-2 control-label">位置</label> <div class="col-sm-10 col-md-10 col-lg-10"> <div class="btn-group"> <p class="form-control-static">{ __app.enums.AdlinkLayout.values[adlink.layout] }</p> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 col-md-2 col-lg-2 control-label">主题</label> <div class="col-sm-10 col-md-10 col-lg-10"> <div class="btn-group"> <p class="form-control-static">{ __app.enums.AdlinkTheme.values[adlink.theme] }</p> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 col-md-2 col-lg-2 control-label">创建时间</label> <div class="col-sm-10 col-md-10 col-lg-10"> <div class="btn-group"> <p class="form-control-static">{ adlink.crtOnText }</p> </div> </div> </div> <div class="form-group"> <div class="col-sm-offset-2 col-md-offset-2 col-lg-offset-2 col-sm-10 col-md-10 col-lg-10"> <button type="button" class="btn btn-primary" onclick="{onEdit}">编辑</button> </div> </div> </form> </div> </div> </div> </div>',"adlink-detail .row-fluid { word-wrap: break-word; }",function(t){function e(t){return t?t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""):""}function n(t){return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}var i=nest.presentable(this);i.api=__app.settings.api.url,i.adlink={};var o=domain.action("loadAdlink"),r=function(t){t.crtOnText=n(new Date(t.crtOn)),i.update({hidden:!1,adlink:t})};this.on("mount",function(){o.onDone(r)}),this.on("unmount",function(){o.offDone(r)}),i.on("open",function(t){t.id?o.execute(t.id):r(t.model)}),i.on("close",function(){i.update({hidden:!0})}),this.onEdit=function(t){i.parent.showEditView(i.adlink._id)}.bind(this),this.onSyncLayout=function(t){$("#adlink-edit #layout").val($(t.currentTarget).find("input").val())}.bind(this),this.onSyncTheme=function(t){$("#adlink-edit #theme").val($(t.currentTarget).find("input").val())}.bind(this),this.onPhoneBlur=function(t){var n=$(t.currentTarget).val();$("#adlink-edit #hasPhone").prop("checked",""!==e(n))}.bind(this)}),riot.tag("adlink-edit",'<div if="{!hidden}"> <div class="container-fluid"> <div class="row-fluid"> <div class="col-sm-12 col-md-12 col-lg-12" > <div id="adlink-msg" class="alert alert-danger alert-dismissible fade in hidden" style="margin-left: 20px;" role="alert"> <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button> <h4></h4> <div id="msgs"></div> </div> </div> </div> <div class="row-fluid"> <div class="col-sm-12 col-md-12 col-lg-12" > <form class="form-horizontal" id="adlink-edit"> <input if="{action==\'edit\'}" type="hidden" id="id" name="id" value="{adlink._id}"> <input if="{action==\'new\'}" type="hidden" id="org" name="org" value="{tenantId}"> <div class="form-group"> <label for="name" class="col-sm-2 col-md-2 col-lg-2 control-label">名称</label> <div class="col-sm-10 col-md-10 col-lg-10"> <input type="text" class="form-control" id="name" placeholder="" value="{adlink.name}"> </div> </div>       <div class="form-group"> <label for="adwords" class="col-sm-2 col-md-2 col-lg-2 control-label">广告图片</label> <div class="col-sm-10 col-md-10 col-lg-10">   <div class="{hidden: adpicMode!=\'select\'}"> <span class="btn btn-default btn-file"> 浏览<input id="img_file" type="file" multiple="multiple" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="{previewImg}"> </span> <div class="{hidden: !adlink.adpicUrl}"> <img riot-src="{adlink.adpicUrl}" style="width: 100%;"> </div> </div> <div class="{hidden: adpicMode!=\'preview\'}" class="panel panel-default" id="img_prew" style="margin-bottom: 10px"> <table class="table table-condensed" style="border: 0px; text-align: center; vertical-align: middle;"> <tbody> <tr> <td colspan="3"><img riot-src="{img_url}" style="width: 100%;"></td> </tr> <tr> <td>{img_name}</td> <td>{img_size}</td> <td>{img_width}*{img_height}</td> </tr> <tr> <td colspan="3"> <input class="btn btn-default" type="button" style="margin-right: 50px" value="取消" onclick="{cancel_send_img}"> <input class="btn btn-success" type="button" value="发送" onclick="{send_img}"> </td> </tr> </tbody> </table> </div> </div> </div> <div class="form-group"> <label for="url" class="col-sm-2 col-md-2 col-lg-2 control-label">广告链接</label> <div class="col-sm-10"> <input type="url" class="form-control" id="url" placeholder="" value="{adlink.url}"> </div> </div> <div class="form-group"> <label for="phone" class="col-sm-2 col-md-2 col-lg-2 control-label">客服电话</label> <div class="col-sm-10 col-md-10 col-lg-10"> <div class="input-group"> <span class="input-group-addon"> <input type="checkbox" aria-label="..." id="hasPhone" __checked="{adlink.phone==\'\' ? \'false\':\'true\'}"> </span> <input type="phone" class="form-control" id="phone" placeholder="" onblur="{onPhoneBlur}" value="{adlink.phone}"> </div> </div> </div> <div class="form-group"> <label for="layout" class="col-sm-2 col-md-2 col-lg-2 control-label">位置</label> <div class="col-sm-10 col-md-10 col-lg-10"> <div class="btn-group" data-toggle="buttons"> <input type="hidden" id="layout" name="layout" value="{adlink.layout ? adlink.layout : \'bottom\'}"> <label class="btn btn-default {!adlink.layout || adlink.layout==\'bottom\' ? \'active\': \'\'}" onclick="{onSyncLayout}"> <input type="radio" name="layoutRadio" id="layoutBottom" autocomplete="off" value="bottom">底部 </label> <label class="btn btn-default {adlink.layout==\'top\' ? \'active\': \'\'}" onclick="{onSyncLayout}"> <input type="radio" name="layoutRadio" id="layoutTop" autocomplete="off" value="top">顶部 </label> </div> </div> </div> <div class="form-group"> <label for="theme" class="col-sm-2 col-md-2 col-lg-2 control-label">主题</label> <div class="col-sm-10 col-md-10 col-lg-10"> <div class="btn-group" data-toggle="buttons"> <input type="hidden" id="theme" name="theme" value="{adlink.theme ? adlink.theme : \'dark\'}"> <label class="btn btn-default {!adlink.theme || adlink.theme==\'dark\' ? \'active\': \'\'}" onclick="{onSyncTheme}"> <input type="radio" name="themeRadio" id="themeDark" autocomplete="off" value="dark">深色 </label> <label class="btn btn-default {adlink.theme==\'light\' ? \'active\': \'\'}" onclick="{onSyncTheme}"> <input type="radio" name="themeRadio" id="themeLight" autocomplete="off" value="light">浅色 </label> </div> </div> </div> <div if="{action==\'edit\'}" class="form-group"> <label for="url" class="col-sm-2 col-md-2 col-lg-2 control-label">创建时间</label> <div class="btn-group"> <p class="form-control-static">{ adlink.crtOnText }</p> </div> </div> <div class="form-group"> <div class="col-sm-offset-2 col-md-offset-2 col-lg-offset-2 col-sm-10 col-md-10 col-lg-10"> <button if="{action==\'new\'}" type="button" class="btn btn-primary" onclick="{onSave}">创建</button> <button if="{action==\'edit\'}" type="button" class="btn btn-primary" onclick="{onSave}">更新</button> </div> </div> </form> </div> </div> </div> </div>',"adlink-edit .btn-file { position: relative; overflow: hidden; } adlink-edit .btn-file input[type=file] { position: absolute; top: 0; right: 0; min-width: 100%; min-height: 100%; font-size: 100px; text-align: right; filter: alpha(opacity=0); opacity: 0; outline: none; background: white; cursor: inherit; display: block; }",function(t){function e(t){return t?t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""):""}function n(t){return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}var i=nest.presentable(this);i.api=__app.settings.api.url,i.adlink={},i.adpicMode="select";var o=domain.action("createAdlink"),r=domain.action("updateAdlink"),a=function(t){i.parent.showDetailView(t),i.parent.onRefresh()},s=domain.action("loadAndEditAdlink"),l=function(t){t.crtOnText=n(new Date(t.crtOn)),i.update({hidden:!1,
adlink:t})};this.on("mount",function(){o.onDone(a),r.onDone(a),s.onDone(l)}),this.on("unmount",function(){o.offDone(a),r.offDone(a),s.offDone(l)}),i.on("open",function(t){i.action=t.action,"new"==t.action?(i.tenantId=t.tenantId,i.adlink={org:t.tenantId},i.update({hidden:!1})):"edit"==t.action&&s.execute(t.id)}),i.on("close",function(){i.update({hidden:!0})}),this.cancel_send_img=function(t){i.adpicMode="select",i.update()}.bind(this),this.previewImg=function(t){var e=t.target.files[0],n=Math.round(e.size/1024);i.img_size=n>=1024?Math.round(n/1024)+"m":n+"k",i.img_name=e.name,i.img_width=0,i.img_height=0;var o=new FileReader;o.onload=function(t){i.img_url=t.target.result;var e=new Image;e.src=t.target.result,e.onload=function(){i.img_width=this.width,i.img_height=this.height,i.update()},i.adpicMode="preview",i.update()},o.readAsDataURL(e)}.bind(this),this.send_img=function(t){var e=new FormData,n=$("#img_file")[0].files;e.append("file",n[0]),$.ajax({url:i.api+"/file/upload",type:"POST",data:e,processData:!1,contentType:!1,success:function(t){i.adlink.adpic=t.media_id,i.adlink.adpicUrl="/api/file?media_id="+t.media_id,i.adpicMode="select",i.update()},error:function(t){console.error("失败:"+JSON.stringify(t))}})}.bind(this);var c={};this.onSave=function(t){var n=[];return c.name=$("#adlink-edit #name").val(),""==e(c.name)&&n.push('<p>"名称"不能为空</p>'),console.log(i.adlink),c.adpic=i.adlink.adpic,c.adpicUrl=i.adlink.adpicUrl,""==e(c.adpic)&&n.push('<p>"广告图片"不能为空</p>'),c.url=$("#adlink-edit #url").val(),""==e(c.url)&&n.push('<p>"广告链接"不能为空</p>'),c.phone=$("#adlink-edit #phone").val(),c.layout=$("#adlink-edit #layout").val(),c.theme=$("#adlink-edit #theme").val(),n.length?($("#adlink-msg #msgs").html(n.join("")),void $("#adlink-msg").removeClass("hidden")):($("#adlink-msg #msgs").html(""),$("#adlink-msg").addClass("hidden"),void("new"==i.action?(c.org=i.tenantId,o.execute(c)):"edit"==i.action&&(c._id=$("#adlink-edit #id").val(),r.execute(c))))}.bind(this),this.onSyncLayout=function(t){$("#adlink-edit #layout").val($(t.currentTarget).find("input").val())}.bind(this),this.onSyncTheme=function(t){$("#adlink-edit #theme").val($(t.currentTarget).find("input").val())}.bind(this),this.onPhoneBlur=function(t){var n=$(t.currentTarget).val();$("#adlink-edit #hasPhone").prop("checked",""!==e(n))}.bind(this)}),riot.tag("adlink-index",'<div if="{!hidden}"> <div class="container-fluid"> <div class="row-fluid"> &nbsp; </div> <div class="row-fluid"> <div class="col-md-4 col-lg-4" > <div class="row-fluid"> <div class="col-md-12 col-lg-12" > <div class="pull-right"> <button class="btn btn-default btn-sm" type="button" onclick="{onRefresh}">刷新</button> <button class="btn btn-default btn-sm" type="button" onclick="{onNew}">新建</button> </div> <table class="table table-striped"> <thead> <tr> <th>名称</th> <th>广告</th> <th>布局</th> </tr> </thead> <tbody> <tr each="{adlinks}"> <td> <a onclick="{parent.onView}"> <input type="hidden" value="{_id}"> {name} </a> </td> <td> <a href="{url}"> <img riot-src="{adpicUrl}" style="width: 200px;"> </a> </td> <td> { __app.enums.AdlinkLayout.values[layout] } </td> </tr> </tbody> </table> </div> </div> </div> <div class="col-md-8 col-lg-8" > <adlink-edit id="edit"></adlink-edit> <adlink-detail id="detail"></adlink-detail> </div> </div> </div> </div>',function(t){"use strict";this.app=this.opts.app;var e=nest.presentable(this);e.api=__app.settings.api.url,e.tenantId=this.opts.tenant;var n=e.tags["adlink-edit"],i=e.tags["adlink-detail"],o=domain.action("findTenantAdlinks"),r=function(t){e.update({adlinks:t})};this.on("mount",function(){o.onDone(r)}),this.on("unmount",function(){o.offDone(r)}),this.on("open",function(t){console.info("tag adlink-index is opening"),e.trigger("ready",!1),e.trigger("view-route-to"),o.execute(e.tenantId)}),this.on("leave",function(){e.mask=!0,e.update()}),this.on("reenter",function(){e.mask=!1,e.update()}),this.on("refresh",function(){onRefresh()}),this.onRefresh=function(t){o.execute(e.tenantId)}.bind(this),this.onNew=function(t){i.trigger("close"),n.trigger("open",{action:"new",tenantId:e.tenantId})}.bind(this),this.onView=function(t){var e=$(t.currentTarget).find("input[type=hidden]").val();n.trigger("close"),i.trigger("open",{id:e})}.bind(this),this.showEditView=function(t){i.trigger("close"),n.trigger("open",{action:"edit",id:t})},this.showDetailView=function(t){n.trigger("close"),i.trigger("open",{model:t})}}),riot.tag("alert",'<div class="alert-container" if="{opts.validators.length}"> <div style="width: 300px; margin: 0px auto;" class="alert {alert-warning: !opts.validator.success, alert-success: opts.validator.success} alert-dismissible fade in" role="alert"> <button onclick="{onCancel}" type="button" class="close" aria-label="Close"><span aria-hidden="true">×</span></button> <p each="{validator in opts.validators}"><strong>{validator.field && (\'【\' + validator.field + \'】\')}</strong> {validator.desc}</p> </div> </div>',"alert .alert-container{ top: 60px; width: 100%; }",function(t){var e=this;this.onCancel=function(t){e.opts.clear(),e.update()}}),riot.tag("boss-tenant-power-add",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <alert validators="{validators}" clear="{clear}"></alert> <div class="col-md-10 col-md-offset-1"> <div class="jumbotron" style="height: auto; padding: 25px;"> <div id="addForm" class="panel" style="margin-top: 1em;"> <div style="padding-left: 20px; padding-bottom: 20px; padding-top: 15px"><a href="#power/list" style="font-size: 15px; text-decoration: none;">返回活动列表</a></div> <ul class="ul" style="text-align: left; padding-left: 2em"> <li><span>助力活动设置</span></li> <li> <span>活动公众号: </span> <select id="selectMedia" > <option each="{wechatMedias}" value="{originalId}" __selected="{patent.activity.wechatId = originalId}">{name}</option> </select> </li> <li id="type_select"><span>类型: </span> <label><input id="type_rp" name="activity_type" type="radio" value="rp" __checked="{activity.type === \'rp\'}">红包</label> <label><input id="type_po" name="activity_type" type="radio" value="po" __checked="{activity.type === \'po\'}">积分</label> </li> <li><span>启动图片助力: </span><input name="withPic" type="checkbox" __checked="{activity.withPic === \'true\'}" onclick="{toggleWithPic}"></li> <li id="poster" if="{activity.withPic === \'true\'}" style="clear: both; min-height: 26px;"><span style="float: left">海报背景图片: </span><input if="{!activity.posterBgImg}" id="posterBgImg" type="file" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="{uploadPosterBgImg}" style="width: 60px;"> <div if="{activity.posterBgImg}" class="posterBgImgCon"><i onclick="{deletePosterBgImg}" class="glyphicon glyphicon-remove"></i><img riot-src="{activity.posterBgImg}" alt=""></div> </li> <li><span>活动名称: </span><input name="activityName" type="text" value="{activity.name}"></li> <li class="bgImg" style="min-height: 26px"><span style="float: left">背景图片(3张): </span><input if="{activity.bgImg.length != 3}" id="bgImg" type="file" multiple="multiple" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="{uploadBgImg}" style="width: 60px;"> <div if="{activity.bgImg.length >= 1}" class="bgImgCon"><i onclick="{deleteBgImg}" class="glyphicon glyphicon-remove"></i><img riot-src="{activity.bgImg[0]}" alt=""></div> <div if="{activity.bgImg.length >= 2}" class="bgImgCon"><i onclick="{deleteBgImg}" class="glyphicon glyphicon-remove"></i><img riot-src="{activity.bgImg[1]}" alt=""></div> <div if="{activity.bgImg.length >= 3}" class="bgImgCon"><i onclick="{deleteBgImg}" class="glyphicon glyphicon-remove"></i><img riot-src="{activity.bgImg[2]}" alt=""></div> </li> <li style="clear: both; min-height: 26px"><span style="float: left">分享卡片图片: </span><input if="{!activity.shareImg}" id="shareImg" type="file" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="{uploadShareImg}" style="width: 60px;"> <div if="{activity.shareImg}" class="shareImgCon"><i onclick="{deleteShareImg}" class="glyphicon glyphicon-remove"></i><img riot-src="{activity.shareImg}" alt=""></div> </li> <li style="clear: both"><span>活动时间: </span><input id="startTime" type="date" value="{formatDate(activity.startTime)}"><span> 至 </span><input id="endTime" type="date" value="{formatDate(activity.endTime)}"> </li> <li><span>活动介绍: </span><div id="desc"></div></li> <li><span>活动规则: </span><div id="rule"></div></li> <li><span>分享标题自定义: </span><input class="form-control" type="text" name="shareTitle" value="{activity.shareTitle}"></li> <li><span>分享描述自定义: </span><input class="form-control" type="text" name="shareDesc" value="{activity.shareTitle}"></li> <li><span>基础奖励: </span><input id="base_power" type="text" value="{activity.base_power}"></li> <li><span>好友助力单次奖励: </span><input name="friend_help_min_power" type="text" value="{activity.friend_help_min_power}"><span> 至 </span><input name="friend_help_max_power" type="text" value="{activity.friend_help_max_power}"></li> <li><span>好友助力上限人数: </span><input name="friend_help_count_limit" type="text" value="{activity.friend_help_count_limit}"></li> <li style="text-align: center; margin-top: 1em"><input class="btn btn-success" type="button" onclick="{submit}" value="提交"></li> </ul> </div> </div> </div> </div> </div>',"boss-tenant-power-add .ul {list-style-type: none; text-align: center; padding: 0} boss-tenant-power-add .ul li {margin-bottom: 20px;} boss-tenant-power-add .bgImg #bgImg {float: left; margin-left: 10px;} boss-tenant-power-add .bgImg .bgImgCon {margin-left: 10px; display: -webkit-inline-box; position: relative; border: solid 1px #E8E7E7;} boss-tenant-power-add .bgImgCon i{color: #EC3131; position: absolute; left: 58px; top: 2px; cursor: pointer;} boss-tenant-power-add .bgImgCon div{margin-left: 20px; float: left;} boss-tenant-power-add .bgImgCon img {width: 75px; height: 75px;} boss-tenant-power-add .shareImgCon img {width: 75px; height: 75px;} boss-tenant-power-add #shareImg{float: left; margin-left: 10px;} boss-tenant-power-add .shareImgCon i{color: #EC3131;position: absolute;left: 58px;top: 2px;cursor: pointer;} boss-tenant-power-add .shareImgCon{margin-left: 10px; display: -webkit-inline-box;position: relative; border: solid 1px #E8E7E7;} boss-tenant-power-add .posterBgImgCon img {width: 75px; height: 75px;} boss-tenant-power-add #posterBgImg{float: left; margin-left: 10px;} boss-tenant-power-add .posterBgImgCon i{color: #EC3131;position: absolute;left: 58px;top: 2px;cursor: pointer;} boss-tenant-power-add .posterBgImgCon{margin-left: 10px; display: -webkit-inline-box;position: relative; border: solid 1px #E8E7E7;}",function(t){"use strict";function e(t,e){if(n.validators=[],t.size>2097152)return void n.validators.push({success:!1,field:"提示",desc:"文件大小超过限制-2M"});var i=new FormData;i.append("file",t),$.ajax({url:__app.settings.api.url+"/file/upload",type:"POST",data:i,processData:!1,contentType:!1,success:function(t){e(null,t)},error:function(t){e(t,null)}})}var n=nest.presentable(this);n.validators=[];var i=domain.action("addPowerActivity"),o=domain.action("loadAllTenantWechatSite");n.activity={org:__page.tenantId,type:"rp",bgImg:[]},n.on("open",function(t){n.trigger("ready",!1),n.trigger("view-route-to"),setTimeout(function(){$("#rule").summernote({height:200,minHeight:null,maxHeight:null,toolbar:[["style",["bold","italic","underline","clear"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["fontname",["fontname"]],["insert",["picture","link","video","hr","table"]]],callbacks:{onImageUpload:function(t){r(t[0],"#rule")}}}).summernote("code",n.activity.rule||"")},10),setTimeout(function(){$("#desc").summernote({height:200,minHeight:null,maxHeight:null,toolbar:[["style",["bold","italic","underline","clear"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["fontname",["fontname"]],["insert",["picture","link","video","hr","table"]]],callbacks:{onImageUpload:function(t){r(t[0],"#desc")}}}).summernote("code",n.activity.desc||"")},10),o.newInvocation(__page.tenantId).onDone(function(t){n.wechatMedias=t,n.update()}).execute()}),n.on("mount",function(){n.validators=_.widget.validatify([])}),n.formatDate=function(t){var e=new Date(t),n=e.getFullYear(),i=e.getMonth()+1>9?e.getMonth()+1:"0"+(e.getMonth()+1),o=e.getDate()>9?e.getDate():"0"+e.getDate();return n+"-"+i+"-"+o},n.uploadPosterBgImg=function(t){var i=t.currentTarget.files[0];e(i,function(t,e){return t?console.error("upload file err in func uploadPosterBgImg, err: "+t):(n.activity.posterBgImg=window.__app.settings.api.url+"/file?media_id="+e.media_id,void n.update())})},n.uploadBgImg=function(t){var i=t.currentTarget.files;if(n.validators=[],i.length>3-n.activity.bgImg.length)return void n.validators.push({success:!1,field:"提示",desc:"最多上传三张背景图片"});for(var o=0;o<i.length;o++)e(i[o],function(t,e){return t?console.error("upload file err in func uploadBgImg, err: "+t):(n.activity.bgImg.push(window.__app.settings.api.url+"/file?media_id="+e.media_id),void n.update())})},n.uploadShareImg=function(t){var i=t.currentTarget.files[0];e(i,function(t,e){return t?console.error("upload file err in func uploadShareImg, err: "+t):(n.activity.shareImg=window.__app.settings.api.url+"/file?media_id="+e.media_id,void n.update())})},n.deleteBgImg=function(t){n.activity.bgImg=n.activity.bgImg.filter(function(e){return e!=$($(t.currentTarget).siblings("img")[0]).attr("src")})},n.deletePosterBgImg=function(t){n.activity.posterBgImg=""},n.deleteShareImg=function(t){n.activity.shareImg=""},n.clear=function(){n.validators=[]},n.toggleWithPic=function(t){return $(t.currentTarget).is(":checked")?n.activity.withPic="true":n.activity.withPic="false",!0},n.verify=function(t){var e=!0;return t.name||(n.validators.push({success:!1,field:"提示",desc:"活动名称不能为空!"}),e=!1),t.shareDesc||(n.validators.push({success:!1,field:"提示",desc:"分享描述不能为空!"}),e=!1),t.shareTitle||(n.validators.push({success:!1,field:"提示",desc:"分享标题不能为空!"}),e=!1),t.withPic&&!t.posterBgImg&&(n.validators.push({success:!1,field:"提示",desc:"必须上传海报背景图片!"}),e=!1),t.shareImg||(n.validators.push({success:!1,field:"提示",desc:"必须设置分享卡片图片!"}),e=!1),(!t.bgImg||t.bgImg.length<1)&&(n.validators.push({success:!1,field:"提示",desc:"必须设置背景图片!"}),e=!1),t.startTime||(n.validators.push({success:!1,field:"提示",desc:"必须设置活动开始时间!"}),e=!1),t.endTime||(n.validators.push({success:!1,field:"提示",desc:"必须设置活动结束时间!"}),e=!1),t.base_power&&/^[0-9]+$/.test(t.base_power)||(n.validators.push({success:!1,field:"提示",desc:"基础奖励必填且必须为数字!"}),e=!1),t.friend_help_count_limit&&/^[0-9]+$/.test(t.friend_help_count_limit)||(n.validators.push({success:!1,field:"提示",desc:"好友助力上限必填且必须为数字!"}),e=!1),t.friend_help_max_power&&/^[0-9]+$/.test(t.friend_help_max_power)||(n.validators.push({success:!1,field:"提示",desc:"单次助力最大值必填且必须为数字!"}),e=!1),t.friend_help_min_power&&/^[0-9]+$/.test(t.friend_help_min_power)||(n.validators.push({success:!1,field:"提示",desc:"单次助力最小值必填且必须为数字!"}),e=!1),e},n.submit=function(t){n.validators=[],n.activity.type=$(':radio[name="activity_type"]:checked').val(),n.activity.name=n.activityName.value,n.activity.shareTitle=n.shareTitle.value,n.activity.shareDesc=n.shareDesc.value,n.activity.base_power=n.base_power.value,n.activity.friend_help_count_limit=n.friend_help_count_limit.value,n.activity.startTime=n.startTime.value,n.activity.endTime=n.endTime.value,n.activity.friend_help_min_power=n.friend_help_min_power.value,n.activity.friend_help_max_power=n.friend_help_max_power.value,n.activity.wechatId=n.selectMedia.value,n.activity.rule=$("#rule").summernote("code"),n.activity.desc=$("#desc").summernote("code");var e=n.verify(n.activity);e&&i.newInvocation(n.activity).onDone(function(t){n.activity={org:__page.tenantId,type:"rp",bgImg:[]},riot.route("power/list")}).execute()};var r=function(t,e){_.uploadImgFile(t,function(t,n){t?alert("上传图片失败"):$(e).summernote("insertImage",n)})}}),riot.tag("boss-tenant-power-edit",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <alert validators="{validators}" clear="{clear}"></alert> <div class="col-md-10 col-md-offset-1"> <div class="jumbotron" style="height: auto; padding: 25px;"> <div id="addForm" class="panel" style="margin-top: 1em;"> <div style="padding-left: 20px; padding-bottom: 20px; padding-top: 15px"><a href="#power/list" style="font-size: 15px; text-decoration: none;">返回活动列表</a></div> <ul class="ul" style="text-align: left; padding-left: 2em"> <li><span>助力活动设置</span></li> <li> <span>活动公众号: </span> <select id="selectMedia" > <option each="{wechatMedias}" value="{originalId}" __selected="{parent.activity.wechatId === originalId}">{name}</option> </select> </li> <li id="type_select"><span>类型: </span> <label><input id="type_rp" name="activity_type" type="radio" value="rp" __checked="{activity.type === \'rp\'}">红包</label> <label><input id="type_po" name="activity_type" type="radio" value="po" __checked="{activity.type === \'po\'}">积分</label> </li> <li><span>启动图片助力: </span><input name="withPic" type="checkbox" __checked="{activity.withPic === \'true\'}" onclick="{toggleWithPic}"></li> <li id="poster" if="{activity.withPic === \'true\'}" style="clear: both; min-height: 26px;"><span style="float: left">海报背景图片: </span><input if="{!activity.posterBgImg}" id="posterBgImg" type="file" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="{uploadPosterBgImg}" style="width: 60px;"> <div if="{activity.posterBgImg}" class="posterBgImgCon"><i onclick="{deletePosterBgImg}" class="glyphicon glyphicon-remove"></i><img riot-src="{activity.posterBgImg}" alt=""></div> </li> <li><span>活动名称: </span><input name="activityName" type="text" value="{activity.name}"></li> <li class="bgImg" style="min-height: 26px"><span style="float: left">背景图片(3张): </span><input if="{activity.bgImg.length != 3}" id="bgImg" type="file" multiple="multiple" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="{uploadBgImg}" style="width: 60px;"> <div if="{activity.bgImg.length >= 1}" class="bgImgCon"><i onclick="{deleteBgImg}" class="glyphicon glyphicon-remove"></i><img riot-src="{activity.bgImg[0]}" alt=""></div> <div if="{activity.bgImg.length >= 2}" class="bgImgCon"><i onclick="{deleteBgImg}" class="glyphicon glyphicon-remove"></i><img riot-src="{activity.bgImg[1]}" alt=""></div> <div if="{activity.bgImg.length >= 3}" class="bgImgCon"><i onclick="{deleteBgImg}" class="glyphicon glyphicon-remove"></i><img riot-src="{activity.bgImg[2]}" alt=""></div> </li> <li style="clear: both; min-height: 26px"><span style="float: left">分享卡片图片: </span><input if="{!activity.shareImg}" id="shareImg" type="file" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="{uploadShareImg}" style="width: 60px;"> <div if="{activity.shareImg}" class="shareImgCon"><i onclick="{deleteShareImg}" class="glyphicon glyphicon-remove"></i><img riot-src="{activity.shareImg}" alt=""></div> </li> <li style="clear: both"><span>活动时间: </span><input id="startTime" type="date" value="{formatDate(activity.startTime)}"><span> 至 </span><input id="endTime" type="date" value="{formatDate(activity.endTime)}"> </li> <li><span>活动介绍: </span><div id="desc"></div></li> <li><span>活动规则: </span><div id="rule"></div></li> <li><span>分享标题自定义: </span><input class="form-control" type="text" name="shareTitle" value="{activity.shareTitle}"></li> <li><span>分享描述自定义: </span><input class="form-control" type="text" name="shareDesc" value="{activity.shareTitle}"></li> <li><span>基础奖励: </span><input id="base_power" type="text" value="{activity.base_power}"></li> <li><span>好友助力单次奖励: </span><input name="friend_help_min_power" type="text" value="{activity.friend_help_min_power}"><span> 至 </span><input name="friend_help_max_power" type="text" value="{activity.friend_help_max_power}"></li> <li><span>好友助力上限人数: </span><input name="friend_help_count_limit" type="text" value="{activity.friend_help_count_limit}"></li> <li style="text-align: center; margin-top: 1em"><input class="btn btn-success" type="button" onclick="{submit}" value="提交"></li> </ul> </div> </div> </div> </div> </div>',"boss-tenant-power-edit .ul {list-style-type: none; text-align: center; padding: 0} boss-tenant-power-edit .ul li {margin-bottom: 20px;} boss-tenant-power-edit .bgImg #bgImg {float: left; margin-left: 10px;} boss-tenant-power-edit .bgImg .bgImgCon {margin-left: 10px; display: -webkit-inline-box; position: relative; border: solid 1px #E8E7E7;} boss-tenant-power-edit .bgImgCon i{color: #EC3131; position: absolute; left: 58px; top: 2px; cursor: pointer;} boss-tenant-power-edit .bgImgCon div{margin-left: 20px; float: left;} boss-tenant-power-edit .bgImgCon img {width: 75px; height: 75px;} boss-tenant-power-edit .shareImgCon img {width: 75px; height: 75px;} boss-tenant-power-edit #shareImg{float: left; margin-left: 10px;} boss-tenant-power-edit .shareImgCon i{color: #EC3131;position: absolute;left: 58px;top: 2px;cursor: pointer;} boss-tenant-power-edit .shareImgCon{margin-left: 10px; display: -webkit-inline-box;position: relative; border: solid 1px #E8E7E7;} boss-tenant-power-edit .posterBgImgCon img {width: 75px; height: 75px;} boss-tenant-power-edit #posterBgImg{float: left; margin-left: 10px;} boss-tenant-power-edit .posterBgImgCon i{color: #EC3131;position: absolute;left: 58px;top: 2px;cursor: pointer;} boss-tenant-power-edit .posterBgImgCon{margin-left: 10px; display: -webkit-inline-box;position: relative; border: solid 1px #E8E7E7;}",function(t){"use strict";function e(t,e){if(n.validators=[],t.size>2097152)return void n.validators.push({success:!1,field:"提示",desc:"文件大小超过限制-2M"});var i=new FormData;i.append("file",t),$.ajax({url:__app.settings.api.url+"/file/upload",type:"POST",data:i,processData:!1,contentType:!1,success:function(t){e(null,t)},error:function(t){e(t,null)}})}var n=nest.presentable(this);n.validators=[];var i=domain.action("loadPowerActivity"),o=domain.action("updatePowerActivity"),r=domain.action("loadAllTenantWechatSite");n.on("open",function(t){i.newInvocation({id:t.id}).onDone(function(t){n.activity=t,n.trigger("ready",!1),n.trigger("view-route-to"),setTimeout(function(){$("#rule").summernote({height:200,minHeight:null,maxHeight:null,toolbar:[["style",["bold","italic","underline","clear"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["fontname",["fontname"]],["insert",["picture","link","video","hr","table"]]],callbacks:{onImageUpload:function(t){a(t[0],"#rule")}}}).summernote("code",n.activity.rule||"")},10),setTimeout(function(){$("#desc").summernote({height:200,minHeight:null,maxHeight:null,toolbar:[["style",["bold","italic","underline","clear"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["fontname",["fontname"]],["insert",["picture","link","video","hr","table"]]],callbacks:{onImageUpload:function(t){a(t[0],"#desc")}}}).summernote("code",n.activity.desc||"")},10)}).execute(),r.newInvocation(__page.tenantId).onDone(function(t){n.wechatMedias=t,n.update()}).execute()}),n.on("mount",function(){n.validators=_.widget.validatify([])}),n.formatDate=function(t){var e=new Date(t),n=e.getFullYear(),i=e.getMonth()+1>9?e.getMonth()+1:"0"+(e.getMonth()+1),o=e.getDate()>9?e.getDate():"0"+e.getDate();return n+"-"+i+"-"+o},n.uploadPosterBgImg=function(t){var i=t.currentTarget.files[0];e(i,function(t,e){return t?console.error("upload file err in func uploadPosterBgImg, err: "+t):(n.activity.posterBgImg=window.__app.settings.api.url+"/file?media_id="+e.media_id,void n.update())})},n.uploadBgImg=function(t){var i=t.currentTarget.files;if(n.validators=[],i.length>3-n.activity.bgImg.length)return void n.validators.push({success:!1,field:"提示",desc:"最多上传三张背景图片"});for(var o=0;o<i.length;o++)e(i[o],function(t,e){return t?console.error("upload file err in func uploadBgImg, err: "+t):(n.activity.bgImg.push(window.__app.settings.api.url+"/file?media_id="+e.media_id),void n.update())})},n.uploadShareImg=function(t){var i=t.currentTarget.files[0];e(i,function(t,e){return t?console.error("upload file err in func uploadShareImg, err: "+t):(n.activity.shareImg=window.__app.settings.api.url+"/file?media_id="+e.media_id,void n.update())})},n.deleteBgImg=function(t){n.activity.bgImg=n.activity.bgImg.filter(function(e){return e!=$($(t.currentTarget).siblings("img")[0]).attr("src")})},n.deletePosterBgImg=function(t){n.activity.posterBgImg=""},n.deleteShareImg=function(t){n.activity.shareImg=""},n.clear=function(){n.validators=[]},n.toggleWithPic=function(t){return $(t.currentTarget).is(":checked")?n.activity.withPic="true":n.activity.withPic="false",!0},n.verify=function(t){var e=!0;return t.name||(n.validators.push({success:!1,field:"提示",desc:"活动名称不能为空!"}),e=!1),t.shareDesc||(n.validators.push({success:!1,field:"提示",desc:"分享描述不能为空!"}),e=!1),t.shareTitle||(n.validators.push({success:!1,field:"提示",desc:"分享标题不能为空!"}),e=!1),t.withPic&&!t.posterBgImg&&(n.validators.push({success:!1,field:"提示",desc:"必须上传海报背景图片!"}),e=!1),t.shareImg||(n.validators.push({success:!1,field:"提示",desc:"必须设置分享卡片图片!"}),e=!1),(!t.bgImg||t.bgImg.length<1)&&(n.validators.push({success:!1,field:"提示",desc:"必须设置背景图片!"}),e=!1),t.startTime||(n.validators.push({success:!1,field:"提示",desc:"必须设置活动开始时间!"}),e=!1),t.endTime||(n.validators.push({success:!1,field:"提示",desc:"必须设置活动结束时间!"}),e=!1),t.base_power&&/^[0-9]+$/.test(t.base_power)||(n.validators.push({success:!1,field:"提示",desc:"基础奖励必填且必须为数字!"}),e=!1),t.friend_help_count_limit&&/^[0-9]+$/.test(t.friend_help_count_limit)||(n.validators.push({success:!1,field:"提示",desc:"好友助力上限必填且必须为数字!"}),e=!1),t.friend_help_max_power&&/^[0-9]+$/.test(t.friend_help_max_power)||(n.validators.push({success:!1,field:"提示",desc:"单次助力最大值必填且必须为数字!"}),e=!1),t.friend_help_min_power&&/^[0-9]+$/.test(t.friend_help_min_power)||(n.validators.push({success:!1,field:"提示",desc:"单次助力最小值必填且必须为数字!"}),e=!1),e},n.submit=function(t){n.validators=[],n.activity.type=$(':radio[name="activity_type"]:checked').val(),n.activity.name=n.activityName.value,n.activity.shareTitle=n.shareTitle.value,n.activity.shareDesc=n.shareDesc.value,n.activity.base_power=n.base_power.value,n.activity.friend_help_count_limit=n.friend_help_count_limit.value,n.activity.startTime=n.startTime.value,n.activity.endTime=n.endTime.value,n.activity.friend_help_min_power=n.friend_help_min_power.value,n.activity.friend_help_max_power=n.friend_help_max_power.value,n.activity.wechatId=n.selectMedia.value,n.activity.rule=$("#rule").summernote("code"),n.activity.desc=$("#desc").summernote("code");var e=n.verify(n.activity);e&&o.newInvocation(n.activity).onDone(function(t){riot.route("power/list")}).execute()};var a=function(t,e){_.uploadImgFile(t,function(t,n){t?alert("上传图片失败"):$(e).summernote("insertImage",n)})}}),riot.tag("boss-tenant-power-list",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="col-md-10 col-md-offset-1"> <div class="jumbotron" style="height: auto; padding: 25px;"> <div id="powerList" class="panel" style="margin-top: 1em; padding: 0; min-height: 30em"> <div style="padding-left: 20px; padding-top: 10px;"><a id="add" href="#power/add" style="font-size: 15px; text-decoration: none; cursor: pointer">新增</a> </div> <ul class="ul" id="list"> <li> <strong class="col-md-2">活动名称</strong> <strong class="col-md-2">开始时间</strong> <strong class="col-md-2">结束时间</strong> <strong class="col-md-2">类型</strong> <strong class="col-md-2">海报二维码</strong> <strong class="col-md-2">操作</strong> </li> <li> <hr width="100%"> </li> <li class="actItem" each="{activityArr}"> <strong class="col-md-2"><a href="#power/edit/_{_id}">{name}</a></strong> <strong class="col-md-2">{_.date.format(new Date(startTime), \'yyyy-MM-dd\')}</strong> <strong class="col-md-2">{_.date.format(new Date(endTime), \'yyyy-MM-dd\')}</strong> <strong class="col-md-2">{__app.enums.PowerType.values[type]}</strong> <strong class="col-md-2 actionCon"> <a class="fa fa-qrcode fa-lg" data-toggle="modal" data-target="#showImg" onclick="{parent.showImg}"></a> </strong> <strong class="col-md-2 actionCon"><a href="{ __app.settings.app.url + \'/marketing/tenant/power/\' + wechatId + \'/activity?id=\' + _id }" target="_blank">查看</a><a href="{__app.settings.api.url + \'/marketing/tenant/power/exportParticipants?id=\' + _id }" target="_blank" >导出</a></strong> </li> </ul> </div> </div> </div> </div> </div>',"boss-tenant-power-list .ul {list-style-type: none; text-align: center; padding: 0} boss-tenant-power-list .ul li {margin-bottom: 20px;} boss-tenant-power-list .actItem {height: 17px; overflow: hidden; margin-top: 2px;} boss-tenant-power-list li strong{ padding: 0 !important; margin: 0 !important; } boss-tenant-power-list .actionCon a{ margin-left: 10px; cursor: pointer; }",function(t){"use strict";var e=nest.presentable(this),n=domain.action("loadPowerActivities");e.showImg=function(t){var e="";t.item.qrCodeUrl||(e="该活动不是海报助力活动"),_.widget.showImg({title:"用微信扫描下方二维码获取活动海报",imgUrl:t.item.qrCodeUrl,width:"300px",height:"300px",errorMsg:e})},e.on("open",function(t){n.newInvocation({tenantId:__page.tenantId}).onDone(function(t){e.activityArr=t,e.trigger("ready",!1),e.trigger("view-route-to")}).execute()}),e.on("mount",function(){e.validators=_.widget.validatify([])})}),riot.tag("boss-tenant-sd-bespeaks",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/bespeaks"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>预约管理</h4> </div> <div class="row"> <form class="form-inline"> <div class="col-md-6 col-lg-6"> <div class="form-group"> <label for="bespeakStatus">状态</label> <select id="bespeakStatus" class="form-control" onchange="{onSelect}"> <option value="">全部状态</option> <option selected value="{__app.enums.LifeFlag.names.Active}">待处理</option> <option value="{__app.enums.LifeFlag.names.Deleted}">已处理</option> </select> </div> <input onclick="{onSearch}" class="btn btn-primary" type="button" value="查询"> </div> </form> </div> <div class="row" style="margin-top: 10px"> <table class="table table-striped"> <thead> <tr> <th>客户昵称</th> <th>预约产品</th> <th>日期</th> <th>电话</th> <th>状态</th> <th>成单</th> </tr> </thead> <tbody> <tr each="{bespeaks}"> <td> <a href="#sd/bespeaks/_{_id}"> {user.nickname} </a> </td> <td> { product.name } </td> <td> {_.date.format(new Date(crtOn), \'yyyy-MM-dd hh点mm分\')} </td> <td> { telephone } </td> <td> { lFlg === __app.enums.LifeFlag.names.Active ? \'待处理\': \'已处理\' } </td> <td> <div if="{lFlg === __app.enums.LifeFlag.names.Active}"> <input onclick="{parent.onOrderCreate}" data-toggle="modal" data-target="#orderModal" type="button" class="btn btn-default" value="成单"> <input onclick="{parent.onOrderGiveUp}" data-toggle="modal" data-target="#modal" type="button" class="btn btn-default" value="弃单"> </div> </td> </tr> </tbody> </table> </div> </div> </div> <div id="orderModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title">生成订单</h4> </div> <div class="modal-body"> <form class="form-horizontal"> <div class="form-group"> <label class="col-sm-2 control-label">媒体价</label> <div class="col-sm-10"> <span>{currBespeak.product.listPrice}</span> </div> </div> <div class="form-group"> <label for="finalPrice" class="col-sm-2 control-label">成交价</label> <div class="col-sm-10"> <input class="form-control" oninput="{onInput}" id="finalPrice" type="number" name="finalPrice"> </div> </div> </form> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">取消</button> <button __disabled="{finalPrice.value.trim() === \'\' || parseInt(finalPrice.value.trim(), 10)<0 || parseInt(finalPrice.value.trim(), 10) > currBespeak.product.listPrice}" onclick="{onSubmitOrder}" data-dismiss="modal" type="button" class="btn btn-primary">确认</button> </div> </div> </div> </div> </div>',function(t){
"use strict";var e=nest.presentable(this),n=domain.action("findBespeaks"),i=domain.action("createOrder"),o=domain.action("updateBespeakById");e.bespeaks=[],e.currBespeak={},e.filter={tenant:__page.tenantId,lFlg:"a"},e.on("open",function(){n.newInvocation({filter:e.filter}).onDone(function(t){return t.error?alert("failed to search bespeaks"):(e.bespeaks=t.bespeaks,e.trigger("ready",!1),void e.trigger("view-route-to"))}).execute()}),e.onOrderCreate=function(t){e.finalPrice.value="",e.currBespeak=t.item},e.onOrderGiveUp=function(t){e.currBespeak=t.item,_.widget.confirm({title:"操作确认",content:"你确认要“销毁”该预约吗？",callback:function(){e.currBespeak.lFlg=__app.enums.LifeFlag.names.Deleted,console.log(t.item),o.newInvocation({id:e.currBespeak._id,o:{media:e.currBespeak.media,lFlg:e.currBespeak.lFlg}}).onDone(function(t){return t.error?void alert("销毁预约失败"):(e.currBespeak=null,e.bespeaks=e.bespeaks.filter(function(e){return e._id!=t.bespeak._id}),void e.update())}).execute()}})},e.onSearch=function(t){n.newInvocation({filter:e.filter}).onDone(function(t){return t.error?alert("failed to search bespeaks"):void e.update({bespeaks:t.bespeaks})}).execute()},e.onInput=function(){},e.onSubmitOrder=function(t){i.newInvocation({bespeak:e.currBespeak,finalPrice:e.finalPrice.value.trim()}).onDone(function(t){return t.error?void alert("成单失败"):(e.currBespeak=null,e.bespeaks=e.bespeaks.filter(function(e){return e._id!=t.order.bespeak}),void e.update())}).execute()},e.onSelect=function(t){var n=e.bespeakStatus.value;return console.log(n),n?void(e.filter.lFlg=n):void(e.filter.hasOwnProperty("lFlg")&&delete e.filter.lFlg)}}),riot.tag("boss-tenant-sd-catalogs-add",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/catalogs"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>新建课程目录</h4> </div> <alert validators="{validators}" clear="{clear}"></alert> <div class="row"> <div class="panel panel-default"> <div class="panel-heading">基本信息</div> <div class="panel-body"> <form class="form-horizontal"> <div class="form-group text-left"> <label for="catalogNameInput" class="col-sm-2 control-label text-left">课程目录名称</label> <div class="col-sm-10 {has-error: !catalogNameInput.value.trim()} has-feedback"> <input onblur="{catalogNameInputBlur}" type="text" class="form-control " id="catalogNameInput"> </div> </div> <div class="form-group"> <label for="catalogWechatsiteInput" class="col-sm-2 control-label">公众号</label> <div class="col-sm-10"> <select class="form-control" id="catalogWechatsiteInput" style="width: 200px"> <option each="{wechatsites}" value="{_id}">{name}</option> </select> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">上/下架状态</label> <div class="col-sm-10" style="height: 32px;line-height: 32px"> <span>待上架</span> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">创建时间</label> <div class="col-sm-10"> <span>{_.date.format(new Date(), \'yyyy-MM-dd hh点mm分\') }</span> </div> </div> <div class="form-group"> <label for="catalogDescInput" class="col-sm-2 control-label">备注</label> <div class="col-sm-10"> <textarea onblur="{catalogDescInputBlur}" type="password" class="form-control" id="catalogDescInput"></textarea> </div> </div> </form> </div> </div> </div> <div class="row" style="margin-top: 10px"> <div class="col-md-12 col-lg-12 text-center"> <input __disabled="{!courseMediaPriceInput.value.trim() || !courseNameInput.value.trim()}" onclick="{onSubmit}" type="button" class="btn btn-primary" value="保存"> <a href="#sd/catalogs" class="btn btn-default">取消</a> </div> </div> </div> </div> </div>',".form-horizontal .control-label{ text-align: left !important; }",function(t){"use strict";var e=nest.presentable(this),n=domain.action("loadAllTenantWechatSite"),i=domain.action("createCatalog");e.on("open",function(){e.catalog={},e.catalog.tenant=__page.tenantId,e.validators=[],e.catalogNameInput.value="",e.catalogDescInput.value="",n.newInvocation(__page.tenantId).onDone(function(t){e.wechatsites=t,e.trigger("ready",!1),e.trigger("view-route-to")}).execute()}),e.catalogNameInputBlur=function(){var t=e.catalogNameInput.value.trim();return t?void(e.catalog.name=t):e.validators.push({success:!1,field:"课程目录名称",desc:"不能为空!"})},e.clear=function(){e.validators=[]},e.catalogDescInputBlur=function(){e.catalog.desc=e.catalogDescInput.value.trim()},e.onSubmit=function(){e.catalog.media=e.catalogWechatsiteInput.value,i.newInvocation(e.catalog).onDone(function(t){riot.route("sd/catalogs")}).execute()}}),riot.tag("boss-tenant-sd-catalogs-detail",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/catalogs"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div> <div class="row" style="text-align: center"> <a href="#sd/catalogs" style="position: absolute; left: 0px; top: 10px">返回课程目录列表</a> <h4>{catalog.name}</h4> </div> <alert validators="{validators.raw()}" clear="{clear}"></alert> <div class="row"> <div class="panel panel-default"> <div class="panel-body"> <div> <table class="table table-narrow"> <tr> <td>所属公众号</td> <td>{catalog.media.name}</td> </tr> <tr> <td>租户类型</td> <td>{__app.enums.PartyType.values[catalog.tenant.type]}</td> </tr> <tr> <td>状态</td> <td>{__app.enums.LifeFlag.values[catalog.lFlg]}</td> </tr> <tr> <td>创建时间</td> <td>{_.date.format(new Date(catalog.crtOn), \'yyyy-MM-dd hh点mm分\')}</td> </tr> <tr> <td>备注</td> <td>{catalog.desc}</td> </tr> <tr> <td>微站URL</td> <td><span>{__app.settings.app.url + "/sd/" + catalog.media.originalId + "/catalog?id=" + catalog._id}</span></td> </tr> </table> <div class="row text-center" style="margin-top: 20px; margin-bottom: 20px"> <div class="col-md-12 col-lg-12"> <a href="#sd/catalogs/edit/_{catalog._id}" class="btn btn-default">修改</a> <input if="{catalog.lFlg === __app.enums.LifeFlag.names.Active}" onclick="{onInactive}" data-toggle="modal" data-target="#modal" value="锁定" type="button" class="btn btn-default"> <input if="{catalog.lFlg === __app.enums.LifeFlag.names.Inactive}" onclick="{onActive}" data-toggle="modal" data-target="#modal" value="激活" type="button" class="btn btn-default"> <input onclick="{onDelete}" data-toggle="modal" data-target="#modal" value="删除" type="button" class="btn btn-default"> </div> </div> <div class="row" style="margin-top: 20px; margin-bottom: 20px"> <div class="col-md-12 col-lg-12"> <h4 class="text-left">课程目录</h4> <hr> <div class="text-right"> <input onclick="{onAddProduct}" type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal" value="添加"> </div> <div> <table class="table table-striped"> <thead> <tr> <th>名称</th> <th>状态</th> <th>上/下架时间</th> <th>创建时间</th> <th>备注</th> <th>二维码</th> </tr> </thead> <tbody> <tr each="{populateProducts(catalog.products)}"> <td> {name} </td> <td> { __app.enums.LiveStatus.values[liveStatus] } </td> <td> { actionTime && _.date.format(new Date(actionTime), \'yyyy-MM-dd hh点mm分\') || \'空\'} </td> <td> {_.date.format(new Date(crtOn), \'yyyy-MM-dd hh点mm分\')} </td> <td> { desc } </td> <td> <i class="fa fa-qrcode fa-lg" aria-hidden="true" data-toggle="modal" data-target="#showImg" onclick="{parent.obtainQr(this)}"></i> </td> </tr> </tbody> </table> </div> </div> </div> </div> </div> </div> </div> </div> <div id="myModal" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"> <div class="modal-dialog modal-lg"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title">选择课程</h4> </div> <div class="modal-body"> <table class="table table-striped"> <thead> <tr> <th> <div class="checkbox"> <label> <input id="toggleInput" type="checkbox" onclick="{onToggleSelectAll}"> </label> </div> </th> <th>名称</th> <th>状态</th> <th>上/下架时间</th> <th>创建时间</th> <th>备注</th> </tr> </thead> <tbody> <tr each="{courses}"> <td> <div class="checkbox"> <label> <input name="CourseCheckBox" type="checkbox" __checked="{parent.isChecked(_id)}" value="{_id}"> </label> </div> </td> <td> {name} </td> <td> { __app.enums.LiveStatus.values[liveStatus] } </td> <td> { actionTime && _.date.format(new Date(actionTime), \'yyyy-MM-dd hh点mm分\') || \'空\'} </td> <td> {_.date.format(new Date(crtOn), \'yyyy-MM-dd hh点mm分\')} </td> <td> { desc } </td> </tr> </tbody> </table> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">取消</button> <button onclick="{onSubmitCourses}" data-dismiss="modal" type="button" class="btn btn-primary">确认</button> </div> </div> </div> </div> </div> </div> </div> </div>',"boss-tenant-sd-catalogs-detail .form-horizontal .control-label{ text-align: left !important; } boss-tenant-sd-catalogs-detail .vcenter { vertical-align: middle; } boss-tenant-sd-catalogs-detail .table-narrow tr td{ border: none !important; width: 30% !important; } boss-tenant-sd-catalogs-detail .my-table{ width: 100%; } boss-tenant-sd-catalogs-detail .my-table td{ width: 33.33333%; } boss-tenant-sd-catalogs-detail .panel-default { border-top: none; border-color: #ddd; }",function(t){"use strict";var e=nest.presentable(this),n=domain.action("loadCatalogById"),i=domain.action("findCourses"),o=domain.action("updateCatalogById"),r=domain.action("fetchSdQrByProductAndWechatSite");e.on("open",function(t){var o=t.req.paramList[0];n.newInvocation({id:o}).onDone(function(t){e.catalog=t.catalog,i.newInvocation({tenant:__page.tenantId}).onDone(function(t){e.courses=t.courses,e.trigger("ready",!1),e.trigger("view-route-to")}).execute()}).execute()}),e.on("mount",function(){e.validators=_.widget.validatify([])}),e.isChecked=function(t){return e.catalog.products.map(function(t){return t._id}).indexOf(t)>=0},e.populateProducts=function(t){return t.map(function(t){return e.courses.filter(function(e){return e._id===t._id})[0]})},e.onToggleSelectAll=function(){var t=[].slice.apply(document.querySelectorAll('input[name="CourseCheckBox"]'));return e.toggleInput.checked===!1?t.map(function(t){t.checked=!1}):t.map(function(t){t.checked=!0}),!0},e.onInactive=function(t){_.widget.confirm({title:"操作确认",content:"你确认要“锁定”该课程目录吗？",callback:function(){e.catalog.lFlg=__app.enums.LifeFlag.names.Inactive,o.newInvocation({id:e.catalog._id,o:e.catalog}).onDone(function(t){e.update()}).execute()}})},e.obtainQr=function(t){return function(n){var i=null,o=null;return"object"==typeof e.catalog.media&&t?t.poster?t.qr&&t.qr.ticket?(i=t.qr.ticket||t.qr.ticket,o="https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket="+i,void _.widget.showImg({title:"扫一扫获取课程海报",imgUrl:o,width:"300px",height:"300px"})):void r.newInvocation({product:_.toObjectFromRiot(t),media:e.catalog.media}).onDone(function(t){return t.error?void alert("获取二维码失败"):(i=t.product.qr.ticket,o="https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket="+i,_.widget.showImg({title:"扫一扫获取课程海报",imgUrl:o,width:"300px",height:"300px"}),void e.catalog.products.forEach(function(n,i){t.product._id===n._id&&(e.catalog.products[i]=t.product)}))}).execute():void _.widget.showImg({title:"扫一扫获取课程海报",imgUrl:"",width:"300px",height:"300px",errorMsg:"该课程尚没有背景图片"}):void 0}},e.onActive=function(){_.widget.confirm({title:"操作确认",content:"你确认要“锁定”该课程目录吗？",callback:function(){e.catalog.lFlg=__app.enums.LifeFlag.names.Active,o.newInvocation({id:e.catalog._id,o:e.catalog}).onDone(function(t){e.update()}).execute()}})},e.onDelete=function(){_.widget.confirm({title:"操作确认",content:"你确认要“删除”该课程目录吗？",callback:function(){e.catalog.lFlg=__app.enums.LifeFlag.names.Deleted,o.newInvocation({id:e.catalog._id,o:e.catalog}).onDone(function(t){t.error||riot.route("sd/catalogs")}).execute()}})},e.onSubmitCourses=function(){var t=document.querySelectorAll('input[name="CourseCheckBox"]:checked'),n=[];e.catalog.products=[].slice.apply(t).map(function(t){return n.push(t.value),e.courses.filter(function(e){return e._id===t.value})[0]});var i={};i._id=e.catalog._id,i.products=n,o.newInvocation({id:e.catalog._id,o:i}).onDone(function(t){t.error&&alert("保存课程失败")}).execute()},e.onAddProduct=function(){e.toggleInput.checked=!1}}),riot.tag("boss-tenant-sd-catalogs-edit",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/catalogs"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>{catalog.name}</h4> </div> <alert validators="{validators.raw()}" clear="{clear}"></alert> <div class="row"> <div class="panel panel-default"> <div class="panel-body"> <form class="form-horizontal"> <div class="form-group text-left"> <label for="catalogNameInput" class="col-sm-2 control-label text-left">课程目录名称</label> <div class="col-sm-10 {has-error: !catalogNameInput.value.trim()} has-feedback"> <input onblur="{catalogNameInputBlur}" value="{catalog.name}" id="catalogNameInput" type="text" class="form-control "> </div> </div> <div class="form-group"> <label for="catalogMediaInput" class="col-sm-2 control-label">公众号</label> <div class="col-sm-10"> <select id="catalogMediaInput" class="form-control"> <option each="{wechatsites}" value="{_id}">{name}</option> </select> </div> </div> <div class="form-group"> <label for="catalogDescInput" class="col-sm-2 control-label">备注</label> <div class="col-sm-10"> <textarea onblur="{catalogDescInputBlur}" type="password" class="form-control" id="catalogDescInput"> {catalog.desc} </textarea> </div> </div> </form> </div> </div> </div> <div class="row" style="margin-top: 10px"> <div class="col-md-12 col-lg-12 text-center"> <input __disabled="{!courseMediaPriceInput.value.trim() || !courseNameInput.value.trim()}" onclick="{onSubmit}" type="button" class="btn btn-primary" value="保存"> <a href="#sd/catalogs" class="btn btn-default">取消</a> </div> </div> </div> </div> </div> </div>',".form-horizontal .control-label{ text-align: left !important; } .vcenter { vertical-align: middle; } .my-table{ width: 100%; } .my-table td{ width: 33.33333%; } .panel-default { border-top: none; border-color: #ddd; }",function(t){"use strict";var e=nest.presentable(this),n=domain.action("loadCatalogById"),i=domain.action("updateCatalogById"),o=domain.action("loadAllTenantWechatSite");e.on("open",function(t){var i=t.req.paramList[0];n.newInvocation({id:i}).onDone(function(t){e.catalog=t.catalog,o.newInvocation(__page.tenantId).onDone(function(t){e.wechatsites=t,e.trigger("ready",!1),e.trigger("view-route-to")}).execute()}).execute()}),e.on("mount",function(){e.validators=_.widget.validatify([])}),e.catalogNameInputBlur=function(){var t=e.catalogNameInput.value.trim();return t?void(e.catalog.name=t):e.validators.addToSet({success:!1,field:"课程名称",desc:"不能为空!",key:"courseNameInput"})},e.clear=function(){e.validators.clear()},e.catalogDescInputBlur=function(){e.catalog.desc=e.catalogDescInput.value.trim()},e.onSubmit=function(){var t={id:e.catalog._id,o:e.catalog};i.newInvocation(t).onDone(function(t){riot.route("sd/catalogs")}).execute()}}),riot.tag("boss-tenant-sd-catalogs",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/catalogs"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>课程目录管理</h4> </div> <div class="row"> <form class="form-inline"> <div class="col-md-6 col-lg-6"> <div class="form-group"> <label for="catalogStatus">状态</label> <select id="catalogStatus" class="form-control" onchange="{onSelect}"> <option value="">全部状态</option> <option value="{__app.enums.LifeFlag.names.Active}">已激活</option> <option value="{__app.enums.LifeFlag.names.Inactive}">已锁定</option> <option value="{__app.enums.LifeFlag.names.Deleted}">已删除</option> </select> </div> <input onclick="{onSearch}" class="btn btn-primary" type="button" value="查询"> </div> <div class="col-md-6 col-lg-6 text-right"> <a class="btn btn-primary" href="#sd/catalogs/add">添加</a> </div> </form> </div> <div class="row" style="margin-top: 10px"> <table class="table table-striped"> <thead> <tr> <th>名称</th> <th>状态</th> <th>公众号</th> <th>创建时间</th> <th>备注</th> </tr> </thead> <tbody> <tr each="{catalogs}"> <td> <a href="#sd/catalogs/_{_id}"> {name} </a> </td> <td> { __app.enums.LifeFlag.values[lFlg] } </td> <td> { media.name } </td> <td> {_.date.format(new Date(crtOn), \'yyyy-MM-dd hh点mm分\')} </td> <td> { desc } </td> </tr> </tbody> </table> </div> </div> </div> </div>',function(t){"use strict";var e=nest.presentable(this),n=domain.action("findCatalogs");e.courses=[],e.filter={tenant:__page.tenantId},e.on("open",function(){n.newInvocation({filter:e.filter}).onDone(function(t){return t.error?alert("failed to search courses"):(e.catalogs=t.catalogs,e.trigger("ready",!1),void e.trigger("view-route-to"))}).execute()}),e.onSearch=function(t){n.newInvocation({filter:e.filter}).onDone(function(t){return t.error?alert("failed to search courses"):void e.update({catalogs:t.catalogs})}).execute()},e.onSelect=function(t){var n=e.catalogStatus.value;return n?void(e.filter.lFlg=n):void(e.filter.hasOwnProperty("lFlg")&&delete e.filter.lFlg)}}),riot.tag("boss-tenant-sd-courses-add",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/courses"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>新建课程</h4> </div> <alert validators="{validators}" clear="{clear}"></alert> <div class="row"> <div class="panel panel-default"> <div class="panel-heading">基本信息</div> <div class="panel-body"> <form class="form-horizontal"> <div class="form-group text-left"> <label for="courseNameInput" class="col-sm-2 control-label text-left">课程名称</label> <div class="col-sm-10 {has-error: !courseNameInput.value.trim()} has-feedback"> <input onblur="{courseNameInputBlur}" type="text" class="form-control " id="courseNameInput"> </div> </div> <div class="form-group"> <label for="coursePromoteInput" class="col-sm-2 control-label">推广语</label> <div class="col-sm-10"> <input type="text" class="form-control" id="coursePromoteInput" onblur="{coursePromoteInputBlur}"> </div> </div> <div class="form-group"> <label for="courseMediaPriceInput" class="col-sm-2 control-label">媒体价 ( :元 )</label> <div class="col-sm-10 {has-error: !courseMediaPriceInput.value.trim()}"> <input onblur="{courseMediaPriceInputBlur}" type="number" class="form-control" id="courseMediaPriceInput"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">上/下架状态</label> <div class="col-sm-10" style="height: 32px;line-height: 32px"> <span>待上架</span> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">上/下架时间</label> <div class="col-sm-10" style="height: 32px;line-height: 32px"> <span>空</span> </div> </div> <div class="form-group"> <label for="courseDescInput" class="col-sm-2 control-label">备注</label> <div class="col-sm-10"> <textarea onblur="{courseDescInputBlur}" type="password" class="form-control" id="courseDescInput"></textarea> </div> </div> </form> </div> </div> </div> <div class="row" style="margin-top: 10px"> <div class="col-md-12 col-lg-12 text-center"> <input __disabled="{!courseMediaPriceInput.value.trim() || !courseNameInput.value.trim()}" onclick="{onSubmit}" type="button" class="btn btn-primary" value="保存"> <a href="#sd/courses" class="btn btn-default">取消</a> </div> </div> </div> </div> </div>',".form-horizontal .control-label{ text-align: left !important; }",function(t){"use strict";var e=nest.presentable(this),n=domain.action("createCourse");e.on("open",function(){e.course={},e.course.tenant=__page.tenantId,e.validators=[],e.courseMediaPriceInput.value="",e.courseNameInput.value="",e.coursePromoteInput.value="",e.courseDescInput.value="",e.trigger("ready",!1),e.trigger("view-route-to")}),e.courseNameInputBlur=function(){var t=e.courseNameInput.value.trim();return t?void(e.course.name=t):e.validators.push({success:!1,field:"课程名称",desc:"不能为空!"})},e.clear=function(){e.validators=[]},e.courseDescInputBlur=function(){e.course.desc=e.courseDescInput.value.trim()},e.coursePromoteInputBlur=function(){e.course.slogan=e.coursePromoteInput.value.trim()},e.courseMediaPriceInputBlur=function(){var t=e.courseMediaPriceInput.value.trim();return t?void(e.course.listPrice=t):e.validators.push({success:!1,field:"媒体价",desc:"不能为空!"})},e.onSubmit=function(){n.newInvocation(e.course).onDone(function(t){riot.route("sd/courses")}).execute()}}),riot.tag("boss-tenant-sd-courses-detail",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/courses"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div> <div class="row" style="text-align: center"> <a href="#sd/courses" style="position: absolute; left: 0px; top: 10px">返回课程列表</a> <h4>{course.name}</h4> </div> <alert validators="{validators.raw()}" clear="{clear}"></alert> <div class="row"> <ul class="nav nav-tabs"> <li role="presentation" class="{active: currNav === 0}"><a onclick="{onChangeTab(0)}">课程</a></li> <li role="presentation" class="{active: currNav === 1}"><a onclick="{onChangeTab(1)}">分销</a></li> </ul> </div> <div class="row" if="{currNav === 0}"> <div class="panel panel-default"> <div class="panel-body"> <div> <table class="table table-narrow"> <tr> <td>课程名称</td> <td>{course.name}</td> </tr> <tr> <td>推广语</td> <td>{course.slogan}</td> </tr> <tr> <td>媒体价 ( :元 )</td> <td>{course.listPrice}</td> </tr> <tr> <td>上/下架状态</td> <td>{__app.enums.LiveStatus.values[course.liveStatus]}</td> </tr> <tr> <td>上/下架时间</td> <td>{course.actionTime && _.date.format(new Date(course.actionTime), \'yyyy-MM-dd hh点mm分\') || \'空\'}</td> </tr> <tr> <td>备注</td> <td>{course.desc}</td> </tr> <tr> <td><strong>焦点图</strong></td> <td colspan="2"> <ul class="banners-container"> <li each="{banner, i in course.banners}"> <img riot-src="{banner && (__app.settings.api.url + \'/file?media_id=\' + banner)}"> </li> </ul> </td> </tr> </table> <div class="row text-center"> <div class="col-md-12 col-lg-12"> <a href="#sd/courses/edit/details/_{course._id}">编辑课程详情</a> </div> </div> <div class="row text-center" style="margin-top: 20px; margin-bottom: 20px"> <div class="col-md-12 col-lg-12"> <a href="#sd/courses/edit/_{course._id}" class="btn btn-default">修改</a> <input if="{course.liveStatus === __app.enums.LiveStatus.names.Idle}" onclick="{onGoLive}" data-toggle="modal" data-target="#modal" value="上架" type="button" class="btn btn-default"> <input if="{course.liveStatus === __app.enums.LiveStatus.names.GoLive}" onclick="{onSunset}" data-toggle="modal" data-target="#modal" value="下架" type="button" class="btn btn-default"> <input onclick="{onDelete}" data-toggle="modal" data-target="#modal" value="删除" type="button" class="btn btn-default"> </div> </div> </div> </div> </div> </div> <div class="row" if="{currNav === 1}"> <div class="panel panel-default"> <div class="panel-body"> <td class="text-left"> <table class="my-table table table-narrow"> <tr> <td><strong>会员折扣</strong></td> <td>单位课程优惠</td> <td> <span>{__app.enums.CommissionType.names.Cash === course.memberDiscountsType && \'金额\' || \'百分比\'}</span> <span>{ course.memberDiscountsValue }</span> </td> </tr> <tr> <td><strong>直接分销商-直接推荐人</strong></td> <td>单位课程佣金</td> <td> <span>{__app.enums.CommissionType.names.Cash === course.upLine1CommissionType && \'金额\' || \'百分比\'}</span> <span>{ course.upLine1CommissionValue }</span> </td> </tr> <tr> <td><strong>间接分销商-间接推荐人</strong></td> <td>单位课程佣金</td> <td> <span>{__app.enums.CommissionType.names.Cash === course.upLine2CommissionType && \'金额\' || \'百分比\'}</span> <span>{ course.upLine2CommissionValue }</span> </td> </tr> <tr> <td><strong>第三级分销商-间接推荐人的推荐人</strong></td> <td>单位课程佣金</td> <td> <span>{__app.enums.CommissionType.names.Cash === course.upLine3CommissionType && \'金额\' || \'百分比\'}</span> <span>{ course.upLine3CommissionValue }</span> </td> </tr> <tr> <td colspan="3" style="text-align: center">注： 如果佣金按百分比计算，佣金基数以实际消费者实付金额为准（即线下实际核销金额）</td> </tr> <tr> <td><strong>分销海报背景</strong></td> <td colspan="2"><img style="width: 200px" riot-src="{course.poster &&__app.settings.api.url + \'/file?media_id=\' + course.poster}"></td> </tr> </table> </div> </div> </div>  </div> </div> </div> </div> </div>',"boss-tenant-sd-courses-detail .form-horizontal .control-label{ text-align: left !important; } boss-tenant-sd-courses-detail .vcenter { vertical-align: middle; } boss-tenant-sd-courses-detail .table-narrow tr td{ border: none !important; width: 30% !important; } boss-tenant-sd-courses-detail .my-table{ width: 100%; } boss-tenant-sd-courses-detail .my-table td{ width: 33.33333%; } boss-tenant-sd-courses-detail .panel-default { border-top: none; border-color: #ddd; }",function(t){"use strict";var e=nest.presentable(this),n=domain.action("loadCourseById"),i=domain.action("updateCourseById");e.currNav=0,e.onChangeTab=function(t){return function(){e.currNav=t}},e.on("open",function(t){var i=t.req.paramList[0];n.newInvocation({id:i}).onDone(function(t){e.course=t.course,e.course.banners||(e.course.banners=[]),e.trigger("ready",!1),e.trigger("view-route-to")}).execute()}),e.on("mount",function(){e.validators=_.widget.validatify([])}),e.onGoLive=function(t){_.widget.confirm({title:"操作确认",content:"你确认要“上架”该课程吗？",callback:function(){e.course.liveStatus=__app.enums.LiveStatus.names.GoLive,i.newInvocation({id:e.course._id,intention:"GoLiveOrSunset",o:e.course}).onDone(function(t){e.course.actionTime=t.course.actionTime,e.course.qr=t.course.qr,e.update()}).execute()}})},e.onSunset=function(){_.widget.confirm({title:"操作确认",content:"你确认要“下架”该课程吗？",callback:function(){e.course.liveStatus=__app.enums.LiveStatus.names.Sunset,i.newInvocation({id:e.course._id,intention:"GoLiveOrSunset",o:e.course}).onDone(function(t){e.course.actionTime=t.course.actionTime,e.update()}).execute()}})},e.onDelete=function(){_.widget.confirm({title:"操作确认",content:"你确认要“删除”该课程吗？",callback:function(){e.course.lFlg=__app.enums.LifeFlag.names.Deleted,i.newInvocation({id:e.course._id,o:e.course}).onDone(function(t){t.error||riot.route("sd/courses")}).execute()}})}}),riot.tag("boss-tenant-sd-courses-edit-detail",'<div class="container" if="{!hidden}"> <div class="row"> <div class="col-md-6 col-md-offset-3"> <div class="row text-center"> <a href="#sd/courses/_{course._id}" style="position: absolute; left: 0px; top: 10px">返回</a> <h4>课程详情-{course.name}</h4> </div> <div class="row" style="margin-bottom: 10px"> <span>更新时间: {course.updOn && _.date.format(new Date(course.updOn), \'yyyy-MM-dd hh点mm分\')}</span> </div> <div if="{status===\'view\'}"> <div class="row" style="margin-bottom: 10px"> <input onclick="{onEdit}" type="button" class="btn btn-primary" value="编辑"> </div> <div class="row" style="height:450px; background: white; padding: 10px; margin-bottom: 20px; overflow: scroll"> <raw content="{course.details}"></raw> </div> </div> <div if="{status===\'edit\'}"> <div class="row" style="margin-bottom: 10px"> <input onclick="{onPreview}" type="button" class="btn btn-primary" value="预览"> </div> <div class="row text-center" style="padding-bottom: 50px"> <div id="richEditor"></div> <input onclick="{onSubmit}" type="button" class="btn-primary btn" value="保存"> <input onclick="{onCancel}" type="button" class="btn-default btn" value="取消"> </div> </div> <div if="{status===\'preview\'}"> <div class="row" style="margin-bottom: 10px"> <input onclick="{onBack}" type="button" class="btn btn-primary" value="返回"> </div> <div class="row" style="height: 450px;background: white; padding: 10px; margin-bottom: 20px; overflow: scroll"> <raw content="{preview}"></raw> </div>    </div> </div> </div> </div>',function(t){"use strict";var e=nest.presentable(this),n=domain.action("loadCourseById"),i=domain.action("updateCourseById");e.on("open",function(t){e.status="view";var i=t.req.paramList[0];n.newInvocation({id:i}).onDone(function(t){e.course=t.course,e.preview=t.course.details||"",e.trigger("ready",!1),e.trigger("view-route-to")}).execute()}),e.onEdit=function(){e.status="edit",setTimeout(function(){$("#richEditor").summernote({height:400,minHeight:null,maxHeight:null,toolbar:[["style",["bold","italic","underline","clear"]],["fontsize",["fontsize"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["fontname",["fontname"]],["insert",["picture","link","video","hr","table"]]],callbacks:{onImageUpload:function(t){o(t[0])}}}).summernote("code",e.course.details||"")},0)},e.onSubmit=function(){e.course.details=$("#richEditor").summernote("code"),i.newInvocation({id:e.course._id,o:e.course}).onDone(function(t){return t.error?alert("error occur."):void riot.route("sd/courses/_"+e.course._id)}).execute()},e.onPreview=function(){"preview"!=e.status&&(e.status="preview",e.preview=$("#richEditor").summernote("code"))},e.onBack=function(){e.status="edit"},e.onCancel=function(){e.status="view"};var o=function(t){_.uploadImgFile(t,function(t,e){t?alert("上传图片失败"):$("#richEditor").summernote("insertImage",e,function(t){t.css("width","100%")})})}}),riot.tag("boss-tenant-sd-courses-edit",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/courses"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>{course.name}</h4> </div> <alert validators="{validators.raw()}" clear="{clear}"></alert> <div class="row"> <ul class="nav nav-tabs"> <li role="presentation" class="{active: currNav === 0}"><a onclick="{onChangeTab(0)}">课程</a></li> <li role="presentation" class="{active: currNav === 1}"><a onclick="{onChangeTab(1)}">分销</a></li> </ul> </div> <div class="row" if="{currNav === 0}"> <div class="panel panel-default"> <div class="panel-body"> <form class="form-horizontal"> <div class="form-group text-left"> <label for="courseNameInput" class="col-sm-2 control-label text-left">课程名称</label> <div class="col-sm-10 {has-error: !courseNameInput.value.trim()} has-feedback"> <input onblur="{courseNameInputBlur}" value="{course.name}" id="courseNameInput" type="text" class="form-control "> </div> </div> <div class="form-group"> <label for="coursePromoteInput" class="col-sm-2 control-label">推广语</label> <div class="col-sm-10"> <input onblur="{coursePromoteInputBlur}" value="{course.slogan}" type="text" class="form-control" id="coursePromoteInput"> </div> </div> <div class="form-group"> <label for="courseMediaPriceInput" class="col-sm-2 control-label">媒体价 ( :元 )</label> <div class="col-sm-10 {has-error: !courseMediaPriceInput.value.trim()}"> <input onblur="{courseMediaPriceInputBlur}" value="{course.listPrice}" type="number" class="form-control" id="courseMediaPriceInput"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">上/下架状态</label> <div class="col-sm-10" style="height: 32px;line-height: 32px"> <span>{__app.enums.LiveStatus.values[course.liveStatus]}</span> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label">上/下架时间</label> <div class="col-sm-10" style="height: 32px;line-height: 32px"> <span>{course.actionTime && _.date.format(new Date(course.actionTime), \'yyyy-MM-dd hh点mm分\') || \'空\'}</span> </div> </div> <div class="form-group"> <label for="courseDescInput" class="col-sm-2 control-label">备注</label> <div class="col-sm-10"> <textarea onblur="{courseDescInputBlur}" type="password" class="form-control" id="courseDescInput"> {course.desc} </textarea> </div> </div> <div class="form-group"> <label for="courseDescInput" class="col-sm-2 control-label">轮播焦点图</label> <div class="col-sm-10"> <input multiple="multiple" onchange="{onBannersChange}" id="bannersInput" type="file" accept="image/jpeg, image/png, image/jpg"> <ul class="banners-container"> <li each="{banner, i in course.banners}" onmouseenter="{parent.onHover}" onmouseleave="{parent.onUnHover}"> <div onclick="{parent.removeBanner}" if="{isImgMaskShow}"> <b> <b class="close-a"></b> <b class="close-b"></b> </b> </div> <img riot-src="{banner.data || banner && (__app.settings.api.url + \'/file?media_id=\' + banner)}"> </li> </ul> </div> </div> </form> </div> </div> </div> <div class="row" if="{currNav === 1}"> <div class="panel panel-default"> <div class="panel-body"> <td class="text-left"> <table class="my-table table table-striped"> <tr> <td><strong>会员折扣</strong></td> <td>单位课程优惠</td> <td> <table> <tr> <td> <div onclick="{onSelectMemberDiscountsType1}" class="radio form-inline"> <label for="memberDiscountsTypeInput1"> <input id="memberDiscountsTypeInput1" value="{__app.enums.CommissionType.names.Cash}" __checked="{course.memberDiscountsType === __app.enums.CommissionType.names.Cash}" type="radio" name="memberDiscountsType"> 金额 </label> </div> </td> <td> <input id="memberDiscountsValueInput1" onblur="{onValidateValue}" __disabled="{course.memberDiscountsType != __app.enums.CommissionType.names.Cash}" value="{course.memberDiscountsType === __app.enums.CommissionType.names.Cash && course.memberDiscountsValue || \'\'}" class="form-control" type="number"> </td> </tr> <tr> <td> <div onclick="{onSelectMemberDiscountsType2}" class="radio form-inline"> <label for="memberDiscountsTypeInput2"> <input type="radio" name="memberDiscountsType" id="memberDiscountsTypeInput2" value="{__app.enums.CommissionType.names.Percent}" __checked="{course.memberDiscountsType === __app.enums.CommissionType.names.Percent}"> 百分比 </label> </div> </td> <td> <input id="memberDiscountsValueInput2" onblur="{onValidatePercent}" __disabled="{course.memberDiscountsType != __app.enums.CommissionType.names.Percent}" value="{course.memberDiscountsType === __app.enums.CommissionType.names.Percent && course.memberDiscountsValue || \'\'}" class="form-control" type="number"> </td> </tr> </table> </td> </tr> <tr> <td><strong>直接分销商-直接推荐人</strong></td> <td>单位课程佣金</td> <td> <table> <tr> <td> <div onclick="{onSelectUpLine1CommissionType1}" class="radio form-inline"> <label for="upLine1CommissionTypeInput1"> <input id="upLine1CommissionTypeInput1" value="{__app.enums.CommissionType.names.Cash}" __checked="{course.upLine1CommissionType === __app.enums.CommissionType.names.Cash}" type="radio" name="upLine1CommissionType"> 金额 </label> </div> </td> <td> <input id="upLine1CommissionValueInput1" onblur="{onBlurUpLine1CommissionValue(\'val\')}" __disabled="{course.upLine1CommissionType != __app.enums.CommissionType.names.Cash}" value="{course.upLine1CommissionType === __app.enums.CommissionType.names.Cash && course.upLine1CommissionValue || \'\'}" class="form-control" type="number"> </td> </tr> <tr> <td> <div onclick="{onSelectUpLine1CommissionType2}" class="radio form-inline"> <label for="upLine1CommissionTypeInput2"> <input id="upLine1CommissionTypeInput2" value="{__app.enums.CommissionType.names.Percent}" __checked="{course.upLine1CommissionType === __app.enums.CommissionType.names.Percent}" type="radio" name="upLine1CommissionType"> 百分比 </label> </div> </td> <td> <input id="upLine1CommissionValueInput2" onblur="{onBlurUpLine1CommissionValue(\'percent\')}" __disabled="{course.upLine1CommissionType != __app.enums.CommissionType.names.Percent}" value="{course.upLine1CommissionType === __app.enums.CommissionType.names.Percent && course.upLine1CommissionValue || \'\'}" class="form-control" type="number"> </td> </tr> </table> </td> </tr> <tr> <td><strong>间接分销商-间接推荐人</strong></td> <td>单位课程佣金</td> <td> <table> <tr> <td> <div onclick="{onSelectUpLine2CommissionType1}" class="radio form-inline"> <label for="upLine2CommissionTypeInput1"> <input id="upLine2CommissionTypeInput1" value="{__app.enums.CommissionType.names.Cash}" __checked="{course.upLine2CommissionType === __app.enums.CommissionType.names.Cash}" type="radio" name="upLine2CommissionType"> 金额 </label> </div> </td> <td> <input id="upLine2CommissionValueInput1" onblur="{onBlurUpLine2CommissionValue(\'val\')}" __disabled="{course.upLine2CommissionType != __app.enums.CommissionType.names.Cash}" value="{course.upLine2CommissionType === __app.enums.CommissionType.names.Cash && course.upLine2CommissionValue || \'\'}" class="form-control" type="number"> </td> </tr> <tr> <td> <div onclick="{onSelectUpLine2CommissionType2}" class="radio form-inline"> <label for="upLine2CommissionTypeInput2"> <input id="upLine2CommissionTypeInput2" value="{__app.enums.CommissionType.names.Percent}" __checked="{course.upLine2CommissionType === __app.enums.CommissionType.names.Percent}" type="radio" name="upLine2CommissionType"> 百分比 </label> </div> </td> <td> <input id="upLine2CommissionValueInput2" onblur="{onBlurUpLine2CommissionValue(\'percent\')}" __disabled="{course.upLine2CommissionType != __app.enums.CommissionType.names.Percent}" value="{course.upLine2CommissionType === __app.enums.CommissionType.names.Percent && course.upLine2CommissionValue || \'\'}" class="form-control" type="number"> </td> </tr> </table> </td> </tr> <tr> <td><strong>第三级分销商-间接推荐人的推荐人</strong></td> <td>单位课程佣金</td> <td> <table> <tr> <td> <div onclick="{onSelectUpLine3CommissionType1}" class="radio form-inline"> <label for="upLine3CommissionTypeInput1"> <input id="upLine3CommissionTypeInput1" value="{__app.enums.CommissionType.names.Cash}" __checked="{course.upLine3CommissionType === __app.enums.CommissionType.names.Cash}" type="radio" name="upLine3CommissionType"> 金额 </label> </div> </td> <td> <input id="upLine3CommissionValueInput1" onblur="{onBlurUpLine3CommissionValue(\'val\')}" __disabled="{course.upLine3CommissionType != __app.enums.CommissionType.names.Cash}" value="{course.upLine3CommissionType === __app.enums.CommissionType.names.Cash && course.upLine3CommissionValue || \'\'}" class="form-control" type="number"> </td> </tr> <tr> <td> <div onclick="{onSelectUpLine3CommissionType2}" class="radio form-inline"> <label for="upLine3CommissionTypeInput2"> <input id="upLine3CommissionTypeInput2" value="{__app.enums.CommissionType.names.Percent}" __checked="{course.upLine3CommissionType === __app.enums.CommissionType.names.Percent}" type="radio" name="upLine3CommissionType"> 百分比 </label> </div> </td> <td> <input id="upLine3CommissionValueInput2" onblur="{onBlurUpLine3CommissionValue(\'percent\')}" __disabled="{course.upLine3CommissionType != __app.enums.CommissionType.names.Percent}" value="{course.upLine3CommissionType === __app.enums.CommissionType.names.Percent && course.upLine3CommissionValue || \'\'}" class="form-control" type="number"> </td> </tr> </table> </td> </tr> <tr> <td colspan="3" style="text-align: center">注： 如果佣金按百分比计算，佣金基数以实际消费者实付金额为准（即线下实际核销金额）</td> </tr> <tr> <td> <strong>分销海报背景</strong> </td> <td colspan="2"> <input onchange="{onFileChange}" id="posterInput" type="file" accept="image/jpeg, image/png, image/jpg"> <img style="width: 100px; margin-top: 10px" riot-src="{course.poster && !course.poster.data && __app.settings.api.url + \'/file?media_id=\' + course.poster || course.poster.data}"> </td> </tr> </table> </div> </div> </div>  <div class="row" style="margin-top: 10px"> <div class="col-md-12 col-lg-12 text-center"> <input __disabled="{!courseMediaPriceInput.value.trim() || !courseNameInput.value.trim() || !validators.allOk()}" onclick="{onSubmit}" type="button" class="btn btn-primary" value="保存"> <a href="#sd/courses" class="btn btn-default">取消</a> </div> </div> </div> </div> </div> </div>',".form-horizontal .control-label{ text-align: left !important; } .vcenter { vertical-align: middle; } .my-table{ width: 100%; } .my-table td{ width: 33.33333%; } .panel-default { border-top: none; border-color: #ddd; } .banners-container{ margin: 0px; margin-top: 10px;overflow: hidden;padding:0px } .banners-container >li { position: relative;width: 100px;height:100px;overflow: hidden;background-color: #EFEFEF; list-style-type:none;float:left;margin-right: 10px;line-height: 100px;text-align: center } .banners-container >li img{ width: 100px; } .banners-container >li div{ position: absolute; top: 0px; left: 0px; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); } .banners-container >li div >b{ position: absolute; top:38px; left:38px; width:24px; height:24px; } .close-a{ position: absolute; top:0px; left:10px; width: 4px; height: 24px; transform:rotate(45deg); background: white; } .close-b{ position: absolute; top:0px; left:10px; width: 4px; height: 24px; transform:rotate(135deg); background: white; }",function(t){
"use strict";var e=nest.presentable(this),n=3,i=domain.action("loadCourseById"),o=domain.action("updateCourseById");e.currNav=0,e.onChangeTab=function(t){return function(){e.currNav=t}},e.on("open",function(t){var n=t.req.paramList[0];e.posterInput.value="",i.newInvocation({id:n}).onDone(function(t){e.course=t.course,e.course.banners||(e.course.banners=[]),e.trigger("ready",!1),e.trigger("view-route-to")}).execute()}),e.onHover=function(){this.isImgMaskShow=!0},e.onUnHover=function(){this.isImgMaskShow=!1},e.on("mount",function(){e.validators=_.widget.validatify([]),setTimeout(function(){$("#richEditor").summernote({height:200,minHeight:null,maxHeight:null,focus:!0})},100)}),e.courseNameInputBlur=function(){var t=e.courseNameInput.value.trim();return t?void(e.course.name=t):e.validators.addToSet({success:!1,field:"课程名称",desc:"不能为空!",key:"courseNameInput"})},e.clear=function(){e.validators.clear()},e.courseDescInputBlur=function(){e.course.desc=e.courseDescInput.value.trim()},e.coursePromoteInputBlur=function(){e.course.slogan=e.coursePromoteInput.value.trim()},e.courseMediaPriceInputBlur=function(){var t=e.courseMediaPriceInput.value.trim();return t?void(e.course.listPrice=t):e.validators.addToSet({success:!1,field:"媒体价",desc:"不能为空!",key:"courseMediaPrice"})},e.onSelectMemberDiscountsType1=function(t){e.course.memberDiscountsType=__app.enums.CommissionType.names.Cash,e.course.memberDiscountsValue=""};var r=function(t,n,i){return t.trim()<0||parseInt(t.trim(),10)>parseInt(e.course.listPrice,10)?e.validators.addToSet({success:!1,field:n.value,desc:"所属金额小于0,或者大于媒体价",key:n.key}):(e.validators.pass(n.key),void i())},a=function(t,n,i){return t.trim()<=0||t.trim()>100?e.validators.addToSet({success:!1,field:n.value,desc:"请输入1到100的自然数",key:n.key}):(e.validators.pass(n.key),void i())};e.onValidateValue=function(t){r(t.target.value,{key:"membershipDiscountValue",value:"会员折扣金额非法"},function(){e.course.memberDiscountsValue=t.target.value})},e.onValidatePercent=function(t){a(t.target.value,{key:"membershipDiscountPercent",value:"会员折扣百分比非法"},function(){e.course.memberDiscountsValue=t.target.value})},e.onSelectMemberDiscountsType2=function(t){e.course.memberDiscountsType=__app.enums.CommissionType.names.Percent,e.course.memberDiscountsValue=""},e.onSelectUpLine1CommissionType1=function(t){e.course.upLine1CommissionType=__app.enums.CommissionType.names.Cash,e.course.upLine1CommissionValue=""},e.onSelectUpLine1CommissionType2=function(t){e.course.upLine1CommissionType=__app.enums.CommissionType.names.Percent,e.course.upLine1CommissionValue=""},e.onBlurUpLine1CommissionValue=function(t){return function(n){return"val"===t?void r(n.target.value,{key:"upLine1CommissionValue",value:"一级分销金额非法"},function(){e.course.upLine1CommissionValue=n.target.value}):void a(n.target.value,{key:"upLine1CommissionPercent",value:"一级分销百分比非法"},function(){e.course.upLine1CommissionValue=n.target.value})}},e.onSelectUpLine2CommissionType1=function(t){e.course.upLine2CommissionType=__app.enums.CommissionType.names.Cash,e.course.upLine2CommissionValue=""},e.onSelectUpLine2CommissionType2=function(t){e.course.upLine2CommissionType=__app.enums.CommissionType.names.Percent,e.course.upLine2CommissionValue=""},e.onBlurUpLine2CommissionValue=function(t){return function(n){return"val"===t?void r(n.target.value,{key:"upLine2CommissionValue",value:"二级分销金额非法"},function(){e.course.upLine2CommissionValue=n.target.value}):void a(n.target.value,{key:"upLine2CommissionPercent",value:"二级分销百分比非法"},function(){e.course.upLine2CommissionValue=n.target.value})}},e.onSelectUpLine3CommissionType1=function(t){e.course.upLine3CommissionType=__app.enums.CommissionType.names.Cash,e.course.upLine3CommissionValue=""},e.onSelectUpLine3CommissionType2=function(t){e.course.upLine3CommissionType=__app.enums.CommissionType.names.Percent,e.course.upLine3CommissionValue=""},e.onBlurUpLine3CommissionValue=function(t){return function(n){return"val"===t?void r(n.target.value,{key:"upLine3CommissionValue",value:"三级分销金额非法"},function(){e.course.upLine3CommissionValue=n.target.value}):void a(n.target.value,{key:"upLine3CommissionPercent",value:"三级分销百分比非法"},function(){e.course.upLine3CommissionValue=n.target.value})}},e.onFileChange=function(t){var n=document.getElementById("posterInput").files[0];if(n.size>2097152)return void alert("文件大小超过限制-2M");var i=new FileReader;i.readAsDataURL(n),i.onload=function(t){e.course.poster={file:n,data:t.target.result},e.update()}},e.removeBanner=function(t){e.course.banners.map(function(n,i){return n&&n.file&&n.file.name&&t.item.banner&&t.item.banner.file&&t.item.banner.file.name?void(n.file.name===t.item.banner.file.name&&e.course.banners.splice(i,1)):void(n===t.item.banner&&e.course.banners.splice(i,1))})},e.onBannersChange=function(t){var i=document.getElementById("bannersInput").files;if(e.course.banners){if(e.course.banners.length+i.length>n)return void alert("焦点图最多"+n+"张")}else if(i.length>n)return void alert("焦点图最多"+n+"张");if(i&&i.length){var o=0,r=function(t){var n=i[t];if(n){if(n.size>2097152)return void alert("文件大小超过限制-2M");var o=new FileReader;o.readAsDataURL(n),o.onload=function(i){e.course.banners||(e.course.banners=[]),e.course.banners.push({file:n,data:i.target.result}),e.update(),r(++t)}}};r(o)}},e.onSubmit=function(){function t(){i==n&&o.newInvocation(r).onDone(function(t){riot.route("sd/courses")}).execute()}var n=0,i=0,r={id:e.course._id,o:e.course};if(e.course.poster&&e.course.poster.file){++n;var a=new FormData;a.append("file",e.course.poster.file),$.ajax({url:__app.settings.api.url+"/file/upload",type:"POST",data:a,processData:!1,contentType:!1,success:function(e){r.o.poster=e.media_id,++i,t()},error:function(t){console.error("失败:"+JSON.stringify(t))}})}if(e.course.banners){++n;var s=new FormData;e.course.banners.map(function(t){t.file&&s.append("files",t.file)}),$.ajax({url:__app.settings.api.url+"/file/uploads",type:"POST",data:s,processData:!1,contentType:!1,success:function(n){var o=[];e.course.banners&&e.course.banners.length&&(o=e.course.banners.filter(function(t){return"string"==typeof t})),r.o.banners=o.concat(n.metas.map(function(t){return t.media_id})),++i,t()},error:function(t){console.error("失败:"+JSON.stringify(t))}})}t()}}),riot.tag("boss-tenant-sd-courses",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/courses"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>课程管理</h4> </div> <div class="row"> <form class="form-inline"> <div class="col-md-6 col-lg-6"> <div class="form-group"> <label for="coursesStatus">状态</label> <select id="coursesStatus" class="form-control" onchange="{onSelect}"> <option value="">全部状态</option> <option value="{__app.enums.LiveStatus.names.Idle}">待上架</option> <option value="{__app.enums.LiveStatus.names.GoLive}">已上架</option> <option value="{__app.enums.LiveStatus.names.Sunset}">已下架</option> </select> </div> <input onclick="{onSearch}" class="btn btn-primary" type="button" value="查询"> </div> <div class="col-md-6 col-lg-6 text-right"> <a class="btn btn-primary" href="#sd/courses/add">添加</a> </div> </form> </div> <div class="row" style="margin-top: 10px"> <table class="table table-striped"> <thead> <tr> <th>名称</th> <th>状态</th> <th>上/下架时间</th> <th>创建时间</th> <th>备注</th> </tr> </thead> <tbody> <tr each="{courses}"> <td> <a href="#sd/courses/_{_id}"> {name} </a> </td> <td> { __app.enums.LiveStatus.values[liveStatus] } </td> <td> { actionTime && _.date.format(new Date(actionTime), \'yyyy-MM-dd hh点mm分\') || \'空\'} </td> <td> {_.date.format(new Date(crtOn), \'yyyy-MM-dd hh点mm分\')} </td> <td> { desc } </td> </tr> </tbody> </table> </div> </div> </div> </div>',function(t){"use strict";var e=nest.presentable(this),n=domain.action("findCourses");e.courses=[],e.filter={},console.log(__app.enums),e.on("open",function(){n.newInvocation({tenant:__page.tenantId,filter:e.filter}).onDone(function(t){return t.error?alert("failed to search courses"):(e.courses=t.courses,e.trigger("ready",!1),void e.trigger("view-route-to"))}).execute()}),e.onSearch=function(t){n.newInvocation({tenant:__page.tenantId,filter:e.filter}).onDone(function(t){return t.error?alert("failed to search courses"):void e.update({courses:t.courses})}).execute()},e.onSelect=function(t){var n=e.coursesStatus.value;return n?void(e.filter.liveStatus=n):void(e.filter.hasOwnProperty("liveStatus")&&delete e.filter.liveStatus)}}),riot.tag("boss-tenant-sd-customers",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/customers"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>客户管理</h4> </div> <div class="row"> <form class="form-inline"> <div class="col-md-12 col-lg-12"> <div class="form-group"> <label for="wechatsitesSelect">公众号</label> <select id="wechatsitesSelect" class="form-control" onchange="{onSelect}"> <option value="">全部</option> <option each="{wechatsites}" value="{originalId}">{name}</option> </select> </div> <input onclick="{onSearch}" class="btn btn-primary" type="button" value="查询"> </div> </form> </div> <div class="row" style="margin-top: 10px"> <span if="{!customers.length}"> <strong>该机构尚没有任何客户.</strong> </span> <table if="{customers.length}" class="table table-striped"> <thead> <tr> <th>名称</th> <th>所属公众号</th> <th>上线分销商</th> <th>创建时间</th> <th>备注</th> </tr> </thead> <tbody> <tr each="{customers}"> <td> { user.nickname } </td> <td> { media.name } </td> <td> { upLine && upLine.user.nickname || \'顶级\' } </td> <td> {_.date.format(new Date(crtOn), \'yyyy-MM-dd hh点mm分\')} </td> <td> { desc } </td> </tr> </tbody> </table> <div> <input onclick="{prevPage}" type="button" class="btn btn-default" value="上一页"> <span>当前页: </span> <span>{filter.no}</span>, <span>共( {totalPage} )页: </span> <input onclick="{nextPage}" type="button" class="btn btn-default" value="下一页"> <input name="pageTo" type="number" value=""> <input onclick="{jumpToPage}" type="button" class="btn btn-default" value="跳转"> </div> </div> </div> </div> </div>',function(t){"use strict";var e=nest.presentable(this),n=domain.action("findCustomersByTenantId"),i=domain.action("findCustomersCountByTenantId"),o=domain.action("loadAllTenantWechatSite");e.customers=[],e.totalPage=1,e.filter={tenant:__page.tenantId,no:1,size:10},e.on("mount",function(){n.onDone(function(t){e.customers=t.customers,e.update()})}),e.on("open",function(){o.newInvocation(__page.tenantId).onDone(function(t){e.update({wechatsites:t})}).execute(),i.newInvocation({tenant:__page.tenantId}).onDone(function(t){return t.error?alert("failed to search customers"):(e.totalPage=Math.ceil(t.count/e.filter.size),void e.update())}).execute(),n.newInvocation({filter:e.filter}).onDone(function(t){return t.error?alert("failed to search customers"):(e.customers=t.customers,e.trigger("ready",!1),void e.trigger("view-route-to"))}).execute()}),e.onSearch=function(t){n.execute({filter:e.filter})},e.onSelect=function(t){var n=e.wechatsitesSelect.value;return n?void(e.filter.wechatId=n):void(e.filter.hasOwnProperty("wechatId")&&delete e.filter.wechatId)},e.prevPage=function(t){var i=e.filter.no;1>=i||(e.filter.no=--i,n.execute({filter:e.filter}))},e.nextPage=function(t){var i=e.filter.no;i>=e.totalPage||(e.filter.no=++i,n.execute({filter:e.filter}))},e.jumpToPage=function(t){return console.log(typeof e.pageTo.value),""===e.pageTo.value.trim()?void alert("请输入页码"):e.pageTo.value<=0||e.pageTo.value>e.totalPage?void alert("页码非法"):(e.filter.no=parseInt(e.pageTo.value,10),void n.execute({filter:e.filter}))}}),riot.tag("boss-tenant-sd-distributors",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/distributors"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>分销商管理</h4> </div> <div class="row"> <form class="form-inline"> <div class="col-md-12 col-lg-12"> <div class="form-group"> <label for="wechatsitesSelect">公众号</label> <select id="wechatsitesSelect" class="form-control" onchange="{onSelect}"> <option value="">全部</option> <option each="{wechatsites}" value="{originalId}">{name}</option> </select> </div> <input onclick="{onSearch}" class="btn btn-primary" type="button" value="查询"> </div> </form> </div> <div class="row" style="margin-top: 10px"> <span if="{!distributors.length}"> <strong>该机构尚没有任何分销商.</strong> </span> <table if="{distributors.length}" class="table table-striped"> <thead> <tr> <th>名称</th> <th>所属公众号</th> <th>上线分销商</th> <th>创建时间</th> <th>备注</th> </tr> </thead> <tbody> <tr each="{distributors}"> <td> { user.nickname } </td> <td> { media.name } </td> <td> { upLine && upLine.user.nickname || \'顶级\' } </td> <td> {_.date.format(new Date(crtOn), \'yyyy-MM-dd hh点mm分\')} </td> <td> { desc } </td> </tr> </tbody> </table> <div> <input onclick="{prevPage}" type="button" class="btn btn-default" value="上一页"> <span>当前页: </span> <span>{filter.no}</span>, <span>共( {totalPage} )页: </span> <input onclick="{nextPage}" type="button" class="btn btn-default" value="下一页"> <input name="pageTo" type="number" value=""> <input onclick="{jumpToPage}" type="button" class="btn btn-default" value="跳转"> </div> </div> </div> </div> </div>',function(t){"use strict";var e=nest.presentable(this),n=domain.action("findDistributorsByTenantId"),i=domain.action("findDistributorsCountByTenantId"),o=domain.action("loadAllTenantWechatSite");e.distributors=[],e.totalPage=1,e.filter={tenant:__page.tenantId,no:1,size:10},e.on("mount",function(){n.onDone(function(t){e.distributors=t.distributors,e.update()})}),e.on("open",function(){o.newInvocation(__page.tenantId).onDone(function(t){e.update({wechatsites:t})}).execute(),i.newInvocation({tenant:__page.tenantId}).onDone(function(t){return t.error?alert("failed to search distributors"):(e.totalPage=Math.ceil(t.count/e.filter.size),void e.update())}).execute(),n.newInvocation({filter:e.filter}).onDone(function(t){return t.error?alert("failed to search distributors"):(e.distributors=t.distributors,e.trigger("ready",!1),void e.trigger("view-route-to"))}).execute()}),e.onSearch=function(t){n.execute({filter:e.filter})},e.onSelect=function(t){var n=e.wechatsitesSelect.value;return n?void(e.filter.wechatId=n):void(e.filter.hasOwnProperty("wechatId")&&delete e.filter.wechatId)},e.prevPage=function(t){var i=e.filter.no;1>=i||(e.filter.no=--i,n.execute({filter:e.filter}))},e.nextPage=function(t){var i=e.filter.no;i>=e.totalPage||(e.filter.no=++i,n.execute({filter:e.filter}))},e.jumpToPage=function(t){return console.log(typeof e.pageTo.value),""===e.pageTo.value.trim()?void alert("请输入页码"):e.pageTo.value<=0||e.pageTo.value>e.totalPage?void alert("页码非法"):(e.filter.no=parseInt(e.pageTo.value,10),void n.execute({filter:e.filter}))}}),riot.tag("boss-tenant-sd-left",'<div class="my-container"> <accordion navs="{navs}"></accordion> </div>',"boss-tenant-sd-left .my-container{ background: white; }",function(t){var e=this;e.navs=[{path:"sd",presentation:"首页"},{path:"sd/courses",presentation:"课程管理"},{path:"sd/catalogs",presentation:"课程目录管理"},{path:"sd/bespeaks",presentation:"预约管理"},{path:"sd/orders",presentation:"订单管理"},{path:"sd/customers",presentation:"客户管理"},{path:"sd/distributors",presentation:"分销商管理"},{path:"sd/splitbill",presentation:"分账管理"}],e.on("mount",function(){var t=this.opts.path;e.navs.forEach(function(e){e.path===t&&(e.useAsDefault=!0)})})}),riot.tag("boss-tenant-sd-orders",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/orders"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>订单管理</h4> </div> <div class="row"> <form class="form-inline"> <div class="col-md-6 col-lg-6"> <div class="form-group"> <label for="orderStatus">状态</label> <select id="orderStatus" class="form-control" onchange="{onSelect}"> <option value="">全部状态</option> <option value="{__app.enums.OrderStatus.names.finish}">已结算</option> <option value="{__app.enums.OrderStatus.names.unFinish}">未结算</option> </select> </div> <input onclick="{onSearch}" class="btn btn-primary" type="button" value="查询"> </div> </form> </div> <div class="row" style="margin-top: 10px"> <table class="table table-striped"> <thead> <tr> <th>客户昵称</th> <th>课程</th> <th>状态</th> <th>成交价</th> <th>创建时间</th> <th colspan="3">受益分销商</th> </tr> </thead> <tbody> <tr each="{orders}"> <td> {bespeak.user.nickname} </td> <td> {bespeak.product.name} </td> <td> { __app.enums.OrderStatus.values[status] } </td> <td> { finalPrice } </td> <td> {_.date.format(new Date(crtOn), \'yyyy-MM-dd hh点mm分\')} </td> <td> {distributors && distributors[0] && parent.getDistributorMoney(distributors[0].user, bespeak.product, 1, finalPrice) || \'无\'} </td> <td> {distributors && distributors[1] && parent.getDistributorMoney(distributors[1].user, bespeak.product, 2, finalPrice) || \'无\'} </td> <td> {distributors && distributors[2] && parent.getDistributorMoney(distributors[2].user, bespeak.product, 3, finalPrice) || \'无\'} </td> </tr> </tbody> </table> <div> <input onclick="{prevPage}" type="button" class="btn btn-default" value="上一页"> <span>当前页: </span> <span>{filter.no}</span>, <span>共( {totalPage} )页: </span> <input onclick="{nextPage}" type="button" class="btn btn-default" value="下一页"> <input name="pageTo" type="number" value=""> <input onclick="{jumpToPage}" type="button" class="btn btn-default" value="跳转"> </div> </div> </div> </div> </div>',function(t){"use strict";var e=nest.presentable(this),n=domain.action("findOrders");e.orders=[],e.totalPage=1,e.filter={tenant:__page.tenantId,no:1,size:10},e.on("mount",function(){n.onDone(function(t){t.error?console.error("failed find orders err:"+t.error):(e.orders=t.orders,e.totalPage=Math.ceil(t.count/e.filter.size),e.update())})}),e.on("open",function(){n.execute({filter:e.filter}),e.trigger("ready",!1),e.trigger("view-route-to")}),e.onSearch=function(t){n.execute({filter:e.filter})},e.onSelect=function(t){var n=e.orderStatus.value;return n?void(e.filter.status=n):void(e.filter.hasOwnProperty("status")&&delete e.filter.status)},e.getDistributorMoney=function(t,e,n,i){var o=0,r="upLine"+n+"CommissionType",a="upLine"+n+"CommissionValue";return e[r]===__app.enums.CommissionType.names.Percent?o=(parseFloat(i)*parseFloat(parseFloat(e[a])/100)).toFixed(2):e[r]===__app.enums.CommissionType.names.Cash&&(o=parseFloat(e[a])),t.nickname+": "+o},e.prevPage=function(t){var i=e.filter.no;1>=i||(e.filter.no=--i,n.execute({filter:e.filter}))},e.nextPage=function(t){var i=e.filter.no;i>=e.totalPage||(e.filter.no=++i,n.execute({filter:e.filter}))},e.jumpToPage=function(t){return console.log(typeof e.pageTo.value),""===e.pageTo.value.trim()?void alert("请输入页码"):e.pageTo.value<=0||e.pageTo.value>e.totalPage?void alert("页码非法"):(e.filter.no=parseInt(e.pageTo.value,10),void n.execute({filter:e.filter}))}}),riot.tag("boss-tenant-sd-splitbill",'<div if="{!hidden}" class="container" style="margin-top: 0px"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd/splitbill"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row" style="text-align: center"> <h4>分账管理</h4> </div>                 <div class="row" style="margin-top: 10px"> <span if="{!distributors.length}"> <strong>尚没有未结款项.</strong> </span> <table if="{distributors.length}" class="table table-striped"> <thead> <tr> <th>分销商</th> <th>所属公众号</th> <th>待结款</th> <th>结款</th> </tr> </thead> <tbody> <tr each="{distributors}"> <td> <a data-toggle="modal" data-target="#ordersInDistributors" onclick="{parent.onClickDistributor}">{ user.nickname }</a> </td> <td> { media.name } </td> <td> { accountBalance || \'顶级\' } </td> <td> <input onclick="{parent.onCheckout}" data-toggle="modal" data-target="#modal" type="button" class="btn btn-default" value="结款"> </td> </tr> </tbody> </table> <div> <input onclick="{prevPage}" type="button" class="btn btn-default" value="上一页"> <span>当前页: </span> <span>{filter.no}</span>, <span>共( {totalPage} )页: </span> <input onclick="{nextPage}" type="button" class="btn btn-default" value="下一页"> <input name="pageTo" type="number" value=""> <input onclick="{jumpToPage}" type="button" class="btn btn-default" value="跳转"> </div> </div> <div id="ordersInDistributors" class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"> <div class="modal-dialog modal-lg"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title">相关订单</h4> </div> <div class="modal-body"> <table class="table table-striped"> <thead> <tr> <th>客户</th> <th>产品</th> <th>成交价</th> <th>所获分成</th> </tr> </thead> <tbody> <tr each="{orders}"> <td> { bespeak.user.nickname } </td> <td> { bespeak.product.name } </td> <td> { finalPrice } </td> <td> { commission } </td> </tr> </tbody> </table> </div> </div> </div> </div> </div> </div> </div>',function(t){"use strict";var e=nest.presentable(this),n=domain.action("findDistributorsWithPendingPaymentByTenantId"),i=domain.action("findDistributorsCountWithPendingPaymentByTenantId"),o=domain.action("findOrderRelatedDistributor"),r=domain.action("checkout");e.distributors=[],e.totalPage=1,e.filter={tenant:__page.tenantId,no:1,size:10},e.on("mount",function(){n.onDone(function(t){e.distributors=t.distributors,e.update()})}),e.on("open",function(){i.newInvocation({tenant:__page.tenantId}).onDone(function(t){return t.error?alert("failed to search distributors"):(e.totalPage=Math.ceil(t.count/e.filter.size),void e.update())}).execute(),n.newInvocation({filter:e.filter}).onDone(function(t){return t.error?alert("failed to search distributors"):(e.distributors=t.distributors,e.trigger("ready",!1),void e.trigger("view-route-to"))}).execute()}),e.onSearch=function(t){n.execute({filter:e.filter})},e.onClickDistributor=function(t){o.newInvocation({distributor:t.item._id,status:__app.enums.OrderStatus.names.unFinish}).onDone(function(n){return n.error?void alert("获取相关订单失败"):(e.orders=n.orders.map(function(e){var n=0,i=e.bespeak.product;if(e.distributors){var o=e.distributors.indexOf(t.item._id)+1,r=i["upLine"+o+"CommissionType"],a=i["upLine"+o+"CommissionValue"];n=r===__app.enums.CommissionType.names.Percent?parseFloat(e.finalPrice)*parseFloat(parseFloat(a)/100):a}return e.commission=n,e}),void e.update())}).execute()},e.onCheckout=function(t){_.widget.confirm({title:"操作确认",content:"你已经为 [ "+t.item.user.nickname+" ] 结清款项了吗？",callback:function(){r.newInvocation({media:t.item.media,distributor:t.item._id,tenant:__page.tenantId}).onDone(function(t){return t.error?void alert("借款失败,请联系管理员"):void n.execute({filter:e.filter})}).execute()}})},e.onSelect=function(t){var n=e.coursesStatus.value;return n?void(e.filter.liveStatus=n):void(e.filter.hasOwnProperty("liveStatus")&&delete e.filter.liveStatus)},e.prevPage=function(t){var i=e.filter.no;1>=i||(e.filter.no=--i,n.execute({filter:e.filter}))},e.nextPage=function(t){var i=e.filter.no;i>=e.totalPage||(e.filter.no=++i,n.execute({filter:e.filter}))},e.jumpToPage=function(t){return""===e.pageTo.value.trim()?void alert("请输入页码"):e.pageTo.value<=0||e.pageTo.value>e.totalPage?void alert("页码非法"):(e.filter.no=parseInt(e.pageTo.value,10),void n.execute({filter:e.filter}))}}),riot.tag("boss-tenant-sd",'<div if="{!hidden}" class="container"> <div class="row"> <div class="col-md-3 col-lg-3"> <boss-tenant-sd-left path="sd"></boss-tenant-sd-left> </div> <div class="col-md-9 col-lg-9"> <div class="row"> <h4 class="text-center">欢迎来到课程分销系统</h4> </div> </div> </div> </div>',function(t){var e=nest.presentable(this);e.on("open",function(){e.trigger("ready",!1),e.trigger("view-route-to")})}),riot.tag("boss-tenant-topbar",'<nav class="navbar navbar-default navbar-inverse" role="navigation" style="margin-bottom: 5px; border-radius: 0;"> <div class="collapse navbar-collapse"> <a class="navbar-brand" style="font-size:20px; color: #ffffff">百加宝-平台端</a> <ul class="nav navbar-nav" style="width: 86%"> <li class="navbtn"><a id="tenant" href="#" route="tenant" class="myActive" onclick="{nav}">机构</a></li> <li class="navbtn"><a id="wechatsite" href="#" route="wechatsite" onclick="{nav}" >公众号</a></li> <li class="navbtn"><a id="sd" href="#" route="sd" onclick="{nav}">分销</a></li> <li class="navbtn"><a id="power" href="#" route="power/list" onclick="{nav}">助力活动</a></li> <li style="float: right;"><a href="#" style="font-size: 1.4em" class="glyphicon glyphicon-off" title="退出" onclick="{logout}"></a></li> <li style="float: right; margin-right: 20px; padding-top: 5px;"> <img riot-src="{headimgurl}" style="height: 40px; width: 40px" alt=""><span style="margin-left: 10px; color: white">{nickname}</span> </li> </ul> </div> </nav>',".navbtn{padding-left: 20px; font-size:16px} .myActive{color: #ffffff !important; border:0; outline: none !important;}",function(t){this.headimgurl=__page.user.headimgurl,this.nickname=__page.user.nickname,this.on("mount",function(){if(window.location.hash){$(".navbtn a").removeClass("myActive");var t=new RegExp(/^#[a-z, A-Z, _]+/),e=t.exec(window.location.hash);$(e[0]).addClass("myActive")}}),this.logout=function(t){$.get("/logout",function(t){window.location.href="/login"})}.bind(this),this.nav=function(t){t.preventUpdate=!0,$(".navbtn a").removeClass("myActive"),$(t.currentTarget).addClass("myActive"),riot.route($(t.currentTarget).attr("route"))}.bind(this)}),riot.tag("boss-tenant-wechatsite",'<div class="container" if="{!hidden}"> <div class="row"> <div class="col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2" style="text-align: center"><h3>公众号管理</h3></div> </div> <div class="row" style="margin-top: 10px"> <div class="action col-md-offset-2 col-lg-offset-2"> <button class="btn btn-default" onclick="{add}">添加</button> </div> <div class="col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2"> <div class="row panel-container"> <table class="table table-striped"> <thead> <tr> <th>名称</th> <th>类型</th> <th>状态</th> <th>创建时间</th> </tr> </thead> <tbody> <tr each="{wechatSites}"> <td><a href="#wechatsite/_{_id}">{name}</a></td> <td>{ __app.enums.WechatSiteType.values[wechatSiteType] }</td> <td>{ __app.enums.LifeFlag.values[lFlg] }</td> <td>{_.date.format(new Date(crtOn), \'yyyy-MM-dd hh点mm分\')}</td> </tr> </tbody> </table> </div> </div> </div> </div>',"boss-tenant-wechatsite .panel-container >div{ height: 40px; line-height: 40px; }",function(t){var e=nest.presentable(this),n=domain.action("loadAllTenantWechatSite"),i=function(t){e.update({wechatSites:t})};e.on("open",function(){n.execute(__page.tenantId),e.trigger("ready",!1),e.trigger("view-route-to")}),e.on("mount",function(){n.onDone(i)}),e.add=function(t){riot.route("wechatsite/add")}}),riot.tag("boss-tenant",'<div class="container" if="{!hidden}"> <div class="row"> <div class="col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2" style="text-align: center"><h3>{tenant.name}</h3></div> </div> <div class="row" style="margin-top: 30px"> <div class="col-md-4 col-md-offset-3 col-lg-4 col-lg-offset-3"> <div class="row panel-container"> <div class="col-md-6">名称</div> <div class="col-md-6">{tenant.name}</div> <div class="col-md-6">类型</div> <div class="col-md-6">{__app.enums.PartyType.values[tenant.type]}</div> <div class="col-md-6">状态</div> <div class="col-md-6">{ __app.enums.LifeFlag.values[tenant.lFlg]}</div> <div class="col-md-6">创建时间</div> <div class="col-md-6">{_.date.format(new Date(tenant.crtOn), \'yyyy-MM-dd hh点mm分\')}</div> <div class="col-md-6">备注</div> <div class="col-md-6">{tenant.desc}</div> </div> </div> </div> </div>',"boss-tenant .panel-container >div{ height: 40px; line-height: 40px; }",function(t){var e=nest.presentable(this),n=domain.action("loadTenantById"),i=function(t){e.update({tenant:t.tenant})};e.on("open",function(){n.execute({id:__page.tenantId}),e.trigger("ready",!1),e.trigger("view-route-to")}),e.on("mount",function(){n.onDone(i)}),e.on("unmount",function(){n.offDone(i)})}),riot.tag("boss-topbar",'<nav class="navbar navbar-default navbar-inverse" role="navigation" style="margin-bottom: 5px; border-radius: 0;"> <div class="collapse navbar-collapse"> <a class="navbar-brand" style="font-size:20px; color: #ffffff">微节点</a> <ul class="nav navbar-nav" style="width: 88%"> <li class="navbtn"><a id="tenants" href="#" route="tenants" class="myActive" onclick="{tenants}">机构</a></li> <li class="navbtn"><a id="power" href="/marketing/boss/power" >助力活动</a></li> <li style="float: right;"><a href="#" style="font-size: 1.4em" class="glyphicon glyphicon-off" title="退出" onclick="{logout}"></a></li> <li style="float: right; margin-right: 20px; padding-top: 5px;"> <img riot-src="{headimgurl}" style="height: 40px; width: 40px" alt=""><span style="margin-left: 10px; color: white">{nickname}</span> </li> </ul> </div> </nav>',".navbtn{padding-left: 20px; font-size:16px} .myActive{color: #ffffff !important; border:0; outline: none !important;}",function(t){this.headimgurl=__page.user.headimgurl,this.nickname=__page.user.nickname,this.on("mount",function(){if(window.location.hash){$(".navbtn a").removeClass("myActive");var t=new RegExp(/^#[a-z, A-Z, _]+/),e=t.exec(window.location.hash);$(e[0]).addClass("myActive")}}),this.logout=function(t){$.get("/logout",function(t){window.location.href="/login"})}.bind(this),this.tenants=function(t){t.preventUpdate=!0,$(".navbtn a").removeClass("myActive"),$(t.currentTarget).addClass("myActive"),riot.route($(t.currentTarget).attr("route"))}.bind(this)}),riot.tag("boss-wechatsite-add",'<div class="container" if="{!hidden}"> <alert validators="{validators}" clear="{clear}"></alert> <div class="row" style="margin-top: 10px"> <div class="action col-md-offset-2 col-lg-offset-2"> <a href="#wechatsite">返回公众号列表</a> </div> <div class="form-con col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2"> <div class="panel panel-default"> <div class="panel-heading">基本信息</div> <div class="panel-body"> <div class="row"> <div class="col-md-3">名称</div> <div class="col-md-9"><input name="name" class="form-control" type="text"></div> </div> <div class="row"> <div class="col-md-3">类型</div> <div class="col-md-9"> <select id="selectType" class="form-control"> <option value="voa">认证服务号</option> <option value="vsa">认证订阅号</option> <option value="oa">服务号</option> <option value="sa">订阅号</option> </select> </div> </div> <div class="row"> <div class="col-md-3">公众号邮箱</div> <div class="col-md-9"><input name="email" class="form-control" type="email"></div> </div> <div class="row"> <div class="col-md-3">原始ID</div> <div class="col-md-9"><input name="originalId" class="form-control" type="text"></div> </div> <div class="row"> <div class="col-md-3">AppID</div> <div class="col-md-9"><input name="appId" class="form-control" type="text"></div> </div> <div class="row"> <div class="col-md-3">AppSecret</div> <div class="col-md-9"><input name="appSecret" class="form-control" type="text"></div> </div> </div> </div> <div class="sub"> <input class="btn btn-primary" onclick="{submit}" type="button" value="提交"> <input class="btn btn-default" onclick="{cancel}" type="button" value="取消"> </div> </div> </div> </div>',"boss-wechatsite-add a { cursor: pointer; } boss-wechatsite-add .row{ margin-top: 10px; } boss-wechatsite-add .panel-container >div{ height: 40px; line-height: 40px; } boss-wechatsite-add .form-con { margin-top: 15px; padding: 0 0; } boss-wechatsite-add #selectType{ width: 30% !important; } boss-wechatsite-add .sub{ text-align: center; } boss-wechatsite-add .sub input{ margin-left: 30px; }",function(t){var e=nest.presentable(this);e.validators=[];var n=domain.action("addTenantWechatSite"),i=function(t){t.error||riot.route("wechatsite/_"+t.wechatSite._id)};e.on("open",function(){e.trigger("ready",!1),e.trigger("view-route-to")}),e.on("mount",function(){n.onDone(i)}),e.cancel=function(t){
riot.route("wechatsite")},e.verify=function(t){var n=!0;if(t.name||(e.validators.push({success:!1,field:"名称",desc:"不能为空!"}),n=!1),t.email||(e.validators.push({success:!1,field:"邮箱",desc:"不能为空!"}),n=!1),t.originalId||(e.validators.push({success:!1,field:"原始ID",desc:"不能为空!"}),n=!1),t.appId||(e.validators.push({success:!1,field:"AppID",desc:"不能为空!"}),n=!1),t.appSecret||(e.validators.push({success:!1,field:"AppSecret",desc:"不能为空!"}),n=!1),t.email){var i=new RegExp(/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/);i.test(t.email)||(e.validators.push({success:!1,field:"邮箱",desc:"输入邮箱非法!"}),n=!1)}return n},e.clear=function(){e.validators=[]},e.submit=function(t){e.validators=[];var i={org:__page.tenantId,name:e.name.value.trim(),email:e.email.value.trim(),originalId:e.originalId.value.trim(),appId:e.appId.value.trim(),appSecret:e.appSecret.value.trim(),wechatSiteType:e.selectType.value},o=e.verify(i);o&&n.execute(i)}}),riot.tag("boss-wechatsite-edit",'<div class="container" if="{!hidden}"> <alert validators="{validators}" clear="{clear}"></alert> <div class="row" style="margin-top: 10px"> <div class="action col-md-offset-2 col-lg-offset-2"> <a href="#wechatsite">返回公众号列表</a> </div> <div class="form-con col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2"> <div class="panel panel-default"> <div class="panel-heading">基本信息</div> <div class="panel-body"> <div class="row"> <div class="col-md-3">名称</div> <div class="col-md-9"><input name="name" class="form-control" type="text" value="{wechatSite.name}"></div> </div> <div class="row"> <div class="col-md-3">类型</div> <div class="col-md-9"> <select id="selectType" class="form-control"> <option value="voa">认证服务号</option> <option value="vsa">认证订阅号</option> <option value="oa">服务号</option> <option value="sa">订阅号</option> </select> </div> </div> <div class="row"> <div class="col-md-3">公众号邮箱</div> <div class="col-md-9"><input name="email" class="form-control" type="email" value="{wechatSite.email}"></div> </div> <div class="row"> <div class="col-md-3">原始ID</div> <div class="col-md-9"><input name="originalId" class="form-control" type="text" value="{wechatSite.originalId}"></div> </div> <div class="row"> <div class="col-md-3">AppID</div> <div class="col-md-9"><input name="appId" class="form-control" type="text" value="{wechatSite.appId}"></div> </div> <div class="row"> <div class="col-md-3">AppSecret</div> <div class="col-md-9"><input name="appSecret" class="form-control" type="text" value="{wechatSite.appSecret}"></div> </div> </div> </div> <div class="panel panel-default"> <div class="panel-heading">托管配置信息</div> <div class="panel-body"> <div class="row"> <div class="col-md-3">Token(令牌)</div> <div class="col-md-7" id="token">{ wechatSite.token }</div> <a class="col-md-2 resetToken" onclick="{resetToken}">重新生成</a> </div> <div class="row"> <div class="col-md-3">EncodingAESKey<br>(消息加解密密钥)</div> <div class="col-md-7" id="encodingAESKey">{ wechatSite.encodingAESKey }</div> <a class="col-md-2 resetAes" onclick="{resetAes}">重新生成</a> </div> </div> </div> <div class="sub"> <input class="btn btn-primary" onclick="{submit}" type="button" value="提交"> <input class="btn btn-default" onclick="{cancel}" type="button" value="取消"> </div> </div> </div> </div>',"boss-wechatsite-edit a { cursor: pointer; } boss-wechatsite-edit .row{ margin-top: 10px; } boss-wechatsite-edit .panel-container >div{ height: 40px; line-height: 40px; } boss-wechatsite-edit .form-con { margin-top: 15px; padding: 0 0; } boss-wechatsite-edit #selectType{ width: 30% !important; } boss-wechatsite-edit .sub{ text-align: center; padding-bottom: 50px; } boss-wechatsite-edit .sub input{ margin-left: 30px; }",function(t){var e=nest.presentable(this);e.validators=[];var n=domain.action("loadTenantWechatSite"),i=domain.action("updateTenantWechatSiteById");e.on("open",function(t){e.trigger("ready",!1),e.trigger("view-route-to"),e.id=t.id,n.newInvocation(t.id).onDone(function(t){e.update({wechatSite:t.wechatSite}),$("#selectType").find("option[value='"+t.wechatSite.wechatSiteType+"']").attr("selected",!0)}).execute()}),e.on("mount",function(){}),e.cancel=function(t){riot.route("wechatsite/_"+e.wechatSite._id)},e.verify=function(t){var n=!0;if(t.name||(e.validators.push({success:!1,field:"名称",desc:"不能为空!"}),n=!1),t.email||(e.validators.push({success:!1,field:"邮箱",desc:"不能为空!"}),n=!1),t.originalId||(e.validators.push({success:!1,field:"原始ID",desc:"不能为空!"}),n=!1),t.appId||(e.validators.push({success:!1,field:"AppID",desc:"不能为空!"}),n=!1),t.appSecret||(e.validators.push({success:!1,field:"AppSecret",desc:"不能为空!"}),n=!1),t.email){var i=new RegExp(/^(\w)+(\.\w+)*@(\w)+((\.\w+)+)$/);i.test(t.email)||(e.validators.push({success:!1,field:"邮箱",desc:"输入邮箱非法!"}),n=!1)}return n},e.clear=function(){e.validators=[]},e.submit=function(t){e.validators=[];var n={id:e.id,org:__page.tenantId,name:e.name.value.trim(),email:e.email.value.trim(),originalId:e.originalId.value.trim(),appId:e.appId.value.trim(),appSecret:e.appSecret.value.trim(),wechatSiteType:e.selectType.value,token:$("#token").text(),encodingAESKey:$("#encodingAESKey").text()},o=e.verify(n);o&&i.newInvocation(n).onDone(function(t){t.error?e.validators.push({success:!1,field:"公众号",desc:"修改失败!"}):riot.route("wechatsite/_"+e.wechatSite._id)}).execute()},e.resetToken=function(t){e.wechatSite.token=_.generateRandomString(20),e.update()},e.resetAes=function(t){e.wechatSite.encodingAESKey=_.generateRandomString(43),e.update()}}),riot.tag("boss-wechatsite",'<div class="container" if="{!hidden}"> <div class="row" style="margin-top: 10px"> <div class="row"> <div class="col-md-2 col-md-offset-2 col-lg-offset-2"> <a href="#wechatsite">返回公众号列表</a> </div> <div class="col-md-2 col-md-offset-1 col-lg-2 col-lg-offset-1" style="text-align: center"><h3>{wechatSite.name}</h3></div> </div> <div class="form-con col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2"> <div class="panel panel-default"> <div class="panel-heading">基本信息</div> <div class="panel-body"> <div class="row"> <div class="col-md-3">名称</div> <div class="col-md-9">{wechatSite.name}</div> </div> <div class="row"> <div class="col-md-3">类型</div> <div class="col-md-9">{ __app.enums.WechatSiteType.values[wechatSite.wechatSiteType] }</div> </div> <div class="row"> <div class="col-md-3">状态</div> <div class="col-md-9">{ __app.enums.LifeFlag.values[wechatSite.lFlg] }</div> </div> <div class="row"> <div class="col-md-3">创建时间</div> <div class="col-md-9">{_.date.format(new Date(wechatSite.crtOn), \'yyyy-MM-dd hh点mm分\')}</div> </div> <div class="row"> <div class="col-md-3">公众号邮箱</div> <div class="col-md-9">{wechatSite.email}</div> </div> <div class="row"> <div class="col-md-3">原始ID</div> <div class="col-md-9">{wechatSite.originalId}</div> </div> <div class="row"> <div class="col-md-3">AppID</div> <div class="col-md-9">{wechatSite.appId}</div> </div> <div class="row"> <div class="col-md-3">AppSecret</div> <div class="col-md-9">{wechatSite.appSecret}</div> </div> </div> </div> <div class="panel panel-default"> <div class="panel-heading">托管配置信息</div> <div class="panel-body"> <div class="row"> <div class="col-md-3">URL(服务器地址)</div> <div class="col-md-8" id="url">{__app.settings.app.protocol + \'://\' + __app.settings.app.domain + \'/wechat/\' + wechatSite.originalId + \'/message\'}</div> <a class="col-md-1 clip_button" data-clipboard-target="url">复制</a> </div> <div class="row"> <div class="col-md-3">Token(令牌)</div> <div class="col-md-8" id="token">{ wechatSite.token }</div> <a class="col-md-1 clip_button" data-clipboard-target="token">复制</a> </div> <div class="row"> <div class="col-md-3">EncodingAESKey<br>(消息加解密密钥)</div> <div class="col-md-8" id="encodingAESKey">{ wechatSite.encodingAESKey }</div> <a class="col-md-1 clip_button" data-clipboard-target="encodingAESKey">复制</a> </div> <div class="row"> <div class="col-md-3">公众号邮箱</div> <div class="col-md-8" id="email">{wechatSite.email}</div> <a class="col-md-1 clip_button" data-clipboard-target="email">复制</a> </div> <div class="row"> <div class="col-md-3">授权回调页面域名</div> <div class="col-md-8" id="callbackDomain">{__app.settings.app.domain}</div> <a class="col-md-1 clip_button" data-clipboard-target="callbackDomain">复制</a> </div> <div class="row"> <div class="col-md-3">JS接口安全域名</div> <div class="col-md-8" id="jsDomain">{__app.settings.app.domain}</div> <a class="col-md-1 clip_button" data-clipboard-target="jsDomain">复制</a> </div> </div> </div> <div class="action"> <a href="#wechatsite/edit/_{wechatSite._id}" class="btn btn-default">修改</a> <input if="{wechatSite.lFlg != \'a\'}" onclick="{unlockWechatSite}" class="btn btn-default" data-toggle="modal" data-target="#modal" type="button" value="激活"> <input if="{wechatSite.lFlg != \'i\'}" onclick="{lockWechatSite}" class="btn btn-default" data-toggle="modal" data-target="#modal" type="button" value="锁定"> <input if="{wechatSite.lFlg != \'d\'}" onclick="{delWechatSite}" class="btn btn-default" data-toggle="modal" data-target="#modal" type="button" value="删除"> </div> </div> </div> </div>',"boss-wechatsite a { cursor: pointer; } boss-wechatsite .row{ margin-top: 10px; } boss-wechatsite .panel-container >div{ height: 40px; line-height: 40px; } boss-wechatsite .form-con { margin-top: 15px; padding: 0 0; } boss-wechatsite .action{ text-align: center; padding-bottom: 50px; } boss-wechatsite .action input{ margin-left: 30px; }",function(t){var e=nest.presentable(this),n=domain.action("loadTenantWechatSite"),i=domain.action("updateTenantWechatSiteById"),o=function(t){t.error||e.update({wechatSite:t.wechatSite})};e.on("open",function(t){e.trigger("ready",!1),e.trigger("view-route-to"),n.execute(t.id);new ZeroClipboard($(".clip_button"))}),e.on("mount",function(){n.onDone(o)}),e.unlockWechatSite=function(){_.widget.confirm({title:"操作确认?",content:"你确认要“激活”该公众号吗？",callback:function(){e.wechatSite.lFlg=__app.enums.LifeFlag.names.Active,i.newInvocation({id:e.wechatSite._id,lFlg:e.wechatSite.lFlg}).onDone(function(t){e.update()}).execute()}})},e.lockWechatSite=function(){_.widget.confirm({title:"操作确认?",content:"你确认要“锁定”该公众号吗？",callback:function(){e.wechatSite.lFlg=__app.enums.LifeFlag.names.Inactive,i.newInvocation({id:e.wechatSite._id,lFlg:e.wechatSite.lFlg}).onDone(function(t){e.update()}).execute()}})},e.delWechatSite=function(){_.widget.confirm({title:"操作确认?",content:"你确认要“删除”该公众号吗？",callback:function(){e.wechatSite.lFlg=__app.enums.LifeFlag.names.Deleted,i.newInvocation({id:e.wechatSite._id,lFlg:e.wechatSite.lFlg}).onDone(function(t){e.update()}).execute()}})}}),riot.tag("broadcast",'<div if="{!hidden}"> <div if="{tip}" class="alert {addClass}" style="margin-top: -5px; float: left; width: 100%; text-align: center; margin-bottom: 0; position: absolute; z-index: 9999"> <strong>{tipInfo}</strong> </div> <div class="container" style="width: 100%; margin-left: 0; margin-right: 0; padding-left: 0; padding-right: 0"> <div class="row-fluid"> <div class="col-md-4 col-xs-4 col-sm-4" style="padding-right: 0; padding-left: 0; margin-top: -5px; width: 30%"> <div class="well sidebar-nav" style="padding-top: 0; padding-right: 0; padding-left: 0;height: 48em; background-color: #222; border: 1px solid #080808; overflow: scroll; border-radius: 0"> <div if="{!broadcastHistory.length}"> <ul style="padding: 0; margin: 0; list-style-type: none"> <li style="margin-bottom: 3px; padding: 25px 20px; background-color: #333; cursor: pointer; text-align: center"> <span style="color: white">暂无群发纪录</span> </li> </ul> </div> <div if="{broadcastHistory.length}"> <ul style="padding: 0; margin: 0; list-style-type: none"> <li each="{broadcastHistory}" style="position:relative; border-bottom: 1px solid #252525; padding: 5px 5px 5px 10px; background-color:#2E3238; cursor: pointer; color: white"> <div if="{contentType == \'image\'}" style="height: 100%; width: 100%"> <div style="display: -webkit-inline-box;"> <img style="width: 48px;height:48px" riot-src="{contentType == \'image\' && media_id && parent.api + \'/file/?media_id=\' + media_id}" alt=""> </div> <div style="position:absolute;right:10px;bottom:10px;font-size: 12px;float:right; text-align: right;">{parent.formatDate(crtOn)}</div> </div> <div if="{contentType == \'text\'}" style="height: 100%; width: 100%"> <div style="display: -webkit-inline-box; padding: 5px; min-height: 50px; overflow: hidden; width: 100%; font-size: 14px">{content}</div> <div style="position:absolute;right:10px;bottom:10px;font-size: 12px;float:right; text-align: right;">{parent.formatDate(crtOn)}</div> </div> </li> </ul> </div> </div> </div> <div class="col-md-8 col-xs-8 col-sm-8" style="padding-right: 1px; padding-left: 0; margin-top: -5px; width: 70%"> <div class="jumbotron" style="height: 48em; border-radius: 0"> <div id="broadcast"> <div class="panel panel-default" id="img_prew" style="display:none; margin-bottom: 10px"> <table class="table table-bordered" style="text-align: center; vertical-align: middle;"> <tbody> <tr> <td rowspan="3"> <img riot-src="{img_url}" alt="" style="height: 9em;"></td> <td>文件名</td> <td>{img_name}</td> </tr> <tr> <td>文件大小</td> <td>{img_size}</td> </tr> <tr> <td colspan="2"> <input class="btn btn-default" type="button" style="margin-right: 50px" value="取消" onclick="{cancel_send_img}"> <input class="btn btn-success" type="button" value="发送" onclick="{send_img}"> </td> </tr> </tbody> </table> </div> <div class="btn-group" style="float: left;margin-bottom: 10px"> <button type="button" class="btn btn-success dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <span id="groupDisplay">请选择分组</span><span class="caret"></span> </button> <ul class="dropdown-menu"> <li each="{groups}"><a href="javascript:void(0)" onclick="{parent.chooseGroup}" groupid="{_id}">{name}</a></li> </ul> <input id="group" type="hidden"> </div> <textarea id="broadcastMsg" style="height:160px;background: #FBFBFB;margin-top: 5px;" class="form-control" rows="3"></textarea> <button id="send" type="button" onclick="{broadcast}" style="margin-top: 1em; width: 7em;float:right" class="btn btn-success">发送</button> <div id="choose_img" style="float: right; margin-right: 20px; margin-top: 12px"> <span class="btn_addPic glyphicon glyphicon-picture" href="javascript:void(0);"><input id="img_file" type="file" class="filePrew" class="glyphicon glyphicon-picture" multiple="multiple" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="{previewImg}"></span> </div> </div> </div> </div> </div> </div> </div>',"broadcast .btn_addPic{ display: block; position: relative; font-size: 35px; width: 38px; height: 38px; overflow: hidden; cursor: pointer; text-align: center; } broadcast .filePrew { display: block; position: absolute; top: 0; left: 0; width: 38px; height: 38px; cursor: pointer; font-size: 100px; opacity: 0; filter:alpha(opacity=0); }",function(t){function e(t,e){var i="";"success"===t&&(i="alert-success"),"error"===t&&(i="alert-danger"),"info"===t&&(i="alert-info"),"warning"===t&&(i="alert-warning"),n.update({tip:!0,tipInfo:e,addClass:i}),setTimeout(function(){n.update({tip:!1,tipInfo:"",addClass:""})},1e3)}this.app=this.opts.app;var n=nest.presentable(this);n.env="production"==__app.settings.env.NODE_ENV?"public":"web",n.api=__app.settings.api.url,n.botId=__page.bot.customId,n.broadcastHistory=[],n.tip=!1,n.tipInfo="";var i=domain.action("broadcastTxt"),o=domain.action("broadcastImg"),r=domain.action("loadBroadcastHistory"),a=domain.action("loadGroups"),s=function(t){n.update({groups:t.groups})},l=function(t){$("#send").attr("disabled",!1),t.success?($("#broadcastMsg").val(""),t.msgArr.forEach(function(t){n.broadcastHistory.unshift(t)}),n.update(),e("success","群发成功")):e("error","群发失败")},c=function(t){t.success?($("#img_file").val(""),t.msgArr.forEach(function(t){n.broadcastHistory.unshift(t)}),n.update(),e("success","群发图片成功")):e("error","群发图片失败")},d=function(t){n.broadcastHistory=t.history||[],n.update()};this.on("mount",function(){console.info("tag broadcast index is mounted"),i.onDone(l),o.onDone(c),r.onDone(d),a.onDone(s)}),this.on("unmount",function(){console.info("tag broadcast index is unmounted"),i.offDone(l),o.offDone(c),r.offDone(d),a.offDone(s)}),this.on("open",function(t){console.info("tag broadcast index is opening"),n.trigger("ready",!1),n.trigger("view-route-to"),r.execute(n.botId),a.execute({tenantId:__page.user.posts[0].org,operatorId:__page.user.posts[0].member})}),this.on("leave",function(){n.mask=!0,n.update()}),this.on("reenter",function(){n.mask=!1,n.update()}),this.on("refresh",function(){console.info("tag broadcast index is refreshing")}),n.formatDate=function(t){var e=new Date(t).toLocaleString();return e.replace(/\//g,"-")},this.previewImg=function(t){var e=t.target.files[0];n.img_size=e.size/1e3+"KB",n.img_name=e.name;var i=new FileReader;i.onload=function(t){n.img_url=t.target.result,n.update(),$("#img_prew").show()},i.readAsDataURL(e)}.bind(this),this.cancel_send_img=function(t){$("#img_prew").hide()}.bind(this),this.send_img=function(t){var i=$("#group").val();if(i){var r=new FormData,a=$("#img_file")[0].files;r.append("file",a[0]),$.ajax({url:n.api+"/file/upload",type:"POST",data:r,processData:!1,contentType:!1,success:function(t){$("#img_prew").hide();var e={botId:n.botId,groupId:i,media_id:t.media_id};o.execute(e)},error:function(t){console.error("失败:"+JSON.stringify(t))}})}else e("warning","请先选择群发的分组")}.bind(this),this.broadcast=function(t){t.preventUpdate=!0;var o=$("#group").val();if(o){var r=$("#broadcastMsg").val().trim();if(r.length>0){var a={botId:n.botId,groupId:o,msg:r};i.execute(a),$(t.currentTarget).attr("disabled",!0)}else e("warning","发送内容不能为空")}else e("warning","请先选择群发的分组")}.bind(this),this.chooseGroup=function(t){$("#groupDisplay").text($(t.currentTarget).text()),$("#group").val($(t.currentTarget).attr("groupId"))}.bind(this)}),riot.tag("confirm",'<div class="modal fade" id="modal"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title">{title || \'操作确认\'}</h4> </div> <div class="modal-body"> <p>{content || \'确定吗?\'}&hellip;</p> </div> <div class="modal-footer"> <button onclick="{Cancel}" type="button" class="btn btn-default" data-dismiss="modal">取消</button> <button onclick="{Confirm}" type="button" class="btn btn-primary" data-dismiss="modal">确认</button> </div> </div> </div> </div>',function(t){var e=this;app.on("confirm",function(t){e.update({title:t.title,content:t.content})}),this.Cancel=function(t){app.trigger("confirmCancel")},this.Confirm=function(t){app.trigger("confirmOk")}}),riot.tag("contacts",'<div if="{!hidden}" onclick="{hideMenu}"> <div if="{tip}" class="alert {addClass}" style="margin-top: -5px; float: left; width: 100%; text-align: center; margin-bottom: 0; position: absolute; z-index: 9999"> <strong>{tipInfo}</strong> </div> <div class="container" style="width: 100%; margin-left: 0; margin-right: 0; padding-left: 0; padding-right: 0"> <div class="row-fluid"> <div class="col-md-4 col-xs-4 col-sm-4" style="padding-right: 0; padding-left: 0; margin-top: -5px; width: 30%"> <div class="row-fluid" style="height:50px; background: #2E3238;"> <div onclick="{selectContacts}" class="{left_nav_sel: viewModel.nav === CONST.NAV.CONTACT, left_nav_def: viewModel.nav != CONST.NAV.CONTACT} col-md-5 col-xs-5 col-sm-5" style="text-align: center;height:50px; line-height: 50px;border-right:1px solid #1C2129"> <span class="glyphicon glyphicon-user" aria-hidden="true"></span> &nbsp联系人 </div> <div onclick="{selectGroups}" class="{left_nav_sel: viewModel.nav === CONST.NAV.GROUP,left_nav_def: viewModel.nav != CONST.NAV.GROUP} col-md-5 col-xs-5 col-sm-5" style="border-right:1px solid #1C2129;text-align: center;height:50px; line-height: 50px"> <span class="glyphicon glyphicon-th" aria-hidden="true"></span> &nbsp群 </div> <div id="menuBtn" onclick="{toggleMenu}" class="{menu_open: menuOpen} col-md-2 col-xs-2 col-sm-2" style="overflow:visible;position:relative;height:50px;line-height: 50px;color:white;font-size:16px;text-align: center"> <span class="glyphicon glyphicon-cog" aria-hidden="true"></span> <div if="{menuOpen===true}" id="menu" style="position: absolute;top:50px;left:0px;width:170px;height:100px"> <ul style="list-style-type: none;margin: 0px;padding:0px;"> <li if="{!syncingContacts}" style="background: #4D5767;border-bottom: 1px solid #3F4650;text-align: left;padding-left:20px" onclick="{syncContact}"> <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> &nbsp<span style="font-size: 14px">同步联系人</span> </li> <li if="{syncingContacts}" style="background: #4D5767;border-bottom: 1px solid #3F4650;text-align: left;padding-left:20px"> <span class="sync glyphicon glyphicon-refresh" aria-hidden="true"></span> &nbsp<span style="font-size: 14px">正在同步联系人...</span> </li> <li if="{!syncingGroups}" style="background: #4D5767;border-bottom: 1px solid #3F4650;text-align: left;padding-left:20px" onclick="{syncGroup}"> <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span> &nbsp<span style="font-size: 14px">同步群</span> </li> <li if="{syncingGroups}" style="background: #4D5767;border-bottom: 1px solid #3F4650;text-align: left;padding-left:20px"> <span class="sync glyphicon glyphicon-refresh" aria-hidden="true"></span> &nbsp<span style="font-size: 14px">正在同步群...</span> </li> </ul> </div> </div> </div> <div class="well sidebar-nav" style="padding-top: 0; padding-right: 0; padding-left: 0;height: 48em; background-color: #2E3238; border: 1px solid #080808; overflow: scroll; border-radius: 0"> <ul if="{viewModel.nav === CONST.NAV.CONTACT}" style="padding: 0; margin: 0; list-style-type: none"> <li each="{contacts}" onclick="{parent.selectContact}" style="margin-bottom: 3px; padding: 5px 20px; border-bottom:1px solid #292C33; cursor: pointer"> <img riot-src="{parent.api + \'/file?media_id=\' + headimgurl}" style="width: 4em; height: 4em" alt=""> <span style="color: white; margin-left: 15px">{nickname}</span> </li> </ul> <span style="display:block;text-align: center;margin-top: 10px; color: white" if="{!groups || groups.length===0}">暂无相关记录</span> <ul if="{viewModel.nav === CONST.NAV.GROUP}" style="padding: 0; margin: 0; list-style-type: none"> <li each="{groups}" style="height:50px;line-height:40px;margin-bottom: 3px; padding: 5px 20px; border-bottom:1px solid #292C33; cursor: pointer">  <span style="color: white; margin-left: 15px">{nickname}</span> </li> </ul> </div> </div> <div if="{Object.keys(currUser).length>0}" class="col-md-8 col-xs-8 col-sm-8" style="padding-right: 1px; padding-left: 0; margin-top: -5px; width: 70%"> <div style="margin-bottom:50px;height: 50px;line-height:50px;border-bottom:1px solid #ddd;text-align: center"> <span>明细</span> </div> <div style="padding-bottom:30px;"> <div class="avatar" style="text-align: center;"><img riot-src="{api + \'/file?media_id=\' + currUser.headimgurl}" style="width:120px;height:120px;border-radius: 5px;margin-bottom: 10px"></div> <div class="nickname_area" style="text-align:center;height:48px;line-height: 48px;"><strong style="font-size: 24px;font-weight: 100">{currUser.nickname}</strong></div> <div style="width:70%;padding-left: 28%;margin: 0px auto;color:#999;margin-bottom:10px"> <label>备注: &nbsp&nbsp&nbsp&nbsp</label><span>{currUser.remark}</span><br> <label>地区: &nbsp&nbsp&nbsp&nbsp</label><span>{showPlace()}</span> </div> <div class="tags_area"> <div style="text-align: center; margin-bottom:20px"> <button if="{viewModel.mode===\'view\'}" onclick="{editTags}" type="button" class="btn btn-default" style="display:inline-block;background: #269227; color:white; border: none"> 编辑标签 </button> <button if="{viewModel.mode===\'edit\'}" onclick="{submitTags}" type="button" class="btn btn-default" style="display:inline-block;background: #269227; color:white; border: none"> 确认 </button>    </div> <ul onclick="{clickTags}" class="{tags_body:true, tags_body_edit:viewModel.mode===\'edit\'}"> <li style="position: relative" class="{tags_item:true ,tags_edit: parent.viewModel.mode===\'edit\'}" each="{name in (currUser.tags || [])}"> {name} <b onclick="{parent.removeTag}" if="{parent.viewModel.mode===\'edit\'}" style="position: absolute;border-radius: 50em;top:6px;right:3px;width:18px;height:18px;background:#8A8A8A"> <b style="width:16px;height:16px;border-radius: 50em;display:block;margin:4px auto"> <span style="position: absolute; top: 2px; left: 2px;" class="glyphicon glyphicon-remove" aria-hidden="true"></span> </b> </b> </li> <li><input name="newTag" onkeyup="{newTagInput}" type="text" value="" style="display:inline-block;margin-left:10px;margin-top:5px;font-size:16px;background:transparent;border:none"></li> </ul> </div> </div> <div> </div> </div> </div> </div> </div>',"contacts .sync{ animation:rotation 2.5s linear infinite; -webkit-animation:rotation 2.5s linear infinite; } contacts .menu_open{ background: #4D5767; } contacts input,contacts textarea{ outline:none; } contacts .left_nav_def{ color:white; } contacts .left_nav_sel{ color:#6CBD6E; } contacts .tags_body{ list-style-type: none; width:50%; margin:0px auto; padding-top: 12px; overflow:hidden; padding-left:0px; padding:10px; } contacts .tags_body_edit{ border:1px solid #ccc; border-radius: 5px; } contacts .tags_item{ float:left;margin-right:10px;margin-bottom:10px;height:32px;padding:5px 25px; background:#6CBD6E;color:white;text-align:center;border-radius: 5px; } contacts .tags_item:first-child{ margin-left:0px; } contacts .tags_edit{ background:#8FC590 !important; }",function(t){this.app=this.opts.app;var e=nest.presentable(this),n=e.CONST={NAV:{CONTACT:"contact",GROUP:"group"}};e.env="production"==__app.settings.env.NODE_ENV?"public":"web",e.api=__app.settings.api.url,e.botId=__page.bot.customId,e.tip=!1,e.tipInfo="",e.viewModel={nav:n.NAV.CONTACT,mode:"view"},e.menuOpen=!1,e.currUser={},e.init=function(){};var i=domain.action("loadContacts"),o=domain.action("saveTagsById"),r=domain.action("syncContacts"),a=domain.action("syncGroups"),s=function(t){e.update({contacts:t.contacts,groups:t.groups})},l=function(t){setTimeout(function(){e.syncingContacts=!1,e.update()},18e6)},c=function(t){setTimeout(function(){e.syncingGroups=!1,e.update()},18e6)},d=function(t){t.success&&(e.viewModel.mode="view",e.newTag.value="",e.update())};this.on("mount",function(){console.info("tag contacts index is mounted"),r.onDone(l),a.onDone(c),i.onDone(s),o.onDone(d)}),this.on("unmount",function(){console.info("tag contacts index is unmounted"),r.offDone(l),a.offDone(c),i.offDone(s),o.offDone(d)}),this.on("open",function(t){console.info("tag contacts index is opening"),e.trigger("ready",!1),e.trigger("view-route-to"),i.execute(e.botId)}),this.on("leave",function(){e.mask=!0,e.update()}),this.on("reenter",function(){e.mask=!1,e.update()}),this.on("refresh",function(){console.info("tag contacts index is refreshing")}),this.selectContact=function(t){e.currUser=t.item,e.viewModel.mode="view",e.newTag.value=""}.bind(this),e.formatDate=function(t){var e=new Date(t).toLocaleDateString();return e.replace(/\//g,"-")},e.showPlace=function(){var t="";return t=e.currUser.district?(e.currUser.city||"")+" "+(e.currUser.district||""):(e.currUser.province||"")+" "+(e.currUser.city||"")},this.hideMenu=function(t){e.menuOpen=!1}.bind(this),this.selectContacts=function(t){e.viewModel.nav=n.NAV.CONTACT}.bind(this),this.selectGroups=function(t){e.viewModel.nav=n.NAV.GROUP}.bind(this),this.editTags=function(t){e.viewModel.mode="edit",$(".tags_body").find(">li>input").focus()}.bind(this),this.cancelTags=function(t){e.viewModel.mode="view",e.newTag.value=""}.bind(this),this.clickTags=function(t){var e=$(t.currentTarget);e.find(">li>input").focus()}.bind(this),this.newTagInput=function(t){if(32===t.which&&""!=e.newTag.value.trim()){if(e.currUser.tags||(e.currUser.tags=[]),e.currUser.tags.length>4)return void alert("最多添加五个标签");e.currUser.tags.forEach(function(t){t.trim()===e.newTag.value.trim()}),e.currUser.tags.push(e.newTag.value.trim()),e.newTag.value=""}}.bind(this),this.removeTag=function(t){return e.currUser.tags.forEach(function(n,i){n===t.item.name&&e.currUser.tags.splice(i,1)}),!1}.bind(this),this.submitTags=function(t){o.execute({id:e.currUser._id,tags:e.currUser.tags,tenant:__page.bot.org})}.bind(this),this.toggleMenu=function(t){e.menuOpen=!e.menuOpen,t.stopPropagation()}.bind(this),this.syncContact=function(t){r.execute({botid:__page.bot.customId}),e.syncingContacts=!0,t.stopPropagation()}.bind(this),this.syncGroup=function(t){a.execute({botid:__page.bot.customId}),e.syncingGroups=!0,t.stopPropagation()}.bind(this)}),riot.tag("del-group-member",'<div class="title_wrap"> <b onclick="{backToView}" style="display: block;width:24px;height:24px;float:left" onclick="{back}"> <i class="glyphicon glyphicon-chevron-left"></i> </b> 移除成员 <b onclick="{submit}" style="display: block;width:80px;height:24px;float:right"> <button type="button" class="btn btn-default" style="display:inline-block;background: #42AC3E; color:white; border: none"> 确认移除 </button> </b> </div> <div> <div class="wrapper" attr="{parent.mediaUsers}"> <div>   <ul class="user_list"> <li onclick="{parent.selectMember}" each="{parent.groupMembers}" id="{_id}" media="{parent.media._id}" group="{parent.parent.parent.group._id}"> <img riot-src="{parent.app.settings.api.url + \'/file?media_id=\' + member.headimgurl}"> <p style="overflow: hidden;height:24px">{member.remark}</p> </li> </ul> </div> </div> </div>',"del-group-member .wrapper{ width:90%; margin:0px auto; } del-group-member .user_list{ overflow: hidden; list-style-type: none; margin:0px; padding:0px; color:#888; } del-group-member .user_list >li{ width:100px; float:left; margin:5px 0px; text-align: center; line-height: 30px; position: relative; } del-group-member .user_list >li img{ display: inline-block; width:64px; height:64px; } del-group-member .title_wrap{ height:50px; margin:8px 10px; text-align: center; line-height: 50px; } del-group-member .select{ position: absolute; top:0px; left:17px; background:#42AC3E; width:64px; height:64px; opacity: 0.8; } del-group-member .select div{ font-size: 40px; color:white; margin:8px; }",function(t){function e(t){t.success&&(n.members={},t.data&&t.data.length&&t.data.forEach(function(t){n.parent.groupMembers.unshift(t)}),n.parent.panel.view(),n.parent.update())}var n=this;n.page=__page,n.app=__app,n.nav=0,n.members={};var i={"基本信息":0,"成员":1},o=domain.action("addGroupMembers");this.on("mount",function(){o.onDone(e)}),this.on("unmount",function(){o.offDone(e)}),this.clickNav=function(t){n.nav=i[t.target.innerText]}.bind(this),this.addMember=function(t){n.parent.panel.status="add_m",n.parent.update()}.bind(this),this.selectMember=function(t){function e(t){if(n.members[a])o(t),delete n.members[a];else{var e={group:s,media:l,member:a};n.members[a]=e,i(t)}}function i(t){var e=document.createElement("div");e.classList.add("select");var n=document.createElement("div");n.classList.add("glyphicon"),n.classList.add("glyphicon-ok"),e.appendChild(n),t.appendChild(e)}function o(t){t.removeChild(t.childNodes[t.childNodes.length-1])}var r=t.currentTarget,a=r.id,s=r.getAttribute("group"),l=r.getAttribute("media");e(r)}.bind(this),this.submit=function(t){Object.keys(n.members).length&&o.execute({members:n.members})}.bind(this),this.backToView=function(t){n.members={},n.parent.panel.view(),n.parent.update()}.bind(this)}),riot.tag("group-left",'<div class="well sidebar-nav" style="padding-top: 0; padding-right: 0; padding-left: 0;height: 48em; background-color: #2E3238; border: 1px solid #080808; overflow: scroll; border-radius: 0"> <ul style="padding: 0; margin: 0; list-style-type: none"> <li style="height: 50px; border-bottom:1px solid #252525; line-height: 50px;overflow: hidden"> <div class="col-md-8 col-xs-8 col-sm-8" style="height:50px;line-height:50px;overflow: hidden"> <div style="padding-left:10px;background: #24272C;height: 32px; margin-top: 8px;line-height:32px;color: #777"> <b style="width:20%;"> <span class="glyphicon glyphicon-search"></span> </b> <input oninput="{search}" type="text" id="searchInput" style="background: transparent;border: none;width:80%" placeholder="搜索"> </div> </div> <div class="col-md-4 col-xs-4 col-sm-4" style="height:50px;overflow: hidden;"> <div style="height:32px;margin-top: 6px;line-height: 32px"> <button type="button" onclick="{parent.addGroup}" class="btn btn-sm" style="background: #42AC3E; color:white"> <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> 添加分组 </button> </div> </div> </li> <li onclick="{parent.parent.viewGroup}" id="{_id}" each="{ownGroups || parent.groups}" style="height: 50px;line-height: 40px;border-bottom:1px solid #252525;padding: 5px 20px; cursor: pointer"> <span style="color: white; margin-left: 15px">{name}</span> </li> </ul> </div>',function(t){
var e=this;e.ownGroups=null,e._timeout=null,e.init=function(){e.ownGroups=null,e.searchInput.value=""},this.search=function(t){e._timeout||(e._timeout=setTimeout(function(){var t=e.searchInput.value,n=t.split(" ");e.ownGroups=e.parent.groups.filter(function(t){var e=!0;return n.forEach(function(n){t.name.search(new RegExp(n))<=-1&&(e=!1)}),e}),clearTimeout(e._timeout),e._timeout=null,e.update()},500))}.bind(this)}),riot.tag("group",'<div if="{!hidden}"> <div class="row-fluid" style="overflow: hidden; background: #eee;margin-top:-6px"> <div class="col-md-4 col-xs-4 col-sm-4" style="padding-right: 0; padding-left: 0; width: 30%"> <group-left></group-left> </div> <div class="col-md-8 col-xs-8 col-sm-8" style="background:#eee;padding-right: 1px; padding-left: 0;width: 70%"> <div if ="{panel.status === \'start\'}"> </div> <view-group if="{panel.status === \'view\'}"></view-group> <add-group if="{panel.status === \'add\'}"></add-group> <del-group-member if="{panel.status === \'del_m\'}"></del-group-member> <add-group-member if="{panel.status === \'add_m\'}"></add-group-member> </div> </div> </div>',function(t){this.app=this.opts.app;var e=nest.presentable(this);e.env="production"==__app.settings.env.NODE_ENV?"public":"web",e.api=__app.settings.api.url,e.botId=__page.bot.customId,e.tip=!1,e.tipInfo="",e.groups={},e.groupMembers=[];var n=domain.action("loadAllMyManageMedia"),i=domain.action("loadGroups"),o=domain.action("loadGroup"),r=function(t){e.groups=t.groups,e.update()},a=function(t){e.myManageMedia=t.medias,e.panel.add(),e.update()},s=function(t){e.group=t.group,e.groupMembers=t.members,e.panel.view(),e.update()};this.on("mount",function(){n.onDone(a),i.onDone(r),o.onDone(s)}),this.on("unmount",function(){n.offDone(a),i.offDone(r),o.offDone(s)}),this.on("open",function(t){console.info("tag group index is opening"),e.trigger("ready",!1),e.trigger("view-route-to"),i.execute({tenantId:__page.user.posts[0].org,operatorId:__page.user.posts[0].member})}),this.on("leave",function(){e.mask=!0,e.update()}),this.on("reenter",function(){e.mask=!1,e.update()}),this.on("refresh",function(){console.info("tag group index is refreshing")}),e.formatDate=function(t){var e=new Date(t).toLocaleDateString();return e.replace(/\//g,"-")},e.panel={status:"start",add:function(){this.status="add"},view:function(){this.status="view",e.tags["view-group"].init()},start:function(){this.status="start",e.group={},e.groupMembers=[]}},this.viewGroup=function(t){var e=t.currentTarget.id;o.execute({id:e})}.bind(this),this.addGroup=function(t){var i=e.panel;"add"!==i.status&&n.execute({tenantId:__page.user.posts[0].org,operatorId:__page.user.posts[0].member})}.bind(this)}),riot.tag("overview",'<div if="{!hidden}"> <div if="{tip}" class="alert {addClass}" style="margin-top: -5px; float: left; width: 100%; text-align: center; margin-bottom: 0; position: absolute; z-index: 9999"> <strong>{tipInfo}</strong> </div> <div class="container" style="width: 100%; margin-left: 0; margin-right: 0; padding-left: 0; padding-right: 0"> <div class="row"> &nbsp; </div> <div class="row"> <div class="col-md-8 col-md-offset-2" > <div class="panel panel-default"> <div class="panel-heading">账户信息</div> <div class="panel-body"> <div class="container" style=""> <div class="row"> <div class="col-md-1 col-lg-1" style=""> 账户： </div> <div class="col-md-3 col-lg-3" riot-style=""> {user.nickname} &nbsp;&nbsp; <small><small>个人账户</small></small> </div> <div class="col-md-1 col-lg-1" style=""> 管理员： </div> <div class="col-md-3 col-lg-3" style=""> <img src="{user.headimgurl}" alt="{user.nickname}" class="img-rounded" data-src="holder.js/40x40" style="width: 40px; height: 40px;"> &nbsp;&nbsp;{user.nickname} </div> </div> </div> </div> </div> <div class="panel panel-default"> <div class="panel-heading">微信托管</div> <div class="panel-body"> <div style=""> <div class="row"> <div class="col-md-3 col-lg-3" style=""> <img src="{bot.headimgurl}" alt="{bot.name}" class="img-rounded" data-src="holder.js/40x40" style="width: 40px; height: 40px;"> &nbsp; {bot.name} <img if="{bot.sex==1}" src="/web/images/male.png" alt="男" class="" style="boder:0px; width: 16px; height: 16px;"> <img if="{bot.sex==2}" src="/web/images/female.png" alt="女" class="" style="boder:0px; width: 16px; height: 16px;"> </div> <div class="col-md-3 col-lg-3" style=""> <div class="row" > <div class="col-md-4 col-lg-4" style="height: 60px"> <img if="{!botActioning && botKeepLogged}" src="/web/images/stop-active.png" alt="退出" onclick="{goExiting}" class="bot-action-icon bot-logged" style=""> <img if="{botActioning && botKeepLogged}" src="/web/images/start.png" alt="启动中..." class="bot-action-icon bot-logging" style=""> <img if="{!botActioning && botKeepExited}" src="/web/images/start-active.png" alt="启动" onclick="{goLogging}" class="bot-action-icon bot-exited" style=""> <img if="{botActioning && botKeepExited}" src="/web/images/stop.png" alt="退出中..." class="bot-action-icon bot-exiting" style=""> </div> <div class="col-md-8 col-lg-8" style="vertical-align: middle;height: 60px;"> <label>&nbsp;&nbsp;{bot.statusName}</label> </div> </div> </div> <div class="col-md-6 col-lg-6" if="{needLoginFlg}"> <div class="row" > <div class="col-md-4 col-lg-4" style="height: 112px;"> <img riot-src="{loginQR}" style="border:1px solid #ddd;display: inline-block; height: 100%"> </div> <div class="col-md-8 col-lg-8" style="vertical-align: middle;height: 60px;"> <label>扫描左方二维码登录</label> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div> </div>',"overview .panel-body{ line-height: 70px; } overview .bot-action-icon{ border: 0px; width: 60px; height: 60px; } overview .bot-logged {cursor: default !important;} overview .bot-logging {cursor: wait !important;} overview .bot-exited {cursor: default !important;} overview .bot-exiting {cursor: wait !important;}",function(t){"use strict";this.app=this.opts.app;var e=nest.presentable(this);e.api=__app.settings.api.url,e.tip=!1,e.tipInfo="",e.botId=__page.bot.customId,e.bot=__page.bot,e.user=__page.user,e.tenantId=__page.tenantId,e.botKeepLogged=!0,e.botKeepExited=!1,e.botActioning=!0,e.needLoginFlg=!1;var n=domain.action("loadBotByMediaId"),i=domain.action("startBot"),o=domain.action("stopBot"),r=__app.enums.IntentionStatus.names,a=__app.enums.WechatBotStatus.names,s=__app.enums.WechatBotStatus.values,l=function(t,e,n){this.id=t,this.intentionStatus=e||r.Logged,this.on("logged",this.onLogged.bind(this)),this.on("exited",this.onExited.bind(this)),this.on("logging",this.onLogging.bind(this)),this.on("exiting",this.onExiting.bind(this)),this.on("status-changed",this.onStatusChanged.bind(this)),this.updateStatus(n)};l.prototype=riot.observable({}),l.prototype.updateStatus=function(t){this.status!=t&&(this.status=t,t==r.Logged?this.trigger("logged"):(t==r.Exited||t==a.Aborted)&&this.trigger("exited"),this.trigger("status-changed",this.status,t))},l.prototype.goLogging=function(){this.trigger("logging")},l.prototype.goExiting=function(){this.trigger("exiting")},l.prototype.onLogged=function(){e.bot.intentionStatus=r.Logged,e.botKeepLogged=!0,e.botKeepExited=!1,e.botActioning=!1,e.update()},l.prototype.onExited=function(){e.bot.intentionStatus=r.Exited,e.botKeepLogged=!1,e.botKeepExited=!0,e.botActioning=!1,e.update()},l.prototype.onLogging=function(){e.botKeepLogged=!0,e.botKeepExited=!1,e.botActioning=!0,e.update(),console.info("logging...")},l.prototype.onExiting=function(){e.botKeepLogged=!1,e.botKeepExited=!0,e.botActioning=!0,e.update(),console.info("exiting...")},l.prototype.onStatusChanged=function(t,n){e.bot.status=n,e.bot.statusName=s[e.bot.status],console.info(e.bot.statusName),e.update()};var c=null;ws.subscribe("/bot/st_change",function(t){var n=t;n.agentId===e.bot.customId&&(n.newStatus===a.Logged&&(e.needLoginFlg=!1),c.updateStatus(n.newStatus))}),ws.subscribe("/bot/need_login",function(t){var n=t;n.agentId===e.bot.customId&&(e.loginQR=n.mediaUrl,e.needLoginFlg=!0,e.update())}),this.goLogging=function(t){i.execute({openid:e.bot.customId,intention:"login",mode:"untrusted",nickname:e.bot.name,sex:e.bot.sex}),c.goLogging()}.bind(this),this.goExiting=function(t){o.execute({openid:e.bot.customId}),console.log({openid:e.bot.customId}),c.goExiting()}.bind(this);var d=function(t){c=new l(e.bot.id,t.media.intentionStatus,t.media.status),c.updateStatus(t.media.status),e.update()};this.on("mount",function(){n.onDone(d),n.execute({botId:e.bot._id})}),this.on("unmount",function(){n.offDone(d)}),this.on("open",function(t){console.info("tag overview is opening"),e.trigger("ready",!1),e.trigger("view-route-to")}),this.on("leave",function(){e.mask=!0,e.update()}),this.on("reenter",function(){e.mask=!1,e.update()}),this.on("refresh",function(){console.info("tag overview is refreshing")})}),riot.tag("raw","",function(t){var e=this;e.on("update",function(){e.root.innerHTML=e.opts.content||""})}),riot.tag("recontent-index",'<div if="{!hidden}"> <div class="container-fluid"> <div class="row-fluid"> &nbsp; </div> <div class="row-fluid"> <div class="col-md-6 col-lg-6" > <div class="row-fluid"> <div class="col-md-12 col-lg-12" > <div class="pull-right"> <button class="btn btn-default btn-sm" type="button" onclick="{onRefresh}">刷新</button> <button class="btn btn-default btn-sm" type="button" onclick="{onNew}">新建</button> </div> <table class="table table-striped"> <thead> <tr> <th>名称</th> <th>广告</th> <th>预览</th> </tr> </thead> <tbody> <tr each="{recontents}"> <td> <a onclick="{parent.onView}"> <input type="hidden" value="{_id}"> {originalTitle} </a> </td> <td> {adName} </td> <td> <a href="{newUrl}" target="_blank"> 预览 </a> </td> </tr> </tbody> </table> </div> </div> </div> <div class="col-md-6 col-lg-6" >   </div> </div> </div> <form id="newForm" method="post" action="recontent-set" target="_blank"> <input type="hidden" id="tenantId" name="tenantId" value="{tenantId}"> </form> </div>',function(t){"use strict";this.app=this.opts.app;var e=nest.presentable(this);e.api=__app.settings.api.url,e.tenantId=this.opts.tenant;var n=domain.action("findTenantRecontents"),i=function(t){console.log(t),e.update({recontents:t})};this.on("mount",function(){n.onDone(i)}),this.on("unmount",function(){n.offDone(i)}),this.on("open",function(t){console.info("tag adlink-index is opening"),e.trigger("ready",!1),e.trigger("view-route-to"),n.execute(e.tenantId)}),this.on("leave",function(){e.mask=!0,e.update()}),this.on("reenter",function(){e.mask=!1,e.update()}),this.on("refresh",function(){onRefresh()}),this.onRefresh=function(t){n.execute(e.tenantId)}.bind(this),this.onNew=function(t){$("#newForm").submit()}.bind(this),this.onView=function(t){}.bind(this),this.showEditView=function(t){detail.trigger("close"),edit.trigger("open",{action:"edit",id:t})},this.showDetailView=function(t){edit.trigger("close"),detail.trigger("open",{model:t})}}),riot.tag("redpacket-boss",'<div if="{!hidden}"> <div if="{tip}" class="alert {addClass}" style="margin-top: -5px; float: left; width: 100%; text-align: center; margin-bottom: 0; position: absolute; z-index: 9999"> <strong>{tipInfo}</strong> </div> <div class="container"> <div class="row-fluid"> <div class="jumbotron" style="height: auto; padding: 25px;"> <div if="{!editing}" id="luckyMoneyHelpList" class="panel" style="margin-top: 1em; padding: 0; min-height: 30em"> <div style="padding-left: 20px; padding-bottom: 10px;"><a id="add" style="font-size: 1.5em; text-decoration: none; cursor: pointer">新增</a> </div> <ul class="ul" id="list"> <li> <strong class="col-md-2">活动名称</strong> <strong class="col-md-2">开始时间</strong> <strong class="col-md-2">结束时间</strong>  <strong class="col-md-6">操作</strong> </li> <li> <hr width="100%"> </li> <li each="{redpackets}"> <strong class="col-md-2 activity-name" onclick="{parent.edit}">{name}</strong> <strong class="col-md-2">{parent.formatDate(startTime)}</strong> <strong class="col-md-2">{parent.formatDate(endTime)}</strong> <strong class="col-md-6 actionCon"><a href="{__app.settings.app.url + \'/marketing/redpacket/redpacket?id=\' + _id}" target="_blank">查看</a><a href="{__app.settings.api.url + \'/marketing/redpacket/exportParticipants?id=\' + _id}" target="_blank" >导出</a></strong> </li> </ul> </div> <div if="{editing}" id="addForm" class="panel" style="margin-top: 1em;"> <div style="padding-left: 20px; padding-bottom: 10px;"><a id="return" style="font-size: 1.5em; text-decoration: none; cursor: pointer">返回</a></div> <ul class="ul" style="text-align: left; padding-left: 2em"> <li><span>红包助力活动设置</span></li> <li><span>活动名称: </span><input name="redpacketActivityName" id="activityName" type="text" value="{redpacket.name}"></li> <li class="bgImg" style="min-height: 26px"><span style="float: left">背景图片(3张): </span><input id="bgImg" type="file" multiple="multiple" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="uploadBgImg()" style="width: 60px;"> <div id="bgImg1" if="{redpacket.bgImg[0]}" class="bgImgCon"><i class="glyphicon glyphicon-remove"></i><img riot-src="{redpacket.bgImg[0]}" alt=""></div> <div id="bgImg2" if="{redpacket.bgImg[1]}" class="bgImgCon"><i class="glyphicon glyphicon-remove"></i><img riot-src="{redpacket.bgImg[1]}" alt=""></div> <div id="bgImg3" if="{redpacket.bgImg[2]}" class="bgImgCon"><i class="glyphicon glyphicon-remove"></i><img riot-src="{redpacket.bgImg[2]}" alt=""></div> </li> <li style="clear: both; min-height: 26px"><span style="float: left">分享卡片图片: </span><input id="shareImg" type="file" accept="image/bmp, image/jpg, image/jpeg, image/gif, image/png" onchange="uploadShareImg()" style="width: 60px;"> <div id="shareImg1" if="{redpacket.shareImg}" class="shareImgCon"><i class="glyphicon glyphicon-remove"></i><img riot-src="{redpacket.shareImg}" alt=""></div> </li> <li style="clear: both"><span>活动时间: </span><input id="startTime" type="date" value="{formatDate(redpacket.startTime)}"><span> 至 </span><input id="endTime" type="date" value="{formatDate(redpacket.endTime)}"> </li> <li><span>活动介绍: </span><div id="desc"></div></li> <li><span>活动规则: </span><div id="rule"></div></li> <li><span>分享标题自定义: </span><textarea id="shareTitle" cols="60" rows="1">{redpacket.shareTitle}</textarea></li> <li><span>分享描述自定义: </span><textarea id="shareDesc" cols="60" rows="1">{redpacket.shareDesc}</textarea></li> <li><span>基础红包金额: </span><input id="base_power" type="text" value="{redpacket.base_power}"></li> <li><span>好友助力单次奖励: </span><input id="friend_help_min_power" type="text" value="{redpacket.friend_help_min_power}"><span> 至 </span><input id="friend_help_max_power" type="text" value="{redpacket.friend_help_max_power}"></li> <li><span>好友助力上限人数: </span><input id="friend_help_count_limit" type="text" value="{redpacket.friend_help_count_limit}"></li> <li style="text-align: center; margin-top: 1em"><input class="btn btn-success" type="button" id="submit" value="提交"></li> </ul> </div> </div> </div>  </div> </div>',"redpacket-boss .leftlist {list-style-type: none; text-align: center; font-size: 1.3em} redpacket-boss .ul {list-style-type: none; text-align: center; padding: 0} redpacket-boss .ul li {margin-bottom: 20px;} redpacket-boss .bgImg #bgImg {float: left; margin-left: 10px;} redpacket-boss .bgImg .bgImgCon {margin-left: 10px; display: -webkit-inline-box; position: relative; display: none; border: solid 1px #E8E7E7;} redpacket-boss .bgImgCon i{color: #EC3131; position: absolute; left: 58px; top: 2px; cursor: pointer;} redpacket-boss .bgImgCon div{margin-left: 20px; float: left;} redpacket-boss .bgImgCon img {width: 75px; height: 75px;} redpacket-boss .shareImgCon img {width: 75px; height: 75px;} redpacket-boss #shareImg{float: left; margin-left: 10px;} redpacket-boss .shareImgCon i{color: #EC3131;position: absolute;left: 58px;top: 2px;cursor: pointer;} redpacket-boss .shareImgCon{margin-left: 10px; display: -webkit-inline-box;position: relative; display: none; border: solid 1px #E8E7E7;} redpacket-boss .activity-name{ color: #23527c; cursor: pointer; } redpacket-boss li strong{ padding: 0 !important; margin: 0 !important; } redpacket-boss .actionCon a{ margin-left: 10px; }",function(t){"use strict";this.app=this.opts.app;var e=nest.presentable(this);e.api=__app.settings.api.url,e.tip=!1,e.tipInfo="",e.redpacket={},e.editing=!1;var n=domain.action("loadRedpackets"),i=function(t){e.redpackets=t,e.update()};setTimeout(function(){console.error($("#desc").summernote),console.log($("#desc")),$("#desc").summernote({height:200,minHeight:null,maxHeight:null,focus:!0}),$("#rule").summernote({height:200,minHeight:null,maxHeight:null,focus:!0})},5e3),this.on("mount",function(){n.onDone(i)}),this.on("unmount",function(){n.offDone(i)}),this.on("open",function(t){e.trigger("ready",!1),e.trigger("view-route-to"),n.execute({}),console.info("tag tenants is opening")}),this.on("leave",function(){e.mask=!0,e.update()}),this.on("reenter",function(){e.mask=!1,e.update()}),this.on("refresh",function(){console.info("tag tenants is refreshing")}),e.formatDate=function(t){var e=new Date(t),n=e.getFullYear(),i=e.getMonth()+1>9?e.getMonth()+1:"0"+(e.getMonth()+1),o=e.getDate()>9?e.getDate():"0"+e.getDate();return n+"-"+i+"-"+o},e.edit=function(t){e.update({redpacket:t.item,editing:!0})}}),riot.tag("showimg",'<div class="modal fade" id="showImg"> <div class="modal-dialog"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title">{title || \'图片\'}</h4> </div> <div if="{!errorMsg}" class="modal-body" style="text-align: center"> <img riot-src="{imgUrl}" alt="" id="img" riot-style="height: {height}; width: {width}"> </div> <div if="{errorMsg}" class="modal-body" style="text-align: center"> <span>{errorMsg}</span> </div> </div> </div> </div>',function(t){var e=this;app.on("showImg",function(t){console.log(t),e.update({title:t.title,imgUrl:t.imgUrl,width:t.width,height:t.imgUrl,errorMsg:t.errorMsg})})}),riot.tag("tenant-edit",'<div class="container" if="{!hidden}"> <div class="row"> <div class="col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2" style="text-align: center"><h3>{tenant.name}</h3></div> </div> <alert validators="{validators}" clear="{clear}"></alert> <div class="row" style="margin-top: 30px"> <div class="col-md-6 col-md-offset-3 col-lg-6 col-lg-offset-3"> <div class="row panel-container"> <div class="col-md-3">名称</div> <div class="col-md-9"> <div class="{has-error: !tenantNameInput.value.trim()} has-feedback"> <input type="text" onblur="{onNameBlur}" class="form-control" name="tenantNameInput" value="{tenant.name}" required> </div> </div> <div class="col-md-3">类型</div> <div class="col-md-9"> <div class="btn-group" data-toggle="buttons"> <label onclick="{selectPersonalType}" class="btn btn-default {active: tenant.type == \'p\'}"> <input type="radio" name="orgTypeRadio" autocomplete="off" __checked="{tenant.type == \'p\'}" value="p"> 个人 </label> <label onclick="{selectOrgType}" class="btn btn-default {active: tenant.type == \'o\'}"> <input type="radio" name="orgTypeRadio" autocomplete="off" __checked="{tenant.type == \'o\'}" value="o"> 机构 </label> </div> </div> <div class="col-md-3">状态</div> <div class="col-md-9">{ __app.enums.LifeFlag.values[tenant.lFlg]}</div> <div class="col-md-3">创建时间</div> <div class="col-md-9">{_.date.format(new Date(tenant.crtOn), \'yyyy-MM-dd hh点mm分\')}</div> <div class="col-md-3">备注</div> <div class="col-md-9"><textarea name="tenantDescInput" class="form-control" onblur="{descOnBlur}">{tenant.desc}</textarea></div> </div> </div> </div> <div class="row" style="margin-top: 30px"> <div class="col-md-12 col-lg-12" style="text-align: center"> <input __disabled="{!tenantNameInput.value.trim()}" onclick="{onSubmit}" class="btn btn-primary" type="button" value="保存"> <a href="#tenants/_{tenant._id}" class="btn btn-default">取消</a> </div> </div> </div>',function(t){var e=nest.presentable(this),n=domain.action("loadTenantById"),i=domain.action("updateTenantById"),o=function(t){e.update({tenant:t.tenant}),e.trigger("ready",!1),e.trigger("view-route-to")};e.validators=[],e.on("open",function(t){n.newInvocation({id:t.req.paramList[0]}).onDone(o).execute()}),e.selectPersonalType=function(t){e.tenant.type="p",e.update()},e.selectOrgType=function(t){e.tenant.type="o",e.update()},e.onSubmit=function(){i.newInvocation(e.tenant).onDone(function(){riot.route("tenants/_"+e.tenant._id)}).execute()},e.onNameBlur=function(){var t=e.tenantNameInput.value.trim();return t?void(e.tenant.name=t):e.validators.push({success:!1,field:"名称",desc:"不能为空!"})},e.clear=function(){e.validators=[]},e.descOnBlur=function(){var t=e.tenantDescInput.value.trim();t&&(e.tenant.desc=t)}}),riot.tag("tenant-topbar",'<nav class="navbar navbar-default navbar-inverse" role="navigation" style="margin-bottom: 5px; border-radius: 0;"> <div class="collapse navbar-collapse"> <a class="navbar-brand" style="font-size:20px; color: #ffffff">微节点</a> <ul class="nav navbar-nav" style="width: 88%"> <li class="navbtn"><a id="adlink-index" href="#" route="adlink-index" onclick="{adlinks}">广告位</a></li> <li class="navbtn"><a id="recontent-index" href="#" route="recontent-index" class="myActive" onclick="{recontents}">文章</a></li> <li style="float: right;"><a href="#" style="font-size: 1.4em" class="glyphicon glyphicon-off" title="退出" onclick="{logout}"></a></li> <li style="float: right; margin-right: 20px; padding-top: 5px;"> <img riot-src="{headimgurl}" style="height: 40px; width: 40px" alt=""><span style="margin-left: 10px; color: white">{nickname}</span> </li> </ul> </div> </nav>',".navbtn{padding-left: 20px; font-size:16px} .myActive{color: #ffffff !important; border:0; outline: none !important;}",function(t){this.headimgurl=__page.user.headimgurl,this.nickname=__page.user.nickname,this.tenantId=this.opts.tenant,this.on("mount",function(){window.location.hash&&($(".navbtn a").removeClass("myActive"),$(window.location.hash).addClass("myActive"))}),this.logout=function(t){$.get("/logout",function(t){window.location.href="/login"})}.bind(this),this.adlinks=function(t){t.preventUpdate=!0,$(".navbtn a").removeClass("myActive"),$(t.currentTarget).addClass("myActive"),riot.route($(t.currentTarget).attr("route"))}.bind(this),this.recontents=function(t){t.preventUpdate=!0,$(".navbtn a").removeClass("myActive"),$(t.currentTarget).addClass("myActive"),riot.route($(t.currentTarget).attr("route"))}.bind(this)}),riot.tag("tenant",'<div class="container" if="{!hidden}"> <div class="row"> <div class="col-md-6 col-md-offset-3 col-lg-6 col-lg-offset-3" style="position: relative;text-align: center"> <a href="#tenants" style="position: absolute; left: 0px; top: 20px;">返回机构列表</a> <h3>{tenant.name}</h3> </div> </div> <div class="row" style="margin-top: 30px"> <div class="col-md-4 col-md-offset-3 col-lg-4 col-lg-offset-3"> <div class="row panel-container"> <div class="col-md-6">名称</div> <div class="col-md-6">{tenant.name}</div> <div class="col-md-6">类型</div> <div class="col-md-6">{__app.enums.PartyType.values[tenant.type]}</div> <div class="col-md-6">状态</div> <div class="col-md-6">{ __app.enums.LifeFlag.values[tenant.lFlg]}</div> <div class="col-md-6">创建时间</div> <div class="col-md-6">{_.date.format(new Date(tenant.crtOn), \'yyyy-MM-dd hh点mm分\')}</div> <div class="col-md-6">备注</div> <div class="col-md-6">{tenant.desc}</div> </div> </div> </div> <div class="row" style="margin-top: 30px"> <div class="col-md-4 col-md-offset-4 col-lg-4 col-lg-offset-4" style="text-align: center"> <a href="#tenants/edit/_{tenant._id}" class="btn btn-default">修改</a> <input if="{tenant.lFlg != \'a\'}" onclick="{unlockTenant}" class="btn btn-default" data-toggle="modal" data-target="#modal" type="button" value="激活"> <input if="{tenant.lFlg != \'i\'}" onclick="{lockTenant}" class="btn btn-default" data-toggle="modal" data-target="#modal" type="button" value="锁定"> <input if="{tenant.lFlg != \'d\'}" onclick="{delTenant}" class="btn btn-default" data-toggle="modal" data-target="#modal" type="button" value="删除"> </div> </div> <div class="row" style="margin-top: 30px"> <div class="col-md-12 col-lg-12" style="text-align: center"> <a href="/boss/tenant/_{tenant._id}">机构管理</a> </div> </div> </div>',".panel-container >div{ height: 40px; line-height: 40px; }",function(t){var e=nest.presentable(this),n=domain.action("loadTenantById"),i=domain.action("updateTenantById");e.unlockTenant=function(){_.widget.confirm({title:"操作确认?",content:"你确认要“激活”机构吗？",callback:function(){e.tenant.lFlg=__app.enums.LifeFlag.names.Active,i.newInvocation({id:e.tenant._id,lFlg:e.tenant.lFlg}).onDone(function(t){e.update()}).execute()}})},e.lockTenant=function(){_.widget.confirm({title:"操作确认?",content:"你确认要“锁定”机构吗？",callback:function(){e.tenant.lFlg=__app.enums.LifeFlag.names.Inactive,i.newInvocation({id:e.tenant._id,lFlg:e.tenant.lFlg}).onDone(function(t){e.update()}).execute()}})},e.delTenant=function(){_.widget.confirm({title:"操作确认?",content:"你确认要“删除”机构吗？",callback:function(){e.tenant.lFlg=__app.enums.LifeFlag.names.Deleted,i.newInvocation({id:e.tenant._id,lFlg:e.tenant.lFlg}).onDone(function(t){e.update()}).execute()}})},e.on("open",function(t){n.newInvocation({id:t.req.paramList[0]}).onDone(function(t){e.update({tenant:t.tenant}),e.trigger("ready",!1),e.trigger("view-route-to")}).execute()})}),riot.tag("tenants",'<div if="{!hidden}"> <div if="{tip}" class="alert {addClass}" style="margin-top: -5px; float: left; width: 100%; text-align: center; margin-bottom: 0; position: absolute; z-index: 9999"> <strong>{tipInfo}</strong> </div> <div class="container" style="width: 100%; margin-left: 0; margin-right: 0; padding-left: 0; padding-right: 0"> <div class="row"> &nbsp; </div> <div class="row"> <div class="col-md-8 col-md-offset-2 col-lg-8 col-lg-offset-2" > <form class="form-inline"> <div class="form-group"> <label for="statusSelect">状态</label> <select id="statusSelect" class="form-control"> <option value="" selected>请选择</option> <option value="{__app.enums.LifeFlag.names.Active}">{__app.enums.LifeFlag.values.a}</option> <option value="{__app.enums.LifeFlag.names.Inactive}">{__app.enums.LifeFlag.values.i}</option> <option value="{__app.enums.LifeFlag.names.Deleted}">{__app.enums.LifeFlag.values.d}</option> </select> </div> <button onclick="{queryTenantsByFilter}" class="btn btn-primary">查询</button> </form> <table class="table table-striped"> <thead> <tr> <th>名称</th> <th>类型</th> <th>状态</th> <th>创建时间</th> <th>备注</th> </tr> </thead> <tbody> <tr each="{tenants}"> <td> <a href="#tenants/_{_id}"> {name} </a> </td> <td> { __app.enums.PartyType.values[type] } </td> <td> { __app.enums.LifeFlag.values[lFlg] } </td> <td> {_.date.format(new Date(crtOn), \'yyyy-MM-dd hh点mm分\')} </td> <td> { desc } </td> </tr> </tbody> </table> </div> </div> </div> </div>',function(t){"use strict";this.app=this.opts.app;var e=nest.presentable(this);e.api=__app.settings.api.url,e.tip=!1,e.tipInfo="";var n=domain.action("findTenants"),i=function(t){var n=t.tenants;n=n.filter(function(t){return"a"===t.lFlg}).concat(n.filter(function(t){return"i"===t.lFlg})).concat(n.filter(function(t){return"d"===t.lFlg})),e.update({tenants:n})};e.queryTenantsByFilter=function(t){var i={};e.statusSelect.value&&(i.lFlg=e.statusSelect.value),n.execute(i)},this.on("mount",function(){n.onDone(i)}),this.on("unmount",function(){n.offDone(i)}),this.on("open",function(t){e.trigger("ready",!1),e.trigger("view-route-to"),n.execute({}),console.info("tag tenants is opening")})}),riot.tag("top-menu",'<nav class="navbar navbar-default navbar-inverse" role="navigation" style="margin-bottom: 5px; border-radius: 0;"> <div class="collapse navbar-collapse"> <a class="navbar-brand" style="font-size: 1.6em;color: white">微节点</a> <ul class="nav navbar-nav" style="width: 88%"> <li class="navbtn"><a id="overview" href="#" route="overview" class="myActive" onclick="{overview}">首页</a></li> <li class="navbtn"><a id="broadcast" href="#" route="broadcast" class="" onclick="{broadcast}">群发</a></li> <li class="navbtn"><a id="contacts" href="#" route="contacts" onclick="{contacts}">联系人</a></li> <li class="navbtn"><a id="group" href="#" route="group" onclick="{group}">群组</a></li> <li style="float: right;"><a href="#" style="font-size: 1.4em" class="glyphicon glyphicon-off" title="退出" onclick="{logout}"></a></li> <li style="float: right; margin-right: 20px; padding-top: 5px;"> <img riot-src="{headimgurl}" style="height: 40px; width: 40px" alt=""><span style="margin-left: 10px; color: white">{nickname}</span> </li> </ul> </div> </nav>',"top-menu .navbtn{padding-left: 3em; font-size:1.2em} top-menu .myActive{color: #ffffff !important; border:0; outline:none !important;}",function(t){this.headimgurl=__page.user.headimgurl,this.nickname=__page.user.nickname,this.on("mount",function(){window.location.hash&&($(".navbtn a").removeClass("myActive"),$(window.location.hash).addClass("myActive"))}),this.logout=function(t){$.get("/logout",function(t){window.location.href="/login"})}.bind(this),this.overview=function(t){t.preventUpdate=!0,$(".navbtn a").removeClass("myActive"),$(t.currentTarget).addClass("myActive"),riot.route($(t.currentTarget).attr("route"))}.bind(this),this.broadcast=function(t){t.preventUpdate=!0,$(".navbtn a").removeClass("myActive"),$(t.currentTarget).addClass("myActive"),riot.route($(t.currentTarget).attr("route"))}.bind(this),this.group=function(t){t.preventUpdate=!0,$(".navbtn a").removeClass("myActive"),$(t.currentTarget).addClass("myActive"),riot.route($(t.currentTarget).attr("route"))}.bind(this),this.contacts=function(t){t.preventUpdate=!0,$(".navbtn a").removeClass("myActive"),$(t.currentTarget).addClass("myActive"),riot.route($(t.currentTarget).attr("route"))}.bind(this)}),riot.tag("view-group",'<div class="title_wrap"> <ul onclick="{clickNav}" class="nav nav-tabs" style="color: #3E3D3D"> <li role="presentation" class="{active: nav===0}"><a href="#">基本信息</a></li> <li role="presentation" class="{active: nav===1}"><a href="#">成员</a></li> </ul> </div> <div if="{nav===0}" class="profile"> <div class="profile_item row-fluid"> <div class="primary col-md-6 col-xs-6 col-sm-6"> <label>名称</label> </div> <div class="primary col-md-6 col-xs-6 col-sm-6"> <div if="{viewModel.mode === \'view\'}"> <label>{parent.group.name}</label>&nbsp&nbsp <span onclick="{editGroupName}" style="color:#45cc10;font-size:16px;" class="glyphicon glyphicon-edit" aria-hidden="true"></span> </div> <form if="{viewModel.mode===\'edit\'}" class="form-inline"> <input onblur="{checkGroupName}" class="form-control" name="groupName" type="text" value="{parent.group.name}" style="width:100px"> <button onclick="{submitGroupName}" type="button" class="btn btn-default" style="background: #18c54b;border:none"> <span class="glyphicon glyphicon-ok" style="color:white" aria-hidden="true"></span> </button> </form> </div> </div> <div class="profile_item row-fluid"> <div class="secondary col-md-6 col-xs-6 col-sm-6"> <label>类型</label> </div> <div class="secondary col-md-6 col-xs-6 col-sm-6"> <label>{__app.enums.GroupType.values[parent.group.type]}</label> </div> </div> <div class="profile_item row-fluid"> <div class="secondary col-md-6 col-xs-6 col-sm-6"> <label>范围</label> </div> <div class="secondary col-md-6 col-xs-6 col-sm-6"> <label>{__app.enums.GroupScope.values[parent.group.scope]}</label> </div> </div> <div class="profile_item row-fluid"> <div class="secondary col-md-6 col-xs-6 col-sm-6"> <label>包含微信号</label> </div> <div class="secondary col-md-6 col-xs-6 col-sm-6"> <button each="{parent.group.medias}" onclick="{backToView}" type="button" class="btn btn-default" style="display:inline-block;background: #CCC; color:white; border: none"> {name} </button> </div> </div> <div class="profile_item row-fluid"> <div class="secondary col-md-6 col-xs-6 col-sm-6"> <label>负责人</label> </div> <div class="secondary col-md-6 col-xs-6 col-sm-6"> <label>{parent.group.operator.remark}</label> </div> </div> <div class="profile_item"> <button onclick="{delGroup}" type="button" class="btn btn-default" style="height:40px;width:160px;background: #903D3D; color:white; border: none"> <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> 删除该组 </button> </div> </div> <div if="{nav===1}"> <div class="wrapper"> <div style="margin-bottom: 10px; overflow: hidden"> <span>共 ( <strong style="color:#65cc2b">{parent.groupMembers.length}</strong> ) 人</span> <button onclick="{selectContact}" class="{select_contact: status[\'contact\']}"> <span class="glyphicon glyphicon-user" aria-hidden="true"></span> 联系人 </button> <button onclick="{selectGroup}" class="{select_contact: status[\'group\']}"> <span class="glyphicon glyphicon-th" aria-hidden="true"></span> 群组 </button> <div style="float:right"> <button if="{currentStatus === \'view\'}" onclick="{addMember}" style="background: #52B918; color:white" type="button" class="btn" aria-label="Left Align"> <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> 添加成员 </button> <button if="{currentStatus === \'view\'}" onclick="{editMember}" style="background: #e35a51; color:white" type="button" class="btn" aria-label="Align Right"> <span class="glyphicon glyphicon-minus" aria-hidden="true"></span> 移除成员 </button> <button if="{currentStatus === \'edit\'}" onclick="{delMember}" class="{btn: true, btn_enabled: members && Object.keys(members).length>0, btn_disable: !members || Object.keys(members).length===0}" style="color:white" type="button" aria-label="Align Right"> <span class="glyphicon glyphicon-trash" aria-hidden="true"></span> 完成 </button> <button if="{currentStatus === \'edit\'}" onclick="{cancelDelMember}" style="background: #B1B1B1; color:white" type="button" class="btn" aria-label="Align Right"> <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> 取消 </button> </div> </div> <div class="list_container"> <ul class="user_list" > <li onclick="{parent.selectMember}" each="{parent.groupMembers}" if="{parent.status[member.contacttype]}" remark="{member.remark}" mid="{member._id}"> <img class="{img_sel: parent.currentStatus === \'edit\'}" riot-src="{parent.app.settings.api.url + \'/file?media_id=\' + member.headimgurl}"> <p style="overflow: hidden;height:24px">{member.remark}</p> </li> </ul> </div> </div> </div>',"view-group input,view-group textarea{ outline:none; } view-group .select_contact{ background: #5B6779; border:1px solid #2E3238; color:white; } view-group .profile_item .primary:nth-child(1){ padding-left:25% } view-group .profile_item .primary:nth-child(2){ padding-left:15% } view-group .profile_item .secondary:nth-child(1){ padding-left:25% } view-group .profile_item .secondary:nth-child(2){ padding-left:15% } view-group .list_container{ overflow: scroll; height:500px; } view-group .img_sel{ opacity: 0.4; } view-group .wrapper{ width:90%; margin:0px auto; } view-group .user_list{ overflow: hidden; list-style-type: none; margin:0px; padding:0px; color:#888; } view-group .user_list >li{ width:100px; float:left; margin:5px 0px; text-align: center; line-height: 30px; position: relative; } view-group .user_list >li img{ display: inline-block; width:64px; height:64px; } view-group .profile{ padding-top:30px; margin:0px auto; width:80% } view-group .profile_item{ margin: 0px auto; text-align: center; margin-bottom: 30px; overflow: hidden; } view-group .profile_item div.secondary label{ font-size: 16px; } view-group .profile_item >div:first-child{ text-align: left; } view-group .profile_item >div:nth-child(2){ text-align: left; } view-group .profile_item label{ font-weight:400; font-size: 24px; } view-group .select{ position: absolute; top:0px; left:17px; background:#42AC3E; width:64px; height:64px; opacity: 0.8; } view-group .select div{ font-size: 40px; color:white; margin:8px; } view-group .title_wrap{ height:50px; margin:8px 10px; } view-group .btn_disable{ background: #B1B1B1; } view-group .btn_enabled{ background: #e35a51; }",function(t){
function e(t){r.parent.panel.status="add_m",r.parent.mediaUsers=t.users,r.parent.tags["add-group-member"].init(),r.parent.update()}function n(t){t.success||alert("删除失败"),t.deprecateMembers.forEach(function(t){var e=r.parent.groupMembers.map(function(t){return t._id}),n=e.indexOf(t._id);return n>=0?r.parent.groupMembers.splice(n,1):void 0}),r.currentStatus=u.VIEW,r.members={},r.parent.update()}function i(t){r.parent.groups.forEach(function(t,e){t._id===r.parent.group._id&&r.parent.groups.splice(e,1)}),r.parent.panel.start(),r.parent.update()}function o(t){t.success&&(r.parent.group.name=t.group.name,r.parent.groups.forEach(function(e){e._id===t.group._id&&(e.name=t.group.name)}),r.parent.panel.view(),r.parent.update())}var r=this,a=domain.action("loadAllGroupMediaUsers"),s=domain.action("editGroup"),l=domain.action("delGroup"),c=domain.action("delGroupMember"),d={"基本信息":0,"成员":1},u={VIEW:"view",EDIT:"edit"};r.page=__page,r.app=__app,r.viewModel={},r.status={},r.init=function(){r.currentStatus=u.VIEW,r.members={},r.nav=0,r.viewModel.mode="view",r.status={},r.status.contact="contact"},r.init(),this.on("mount",function(){l.onDone(i),c.onDone(n),s.onDone(o),a.onDone(e)}),this.on("unmount",function(){l.offDone(i),c.offDone(n),s.offDone(o),a.offDone(e)}),this.selectContact=function(t){return r.status.contact?void delete r.status.contact:void(r.status.contact="contact")}.bind(this),this.selectGroup=function(t){return r.status.group?void delete r.status.group:void(r.status.group="group")}.bind(this),this.clickNav=function(t){r.nav=d[t.target.innerText]}.bind(this),this.addMember=function(t){var e=r.parent.group.medias,n=r.parent.group._id;a.execute({medias:e,groupId:n})}.bind(this),this.delGroup=function(t){l.execute({groupId:r.parent.group._id})}.bind(this),this.editMember=function(t){r.currentStatus=u.EDIT}.bind(this),this.delMember=function(t){Object.keys(r.members).length&&([].forEach.call(document.querySelectorAll("ul.user_list >li"),function(t){t.removeChild(t.childNodes[t.childNodes.length-1])}),c.execute({groupId:r.parent.group._id,mids:JSON.stringify(Object.keys(r.members))}))}.bind(this),this.submitGroupName=function(t){var e=r.groupName.value.trim();return""===e?void alert("请输入名称"):void s.execute({id:r.parent.group._id,name:e})}.bind(this),this.cancelDelMember=function(t){r.members={},[].forEach.call(document.querySelectorAll("ul.user_list >li >div.select"),function(t){t.parentNode.removeChild(t)}),r.currentStatus=u.VIEW}.bind(this),this.checkGroupName=function(t){var e=r.groupName.value;""===e.trim()?(t.target.parentNode.classList.add("has-error"),t.target.focus()):t.target.parentNode.classList.remove("has-error")}.bind(this),this.editGroupName=function(t){r.viewModel.mode="edit",r.groupName.focus()}.bind(this),this.selectMember=function(t){function e(t){r.members[s]?(i(t),delete r.members[s]):(r.members[s]=a,n(t))}function n(t){var e=document.createElement("div");e.classList.add("select");var n=document.createElement("div");n.classList.add("glyphicon"),n.classList.add("glyphicon-ok"),e.appendChild(n),t.appendChild(e)}function i(t){t.removeChild(t.childNodes[t.childNodes.length-1])}if(r.currentStatus==u.EDIT){var o=t.currentTarget,a=o.getAttribute("remark"),s=o.getAttribute("mid");e(o),r.update()}}.bind(this)})}},function(t,e,n){var i=n(4);i=n(6),util=n(7);n(8);riot=n(1),nest=n(9),$=jQuery=i,n(10),domain=n(11),n(24),n(25);var o={init:function(){return this}};!function(t){function e(t){util.forbidOperation()}function n(t,e,n){util.removeforbidOperation()}t(document).ajaxStart(e).ajaxComplete(n),t(window).resize(function(){}),t(".img_home").click(function(){t(".home_gy").removeClass("home_gy_set1"),t(".home_gy").addClass("home_gy_set")}),t(".home_close").click(function(){t(".home_gy").removeClass("home_gy_set"),t(".home_gy").addClass("home_gy_set1")}),window.newActivity={},window.revokedActivity={},riot.observable(window.newActivity),riot.observable(window.revokedActivity)}(i),t.exports=o},function(t,e,n){var i;!function(e,n){"object"==typeof t&&"object"==typeof t.exports?t.exports=e.document?n(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(e)}("undefined"!=typeof window?window:this,function(o,r){function a(t){var e=t.length,n=it.type(t);return"function"===n||it.isWindow(t)?!1:1===t.nodeType&&e?!0:"array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t}function s(t,e,n){if(it.isFunction(e))return it.grep(t,function(t,i){return!!e.call(t,i,t)!==n});if(e.nodeType)return it.grep(t,function(t){return t===e!==n});if("string"==typeof e){if(ut.test(e))return it.filter(e,t,n);e=it.filter(e,t)}return it.grep(t,function(t){return Y.call(e,t)>=0!==n})}function l(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function c(t){var e=bt[t]={};return it.each(t.match(vt)||[],function(t,n){e[n]=!0}),e}function d(){et.removeEventListener("DOMContentLoaded",d,!1),o.removeEventListener("load",d,!1),it.ready()}function u(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=it.expando+u.uid++}function p(t,e,n){var i;if(void 0===n&&1===t.nodeType)if(i="data-"+e.replace(Tt,"-$1").toLowerCase(),n=t.getAttribute(i),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:Ct.test(n)?it.parseJSON(n):n}catch(o){}kt.set(t,e,n)}else n=void 0;return n}function f(){return!0}function h(){return!1}function m(){try{return et.activeElement}catch(t){}}function g(t,e){return it.nodeName(t,"table")&&it.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function v(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function b(t){var e=Rt.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function y(t,e){for(var n=0,i=t.length;i>n;n++)xt.set(t[n],"globalEval",!e||xt.get(e[n],"globalEval"))}function w(t,e){var n,i,o,r,a,s,l,c;if(1===e.nodeType){if(xt.hasData(t)&&(r=xt.access(t),a=xt.set(e,r),c=r.events)){delete a.handle,a.events={};for(o in c)for(n=0,i=c[o].length;i>n;n++)it.event.add(e,o,c[o][n])}kt.hasData(t)&&(s=kt.access(t),l=it.extend({},s),kt.set(e,l))}}function x(t,e){var n=t.getElementsByTagName?t.getElementsByTagName(e||"*"):t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&it.nodeName(t,e)?it.merge([t],n):n}function k(t,e){var n=e.nodeName.toLowerCase();"input"===n&&Lt.test(t.type)?e.checked=t.checked:("input"===n||"textarea"===n)&&(e.defaultValue=t.defaultValue)}function C(t,e){var n,i=it(e.createElement(t)).appendTo(e.body),r=o.getDefaultComputedStyle&&(n=o.getDefaultComputedStyle(i[0]))?n.display:it.css(i[0],"display");return i.detach(),r}function T(t){var e=et,n=Ut[t];return n||(n=C(t,e),"none"!==n&&n||(Wt=(Wt||it("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement),e=Wt[0].contentDocument,e.write(),e.close(),n=C(t,e),Wt.detach()),Ut[t]=n),n}function S(t,e,n){var i,o,r,a,s=t.style;return n=n||Gt(t),n&&(a=n.getPropertyValue(e)||n[e]),n&&(""!==a||it.contains(t.ownerDocument,t)||(a=it.style(t,e)),Vt.test(a)&&qt.test(e)&&(i=s.width,o=s.minWidth,r=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=i,s.minWidth=o,s.maxWidth=r)),void 0!==a?a+"":a}function _(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function I(t,e){if(e in t)return e;for(var n=e[0].toUpperCase()+e.slice(1),i=e,o=Zt.length;o--;)if(e=Zt[o]+n,e in t)return e;return i}function L(t,e,n){var i=Xt.exec(e);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):e}function D(t,e,n,i,o){for(var r=n===(i?"border":"content")?4:"width"===e?1:0,a=0;4>r;r+=2)"margin"===n&&(a+=it.css(t,n+_t[r],!0,o)),i?("content"===n&&(a-=it.css(t,"padding"+_t[r],!0,o)),"margin"!==n&&(a-=it.css(t,"border"+_t[r]+"Width",!0,o))):(a+=it.css(t,"padding"+_t[r],!0,o),"padding"!==n&&(a+=it.css(t,"border"+_t[r]+"Width",!0,o)));return a}function N(t,e,n){var i=!0,o="width"===e?t.offsetWidth:t.offsetHeight,r=Gt(t),a="border-box"===it.css(t,"boxSizing",!1,r);if(0>=o||null==o){if(o=S(t,e,r),(0>o||null==o)&&(o=t.style[e]),Vt.test(o))return o;i=a&&(tt.boxSizingReliable()||o===t.style[e]),o=parseFloat(o)||0}return o+D(t,e,n||(a?"border":"content"),i,r)+"px"}function E(t,e){for(var n,i,o,r=[],a=0,s=t.length;s>a;a++)i=t[a],i.style&&(r[a]=xt.get(i,"olddisplay"),n=i.style.display,e?(r[a]||"none"!==n||(i.style.display=""),""===i.style.display&&It(i)&&(r[a]=xt.access(i,"olddisplay",T(i.nodeName)))):(o=It(i),"none"===n&&o||xt.set(i,"olddisplay",o?n:it.css(i,"display"))));for(a=0;s>a;a++)i=t[a],i.style&&(e&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=e?r[a]||"":"none"));return t}function A(t,e,n,i,o){return new A.prototype.init(t,e,n,i,o)}function M(){return setTimeout(function(){te=void 0}),te=it.now()}function P(t,e){var n,i=0,o={height:t};for(e=e?1:0;4>i;i+=2-e)n=_t[i],o["margin"+n]=o["padding"+n]=t;return e&&(o.opacity=o.width=t),o}function O(t,e,n){for(var i,o=(ae[e]||[]).concat(ae["*"]),r=0,a=o.length;a>r;r++)if(i=o[r].call(n,e,t))return i}function F(t,e,n){var i,o,r,a,s,l,c,d,u=this,p={},f=t.style,h=t.nodeType&&It(t),m=xt.get(t,"fxshow");n.queue||(s=it._queueHooks(t,"fx"),null==s.unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,u.always(function(){u.always(function(){s.unqueued--,it.queue(t,"fx").length||s.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],c=it.css(t,"display"),d="none"===c?xt.get(t,"olddisplay")||T(t.nodeName):c,"inline"===d&&"none"===it.css(t,"float")&&(f.display="inline-block")),n.overflow&&(f.overflow="hidden",u.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}));for(i in e)if(o=e[i],ne.exec(o)){if(delete e[i],r=r||"toggle"===o,o===(h?"hide":"show")){if("show"!==o||!m||void 0===m[i])continue;h=!0}p[i]=m&&m[i]||it.style(t,i)}else c=void 0;if(it.isEmptyObject(p))"inline"===("none"===c?T(t.nodeName):c)&&(f.display=c);else{m?"hidden"in m&&(h=m.hidden):m=xt.access(t,"fxshow",{}),r&&(m.hidden=!h),h?it(t).show():u.done(function(){it(t).hide()}),u.done(function(){var e;xt.remove(t,"fxshow");for(e in p)it.style(t,e,p[e])});for(i in p)a=O(h?m[i]:0,i,u),i in m||(m[i]=a.start,h&&(a.end=a.start,a.start="width"===i||"height"===i?1:0))}}function H(t,e){var n,i,o,r,a;for(n in t)if(i=it.camelCase(n),o=e[i],r=t[n],it.isArray(r)&&(o=r[1],r=t[n]=r[0]),n!==i&&(t[i]=r,delete t[n]),a=it.cssHooks[i],a&&"expand"in a){r=a.expand(r),delete t[i];for(n in r)n in t||(t[n]=r[n],e[n]=o)}else e[i]=o}function $(t,e,n){var i,o,r=0,a=re.length,s=it.Deferred().always(function(){delete l.elem}),l=function(){if(o)return!1;for(var e=te||M(),n=Math.max(0,c.startTime+c.duration-e),i=n/c.duration||0,r=1-i,a=0,l=c.tweens.length;l>a;a++)c.tweens[a].run(r);return s.notifyWith(t,[c,r,n]),1>r&&l?n:(s.resolveWith(t,[c]),!1)},c=s.promise({elem:t,props:it.extend({},e),opts:it.extend(!0,{specialEasing:{}},n),originalProperties:e,originalOptions:n,startTime:te||M(),duration:n.duration,tweens:[],createTween:function(e,n){var i=it.Tween(t,c.opts,e,n,c.opts.specialEasing[e]||c.opts.easing);return c.tweens.push(i),i},stop:function(e){var n=0,i=e?c.tweens.length:0;if(o)return this;for(o=!0;i>n;n++)c.tweens[n].run(1);return e?s.resolveWith(t,[c,e]):s.rejectWith(t,[c,e]),this}}),d=c.props;for(H(d,c.opts.specialEasing);a>r;r++)if(i=re[r].call(c,t,d,c.opts))return i;return it.map(d,O,c),it.isFunction(c.opts.start)&&c.opts.start.call(t,c),it.fx.timer(it.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function B(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var i,o=0,r=e.toLowerCase().match(vt)||[];if(it.isFunction(n))for(;i=r[o++];)"+"===i[0]?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(n)):(t[i]=t[i]||[]).push(n)}}function R(t,e,n,i){function o(s){var l;return r[s]=!0,it.each(t[s]||[],function(t,s){var c=s(e,n,i);return"string"!=typeof c||a||r[c]?a?!(l=c):void 0:(e.dataTypes.unshift(c),o(c),!1)}),l}var r={},a=t===Ce;return o(e.dataTypes[0])||!r["*"]&&o("*")}function z(t,e){var n,i,o=it.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((o[n]?t:i||(i={}))[n]=e[n]);return i&&it.extend(!0,t,i),t}function j(t,e,n){for(var i,o,r,a,s=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i)for(o in s)if(s[o]&&s[o].test(i)){l.unshift(o);break}if(l[0]in n)r=l[0];else{for(o in n){if(!l[0]||t.converters[o+" "+l[0]]){r=o;break}a||(a=o)}r=r||a}return r?(r!==l[0]&&l.unshift(r),n[r]):void 0}function W(t,e,n,i){var o,r,a,s,l,c={},d=t.dataTypes.slice();if(d[1])for(a in t.converters)c[a.toLowerCase()]=t.converters[a];for(r=d.shift();r;)if(t.responseFields[r]&&(n[t.responseFields[r]]=e),!l&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=r,r=d.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(a=c[l+" "+r]||c["* "+r],!a)for(o in c)if(s=o.split(" "),s[1]===r&&(a=c[l+" "+s[0]]||c["* "+s[0]])){a===!0?a=c[o]:c[o]!==!0&&(r=s[0],d.unshift(s[1]));break}if(a!==!0)if(a&&t["throws"])e=a(e);else try{e=a(e)}catch(u){return{state:"parsererror",error:a?u:"No conversion from "+l+" to "+r}}}return{state:"success",data:e}}function U(t,e,n,i){var o;if(it.isArray(e))it.each(e,function(e,o){n||Le.test(t)?i(t,o):U(t+"["+("object"==typeof o?e:"")+"]",o,n,i)});else if(n||"object"!==it.type(e))i(t,e);else for(o in e)U(t+"["+o+"]",e[o],n,i)}function q(t){return it.isWindow(t)?t:9===t.nodeType&&t.defaultView}var V=[],G=V.slice,K=V.concat,X=V.push,Y=V.indexOf,Q={},J=Q.toString,Z=Q.hasOwnProperty,tt={},et=o.document,nt="2.1.3",it=function(t,e){return new it.fn.init(t,e)},ot=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rt=/^-ms-/,at=/-([\da-z])/gi,st=function(t,e){return e.toUpperCase()};it.fn=it.prototype={jquery:nt,constructor:it,selector:"",length:0,toArray:function(){return G.call(this)},get:function(t){return null!=t?0>t?this[t+this.length]:this[t]:G.call(this)},pushStack:function(t){var e=it.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return it.each(this,t,e)},map:function(t){return this.pushStack(it.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return this.pushStack(G.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(0>t?e:0);return this.pushStack(n>=0&&e>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:X,sort:V.sort,splice:V.splice},it.extend=it.fn.extend=function(){var t,e,n,i,o,r,a=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[s]||{},s++),"object"==typeof a||it.isFunction(a)||(a={}),s===l&&(a=this,s--);l>s;s++)if(null!=(t=arguments[s]))for(e in t)n=a[e],i=t[e],a!==i&&(c&&i&&(it.isPlainObject(i)||(o=it.isArray(i)))?(o?(o=!1,r=n&&it.isArray(n)?n:[]):r=n&&it.isPlainObject(n)?n:{},a[e]=it.extend(c,r,i)):void 0!==i&&(a[e]=i));return a},it.extend({expando:"jQuery"+(nt+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===it.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){return!it.isArray(t)&&t-parseFloat(t)+1>=0},isPlainObject:function(t){return"object"!==it.type(t)||t.nodeType||it.isWindow(t)?!1:t.constructor&&!Z.call(t.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?Q[J.call(t)]||"object":typeof t},globalEval:function(t){var e,n=eval;t=it.trim(t),t&&(1===t.indexOf("use strict")?(e=et.createElement("script"),e.text=t,et.head.appendChild(e).parentNode.removeChild(e)):n(t))},camelCase:function(t){return t.replace(rt,"ms-").replace(at,st)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,n){var i,o=0,r=t.length,s=a(t);if(n){if(s)for(;r>o&&(i=e.apply(t[o],n),i!==!1);o++);else for(o in t)if(i=e.apply(t[o],n),i===!1)break}else if(s)for(;r>o&&(i=e.call(t[o],o,t[o]),i!==!1);o++);else for(o in t)if(i=e.call(t[o],o,t[o]),i===!1)break;return t},trim:function(t){return null==t?"":(t+"").replace(ot,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(a(Object(t))?it.merge(n,"string"==typeof t?[t]:t):X.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:Y.call(e,t,n)},merge:function(t,e){for(var n=+e.length,i=0,o=t.length;n>i;i++)t[o++]=e[i];return t.length=o,t},grep:function(t,e,n){for(var i,o=[],r=0,a=t.length,s=!n;a>r;r++)i=!e(t[r],r),i!==s&&o.push(t[r]);return o},map:function(t,e,n){var i,o=0,r=t.length,s=a(t),l=[];if(s)for(;r>o;o++)i=e(t[o],o,n),null!=i&&l.push(i);else for(o in t)i=e(t[o],o,n),null!=i&&l.push(i);return K.apply([],l)},guid:1,proxy:function(t,e){var n,i,o;return"string"==typeof e&&(n=t[e],e=t,t=n),it.isFunction(t)?(i=G.call(arguments,2),o=function(){return t.apply(e||this,i.concat(G.call(arguments)))},o.guid=t.guid=t.guid||it.guid++,o):void 0},now:Date.now,support:tt}),it.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){Q["[object "+e+"]"]=e.toLowerCase()});var lt=function(t){function e(t,e,n,i){var o,r,a,s,l,c,u,f,h,m;if((e?e.ownerDocument||e:R)!==A&&E(e),e=e||A,n=n||[],s=e.nodeType,"string"!=typeof t||!t||1!==s&&9!==s&&11!==s)return n;if(!i&&P){if(11!==s&&(o=bt.exec(t)))if(a=o[1]){if(9===s){if(r=e.getElementById(a),!r||!r.parentNode)return n;if(r.id===a)return n.push(r),n}else if(e.ownerDocument&&(r=e.ownerDocument.getElementById(a))&&$(e,r)&&r.id===a)return n.push(r),n}else{if(o[2])return J.apply(n,e.getElementsByTagName(t)),n;if((a=o[3])&&x.getElementsByClassName)return J.apply(n,e.getElementsByClassName(a)),n}if(x.qsa&&(!O||!O.test(t))){if(f=u=B,h=e,m=1!==s&&t,1===s&&"object"!==e.nodeName.toLowerCase()){for(c=S(t),(u=e.getAttribute("id"))?f=u.replace(wt,"\\$&"):e.setAttribute("id",f),f="[id='"+f+"'] ",l=c.length;l--;)c[l]=f+p(c[l]);h=yt.test(t)&&d(e.parentNode)||e,m=c.join(",")}if(m)try{return J.apply(n,h.querySelectorAll(m)),n}catch(g){}finally{u||e.removeAttribute("id")}}}return I(t.replace(lt,"$1"),e,n,i)}function n(){function t(n,i){return e.push(n+" ")>k.cacheLength&&delete t[e.shift()],t[n+" "]=i}var e=[];return t}function i(t){return t[B]=!0,t}function o(t){var e=A.createElement("div");try{return!!t(e)}catch(n){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function r(t,e){for(var n=t.split("|"),i=t.length;i--;)k.attrHandle[n[i]]=e}function a(t,e){var n=e&&t,i=n&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||G)-(~t.sourceIndex||G);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function s(t){return function(e){var n=e.nodeName.toLowerCase();return"input"===n&&e.type===t}}function l(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function c(t){return i(function(e){return e=+e,i(function(n,i){for(var o,r=t([],n.length,e),a=r.length;a--;)n[o=r[a]]&&(n[o]=!(i[o]=n[o]))})})}function d(t){return t&&"undefined"!=typeof t.getElementsByTagName&&t}function u(){}function p(t){for(var e=0,n=t.length,i="";n>e;e++)i+=t[e].value;return i}function f(t,e,n){var i=e.dir,o=n&&"parentNode"===i,r=j++;return e.first?function(e,n,r){for(;e=e[i];)if(1===e.nodeType||o)return t(e,n,r)}:function(e,n,a){var s,l,c=[z,r];if(a){for(;e=e[i];)if((1===e.nodeType||o)&&t(e,n,a))return!0}else for(;e=e[i];)if(1===e.nodeType||o){if(l=e[B]||(e[B]={}),(s=l[i])&&s[0]===z&&s[1]===r)return c[2]=s[2];if(l[i]=c,c[2]=t(e,n,a))return!0}}}function h(t){return t.length>1?function(e,n,i){for(var o=t.length;o--;)if(!t[o](e,n,i))return!1;return!0}:t[0]}function m(t,n,i){for(var o=0,r=n.length;r>o;o++)e(t,n[o],i);return i}function g(t,e,n,i,o){for(var r,a=[],s=0,l=t.length,c=null!=e;l>s;s++)(r=t[s])&&(!n||n(r,i,o))&&(a.push(r),c&&e.push(s));return a}function v(t,e,n,o,r,a){return o&&!o[B]&&(o=v(o)),r&&!r[B]&&(r=v(r,a)),i(function(i,a,s,l){var c,d,u,p=[],f=[],h=a.length,v=i||m(e||"*",s.nodeType?[s]:s,[]),b=!t||!i&&e?v:g(v,p,t,s,l),y=n?r||(i?t:h||o)?[]:a:b;if(n&&n(b,y,s,l),o)for(c=g(y,f),o(c,[],s,l),d=c.length;d--;)(u=c[d])&&(y[f[d]]=!(b[f[d]]=u));if(i){if(r||t){if(r){for(c=[],d=y.length;d--;)(u=y[d])&&c.push(b[d]=u);r(null,y=[],c,l)}for(d=y.length;d--;)(u=y[d])&&(c=r?tt(i,u):p[d])>-1&&(i[c]=!(a[c]=u))}}else y=g(y===a?y.splice(h,y.length):y),r?r(null,a,y,l):J.apply(a,y)})}function b(t){for(var e,n,i,o=t.length,r=k.relative[t[0].type],a=r||k.relative[" "],s=r?1:0,l=f(function(t){return t===e},a,!0),c=f(function(t){return tt(e,t)>-1},a,!0),d=[function(t,n,i){var o=!r&&(i||n!==L)||((e=n).nodeType?l(t,n,i):c(t,n,i));return e=null,o}];o>s;s++)if(n=k.relative[t[s].type])d=[f(h(d),n)];else{if(n=k.filter[t[s].type].apply(null,t[s].matches),n[B]){for(i=++s;o>i&&!k.relative[t[i].type];i++);return v(s>1&&h(d),s>1&&p(t.slice(0,s-1).concat({value:" "===t[s-2].type?"*":""})).replace(lt,"$1"),n,i>s&&b(t.slice(s,i)),o>i&&b(t=t.slice(i)),o>i&&p(t))}d.push(n)}return h(d)}function y(t,n){var o=n.length>0,r=t.length>0,a=function(i,a,s,l,c){var d,u,p,f=0,h="0",m=i&&[],v=[],b=L,y=i||r&&k.find.TAG("*",c),w=z+=null==b?1:Math.random()||.1,x=y.length;for(c&&(L=a!==A&&a);h!==x&&null!=(d=y[h]);h++){if(r&&d){for(u=0;p=t[u++];)if(p(d,a,s)){l.push(d);break}c&&(z=w)}o&&((d=!p&&d)&&f--,i&&m.push(d))}if(f+=h,o&&h!==f){for(u=0;p=n[u++];)p(m,v,a,s);if(i){if(f>0)for(;h--;)m[h]||v[h]||(v[h]=Y.call(l));v=g(v)}J.apply(l,v),c&&!i&&v.length>0&&f+n.length>1&&e.uniqueSort(l)}return c&&(z=w,L=b),m};return o?i(a):a}var w,x,k,C,T,S,_,I,L,D,N,E,A,M,P,O,F,H,$,B="sizzle"+1*new Date,R=t.document,z=0,j=0,W=n(),U=n(),q=n(),V=function(t,e){return t===e&&(N=!0),0},G=1<<31,K={}.hasOwnProperty,X=[],Y=X.pop,Q=X.push,J=X.push,Z=X.slice,tt=function(t,e){for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return n;return-1},et="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",nt="[\\x20\\t\\r\\n\\f]",it="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ot=it.replace("w","w#"),rt="\\["+nt+"*("+it+")(?:"+nt+"*([*^$|!~]?=)"+nt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ot+"))|)"+nt+"*\\]",at=":("+it+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+rt+")*)|.*)\\)|)",st=new RegExp(nt+"+","g"),lt=new RegExp("^"+nt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+nt+"+$","g"),ct=new RegExp("^"+nt+"*,"+nt+"*"),dt=new RegExp("^"+nt+"*([>+~]|"+nt+")"+nt+"*"),ut=new RegExp("="+nt+"*([^\\]'\"]*?)"+nt+"*\\]","g"),pt=new RegExp(at),ft=new RegExp("^"+ot+"$"),ht={ID:new RegExp("^#("+it+")"),CLASS:new RegExp("^\\.("+it+")"),TAG:new RegExp("^("+it.replace("w","w*")+")"),ATTR:new RegExp("^"+rt),PSEUDO:new RegExp("^"+at),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+nt+"*(even|odd|(([+-]|)(\\d*)n|)"+nt+"*(?:([+-]|)"+nt+"*(\\d+)|))"+nt+"*\\)|)","i"),bool:new RegExp("^(?:"+et+")$","i"),needsContext:new RegExp("^"+nt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+nt+"*((?:-\\d)?\\d*)"+nt+"*\\)|)(?=[^-]|$)","i")},mt=/^(?:input|select|textarea|button)$/i,gt=/^h\d$/i,vt=/^[^{]+\{\s*\[native \w/,bt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,yt=/[+~]/,wt=/'|\\/g,xt=new RegExp("\\\\([\\da-f]{1,6}"+nt+"?|("+nt+")|.)","ig"),kt=function(t,e,n){var i="0x"+e-65536;return i!==i||n?e:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},Ct=function(){E()};try{J.apply(X=Z.call(R.childNodes),R.childNodes),X[R.childNodes.length].nodeType}catch(Tt){J={apply:X.length?function(t,e){Q.apply(t,Z.call(e))}:function(t,e){for(var n=t.length,i=0;t[n++]=e[i++];);t.length=n-1}}}x=e.support={},T=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return e?"HTML"!==e.nodeName:!1},E=e.setDocument=function(t){var e,n,i=t?t.ownerDocument||t:R;return i!==A&&9===i.nodeType&&i.documentElement?(A=i,M=i.documentElement,n=i.defaultView,n&&n!==n.top&&(n.addEventListener?n.addEventListener("unload",Ct,!1):n.attachEvent&&n.attachEvent("onunload",Ct)),P=!T(i),x.attributes=o(function(t){return t.className="i",!t.getAttribute("className")}),x.getElementsByTagName=o(function(t){return t.appendChild(i.createComment("")),!t.getElementsByTagName("*").length}),x.getElementsByClassName=vt.test(i.getElementsByClassName),x.getById=o(function(t){return M.appendChild(t).id=B,!i.getElementsByName||!i.getElementsByName(B).length}),x.getById?(k.find.ID=function(t,e){if("undefined"!=typeof e.getElementById&&P){var n=e.getElementById(t);return n&&n.parentNode?[n]:[]}},k.filter.ID=function(t){var e=t.replace(xt,kt);return function(t){return t.getAttribute("id")===e}}):(delete k.find.ID,k.filter.ID=function(t){var e=t.replace(xt,kt);return function(t){var n="undefined"!=typeof t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}}),k.find.TAG=x.getElementsByTagName?function(t,e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t):x.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,i=[],o=0,r=e.getElementsByTagName(t);if("*"===t){for(;n=r[o++];)1===n.nodeType&&i.push(n);return i}return r},k.find.CLASS=x.getElementsByClassName&&function(t,e){return P?e.getElementsByClassName(t):void 0},F=[],O=[],(x.qsa=vt.test(i.querySelectorAll))&&(o(function(t){M.appendChild(t).innerHTML="<a id='"+B+"'></a><select id='"+B+"-\f]' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&O.push("[*^$]="+nt+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||O.push("\\["+nt+"*(?:value|"+et+")"),t.querySelectorAll("[id~="+B+"-]").length||O.push("~="),t.querySelectorAll(":checked").length||O.push(":checked"),t.querySelectorAll("a#"+B+"+*").length||O.push(".#.+[+~]")}),o(function(t){var e=i.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&O.push("name"+nt+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||O.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),O.push(",.*:")})),(x.matchesSelector=vt.test(H=M.matches||M.webkitMatchesSelector||M.mozMatchesSelector||M.oMatchesSelector||M.msMatchesSelector))&&o(function(t){x.disconnectedMatch=H.call(t,"div"),H.call(t,"[s!='']:x"),F.push("!=",at)}),O=O.length&&new RegExp(O.join("|")),F=F.length&&new RegExp(F.join("|")),e=vt.test(M.compareDocumentPosition),$=e||vt.test(M.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},V=e?function(t,e){if(t===e)return N=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n?n:(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&n||!x.sortDetached&&e.compareDocumentPosition(t)===n?t===i||t.ownerDocument===R&&$(R,t)?-1:e===i||e.ownerDocument===R&&$(R,e)?1:D?tt(D,t)-tt(D,e):0:4&n?-1:1)}:function(t,e){if(t===e)return N=!0,0;var n,o=0,r=t.parentNode,s=e.parentNode,l=[t],c=[e];if(!r||!s)return t===i?-1:e===i?1:r?-1:s?1:D?tt(D,t)-tt(D,e):0;if(r===s)return a(t,e);for(n=t;n=n.parentNode;)l.unshift(n);for(n=e;n=n.parentNode;)c.unshift(n);for(;l[o]===c[o];)o++;return o?a(l[o],c[o]):l[o]===R?-1:c[o]===R?1:0},i):A},e.matches=function(t,n){return e(t,null,null,n)},e.matchesSelector=function(t,n){if((t.ownerDocument||t)!==A&&E(t),n=n.replace(ut,"='$1']"),!(!x.matchesSelector||!P||F&&F.test(n)||O&&O.test(n)))try{var i=H.call(t,n);if(i||x.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(o){}return e(n,A,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==A&&E(t),$(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==A&&E(t);var n=k.attrHandle[e.toLowerCase()],i=n&&K.call(k.attrHandle,e.toLowerCase())?n(t,e,!P):void 0;return void 0!==i?i:x.attributes||!P?t.getAttribute(e):(i=t.getAttributeNode(e))&&i.specified?i.value:null},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,n=[],i=0,o=0;if(N=!x.detectDuplicates,D=!x.sortStable&&t.slice(0),t.sort(V),N){for(;e=t[o++];)e===t[o]&&(i=n.push(o));for(;i--;)t.splice(n[i],1)}return D=null,t},C=e.getText=function(t){var e,n="",i=0,o=t.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=C(t)}else if(3===o||4===o)return t.nodeValue}else for(;e=t[i++];)n+=C(e);return n},k=e.selectors={cacheLength:50,createPseudo:i,match:ht,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(xt,kt),t[3]=(t[3]||t[4]||t[5]||"").replace(xt,kt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return ht.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&pt.test(n)&&(e=S(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(xt,kt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=W[t+" "];return e||(e=new RegExp("(^|"+nt+")"+t+"("+nt+"|$)"))&&W(t,function(t){return e.test("string"==typeof t.className&&t.className||"undefined"!=typeof t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,n,i){return function(o){var r=e.attr(o,t);return null==r?"!="===n:n?(r+="","="===n?r===i:"!="===n?r!==i:"^="===n?i&&0===r.indexOf(i):"*="===n?i&&r.indexOf(i)>-1:"$="===n?i&&r.slice(-i.length)===i:"~="===n?(" "+r.replace(st," ")+" ").indexOf(i)>-1:"|="===n?r===i||r.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(t,e,n,i,o){var r="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===i&&0===o?function(t){return!!t.parentNode}:function(e,n,l){var c,d,u,p,f,h,m=r!==a?"nextSibling":"previousSibling",g=e.parentNode,v=s&&e.nodeName.toLowerCase(),b=!l&&!s;if(g){if(r){for(;m;){for(u=e;u=u[m];)if(s?u.nodeName.toLowerCase()===v:1===u.nodeType)return!1;h=m="only"===t&&!h&&"nextSibling"}return!0}if(h=[a?g.firstChild:g.lastChild],a&&b){for(d=g[B]||(g[B]={}),c=d[t]||[],f=c[0]===z&&c[1],p=c[0]===z&&c[2],u=f&&g.childNodes[f];u=++f&&u&&u[m]||(p=f=0)||h.pop();)if(1===u.nodeType&&++p&&u===e){d[t]=[z,f,p];break}}else if(b&&(c=(e[B]||(e[B]={}))[t])&&c[0]===z)p=c[1];else for(;(u=++f&&u&&u[m]||(p=f=0)||h.pop())&&((s?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++p||(b&&((u[B]||(u[B]={}))[t]=[z,p]),u!==e)););return p-=o,p===i||p%i===0&&p/i>=0}}},PSEUDO:function(t,n){var o,r=k.pseudos[t]||k.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return r[B]?r(n):r.length>1?(o=[t,t,"",n],k.setFilters.hasOwnProperty(t.toLowerCase())?i(function(t,e){for(var i,o=r(t,n),a=o.length;a--;)i=tt(t,o[a]),t[i]=!(e[i]=o[a])}):function(t){return r(t,0,o)}):r}},pseudos:{not:i(function(t){var e=[],n=[],o=_(t.replace(lt,"$1"));return o[B]?i(function(t,e,n,i){for(var r,a=o(t,null,i,[]),s=t.length;s--;)(r=a[s])&&(t[s]=!(e[s]=r))}):function(t,i,r){return e[0]=t,o(e,null,r,n),e[0]=null,!n.pop()}}),has:i(function(t){return function(n){return e(t,n).length>0}}),contains:i(function(t){return t=t.replace(xt,kt),function(e){return(e.textContent||e.innerText||C(e)).indexOf(t)>-1}}),lang:i(function(t){return ft.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(xt,kt).toLowerCase(),function(e){var n;do if(n=P?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return n=n.toLowerCase(),n===t||0===n.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id;
},root:function(t){return t===M},focus:function(t){return t===A.activeElement&&(!A.hasFocus||A.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!k.pseudos.empty(t)},header:function(t){return gt.test(t.nodeName)},input:function(t){return mt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:c(function(){return[0]}),last:c(function(t,e){return[e-1]}),eq:c(function(t,e,n){return[0>n?n+e:n]}),even:c(function(t,e){for(var n=0;e>n;n+=2)t.push(n);return t}),odd:c(function(t,e){for(var n=1;e>n;n+=2)t.push(n);return t}),lt:c(function(t,e,n){for(var i=0>n?n+e:n;--i>=0;)t.push(i);return t}),gt:c(function(t,e,n){for(var i=0>n?n+e:n;++i<e;)t.push(i);return t})}},k.pseudos.nth=k.pseudos.eq;for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})k.pseudos[w]=s(w);for(w in{submit:!0,reset:!0})k.pseudos[w]=l(w);return u.prototype=k.filters=k.pseudos,k.setFilters=new u,S=e.tokenize=function(t,n){var i,o,r,a,s,l,c,d=U[t+" "];if(d)return n?0:d.slice(0);for(s=t,l=[],c=k.preFilter;s;){(!i||(o=ct.exec(s)))&&(o&&(s=s.slice(o[0].length)||s),l.push(r=[])),i=!1,(o=dt.exec(s))&&(i=o.shift(),r.push({value:i,type:o[0].replace(lt," ")}),s=s.slice(i.length));for(a in k.filter)!(o=ht[a].exec(s))||c[a]&&!(o=c[a](o))||(i=o.shift(),r.push({value:i,type:a,matches:o}),s=s.slice(i.length));if(!i)break}return n?s.length:s?e.error(t):U(t,l).slice(0)},_=e.compile=function(t,e){var n,i=[],o=[],r=q[t+" "];if(!r){for(e||(e=S(t)),n=e.length;n--;)r=b(e[n]),r[B]?i.push(r):o.push(r);r=q(t,y(o,i)),r.selector=t}return r},I=e.select=function(t,e,n,i){var o,r,a,s,l,c="function"==typeof t&&t,u=!i&&S(t=c.selector||t);if(n=n||[],1===u.length){if(r=u[0]=u[0].slice(0),r.length>2&&"ID"===(a=r[0]).type&&x.getById&&9===e.nodeType&&P&&k.relative[r[1].type]){if(e=(k.find.ID(a.matches[0].replace(xt,kt),e)||[])[0],!e)return n;c&&(e=e.parentNode),t=t.slice(r.shift().value.length)}for(o=ht.needsContext.test(t)?0:r.length;o--&&(a=r[o],!k.relative[s=a.type]);)if((l=k.find[s])&&(i=l(a.matches[0].replace(xt,kt),yt.test(r[0].type)&&d(e.parentNode)||e))){if(r.splice(o,1),t=i.length&&p(r),!t)return J.apply(n,i),n;break}}return(c||_(t,u))(i,e,!P,n,yt.test(t)&&d(e.parentNode)||e),n},x.sortStable=B.split("").sort(V).join("")===B,x.detectDuplicates=!!N,E(),x.sortDetached=o(function(t){return 1&t.compareDocumentPosition(A.createElement("div"))}),o(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||r("type|href|height|width",function(t,e,n){return n?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),x.attributes&&o(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||r("value",function(t,e,n){return n||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue}),o(function(t){return null==t.getAttribute("disabled")})||r(et,function(t,e,n){var i;return n?void 0:t[e]===!0?e.toLowerCase():(i=t.getAttributeNode(e))&&i.specified?i.value:null}),e}(o);it.find=lt,it.expr=lt.selectors,it.expr[":"]=it.expr.pseudos,it.unique=lt.uniqueSort,it.text=lt.getText,it.isXMLDoc=lt.isXML,it.contains=lt.contains;var ct=it.expr.match.needsContext,dt=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ut=/^.[^:#\[\.,]*$/;it.filter=function(t,e,n){var i=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===i.nodeType?it.find.matchesSelector(i,t)?[i]:[]:it.find.matches(t,it.grep(e,function(t){return 1===t.nodeType}))},it.fn.extend({find:function(t){var e,n=this.length,i=[],o=this;if("string"!=typeof t)return this.pushStack(it(t).filter(function(){for(e=0;n>e;e++)if(it.contains(o[e],this))return!0}));for(e=0;n>e;e++)it.find(t,o[e],i);return i=this.pushStack(n>1?it.unique(i):i),i.selector=this.selector?this.selector+" "+t:t,i},filter:function(t){return this.pushStack(s(this,t||[],!1))},not:function(t){return this.pushStack(s(this,t||[],!0))},is:function(t){return!!s(this,"string"==typeof t&&ct.test(t)?it(t):t||[],!1).length}});var pt,ft=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ht=it.fn.init=function(t,e){var n,i;if(!t)return this;if("string"==typeof t){if(n="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:ft.exec(t),!n||!n[1]&&e)return!e||e.jquery?(e||pt).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof it?e[0]:e,it.merge(this,it.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:et,!0)),dt.test(n[1])&&it.isPlainObject(e))for(n in e)it.isFunction(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return i=et.getElementById(n[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=et,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):it.isFunction(t)?"undefined"!=typeof pt.ready?pt.ready(t):t(it):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),it.makeArray(t,this))};ht.prototype=it.fn,pt=it(et);var mt=/^(?:parents|prev(?:Until|All))/,gt={children:!0,contents:!0,next:!0,prev:!0};it.extend({dir:function(t,e,n){for(var i=[],o=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(o&&it(t).is(n))break;i.push(t)}return i},sibling:function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n}}),it.fn.extend({has:function(t){var e=it(t,this),n=e.length;return this.filter(function(){for(var t=0;n>t;t++)if(it.contains(this,e[t]))return!0})},closest:function(t,e){for(var n,i=0,o=this.length,r=[],a=ct.test(t)||"string"!=typeof t?it(t,e||this.context):0;o>i;i++)for(n=this[i];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&it.find.matchesSelector(n,t))){r.push(n);break}return this.pushStack(r.length>1?it.unique(r):r)},index:function(t){return t?"string"==typeof t?Y.call(it(t),this[0]):Y.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(it.unique(it.merge(this.get(),it(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),it.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return it.dir(t,"parentNode")},parentsUntil:function(t,e,n){return it.dir(t,"parentNode",n)},next:function(t){return l(t,"nextSibling")},prev:function(t){return l(t,"previousSibling")},nextAll:function(t){return it.dir(t,"nextSibling")},prevAll:function(t){return it.dir(t,"previousSibling")},nextUntil:function(t,e,n){return it.dir(t,"nextSibling",n)},prevUntil:function(t,e,n){return it.dir(t,"previousSibling",n)},siblings:function(t){return it.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return it.sibling(t.firstChild)},contents:function(t){return t.contentDocument||it.merge([],t.childNodes)}},function(t,e){it.fn[t]=function(n,i){var o=it.map(this,e,n);return"Until"!==t.slice(-5)&&(i=n),i&&"string"==typeof i&&(o=it.filter(i,o)),this.length>1&&(gt[t]||it.unique(o),mt.test(t)&&o.reverse()),this.pushStack(o)}});var vt=/\S+/g,bt={};it.Callbacks=function(t){t="string"==typeof t?bt[t]||c(t):it.extend({},t);var e,n,i,o,r,a,s=[],l=!t.once&&[],d=function(c){for(e=t.memory&&c,n=!0,a=o||0,o=0,r=s.length,i=!0;s&&r>a;a++)if(s[a].apply(c[0],c[1])===!1&&t.stopOnFalse){e=!1;break}i=!1,s&&(l?l.length&&d(l.shift()):e?s=[]:u.disable())},u={add:function(){if(s){var n=s.length;!function a(e){it.each(e,function(e,n){var i=it.type(n);"function"===i?t.unique&&u.has(n)||s.push(n):n&&n.length&&"string"!==i&&a(n)})}(arguments),i?r=s.length:e&&(o=n,d(e))}return this},remove:function(){return s&&it.each(arguments,function(t,e){for(var n;(n=it.inArray(e,s,n))>-1;)s.splice(n,1),i&&(r>=n&&r--,a>=n&&a--)}),this},has:function(t){return t?it.inArray(t,s)>-1:!(!s||!s.length)},empty:function(){return s=[],r=0,this},disable:function(){return s=l=e=void 0,this},disabled:function(){return!s},lock:function(){return l=void 0,e||u.disable(),this},locked:function(){return!l},fireWith:function(t,e){return!s||n&&!l||(e=e||[],e=[t,e.slice?e.slice():e],i?l.push(e):d(e)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!n}};return u},it.extend({Deferred:function(t){var e=[["resolve","done",it.Callbacks("once memory"),"resolved"],["reject","fail",it.Callbacks("once memory"),"rejected"],["notify","progress",it.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var t=arguments;return it.Deferred(function(n){it.each(e,function(e,r){var a=it.isFunction(t[e])&&t[e];o[r[1]](function(){var t=a&&a.apply(this,arguments);t&&it.isFunction(t.promise)?t.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[r[0]+"With"](this===i?n.promise():this,a?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?it.extend(t,i):i}},o={};return i.pipe=i.then,it.each(e,function(t,r){var a=r[2],s=r[3];i[r[1]]=a.add,s&&a.add(function(){n=s},e[1^t][2].disable,e[2][2].lock),o[r[0]]=function(){return o[r[0]+"With"](this===o?i:this,arguments),this},o[r[0]+"With"]=a.fireWith}),i.promise(o),t&&t.call(o,o),o},when:function(t){var e,n,i,o=0,r=G.call(arguments),a=r.length,s=1!==a||t&&it.isFunction(t.promise)?a:0,l=1===s?t:it.Deferred(),c=function(t,n,i){return function(o){n[t]=this,i[t]=arguments.length>1?G.call(arguments):o,i===e?l.notifyWith(n,i):--s||l.resolveWith(n,i)}};if(a>1)for(e=new Array(a),n=new Array(a),i=new Array(a);a>o;o++)r[o]&&it.isFunction(r[o].promise)?r[o].promise().done(c(o,i,r)).fail(l.reject).progress(c(o,n,e)):--s;return s||l.resolveWith(i,r),l.promise()}});var yt;it.fn.ready=function(t){return it.ready.promise().done(t),this},it.extend({isReady:!1,readyWait:1,holdReady:function(t){t?it.readyWait++:it.ready(!0)},ready:function(t){(t===!0?--it.readyWait:it.isReady)||(it.isReady=!0,t!==!0&&--it.readyWait>0||(yt.resolveWith(et,[it]),it.fn.triggerHandler&&(it(et).triggerHandler("ready"),it(et).off("ready"))))}}),it.ready.promise=function(t){return yt||(yt=it.Deferred(),"complete"===et.readyState?setTimeout(it.ready):(et.addEventListener("DOMContentLoaded",d,!1),o.addEventListener("load",d,!1))),yt.promise(t)},it.ready.promise();var wt=it.access=function(t,e,n,i,o,r,a){var s=0,l=t.length,c=null==n;if("object"===it.type(n)){o=!0;for(s in n)it.access(t,e,s,n[s],!0,r,a)}else if(void 0!==i&&(o=!0,it.isFunction(i)||(a=!0),c&&(a?(e.call(t,i),e=null):(c=e,e=function(t,e,n){return c.call(it(t),n)})),e))for(;l>s;s++)e(t[s],n,a?i:i.call(t[s],s,e(t[s],n)));return o?t:c?e.call(t):l?e(t[0],n):r};it.acceptData=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType},u.uid=1,u.accepts=it.acceptData,u.prototype={key:function(t){if(!u.accepts(t))return 0;var e={},n=t[this.expando];if(!n){n=u.uid++;try{e[this.expando]={value:n},Object.defineProperties(t,e)}catch(i){e[this.expando]=n,it.extend(t,e)}}return this.cache[n]||(this.cache[n]={}),n},set:function(t,e,n){var i,o=this.key(t),r=this.cache[o];if("string"==typeof e)r[e]=n;else if(it.isEmptyObject(r))it.extend(this.cache[o],e);else for(i in e)r[i]=e[i];return r},get:function(t,e){var n=this.cache[this.key(t)];return void 0===e?n:n[e]},access:function(t,e,n){var i;return void 0===e||e&&"string"==typeof e&&void 0===n?(i=this.get(t,e),void 0!==i?i:this.get(t,it.camelCase(e))):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,i,o,r=this.key(t),a=this.cache[r];if(void 0===e)this.cache[r]={};else{it.isArray(e)?i=e.concat(e.map(it.camelCase)):(o=it.camelCase(e),e in a?i=[e,o]:(i=o,i=i in a?[i]:i.match(vt)||[])),n=i.length;for(;n--;)delete a[i[n]]}},hasData:function(t){return!it.isEmptyObject(this.cache[t[this.expando]]||{})},discard:function(t){t[this.expando]&&delete this.cache[t[this.expando]]}};var xt=new u,kt=new u,Ct=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Tt=/([A-Z])/g;it.extend({hasData:function(t){return kt.hasData(t)||xt.hasData(t)},data:function(t,e,n){return kt.access(t,e,n)},removeData:function(t,e){kt.remove(t,e)},_data:function(t,e,n){return xt.access(t,e,n)},_removeData:function(t,e){xt.remove(t,e)}}),it.fn.extend({data:function(t,e){var n,i,o,r=this[0],a=r&&r.attributes;if(void 0===t){if(this.length&&(o=kt.get(r),1===r.nodeType&&!xt.get(r,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&(i=a[n].name,0===i.indexOf("data-")&&(i=it.camelCase(i.slice(5)),p(r,i,o[i])));xt.set(r,"hasDataAttrs",!0)}return o}return"object"==typeof t?this.each(function(){kt.set(this,t)}):wt(this,function(e){var n,i=it.camelCase(t);if(r&&void 0===e){if(n=kt.get(r,t),void 0!==n)return n;if(n=kt.get(r,i),void 0!==n)return n;if(n=p(r,i,void 0),void 0!==n)return n}else this.each(function(){var n=kt.get(this,i);kt.set(this,i,e),-1!==t.indexOf("-")&&void 0!==n&&kt.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){kt.remove(this,t)})}}),it.extend({queue:function(t,e,n){var i;return t?(e=(e||"fx")+"queue",i=xt.get(t,e),n&&(!i||it.isArray(n)?i=xt.access(t,e,it.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(t,e){e=e||"fx";var n=it.queue(t,e),i=n.length,o=n.shift(),r=it._queueHooks(t,e),a=function(){it.dequeue(t,e)};"inprogress"===o&&(o=n.shift(),i--),o&&("fx"===e&&n.unshift("inprogress"),delete r.stop,o.call(t,a,r)),!i&&r&&r.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return xt.get(t,n)||xt.access(t,n,{empty:it.Callbacks("once memory").add(function(){xt.remove(t,[e+"queue",n])})})}}),it.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?it.queue(this[0],t):void 0===e?this:this.each(function(){var n=it.queue(this,t,e);it._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&it.dequeue(this,t)})},dequeue:function(t){return this.each(function(){it.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,i=1,o=it.Deferred(),r=this,a=this.length,s=function(){--i||o.resolveWith(r,[r])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)n=xt.get(r[a],t+"queueHooks"),n&&n.empty&&(i++,n.empty.add(s));return s(),o.promise(e)}});var St=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,_t=["Top","Right","Bottom","Left"],It=function(t,e){return t=e||t,"none"===it.css(t,"display")||!it.contains(t.ownerDocument,t)},Lt=/^(?:checkbox|radio)$/i;!function(){var t=et.createDocumentFragment(),e=t.appendChild(et.createElement("div")),n=et.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),e.appendChild(n),tt.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",tt.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var Dt="undefined";tt.focusinBubbles="onfocusin"in o;var Nt=/^key/,Et=/^(?:mouse|pointer|contextmenu)|click/,At=/^(?:focusinfocus|focusoutblur)$/,Mt=/^([^.]*)(?:\.(.+)|)$/;it.event={global:{},add:function(t,e,n,i,o){var r,a,s,l,c,d,u,p,f,h,m,g=xt.get(t);if(g)for(n.handler&&(r=n,n=r.handler,o=r.selector),n.guid||(n.guid=it.guid++),(l=g.events)||(l=g.events={}),(a=g.handle)||(a=g.handle=function(e){return typeof it!==Dt&&it.event.triggered!==e.type?it.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match(vt)||[""],c=e.length;c--;)s=Mt.exec(e[c])||[],f=m=s[1],h=(s[2]||"").split(".").sort(),f&&(u=it.event.special[f]||{},f=(o?u.delegateType:u.bindType)||f,u=it.event.special[f]||{},d=it.extend({type:f,origType:m,data:i,handler:n,guid:n.guid,selector:o,needsContext:o&&it.expr.match.needsContext.test(o),namespace:h.join(".")},r),(p=l[f])||(p=l[f]=[],p.delegateCount=0,u.setup&&u.setup.call(t,i,h,a)!==!1||t.addEventListener&&t.addEventListener(f,a,!1)),u.add&&(u.add.call(t,d),d.handler.guid||(d.handler.guid=n.guid)),o?p.splice(p.delegateCount++,0,d):p.push(d),it.event.global[f]=!0)},remove:function(t,e,n,i,o){var r,a,s,l,c,d,u,p,f,h,m,g=xt.hasData(t)&&xt.get(t);if(g&&(l=g.events)){for(e=(e||"").match(vt)||[""],c=e.length;c--;)if(s=Mt.exec(e[c])||[],f=m=s[1],h=(s[2]||"").split(".").sort(),f){for(u=it.event.special[f]||{},f=(i?u.delegateType:u.bindType)||f,p=l[f]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=r=p.length;r--;)d=p[r],!o&&m!==d.origType||n&&n.guid!==d.guid||s&&!s.test(d.namespace)||i&&i!==d.selector&&("**"!==i||!d.selector)||(p.splice(r,1),d.selector&&p.delegateCount--,u.remove&&u.remove.call(t,d));a&&!p.length&&(u.teardown&&u.teardown.call(t,h,g.handle)!==!1||it.removeEvent(t,f,g.handle),delete l[f])}else for(f in l)it.event.remove(t,f+e[c],n,i,!0);it.isEmptyObject(l)&&(delete g.handle,xt.remove(t,"events"))}},trigger:function(t,e,n,i){var r,a,s,l,c,d,u,p=[n||et],f=Z.call(t,"type")?t.type:t,h=Z.call(t,"namespace")?t.namespace.split("."):[];if(a=s=n=n||et,3!==n.nodeType&&8!==n.nodeType&&!At.test(f+it.event.triggered)&&(f.indexOf(".")>=0&&(h=f.split("."),f=h.shift(),h.sort()),c=f.indexOf(":")<0&&"on"+f,t=t[it.expando]?t:new it.Event(f,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=h.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),e=null==e?[t]:it.makeArray(e,[t]),u=it.event.special[f]||{},i||!u.trigger||u.trigger.apply(n,e)!==!1)){if(!i&&!u.noBubble&&!it.isWindow(n)){for(l=u.delegateType||f,At.test(l+f)||(a=a.parentNode);a;a=a.parentNode)p.push(a),s=a;s===(n.ownerDocument||et)&&p.push(s.defaultView||s.parentWindow||o)}for(r=0;(a=p[r++])&&!t.isPropagationStopped();)t.type=r>1?l:u.bindType||f,d=(xt.get(a,"events")||{})[t.type]&&xt.get(a,"handle"),d&&d.apply(a,e),d=c&&a[c],d&&d.apply&&it.acceptData(a)&&(t.result=d.apply(a,e),t.result===!1&&t.preventDefault());return t.type=f,i||t.isDefaultPrevented()||u._default&&u._default.apply(p.pop(),e)!==!1||!it.acceptData(n)||c&&it.isFunction(n[f])&&!it.isWindow(n)&&(s=n[c],s&&(n[c]=null),it.event.triggered=f,n[f](),it.event.triggered=void 0,s&&(n[c]=s)),t.result}},dispatch:function(t){t=it.event.fix(t);var e,n,i,o,r,a=[],s=G.call(arguments),l=(xt.get(this,"events")||{})[t.type]||[],c=it.event.special[t.type]||{};if(s[0]=t,t.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,t)!==!1){for(a=it.event.handlers.call(this,t,l),e=0;(o=a[e++])&&!t.isPropagationStopped();)for(t.currentTarget=o.elem,n=0;(r=o.handlers[n++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(r.namespace))&&(t.handleObj=r,t.data=r.data,i=((it.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,s),void 0!==i&&(t.result=i)===!1&&(t.preventDefault(),t.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,t),t.result}},handlers:function(t,e){var n,i,o,r,a=[],s=e.delegateCount,l=t.target;if(s&&l.nodeType&&(!t.button||"click"!==t.type))for(;l!==this;l=l.parentNode||this)if(l.disabled!==!0||"click"!==t.type){for(i=[],n=0;s>n;n++)r=e[n],o=r.selector+" ",void 0===i[o]&&(i[o]=r.needsContext?it(o,this).index(l)>=0:it.find(o,this,null,[l]).length),i[o]&&i.push(r);i.length&&a.push({elem:l,handlers:i})}return s<e.length&&a.push({elem:this,handlers:e.slice(s)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var n,i,o,r=e.button;return null==t.pageX&&null!=e.clientX&&(n=t.target.ownerDocument||et,i=n.documentElement,o=n.body,t.pageX=e.clientX+(i&&i.scrollLeft||o&&o.scrollLeft||0)-(i&&i.clientLeft||o&&o.clientLeft||0),t.pageY=e.clientY+(i&&i.scrollTop||o&&o.scrollTop||0)-(i&&i.clientTop||o&&o.clientTop||0)),t.which||void 0===r||(t.which=1&r?1:2&r?3:4&r?2:0),t}},fix:function(t){if(t[it.expando])return t;var e,n,i,o=t.type,r=t,a=this.fixHooks[o];for(a||(this.fixHooks[o]=a=Et.test(o)?this.mouseHooks:Nt.test(o)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,t=new it.Event(r),e=i.length;e--;)n=i[e],t[n]=r[n];return t.target||(t.target=et),3===t.target.nodeType&&(t.target=t.target.parentNode),a.filter?a.filter(t,r):t},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==m()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===m()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&it.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(t){return it.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,n,i){var o=it.extend(new it.Event,n,{type:t,isSimulated:!0,originalEvent:{}});i?it.event.trigger(o,null,e):it.event.dispatch.call(e,o),o.isDefaultPrevented()&&n.preventDefault()}},it.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n,!1)},it.Event=function(t,e){return this instanceof it.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&t.returnValue===!1?f:h):this.type=t,e&&it.extend(this,e),this.timeStamp=t&&t.timeStamp||it.now(),void(this[it.expando]=!0)):new it.Event(t,e)},it.Event.prototype={isDefaultPrevented:h,isPropagationStopped:h,isImmediatePropagationStopped:h,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=f,t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=f,t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=f,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},it.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){it.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,i=this,o=t.relatedTarget,r=t.handleObj;return(!o||o!==i&&!it.contains(i,o))&&(t.type=r.origType,n=r.handler.apply(this,arguments),t.type=e),n}}}),tt.focusinBubbles||it.each({focus:"focusin",blur:"focusout"},function(t,e){var n=function(t){it.event.simulate(e,t.target,it.event.fix(t),!0)};it.event.special[e]={setup:function(){var i=this.ownerDocument||this,o=xt.access(i,e);o||i.addEventListener(t,n,!0),xt.access(i,e,(o||0)+1)},teardown:function(){var i=this.ownerDocument||this,o=xt.access(i,e)-1;o?xt.access(i,e,o):(i.removeEventListener(t,n,!0),xt.remove(i,e))}}}),it.fn.extend({on:function(t,e,n,i,o){var r,a;if("object"==typeof t){"string"!=typeof e&&(n=n||e,e=void 0);for(a in t)this.on(a,e,n,t[a],o);return this}if(null==n&&null==i?(i=e,n=e=void 0):null==i&&("string"==typeof e?(i=n,n=void 0):(i=n,n=e,e=void 0)),i===!1)i=h;else if(!i)return this;return 1===o&&(r=i,i=function(t){return it().off(t),r.apply(this,arguments)},i.guid=r.guid||(r.guid=it.guid++)),this.each(function(){it.event.add(this,t,i,n,e)})},one:function(t,e,n,i){return this.on(t,e,n,i,1)},off:function(t,e,n){var i,o;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,it(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof t){for(o in t)this.off(o,e,t[o]);return this}return(e===!1||"function"==typeof e)&&(n=e,e=void 0),n===!1&&(n=h),this.each(function(){it.event.remove(this,t,n,e)})},trigger:function(t,e){return this.each(function(){it.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];return n?it.event.trigger(t,e,n,!0):void 0}});var Pt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ot=/<([\w:]+)/,Ft=/<|&#?\w+;/,Ht=/<(?:script|style|link)/i,$t=/checked\s*(?:[^=]|=\s*.checked.)/i,Bt=/^$|\/(?:java|ecma)script/i,Rt=/^true\/(.*)/,zt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,jt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};jt.optgroup=jt.option,jt.tbody=jt.tfoot=jt.colgroup=jt.caption=jt.thead,jt.th=jt.td,it.extend({clone:function(t,e,n){var i,o,r,a,s=t.cloneNode(!0),l=it.contains(t.ownerDocument,t);if(!(tt.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||it.isXMLDoc(t)))for(a=x(s),r=x(t),i=0,o=r.length;o>i;i++)k(r[i],a[i]);if(e)if(n)for(r=r||x(t),a=a||x(s),i=0,o=r.length;o>i;i++)w(r[i],a[i]);else w(t,s);return a=x(s,"script"),a.length>0&&y(a,!l&&x(t,"script")),s},buildFragment:function(t,e,n,i){for(var o,r,a,s,l,c,d=e.createDocumentFragment(),u=[],p=0,f=t.length;f>p;p++)if(o=t[p],o||0===o)if("object"===it.type(o))it.merge(u,o.nodeType?[o]:o);else if(Ft.test(o)){for(r=r||d.appendChild(e.createElement("div")),a=(Ot.exec(o)||["",""])[1].toLowerCase(),s=jt[a]||jt._default,r.innerHTML=s[1]+o.replace(Pt,"<$1></$2>")+s[2],c=s[0];c--;)r=r.lastChild;it.merge(u,r.childNodes),r=d.firstChild,r.textContent=""}else u.push(e.createTextNode(o));for(d.textContent="",p=0;o=u[p++];)if((!i||-1===it.inArray(o,i))&&(l=it.contains(o.ownerDocument,o),r=x(d.appendChild(o),"script"),l&&y(r),n))for(c=0;o=r[c++];)Bt.test(o.type||"")&&n.push(o);return d},cleanData:function(t){for(var e,n,i,o,r=it.event.special,a=0;void 0!==(n=t[a]);a++){if(it.acceptData(n)&&(o=n[xt.expando],o&&(e=xt.cache[o]))){if(e.events)for(i in e.events)r[i]?it.event.remove(n,i):it.removeEvent(n,i,e.handle);xt.cache[o]&&delete xt.cache[o]}delete kt.cache[n[kt.expando]]}}}),it.fn.extend({text:function(t){return wt(this,function(t){return void 0===t?it.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=t)})},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=g(this,t);e.appendChild(t)}})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=g(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var n,i=t?it.filter(t,this):this,o=0;null!=(n=i[o]);o++)e||1!==n.nodeType||it.cleanData(x(n)),n.parentNode&&(e&&it.contains(n.ownerDocument,n)&&y(x(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(it.cleanData(x(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null==t?!1:t,e=null==e?t:e,this.map(function(){return it.clone(this,t,e)})},html:function(t){return wt(this,function(t){var e=this[0]||{},n=0,i=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Ht.test(t)&&!jt[(Ot.exec(t)||["",""])[1].toLowerCase()]){t=t.replace(Pt,"<$1></$2>");try{for(;i>n;n++)e=this[n]||{},1===e.nodeType&&(it.cleanData(x(e,!1)),e.innerHTML=t);e=0}catch(o){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,function(e){t=this.parentNode,it.cleanData(x(this)),t&&t.replaceChild(e,this)}),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e){t=K.apply([],t);var n,i,o,r,a,s,l=0,c=this.length,d=this,u=c-1,p=t[0],f=it.isFunction(p);if(f||c>1&&"string"==typeof p&&!tt.checkClone&&$t.test(p))return this.each(function(n){var i=d.eq(n);f&&(t[0]=p.call(this,n,i.html())),i.domManip(t,e)});if(c&&(n=it.buildFragment(t,this[0].ownerDocument,!1,this),i=n.firstChild,1===n.childNodes.length&&(n=i),i)){for(o=it.map(x(n,"script"),v),r=o.length;c>l;l++)a=n,l!==u&&(a=it.clone(a,!0,!0),r&&it.merge(o,x(a,"script"))),e.call(this[l],a,l);if(r)for(s=o[o.length-1].ownerDocument,it.map(o,b),l=0;r>l;l++)a=o[l],Bt.test(a.type||"")&&!xt.access(a,"globalEval")&&it.contains(s,a)&&(a.src?it._evalUrl&&it._evalUrl(a.src):it.globalEval(a.textContent.replace(zt,"")))}return this}}),it.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){it.fn[t]=function(t){for(var n,i=[],o=it(t),r=o.length-1,a=0;r>=a;a++)n=a===r?this:this.clone(!0),it(o[a])[e](n),X.apply(i,n.get());return this.pushStack(i)}});var Wt,Ut={},qt=/^margin/,Vt=new RegExp("^("+St+")(?!px)[a-z%]+$","i"),Gt=function(t){return t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):o.getComputedStyle(t,null)};!function(){function t(){a.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",a.innerHTML="",i.appendChild(r);var t=o.getComputedStyle(a,null);e="1%"!==t.top,n="4px"===t.width,i.removeChild(r)}var e,n,i=et.documentElement,r=et.createElement("div"),a=et.createElement("div");a.style&&(a.style.backgroundClip="content-box",a.cloneNode(!0).style.backgroundClip="",tt.clearCloneStyle="content-box"===a.style.backgroundClip,r.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",r.appendChild(a),o.getComputedStyle&&it.extend(tt,{pixelPosition:function(){return t(),e},boxSizingReliable:function(){return null==n&&t(),n},reliableMarginRight:function(){var t,e=a.appendChild(et.createElement("div"));return e.style.cssText=a.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",e.style.marginRight=e.style.width="0",a.style.width="1px",i.appendChild(r),t=!parseFloat(o.getComputedStyle(e,null).marginRight),i.removeChild(r),a.removeChild(e),t}}))}(),it.swap=function(t,e,n,i){var o,r,a={};for(r in e)a[r]=t.style[r],t.style[r]=e[r];o=n.apply(t,i||[]);for(r in e)t.style[r]=a[r];return o};var Kt=/^(none|table(?!-c[ea]).+)/,Xt=new RegExp("^("+St+")(.*)$","i"),Yt=new RegExp("^([+-])=("+St+")","i"),Qt={position:"absolute",visibility:"hidden",display:"block"},Jt={letterSpacing:"0",fontWeight:"400"},Zt=["Webkit","O","Moz","ms"];it.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=S(t,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(t,e,n,i){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var o,r,a,s=it.camelCase(e),l=t.style;return e=it.cssProps[s]||(it.cssProps[s]=I(l,s)),a=it.cssHooks[e]||it.cssHooks[s],void 0===n?a&&"get"in a&&void 0!==(o=a.get(t,!1,i))?o:l[e]:(r=typeof n,"string"===r&&(o=Yt.exec(n))&&(n=(o[1]+1)*o[2]+parseFloat(it.css(t,e)),r="number"),void(null!=n&&n===n&&("number"!==r||it.cssNumber[s]||(n+="px"),tt.clearCloneStyle||""!==n||0!==e.indexOf("background")||(l[e]="inherit"),a&&"set"in a&&void 0===(n=a.set(t,n,i))||(l[e]=n))))}},css:function(t,e,n,i){var o,r,a,s=it.camelCase(e);return e=it.cssProps[s]||(it.cssProps[s]=I(t.style,s)),a=it.cssHooks[e]||it.cssHooks[s],a&&"get"in a&&(o=a.get(t,!0,n)),void 0===o&&(o=S(t,e,i)),"normal"===o&&e in Jt&&(o=Jt[e]),""===n||n?(r=parseFloat(o),n===!0||it.isNumeric(r)?r||0:o):o}}),it.each(["height","width"],function(t,e){it.cssHooks[e]={get:function(t,n,i){return n?Kt.test(it.css(t,"display"))&&0===t.offsetWidth?it.swap(t,Qt,function(){return N(t,e,i)}):N(t,e,i):void 0},set:function(t,n,i){var o=i&&Gt(t);return L(t,n,i?D(t,e,i,"border-box"===it.css(t,"boxSizing",!1,o),o):0);
}}}),it.cssHooks.marginRight=_(tt.reliableMarginRight,function(t,e){return e?it.swap(t,{display:"inline-block"},S,[t,"marginRight"]):void 0}),it.each({margin:"",padding:"",border:"Width"},function(t,e){it.cssHooks[t+e]={expand:function(n){for(var i=0,o={},r="string"==typeof n?n.split(" "):[n];4>i;i++)o[t+_t[i]+e]=r[i]||r[i-2]||r[0];return o}},qt.test(t)||(it.cssHooks[t+e].set=L)}),it.fn.extend({css:function(t,e){return wt(this,function(t,e,n){var i,o,r={},a=0;if(it.isArray(e)){for(i=Gt(t),o=e.length;o>a;a++)r[e[a]]=it.css(t,e[a],!1,i);return r}return void 0!==n?it.style(t,e,n):it.css(t,e)},t,e,arguments.length>1)},show:function(){return E(this,!0)},hide:function(){return E(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){It(this)?it(this).show():it(this).hide()})}}),it.Tween=A,A.prototype={constructor:A,init:function(t,e,n,i,o,r){this.elem=t,this.prop=n,this.easing=o||"swing",this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=r||(it.cssNumber[n]?"":"px")},cur:function(){var t=A.propHooks[this.prop];return t&&t.get?t.get(this):A.propHooks._default.get(this)},run:function(t){var e,n=A.propHooks[this.prop];return this.pos=e=this.options.duration?it.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):A.propHooks._default.set(this),this}},A.prototype.init.prototype=A.prototype,A.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=it.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){it.fx.step[t.prop]?it.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[it.cssProps[t.prop]]||it.cssHooks[t.prop])?it.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},A.propHooks.scrollTop=A.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},it.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},it.fx=A.prototype.init,it.fx.step={};var te,ee,ne=/^(?:toggle|show|hide)$/,ie=new RegExp("^(?:([+-])=|)("+St+")([a-z%]*)$","i"),oe=/queueHooks$/,re=[F],ae={"*":[function(t,e){var n=this.createTween(t,e),i=n.cur(),o=ie.exec(e),r=o&&o[3]||(it.cssNumber[t]?"":"px"),a=(it.cssNumber[t]||"px"!==r&&+i)&&ie.exec(it.css(n.elem,t)),s=1,l=20;if(a&&a[3]!==r){r=r||a[3],o=o||[],a=+i||1;do s=s||".5",a/=s,it.style(n.elem,t,a+r);while(s!==(s=n.cur()/i)&&1!==s&&--l)}return o&&(a=n.start=+a||+i||0,n.unit=r,n.end=o[1]?a+(o[1]+1)*o[2]:+o[2]),n}]};it.Animation=it.extend($,{tweener:function(t,e){it.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var n,i=0,o=t.length;o>i;i++)n=t[i],ae[n]=ae[n]||[],ae[n].unshift(e)},prefilter:function(t,e){e?re.unshift(t):re.push(t)}}),it.speed=function(t,e,n){var i=t&&"object"==typeof t?it.extend({},t):{complete:n||!n&&e||it.isFunction(t)&&t,duration:t,easing:n&&e||e&&!it.isFunction(e)&&e};return i.duration=it.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in it.fx.speeds?it.fx.speeds[i.duration]:it.fx.speeds._default,(null==i.queue||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){it.isFunction(i.old)&&i.old.call(this),i.queue&&it.dequeue(this,i.queue)},i},it.fn.extend({fadeTo:function(t,e,n,i){return this.filter(It).css("opacity",0).show().end().animate({opacity:e},t,n,i)},animate:function(t,e,n,i){var o=it.isEmptyObject(t),r=it.speed(e,n,i),a=function(){var e=$(this,it.extend({},t),r);(o||xt.get(this,"finish"))&&e.stop(!0)};return a.finish=a,o||r.queue===!1?this.each(a):this.queue(r.queue,a)},stop:function(t,e,n){var i=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,o=null!=t&&t+"queueHooks",r=it.timers,a=xt.get(this);if(o)a[o]&&a[o].stop&&i(a[o]);else for(o in a)a[o]&&a[o].stop&&oe.test(o)&&i(a[o]);for(o=r.length;o--;)r[o].elem!==this||null!=t&&r[o].queue!==t||(r[o].anim.stop(n),e=!1,r.splice(o,1));(e||!n)&&it.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,n=xt.get(this),i=n[t+"queue"],o=n[t+"queueHooks"],r=it.timers,a=i?i.length:0;for(n.finish=!0,it.queue(this,t,[]),o&&o.stop&&o.stop.call(this,!0),e=r.length;e--;)r[e].elem===this&&r[e].queue===t&&(r[e].anim.stop(!0),r.splice(e,1));for(e=0;a>e;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete n.finish})}}),it.each(["toggle","show","hide"],function(t,e){var n=it.fn[e];it.fn[e]=function(t,i,o){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(P(e,!0),t,i,o)}}),it.each({slideDown:P("show"),slideUp:P("hide"),slideToggle:P("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){it.fn[t]=function(t,n,i){return this.animate(e,t,n,i)}}),it.timers=[],it.fx.tick=function(){var t,e=0,n=it.timers;for(te=it.now();e<n.length;e++)t=n[e],t()||n[e]!==t||n.splice(e--,1);n.length||it.fx.stop(),te=void 0},it.fx.timer=function(t){it.timers.push(t),t()?it.fx.start():it.timers.pop()},it.fx.interval=13,it.fx.start=function(){ee||(ee=setInterval(it.fx.tick,it.fx.interval))},it.fx.stop=function(){clearInterval(ee),ee=null},it.fx.speeds={slow:600,fast:200,_default:400},it.fn.delay=function(t,e){return t=it.fx?it.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,n){var i=setTimeout(e,t);n.stop=function(){clearTimeout(i)}})},function(){var t=et.createElement("input"),e=et.createElement("select"),n=e.appendChild(et.createElement("option"));t.type="checkbox",tt.checkOn=""!==t.value,tt.optSelected=n.selected,e.disabled=!0,tt.optDisabled=!n.disabled,t=et.createElement("input"),t.value="t",t.type="radio",tt.radioValue="t"===t.value}();var se,le,ce=it.expr.attrHandle;it.fn.extend({attr:function(t,e){return wt(this,it.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){it.removeAttr(this,t)})}}),it.extend({attr:function(t,e,n){var i,o,r=t.nodeType;return t&&3!==r&&8!==r&&2!==r?typeof t.getAttribute===Dt?it.prop(t,e,n):(1===r&&it.isXMLDoc(t)||(e=e.toLowerCase(),i=it.attrHooks[e]||(it.expr.match.bool.test(e)?le:se)),void 0===n?i&&"get"in i&&null!==(o=i.get(t,e))?o:(o=it.find.attr(t,e),null==o?void 0:o):null!==n?i&&"set"in i&&void 0!==(o=i.set(t,n,e))?o:(t.setAttribute(e,n+""),n):void it.removeAttr(t,e)):void 0},removeAttr:function(t,e){var n,i,o=0,r=e&&e.match(vt);if(r&&1===t.nodeType)for(;n=r[o++];)i=it.propFix[n]||n,it.expr.match.bool.test(n)&&(t[i]=!1),t.removeAttribute(n)},attrHooks:{type:{set:function(t,e){if(!tt.radioValue&&"radio"===e&&it.nodeName(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}}}),le={set:function(t,e,n){return e===!1?it.removeAttr(t,n):t.setAttribute(n,n),n}},it.each(it.expr.match.bool.source.match(/\w+/g),function(t,e){var n=ce[e]||it.find.attr;ce[e]=function(t,e,i){var o,r;return i||(r=ce[e],ce[e]=o,o=null!=n(t,e,i)?e.toLowerCase():null,ce[e]=r),o}});var de=/^(?:input|select|textarea|button)$/i;it.fn.extend({prop:function(t,e){return wt(this,it.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[it.propFix[t]||t]})}}),it.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(t,e,n){var i,o,r,a=t.nodeType;return t&&3!==a&&8!==a&&2!==a?(r=1!==a||!it.isXMLDoc(t),r&&(e=it.propFix[e]||e,o=it.propHooks[e]),void 0!==n?o&&"set"in o&&void 0!==(i=o.set(t,n,e))?i:t[e]=n:o&&"get"in o&&null!==(i=o.get(t,e))?i:t[e]):void 0},propHooks:{tabIndex:{get:function(t){return t.hasAttribute("tabindex")||de.test(t.nodeName)||t.href?t.tabIndex:-1}}}}),tt.optSelected||(it.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null}}),it.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){it.propFix[this.toLowerCase()]=this});var ue=/[\t\r\n\f]/g;it.fn.extend({addClass:function(t){var e,n,i,o,r,a,s="string"==typeof t&&t,l=0,c=this.length;if(it.isFunction(t))return this.each(function(e){it(this).addClass(t.call(this,e,this.className))});if(s)for(e=(t||"").match(vt)||[];c>l;l++)if(n=this[l],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(ue," "):" ")){for(r=0;o=e[r++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");a=it.trim(i),n.className!==a&&(n.className=a)}return this},removeClass:function(t){var e,n,i,o,r,a,s=0===arguments.length||"string"==typeof t&&t,l=0,c=this.length;if(it.isFunction(t))return this.each(function(e){it(this).removeClass(t.call(this,e,this.className))});if(s)for(e=(t||"").match(vt)||[];c>l;l++)if(n=this[l],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(ue," "):"")){for(r=0;o=e[r++];)for(;i.indexOf(" "+o+" ")>=0;)i=i.replace(" "+o+" "," ");a=t?it.trim(i):"",n.className!==a&&(n.className=a)}return this},toggleClass:function(t,e){var n=typeof t;return"boolean"==typeof e&&"string"===n?e?this.addClass(t):this.removeClass(t):this.each(it.isFunction(t)?function(n){it(this).toggleClass(t.call(this,n,this.className,e),e)}:function(){if("string"===n)for(var e,i=0,o=it(this),r=t.match(vt)||[];e=r[i++];)o.hasClass(e)?o.removeClass(e):o.addClass(e);else(n===Dt||"boolean"===n)&&(this.className&&xt.set(this,"__className__",this.className),this.className=this.className||t===!1?"":xt.get(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(ue," ").indexOf(e)>=0)return!0;return!1}});var pe=/\r/g;it.fn.extend({val:function(t){var e,n,i,o=this[0];return arguments.length?(i=it.isFunction(t),this.each(function(n){var o;1===this.nodeType&&(o=i?t.call(this,n,it(this).val()):t,null==o?o="":"number"==typeof o?o+="":it.isArray(o)&&(o=it.map(o,function(t){return null==t?"":t+""})),e=it.valHooks[this.type]||it.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&void 0!==e.set(this,o,"value")||(this.value=o))})):o?(e=it.valHooks[o.type]||it.valHooks[o.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(n=e.get(o,"value"))?n:(n=o.value,"string"==typeof n?n.replace(pe,""):null==n?"":n)):void 0}}),it.extend({valHooks:{option:{get:function(t){var e=it.find.attr(t,"value");return null!=e?e:it.trim(it.text(t))}},select:{get:function(t){for(var e,n,i=t.options,o=t.selectedIndex,r="select-one"===t.type||0>o,a=r?null:[],s=r?o+1:i.length,l=0>o?s:r?o:0;s>l;l++)if(n=i[l],!(!n.selected&&l!==o||(tt.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&it.nodeName(n.parentNode,"optgroup"))){if(e=it(n).val(),r)return e;a.push(e)}return a},set:function(t,e){for(var n,i,o=t.options,r=it.makeArray(e),a=o.length;a--;)i=o[a],(i.selected=it.inArray(i.value,r)>=0)&&(n=!0);return n||(t.selectedIndex=-1),r}}}}),it.each(["radio","checkbox"],function(){it.valHooks[this]={set:function(t,e){return it.isArray(e)?t.checked=it.inArray(it(t).val(),e)>=0:void 0}},tt.checkOn||(it.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),it.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){it.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}),it.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,i){return this.on(e,t,n,i)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}});var fe=it.now(),he=/\?/;it.parseJSON=function(t){return JSON.parse(t+"")},it.parseXML=function(t){var e,n;if(!t||"string"!=typeof t)return null;try{n=new DOMParser,e=n.parseFromString(t,"text/xml")}catch(i){e=void 0}return(!e||e.getElementsByTagName("parsererror").length)&&it.error("Invalid XML: "+t),e};var me=/#.*$/,ge=/([?&])_=[^&]*/,ve=/^(.*?):[ \t]*([^\r\n]*)$/gm,be=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,ye=/^(?:GET|HEAD)$/,we=/^\/\//,xe=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,ke={},Ce={},Te="*/".concat("*"),Se=o.location.href,_e=xe.exec(Se.toLowerCase())||[];it.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Se,type:"GET",isLocal:be.test(_e[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Te,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":it.parseJSON,"text xml":it.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?z(z(t,it.ajaxSettings),e):z(it.ajaxSettings,t)},ajaxPrefilter:B(ke),ajaxTransport:B(Ce),ajax:function(t,e){function n(t,e,n,a){var l,d,v,b,w,k=e;2!==y&&(y=2,s&&clearTimeout(s),i=void 0,r=a||"",x.readyState=t>0?4:0,l=t>=200&&300>t||304===t,n&&(b=j(u,x,n)),b=W(u,b,x,l),l?(u.ifModified&&(w=x.getResponseHeader("Last-Modified"),w&&(it.lastModified[o]=w),w=x.getResponseHeader("etag"),w&&(it.etag[o]=w)),204===t||"HEAD"===u.type?k="nocontent":304===t?k="notmodified":(k=b.state,d=b.data,v=b.error,l=!v)):(v=k,(t||!k)&&(k="error",0>t&&(t=0))),x.status=t,x.statusText=(e||k)+"",l?h.resolveWith(p,[d,k,x]):h.rejectWith(p,[x,k,v]),x.statusCode(g),g=void 0,c&&f.trigger(l?"ajaxSuccess":"ajaxError",[x,u,l?d:v]),m.fireWith(p,[x,k]),c&&(f.trigger("ajaxComplete",[x,u]),--it.active||it.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=void 0),e=e||{};var i,o,r,a,s,l,c,d,u=it.ajaxSetup({},e),p=u.context||u,f=u.context&&(p.nodeType||p.jquery)?it(p):it.event,h=it.Deferred(),m=it.Callbacks("once memory"),g=u.statusCode||{},v={},b={},y=0,w="canceled",x={readyState:0,getResponseHeader:function(t){var e;if(2===y){if(!a)for(a={};e=ve.exec(r);)a[e[1].toLowerCase()]=e[2];e=a[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===y?r:null},setRequestHeader:function(t,e){var n=t.toLowerCase();return y||(t=b[n]=b[n]||t,v[t]=e),this},overrideMimeType:function(t){return y||(u.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>y)for(e in t)g[e]=[g[e],t[e]];else x.always(t[x.status]);return this},abort:function(t){var e=t||w;return i&&i.abort(e),n(0,e),this}};if(h.promise(x).complete=m.add,x.success=x.done,x.error=x.fail,u.url=((t||u.url||Se)+"").replace(me,"").replace(we,_e[1]+"//"),u.type=e.method||e.type||u.method||u.type,u.dataTypes=it.trim(u.dataType||"*").toLowerCase().match(vt)||[""],null==u.crossDomain&&(l=xe.exec(u.url.toLowerCase()),u.crossDomain=!(!l||l[1]===_e[1]&&l[2]===_e[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(_e[3]||("http:"===_e[1]?"80":"443")))),u.data&&u.processData&&"string"!=typeof u.data&&(u.data=it.param(u.data,u.traditional)),R(ke,u,e,x),2===y)return x;c=it.event&&u.global,c&&0===it.active++&&it.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!ye.test(u.type),o=u.url,u.hasContent||(u.data&&(o=u.url+=(he.test(o)?"&":"?")+u.data,delete u.data),u.cache===!1&&(u.url=ge.test(o)?o.replace(ge,"$1_="+fe++):o+(he.test(o)?"&":"?")+"_="+fe++)),u.ifModified&&(it.lastModified[o]&&x.setRequestHeader("If-Modified-Since",it.lastModified[o]),it.etag[o]&&x.setRequestHeader("If-None-Match",it.etag[o])),(u.data&&u.hasContent&&u.contentType!==!1||e.contentType)&&x.setRequestHeader("Content-Type",u.contentType),x.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+Te+"; q=0.01":""):u.accepts["*"]);for(d in u.headers)x.setRequestHeader(d,u.headers[d]);if(u.beforeSend&&(u.beforeSend.call(p,x,u)===!1||2===y))return x.abort();w="abort";for(d in{success:1,error:1,complete:1})x[d](u[d]);if(i=R(Ce,u,e,x)){x.readyState=1,c&&f.trigger("ajaxSend",[x,u]),u.async&&u.timeout>0&&(s=setTimeout(function(){x.abort("timeout")},u.timeout));try{y=1,i.send(v,n)}catch(k){if(!(2>y))throw k;n(-1,k)}}else n(-1,"No Transport");return x},getJSON:function(t,e,n){return it.get(t,e,n,"json")},getScript:function(t,e){return it.get(t,void 0,e,"script")}}),it.each(["get","post"],function(t,e){it[e]=function(t,n,i,o){return it.isFunction(n)&&(o=o||i,i=n,n=void 0),it.ajax({url:t,type:e,dataType:o,data:n,success:i})}}),it._evalUrl=function(t){return it.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},it.fn.extend({wrapAll:function(t){var e;return it.isFunction(t)?this.each(function(e){it(this).wrapAll(t.call(this,e))}):(this[0]&&(e=it(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(t){return this.each(it.isFunction(t)?function(e){it(this).wrapInner(t.call(this,e))}:function(){var e=it(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=it.isFunction(t);return this.each(function(n){it(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(){return this.parent().each(function(){it.nodeName(this,"body")||it(this).replaceWith(this.childNodes)}).end()}}),it.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0},it.expr.filters.visible=function(t){return!it.expr.filters.hidden(t)};var Ie=/%20/g,Le=/\[\]$/,De=/\r?\n/g,Ne=/^(?:submit|button|image|reset|file)$/i,Ee=/^(?:input|select|textarea|keygen)/i;it.param=function(t,e){var n,i=[],o=function(t,e){e=it.isFunction(e)?e():null==e?"":e,i[i.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=it.ajaxSettings&&it.ajaxSettings.traditional),it.isArray(t)||t.jquery&&!it.isPlainObject(t))it.each(t,function(){o(this.name,this.value)});else for(n in t)U(n,t[n],e,o);return i.join("&").replace(Ie,"+")},it.fn.extend({serialize:function(){return it.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=it.prop(this,"elements");return t?it.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!it(this).is(":disabled")&&Ee.test(this.nodeName)&&!Ne.test(t)&&(this.checked||!Lt.test(t))}).map(function(t,e){var n=it(this).val();return null==n?null:it.isArray(n)?it.map(n,function(t){return{name:e.name,value:t.replace(De,"\r\n")}}):{name:e.name,value:n.replace(De,"\r\n")}}).get()}}),it.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(t){}};var Ae=0,Me={},Pe={0:200,1223:204},Oe=it.ajaxSettings.xhr();o.attachEvent&&o.attachEvent("onunload",function(){for(var t in Me)Me[t]()}),tt.cors=!!Oe&&"withCredentials"in Oe,tt.ajax=Oe=!!Oe,it.ajaxTransport(function(t){var e;return tt.cors||Oe&&!t.crossDomain?{send:function(n,i){var o,r=t.xhr(),a=++Ae;if(r.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(o in t.xhrFields)r[o]=t.xhrFields[o];t.mimeType&&r.overrideMimeType&&r.overrideMimeType(t.mimeType),t.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(o in n)r.setRequestHeader(o,n[o]);e=function(t){return function(){e&&(delete Me[a],e=r.onload=r.onerror=null,"abort"===t?r.abort():"error"===t?i(r.status,r.statusText):i(Pe[r.status]||r.status,r.statusText,"string"==typeof r.responseText?{text:r.responseText}:void 0,r.getAllResponseHeaders()))}},r.onload=e(),r.onerror=e("error"),e=Me[a]=e("abort");try{r.send(t.hasContent&&t.data||null)}catch(s){if(e)throw s}},abort:function(){e&&e()}}:void 0}),it.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return it.globalEval(t),t}}}),it.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),it.ajaxTransport("script",function(t){if(t.crossDomain){var e,n;return{send:function(i,o){e=it("<script>").prop({async:!0,charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&o("error"===t.type?404:200,t.type)}),et.head.appendChild(e[0])},abort:function(){n&&n()}}}});var Fe=[],He=/(=)\?(?=&|$)|\?\?/;it.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Fe.pop()||it.expando+"_"+fe++;return this[t]=!0,t}}),it.ajaxPrefilter("json jsonp",function(t,e,n){var i,r,a,s=t.jsonp!==!1&&(He.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&He.test(t.data)&&"data");return s||"jsonp"===t.dataTypes[0]?(i=t.jsonpCallback=it.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(He,"$1"+i):t.jsonp!==!1&&(t.url+=(he.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return a||it.error(i+" was not called"),a[0]},t.dataTypes[0]="json",r=o[i],o[i]=function(){a=arguments},n.always(function(){o[i]=r,t[i]&&(t.jsonpCallback=e.jsonpCallback,Fe.push(i)),a&&it.isFunction(r)&&r(a[0]),a=r=void 0}),"script"):void 0}),it.parseHTML=function(t,e,n){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(n=e,e=!1),e=e||et;var i=dt.exec(t),o=!n&&[];return i?[e.createElement(i[1])]:(i=it.buildFragment([t],e,o),o&&o.length&&it(o).remove(),it.merge([],i.childNodes))};var $e=it.fn.load;it.fn.load=function(t,e,n){if("string"!=typeof t&&$e)return $e.apply(this,arguments);var i,o,r,a=this,s=t.indexOf(" ");return s>=0&&(i=it.trim(t.slice(s)),t=t.slice(0,s)),it.isFunction(e)?(n=e,e=void 0):e&&"object"==typeof e&&(o="POST"),a.length>0&&it.ajax({url:t,type:o,dataType:"html",data:e}).done(function(t){r=arguments,a.html(i?it("<div>").append(it.parseHTML(t)).find(i):t)}).complete(n&&function(t,e){a.each(n,r||[t.responseText,e,t])}),this},it.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){it.fn[e]=function(t){return this.on(e,t)}}),it.expr.filters.animated=function(t){return it.grep(it.timers,function(e){return t===e.elem}).length};var Be=o.document.documentElement;it.offset={setOffset:function(t,e,n){var i,o,r,a,s,l,c,d=it.css(t,"position"),u=it(t),p={};"static"===d&&(t.style.position="relative"),s=u.offset(),r=it.css(t,"top"),l=it.css(t,"left"),c=("absolute"===d||"fixed"===d)&&(r+l).indexOf("auto")>-1,c?(i=u.position(),a=i.top,o=i.left):(a=parseFloat(r)||0,o=parseFloat(l)||0),it.isFunction(e)&&(e=e.call(t,n,s)),null!=e.top&&(p.top=e.top-s.top+a),null!=e.left&&(p.left=e.left-s.left+o),"using"in e?e.using.call(t,p):u.css(p)}},it.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){it.offset.setOffset(this,t,e)});var e,n,i=this[0],o={top:0,left:0},r=i&&i.ownerDocument;return r?(e=r.documentElement,it.contains(e,i)?(typeof i.getBoundingClientRect!==Dt&&(o=i.getBoundingClientRect()),n=q(r),{top:o.top+n.pageYOffset-e.clientTop,left:o.left+n.pageXOffset-e.clientLeft}):o):void 0},position:function(){if(this[0]){var t,e,n=this[0],i={top:0,left:0};return"fixed"===it.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),it.nodeName(t[0],"html")||(i=t.offset()),i.top+=it.css(t[0],"borderTopWidth",!0),i.left+=it.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-it.css(n,"marginTop",!0),left:e.left-i.left-it.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||Be;t&&!it.nodeName(t,"html")&&"static"===it.css(t,"position");)t=t.offsetParent;return t||Be})}}),it.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var n="pageYOffset"===e;it.fn[t]=function(i){return wt(this,function(t,i,r){var a=q(t);return void 0===r?a?a[e]:t[i]:void(a?a.scrollTo(n?o.pageXOffset:r,n?r:o.pageYOffset):t[i]=r)},t,i,arguments.length,null)}}),it.each(["top","left"],function(t,e){it.cssHooks[e]=_(tt.pixelPosition,function(t,n){return n?(n=S(t,e),Vt.test(n)?it(t).position()[e]+"px":n):void 0})}),it.each({Height:"height",Width:"width"},function(t,e){it.each({padding:"inner"+t,content:e,"":"outer"+t},function(n,i){it.fn[i]=function(i,o){var r=arguments.length&&(n||"boolean"!=typeof i),a=n||(i===!0||o===!0?"margin":"border");return wt(this,function(e,n,i){var o;return it.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(o=e.documentElement,Math.max(e.body["scroll"+t],o["scroll"+t],e.body["offset"+t],o["offset"+t],o["client"+t])):void 0===i?it.css(e,n,a):it.style(e,n,i,a)},e,r?i:void 0,r,null)}})}),it.fn.size=function(){return this.length},it.fn.andSelf=it.fn.addBack,n(5).cmd&&(i=function(t,e,n){n.exports=it}.call(e,n,e,t),!(void 0!==i&&(t.exports=i)));var Re=o.jQuery,ze=o.$;return it.noConflict=function(t){return o.$===it&&(o.$=ze),t&&o.jQuery===it&&(o.jQuery=Re),it},typeof r===Dt&&(o.jQuery=o.$=it),it})},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,n){var i;i=function(t,e,i){var o=n(4);!function(t,e,n){function i(t){return t}function o(t){return r(decodeURIComponent(t.replace(s," ")))}function r(t){return 0===t.indexOf('"')&&(t=t.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")),t}function a(t){return l.json?JSON.parse(t):t}var s=/\+/g,l=t.cookie=function(r,s,c){if(s!==n){if(c=t.extend({},l.defaults,c),null===s&&(c.expires=-1),"number"==typeof c.expires){var d=c.expires,u=c.expires=new Date;u.setDate(u.getDate()+d)}return s=l.json?JSON.stringify(s):String(s),e.cookie=[encodeURIComponent(r),"=",l.raw?s:encodeURIComponent(s),c.expires?"; expires="+c.expires.toUTCString():"",c.path?"; path="+c.path:"",c.domain?"; domain="+c.domain:"",c.secure?"; secure":""].join("")}for(var p=l.raw?i:o,f=e.cookie.split("; "),h=r?null:{},m=0,g=f.length;g>m;m++){var v=f[m].split("="),b=p(v.shift()),y=p(v.join("="));if(r&&r===b){h=a(y);break}r||(h[b]=a(y))}return h};l.defaults={},t.removeCookie=function(e,n){return null!==t.cookie(e)?(t.cookie(e,null,n),!0):!1}}(o,document),i.exports=o}.call(e,n,e,t),!(void 0!==i&&(t.exports=i))},function(t,e){var n={date:{current:function(){return new Date},format:function(t,e){var n={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in n)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?n[i]:("00"+n[i]).substr((""+n[i]).length)));return e},today:function(){var t=new Date;return t.setHours(0),t.setMinutes(0),t.setSeconds(0),t},isYesterday:function(t){return t.toDateString()===n.date.yesterday().toDateString()},yesterday:function(){var t=new Date;return t.setDate(t.getDate()-1),t.setHours(0),t.setMinutes(0),t.setSeconds(0),t},isTheDayBeforeYesterday:function(t){return t.toDateString()===n.date.addDay(new Date,-2).toDateString()},addDay:function(t,e){var n=new Date;return n.setFullYear(t.getFullYear()),n.setMonth(t.getMonth()),n.setDate(t.getDate()+e),n.setHours(0),n.setMinutes(0),n.setSeconds(0),n}},arr:{rest:function(t,e){return t.filter(function(t){return e.indexOf(t)<0?t:void 0})}},range:function(t){for(var e=[],n=0;t>n;n++)e.push(n);return e},deepClone:function(t,e){var i=null;e&&(i={})||(i=[]);for(var o in t){if("function"==typeof t[o])return;"object"==typeof t[o]&&(Array.isArray(t[o])?t[o]=t[o].map(function(t){n.deepClone(t,!0)}):t[o]=n.deepClone(t[o])),i[o]=t[o]}return i},"in":function(t,e){return t.indexOf(e)>=0},assign:function(){var t=[].slice.apply(arguments);return t.reduceRight(function(t,e){return n.mixin(e,t)},void 0)},mixin:function(t,e){if("object"==typeof e){if(!Array.isArray(e)){for(var i in e)t[i]=e[i];return t}e.map(function(i,o){n.mixin(t[o],e[o])})}return t},extend:function(t,e){for(var n in e)t[n]=e[n];return t},toObjectFromRiot:function(t){var e={};for(var i in t)t.hasOwnProperty(i)&&"function"!=typeof t[i]&&(n["in"](["parent","root","opts","tags","hidden"],i)||(e[i]=t[i]));return e},htmlParser:{parse:function(t){return t.replace(/<br>/g,"\n")},unparse:function(t){return t.replace(/\\n/g,"<br>")}},formatDateForNote:function(t){var e,i,o=parseInt((new Date).getTime()/1e3),r=parseInt(t.getTime()/1e3);if(i=o-r,e=parseInt(i/86400),n.date.isTheDayBeforeYesterday(t))return"前天";if(n.date.isYesterday(t))return"昨天";if(0===e)return"今天";if(e>2&&4>=e)return e+"天前";var a=new Date(1e3*r);return a.getMonth()+1+"月"+a.getDate()+"日"},formatDateForComments:function(t){var e,n,i,o,r=parseInt((new Date).getTime()/1e3),a=parseInt(t.getTime()/1e3);if(o=r-a,i=parseInt(o/86400),n=parseInt(o/3600),e=parseInt(o/60),i>0&&4>i)return i+"天前";if(0>=i&&n>0)return n+"小时前";if(0>=n&&e>=1)return e+"分钟前";if(1>=e)return"刚刚";var s=new Date(1e3*a);return s.getMonth()+1+"月"+s.getDate()+"日"},getCookie:function(t){for(var e,n=document.cookie.replace(/[ ]/g,""),i=n.split(";"),o=0;o<i.length;o++){var r=i[o].split("=");if(t==r[0]){e=r[1];break}}return e},forbidOperation:function(){var t=$("<div/>"),e=$(window).height(),n=$("body").height();t.addClass("forbidShadow");var i=e>n?e:n;t.css({position:"absolute",top:"0px",left:"0px;",height:i+"px",background:"#000",width:"100%",opacity:"0"}).css("z-index","999"),$("body").append(t)},removeforbidOperation:function(){$(".forbidShadow")&&$(".forbidShadow").remove()},widget:{confirm:function(t){window.app.trigger("confirm",{title:t.title,content:t.content}).one("confirmOk",function(){app.off("confirmOk"),app.off("confirmCancel"),t.callback()}).one("confirmCancel",function(){app.off("confirmOk"),app.off("confirmCancel")})},showImg:function(t){window.app.trigger("showImg",t)},alert:function(t){window.app.trigger("alert",t)},validatify:function(t){if(!Array.isArray(t))throw new Error("validatify expected to be a Array.");var e={meta:{}};return e.addToSet=function(t){if(!t||!t.hasOwnProperty("success"))throw new Error("expected a success flag");if(!t||!t.field)throw new Error("expected a field");if(!t||!t.desc)throw new Error("expected a desc");if(!t||!t.key)throw new Error("expected a key");this.meta[t.key]||(this.meta[t.key]=delete t.key&&t)},e.pass=function(t){this.meta[t]&&delete this.meta[t]},e.raw=function(){var t=this;return Object.keys(t.meta).map(function(e){return t.meta[e]})},e.allOk=function(){return Object.keys(this.meta).length<=0},e.notOk=function(t){return this.meta[t]},e.clear=function(){return this.meta={},this},n.mixin(t,e),t}},generateRandomString:function(t){for(var e=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],n="",i=0;t>i;i++){var o=Math.floor(62*Math.random());n+=e[o]}return n},uploadImgFile:function(t,e){if(t.size>2097152)return void alert("图片大小不能超过2M");var n=new FormData;n.append("file",t),$.ajax({url:__app.settings.api.url+"/file/upload",type:"POST",data:n,processData:!1,contentType:!1,success:function(t){var n=__app.settings.api.url+"/file?media_id="+t.media_id;e(null,n)},error:function(t){e(t,null)}})}};window._||(window._=n),t.exports=n},function(t,e){var n=(__page||{},function(t){this.state=t});n.prototype.getUrl=function(){var t=window.location.hash||"";return this.state.url+t},n.prototype.getBaseUrl=function(){return this.state.baseUrl},n.prototype.setTitle=function(t){this.state.title=t,document&&(document.title=t)},n.prototype.saveTop=function(t){this.state.top=t,document&&(document.top=t)},n.prototype.getTop=function(){return this.state.top},n.prototype.getUser=function(){return this.state.user},n.prototype.getUser=function(){return this.state.user},__page.holder=function(){return __page._holder||(__page._holder=new n(__page)),__page._holder},t.exports=__page.holder()},function(t,e,n){var i=n(1),o=n(4),r=n(7),a=(document.getElementById("welcome_pag"),{name:"thing",fetched:!1,idAttribute:"_id",url:"/thing/"}),s=function(t,e){i.observable(t),t._m=r.extend({},a),t._m=r.extend(t._m,e);var n=t._m;t.fetched=function(t){return"undefined"==typeof t?n.fetched:n.fetched=t;
},t.has=function(t){return null!=this.get(t)},t.isNew=function(){return!this.has(n.idAttribute)},t.toObject=function(){var t={};for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t},t.fetch=function(e,i){"undefined"==typeof i&&"object"==typeof e&&(i=e,e=null);var a=n;if(i&&(a=r.extend({},n))&&r.extend(a,i),e||(e=this[n.idAttribute]),!e)return console.error("fail to fetch: no id"),!1;var s=a.url+"_"+e,l=o.ajax({type:a.method||"GET",url:s});return l.done(function(e,n,o){e.status?t.trigger("fetch",e.result,i):t.trigger("fetch-error",e,i)}).fail(function(e,n,o){t.trigger("error",o,i)}).always(function(){}),l},t.append=function(e,i){"undefined"==typeof i&&"object"==typeof e&&(i=e,e=null);var a=n;if(i&&(a=r.extend({},n))&&r.extend(a,i),e||(e=this[n.idAttribute]),!e)return console.error("fail to append: no id"),!1;var s=a.url+"_"+e,l=o.ajax({type:a.method||"GET",url:s});return l.done(function(e,n,o){e.status?t.trigger("append",e.result,i):t.trigger("append-error",e,i)}).fail(function(e,n,o){t.trigger("error",o,i)}).always(function(){}),l};var s=function(t){var e=[];for(var n in t)e.push(n+"="+t[n]);return e.join("&")};return t.save=function(e,i){var a=n;i&&(a=r.extend({},n))&&r.extend(a,i);var l=this.isNew()?"POST":"PUT",c=this.isNew()?a.url:a.url+"_"+this[n.idAttribute],d=this.toObject(),u=s(d.query||{});""!=u&&(c+="?"+u);var p=o.ajax({type:l,url:c,data:d});return p.done(function(e,n,o){e.status?(t.fetched(!0),t.trigger("save",e.result,i)):t.trigger("save-error",e,i)}).fail(function(e,n,o){t.trigger("error",o,i)}).always(function(){}),p},t.get=function(t){return this[t]},t.set=function(t,e,n){if("myobj"==t&&"object"==typeof e)r.extend(this,e);else if("randomNotePic"==t&&"object"==typeof e)r.extend(this,e);else if("object"==e)this[t]=e;else{var i=this[t];this[t]=e,n&&n.silent||(this.trigger("change:"+t,this,e,i),this.trigger("change",this))}},t},l={name:"collection",url:"/thing/filter"},c=function(t,e){i.observable(t),t._m=r.extend({},l),t._m=r.extend(t._m,e);var n=t._m;return t.fetched=function(t){return"undefined"==typeof t?n.fetched:n.fetched=t},t.fetch=function(e){var i=n;e&&(i=r.extend({},n))&&r.extend(i,e);var a=n.filter||{},s=i.url,l=o.ajax({type:i.method||"POST",url:s,data:{filter:a}});return l.done(function(n,i,o){n.status?(t.items=n.result,t.fetched(!0),t.trigger("fetch",n.result,e)):t.trigger("fetch-error",n,e)}).fail(function(n,i,o){t.trigger("error",o,e)}).always(function(){}),l},t.append=function(e){var i=n;e&&(i=r.extend({},n))&&r.extend(i,e);var a=n.filter||{},s=i.url,l=o.ajax({type:i.method||"POST",url:s,data:{filter:a}});return l.done(function(n,i,o){n.status?(t.items=n.result,t.fetched(!0),t.trigger("append",n.result,e)):t.trigger("append-error",n,e)}).fail(function(n,i,o){t.trigger("error",o,e)}).always(function(){}),l},t},d=function(t,e){t.hidden=!0,t.ready=!1,t.mask=!1;var n=function(e){t.hidden=!e,t.mask=!e,t.update({hidden:t.hidden})};t.on("show",function(t){n(t)});var i=function(e){t.ready=e,t.update({ready:t.ready})};return t.on("ready",function(t){i(t)}),t.on("refresh",function(){console.info("start refreshing")}),t},u={modelable:function(t,e){return s(t,e)},collectable:function(t,e){return c(t,e)},presentable:function(t,e){return d(t,e)},viewable:function(t){var e=r.extend({},t);return e.init=function(t){if(this.mount(t),console.log(),!this.tag)throw new Error("tag is not set");this.tag.on("view-route-to",function(){e.parent.trigger("view-route-to",e)}),this.tag.on("view-route-back",function(){e.parent.trigger("view-route-back",e)}),this.tag.on("model-changed",function(t,n,i){e.parent.trigger("app-changed",t,n,i)})},e.setParent=function(t){this.parent=t},e.leave=function(t,e){t.tag.trigger("leave",e.tag)},e.enter=function(t,e){e.tag.trigger("enter",t&&t.tag,t&&t.context)},e.reenter=function(){this.tag.trigger("reenter",this.context)},e.open=function(){this.tag.trigger("open")},e.close=function(){this.tag.trigger("close")},e.show=function(t){this.tag.trigger("show",t)},e.equalRoute=function(t){var e=this.context&&this.context.req.query.route;t&&t.context.req.query.route;return e=e},e},emptyFn:function(){}};t.exports=u},function(t,e,n){var i=n(4);i.fn.simslider=function(t){function e(){c>=l-1?(s.find(">ul").css({left:"0%"}),c=0,u.docs&&(s.find(".bannerdocs").find("li").removeClass("docsihov"),s.find(".bannerdocs").find("li:eq("+c+")").addClass("docsihov"))):(s.find(">ul").css({left:"-"+100*(c+1)+"%"}),u.docs&&(s.find(".bannerdocs").find("li").removeClass("docsihov"),s.find(".bannerdocs").find("li:eq("+(c+1)+")").addClass("docsihov")),c++)}function n(){0>=c?(s.find(">ul").css({left:"-"+100*(l-1)+"%"}),c=l-1,u.docs&&(s.find(".bannerdocs").find("li").removeClass("docsihov"),s.find(".bannerdocs").find("li:eq("+c+")").addClass("docsihov"))):(s.find(">ul").css({left:"-"+100*(c-1)+"%"}),u.docs&&(s.find(".bannerdocs").find("li").removeClass("docsihov"),s.find(".bannerdocs").find("li:eq("+(c-1)+")").addClass("docsihov")),c--)}function o(t){var t=t||window.event;p=t.originalEvent.targetTouches[0].pageX}function r(t){t.preventDefault();var t=t||window.event;f=t.originalEvent.targetTouches[0].pageX}function a(){p-f>100?e():f-p>100&&n()}var s=this,l=this.find(">ul>li").length,c=0,d={docs:!0,docscolor:"white"},u=i.extend(d,t);this.css({width:"100%"}),this.find(">ul").css({width:100*l+"%",position:"relative",overflow:"hidden"}),this.find(">ul>li").css({width:parseFloat(100/l).toFixed(6)+"%"}),setInterval(e,5e3);var p,f;if(s.on("touchstart",o),s.on("touchmove",r),s.on("touchend",a),u.docs){for(var h="<div class='bannerdocs' style='width:100%;position:absolute;bottom:6px'><ul style='width:"+11*l+"px'>",m=0;l>m;m++)h+=0!=m?"<li class='docsidef' style='display:block;width:6px;height:6px;border-radius:50em;margin-right:5px;'></li>":"<li class='docsihov docsidef' style='display:block;width:6px;height:6px;border-radius:50em;margin-right:5px;'></li>";h+="</ul></div>",s.append(h)}},t.exports=null},function(t,e,n){var i=n(12);n(20);t.exports=i},function(t,e,n){var i=n(13),o=i.domain();o.restApi({baseUrl:__app.settings.api.url}),t.exports=o},function(t,e,n){var i=n(14);t.exports=i},function(t,e,n){var i={version:"WIP",settings:{}},o=n(15),r=n(16);o.extend(i,r);var a=n(17);o.extend(i,a);var s=n(18);o.extend(i,s);var l=n(19);o.extend(i,l);var c=function(){this._actions={},this._restApiFactories={},this._wsApiFactories={}};c.prototype.action=function(t){var e=this._actions[t];return e?e:this._actions[t]=new i.Action(this,t)},c.prototype.actions=function(){return this._actions},c.prototype.restApi=function(t,e){var n="object"==typeof t||"object"==typeof e,o="string"!=typeof t,r=o?"default":t,a=o?t:e;if(n){var s=!!this._restApiFactories[r];!s&&(this._restApiFactories[r]=new i.RestApiFactory(a)),s&&this._restApiFactories[r].options(a)}return this._restApiFactories[r]},c.prototype.wsApi=function(t,e){var n="string"!=typeof t,i=n?"default":t;return this._wsApiFactories[i]},i.domain=function(){return new c},t.exports=i},function(t,e){var n={};n.extend=function(t,e){for(var n in e)t[n]=e[n];return t},n.getArguments=function(t){return Array.prototype.slice.call(t,0)},n.remove=function(t,e){var n=t.indexOf(e);n>-1&&t.splice(n,1)};var i={};n.nextId=function(t){return i[t]||(i[t]=1),i[t]++},t.exports=n},function(t,e,n){var i={},o=n(15),r=500,a=[{code:100,msg:"unknown error"},{code:101,msg:"ajax request timeout"},{code:102,msg:"ajax request abort"},{code:200,msg:"server side error"},{code:201,msg:"ajax parser error"},{code:500,msg:"wrong biz code, custom error code should be >500"}],s=function(t,e){for(var n=0;n<e.length;n++){var i=e[n];t[""+i.code]=i}},l={};s(l,a);var c={unknown:"100",error:"200",wrongcode:""+r},d={timeout:"101",abort:"102",error:"200",parsererror:"201"};o.extend(c,d);var u=function(t,e){this.code=t,this.msg=e};u.prototype.toString=function(){return"code: "+this.code+", msg: "+this.msg};var p={};p.codes=c,p.ajaxError=function(t,e){var n=t&&c[t]?c[t]:c.unknown,i=l[n];return new u(i.code,e||i.msg)},p.bizError=function(t,e){var n=new u(t,e);return r>t&&console.error("wrong biz error code: "+JSON.stringify(n)),n},i.ApiError=u,i.ApiErrorFactory=p,t.exports=i},function(t,e,n){var i={version:"WIP",settings:{}},o=n(15),r=n(16).ApiErrorFactory,a=$&&$.ajax||n(4),s={dataType:"json"},l=function(t){this._options=o.extend({},s),this.options(t||{})};l.defaultOptions=s,l.prototype.options=function(t){o.extend(this._options,t)};var c=function(t,e){t[e]=function(t){var n=new d(this._options),i=n.o;return i.method=e,i.url=(i.baseUrl||"")+t,n}};c(l.prototype,"get"),c(l.prototype,"post"),c(l.prototype,"put"),c(l.prototype,"delete");var d=function(t){this.o=o.extend({},t||{})},u=function(t,e){t[e]=function(t){return this.o[e]=t,this}};d.prototype.drive=function(t){return this.o.action=t,this},u(d.prototype,"done"),u(d.prototype,"fail"),u(d.prototype,"success"),u(d.prototype,"error"),u(d.prototype,"always"),d.prototype.onDone=function(t,e,n){if(t&&t.errcode){var i=r.bizError(t.errcode,t.errmsg);this.o.fail(i)}else t&&"undefined"!=typeof t.result?this.o.done(t.result):this.o.done(t)},d.prototype.onFail=function(t,e,n){var i=r.ajaxError(e,n);this.o.fail(i)},d.prototype.send=function(t){var e=a({type:this.o.method,url:this.o.url,dataType:this.o.dataType,data:t||null});if(this.o.action){var n=this.o.action;this.done(function(t){n.done(t)}).fail(function(t){n.fail(t)})}return this.o.done||this.o.fail?(e.done(this.onDone.bind(this)),e.fail(this.onFail.bind(this))):(this.o.success&&e.done(this.o.success),this.o.error&&e.fail(this.o.error)),this.o.always&&e.always(this.o.always),e},i.RestApi=d,i.RestApiFactory=l,t.exports=i},function(t,e){var n={};t.exports=n},function(t,e,n){var i={},o=n(15),r=n(1).observable,a=function(t,e,n){var i=[e];Array.prototype.push.apply(i,n),t.trigger.apply(t,i)},s=function(t,e,n,i){for(var o=n[i],r=o.length,a=null,s=0;r>s;s++)a=o[s],e.on(i,a.bind(t))},l=function(t,e){this.id=o.nextId(t.name()),this.action=t,this.inputs=e,this.outputs=null,this.error=null,this.executed=!1;var n=this._events=r({}),i=this.action._listeners;s(this,n,i,"execute"),s(this,n,i,"unexecute"),s(this,n,i,"done"),s(this,n,i,"fail"),s(this,n,i,"always")};l.prototype.execute=function(){a(this._events,"execute",this.inputs)},l.prototype.unexecute=function(){a(this._events,"unexecute",this.inputs)},l.prototype.onDone=function(t){return this._events.on("done",t.bind(this)),this},l.prototype.onFail=function(t){return this._events.on("fail",t.bind(this)),this},l.prototype.onAlways=function(t){return this._events.on("always",t.bind(this)),this},l.prototype.done=function(){var t=o.getArguments(arguments);this.outputs=t,this.executed=!0,a(this._events,"done",t),a(this._events,"always",t)},l.prototype.fail=function(){var t=o.getArguments(arguments);this.error=t[0],this.executed=!0,a(this._events,"fail",t),a(this._events,"always",t)};var c=function(t,e){this._domain=t,this._name=e,this._events=r({}),this._listeners={execute:[],unexecute:[],done:[],fail:[],always:[]}};c.prototype.name=function(t){return t?(this._name=t,this):this._name},c.prototype.onExecute=function(t){return this._listeners.execute.push(t),this},c.prototype.onUnexecute=function(t){return this._listeners.unexecute.push(t),this},c.prototype.onDone=function(t){return this._listeners.done.push(t),this},c.prototype.onFail=function(t){return this._listeners.fail.push(t),this},c.prototype.onAlways=function(t){return this._listeners.always.push(t),this},c.prototype.offDone=function(t){return o.remove(this._listeners.done,t),this},c.prototype.offFail=function(t){return o.remove(this._listeners.fail,t),this},c.prototype.offAlways=function(t){return o.remove(this._listeners.always,t),this},c.prototype.execute=function(){var t=new l(this,o.getArguments(arguments));return t.execute(),t},c.prototype.newInvocation=function(){return new l(this,o.getArguments(arguments))},i.Action=c,i.ActionInvocation=l,t.exports=i},function(t,e,n){var i=n(12);n(21),n(22),n(23),t.exports=i.actions()},function(t,e,n){var i=n(12),o=i.restApi();i.action("startBot").onExecute(function(t){o.post("/bot/start").drive(this).send(t)}),i.action("stopBot").onExecute(function(t){o.get("/bot/stop/"+t.openid).drive(this).send()}),i.action("syncContacts").onExecute(function(t){o.post("/bot/sync/contacts").drive(this).send(t)}),i.action("syncGroups").onExecute(function(t){o.post("/bot/sync/groups").drive(this).send(t)}),i.action("loadBotByMediaId").onExecute(function(t){o.get("/bot/"+t.botId).drive(this).send()}),i.action("saveTagsById").onExecute(function(t){o.post("/bot/tags/user/"+t.id).drive(this).send(t)}),i.action("broadcastTxt").onExecute(function(t){o.post("/bot/broadcastTxt").drive(this).send(t)}),i.action("broadcastImg").onExecute(function(t){o.post("/bot/broadcastImg").drive(this).send(t)}),i.action("loadBroadcastHistory").onExecute(function(t){o.get("/bot/broadcastHistory?botId="+t).drive(this).send()}),i.action("loadContacts").onExecute(function(t){o.get("/bot/contacts?botId="+t).drive(this).send()}),i.action("loadGroup").onExecute(function(t){o.get("/bot/group?id="+t.id).drive(this).send()}),i.action("editGroup").onExecute(function(t){o.put("/bot/group/"+t.id).drive(this).send(t)}),i.action("delGroup").onExecute(function(t){o["delete"]("/bot/group?id="+t.groupId).drive(this).send(t)}),i.action("addGroup").onExecute(function(t){o.post("/bot/group").drive(this).send(t)}),i.action("loadGroups").onExecute(function(t){o.get("/bot/groups?tenantId="+t.tenantId+"&operatorId="+t.operatorId).drive(this).send()}),i.action("loadAllMyManageMedia").onExecute(function(t){o.get("/bot/allMyMedia?tenantId="+t.tenantId+"&operatorId="+t.operatorId).drive(this).send()}),i.action("loadAllGroupMediaUsers").onExecute(function(t){o.post("/bot/group/mediaUser").drive(this).send(t)}),i.action("addGroupMembers").onExecute(function(t){o.post("/bot/group/members").drive(this).send(t)}),i.action("delGroupMember").onExecute(function(t){o["delete"]("/bot/group/members?ids="+t.mids+"&groupId="+t.groupId).drive(this).send()}),t.exports=null},function(t,e,n){var i=n(12),o=i.restApi();i.action("findTenants").onExecute(function(t){o.post("/tenant/filter").drive(this).send(t)}),i.action("loadTenantById").onExecute(function(t){o.get("/tenant/_"+t.id).drive(this).send()}),i.action("updateTenantById").onExecute(function(t){o.put("/tenant/_"+t.id).drive(this).send(t)}),i.action("addTenantWechatSite").onExecute(function(t){o.post("/tenant/add-wechatsite").drive(this).send(t)}),i.action("loadAllTenantWechatSite").onExecute(function(t){o.get("/tenant/wechatsite/loadAll?tenant="+t).drive(this).send()}),i.action("loadTenantWechatSite").onExecute(function(t){o.get("/tenant/wechatsite/load?id="+t).drive(this).send()}),i.action("updateTenantWechatSiteById").onExecute(function(t){o.put("/tenant/wechatsite/_"+t.id).drive(this).send(t)}),i.action("findDistributorsCountByTenantId").onExecute(function(t){o.get("/tenant/sd/distributors/count?tenant="+t.tenant).drive(this).send()}),i.action("findCustomersCountByTenantId").onExecute(function(t){o.get("/tenant/sd/customers/count?tenant="+t.tenant).drive(this).send()}),i.action("findCustomersByTenantId").onExecute(function(t){var e=Object.keys(t.filter).map(function(e){return e+"="+t.filter[e]}).join("&");o.get("/tenant/sd/customers?"+e).drive(this).send()}),i.action("checkout").onExecute(function(t){o.post("/tenant/sd/distributors/checkout").drive(this).send(t)}),i.action("findDistributorsWithPendingPaymentByTenantId").onExecute(function(t){var e=Object.keys(t.filter).map(function(e){return e+"="+t.filter[e]}).join("&");o.get("/tenant/sd/distributors/payment?"+e).drive(this).send()}),i.action("findDistributorsCountWithPendingPaymentByTenantId").onExecute(function(t){o.get("/tenant/sd/distributors/payment/count?tenant="+t.tenant).drive(this).send()}),i.action("findOrderRelatedDistributor").onExecute(function(t){o.get("/tenant/sd/orders/distributor?distributor="+t.distributor+"&status="+t.status).drive(this).send()}),i.action("findDistributorsByTenantId").onExecute(function(t){var e=Object.keys(t.filter).map(function(e){return e+"="+t.filter[e]}).join("&");o.get("/tenant/sd/distributors?"+e).drive(this).send()}),i.action("createOrder").onExecute(function(t){o.post("/tenant/sd/order").drive(this).send(t)}),i.action("createCourse").onExecute(function(t){o.post("/tenant/sd/course").drive(this).send(t)}),i.action("findCourses").onExecute(function(t){o.post("/tenant/sd/courses").drive(this).send(t)}),i.action("loadCourseById").onExecute(function(t){o.get("/tenant/sd/course/_"+t.id).drive(this).send(t)}),i.action("updateCourseById").onExecute(function(t){o.put("/tenant/sd/course/_"+t.id).drive(this).send(t)}),i.action("createCatalog").onExecute(function(t){o.post("/tenant/sd/catalog").drive(this).send(t)}),i.action("loadCatalogById").onExecute(function(t){o.get("/tenant/sd/catalog/_"+t.id).drive(this).send()}),i.action("updateCatalogById").onExecute(function(t){o.put("/tenant/sd/catalog/_"+t.id).drive(this).send(t)}),i.action("fetchSdQrByProductAndWechatSite").onExecute(function(t){o.post("/tenant/sd/catalog/poster").drive(this).send(t)}),i.action("findBespeaks").onExecute(function(t){var e=Object.keys(t.filter).map(function(e){return e+"="+t.filter[e]}).join("&");o.get("/tenant/sd/bespeak?"+e).drive(this).send()}),i.action("updateBespeakById").onExecute(function(t){o.put("/tenant/sd/bespeaks/_"+t.id).drive(this).send(t)}),i.action("findCatalogs").onExecute(function(t){var e=Object.keys(t.filter).map(function(e){return e+"="+t.filter[e]}).join("&");o.get("/tenant/sd/catalog?"+e).drive(this).send()}),i.action("loadPowerActivities").onExecute(function(t){o.get("/marketing/tenant/power/load?tenantId="+t.tenantId).drive(this).send()}),i.action("loadPowerActivity").onExecute(function(t){o.get("/marketing/tenant/power/loadById?id="+t.id).drive(this).send()}),i.action("updatePowerActivity").onExecute(function(t){o.post("/marketing/tenant/power/update").drive(this).send(t)}),i.action("addPowerActivity").onExecute(function(t){o.post("/marketing/tenant/power/add").drive(this).send(t)}),i.action("findOrders").onExecute(function(t){var e=Object.keys(t.filter).map(function(e){return e+"="+t.filter[e]}).join("&");o.get("/tenant/sd/orders?"+e).drive(this).send()}),t.exports=null},function(t,e,n){var i=n(12),o=i.restApi();i.action("findTenantAdlinks").onExecute(function(t){o.get("/adlink/tenant-"+t).drive(this).send()}),i.action("findTenantRecontents").onExecute(function(t){o.get("/recontent/tenant-"+t).drive(this).send()}),i.action("loadAdlink").onExecute(function(t){o.get("/adlink/_"+t).drive(this).send()}),i.action("loadAndEditAdlink").onExecute(function(t){o.get("/adlink/_"+t).drive(this).send()}),i.action("createAdlink").onExecute(function(t){o.post("/adlink/").drive(this).send(t)}),i.action("updateAdlink").onExecute(function(t){o.put("/adlink/_"+t._id).drive(this).send(t)}),t.exports=null},function(t,e){if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(t){"use strict";var e=t.fn.jquery.split(" ")[0].split(".");if(e[0]<2&&e[1]<9||1==e[0]&&9==e[1]&&e[2]<1||e[0]>2)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 3")}(jQuery),+function(t){"use strict";function e(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in e)if(void 0!==t.style[n])return{end:e[n]};return!1}t.fn.emulateTransitionEnd=function(e){var n=!1,i=this;t(this).one("bsTransitionEnd",function(){n=!0});var o=function(){n||t(i).trigger(t.support.transition.end)};return setTimeout(o,e),this},t(function(){t.support.transition=e(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){return t(e.target).is(this)?e.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),o=n.data("bs.alert");o||n.data("bs.alert",o=new i(this)),"string"==typeof e&&o[e].call(n)})}var n='[data-dismiss="alert"]',i=function(e){t(e).on("click",n,this.close)};i.VERSION="3.3.6",i.TRANSITION_DURATION=150,i.prototype.close=function(e){function n(){a.detach().trigger("closed.bs.alert").remove()}var o=t(this),r=o.attr("data-target");r||(r=o.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));var a=t(r);e&&e.preventDefault(),a.length||(a=o.closest(".alert")),a.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(a.removeClass("in"),t.support.transition&&a.hasClass("fade")?a.one("bsTransitionEnd",n).emulateTransitionEnd(i.TRANSITION_DURATION):n())};var o=t.fn.alert;t.fn.alert=e,t.fn.alert.Constructor=i,t.fn.alert.noConflict=function(){return t.fn.alert=o,this},t(document).on("click.bs.alert.data-api",n,i.prototype.close)}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),o=i.data("bs.button"),r="object"==typeof e&&e;o||i.data("bs.button",o=new n(this,r)),"toggle"==e?o.toggle():e&&o.setState(e)})}var n=function(e,i){this.$element=t(e),this.options=t.extend({},n.DEFAULTS,i),this.isLoading=!1};n.VERSION="3.3.6",n.DEFAULTS={loadingText:"loading..."},n.prototype.setState=function(e){var n="disabled",i=this.$element,o=i.is("input")?"val":"html",r=i.data();e+="Text",null==r.resetText&&i.data("resetText",i[o]()),setTimeout(t.proxy(function(){i[o](null==r[e]?this.options[e]:r[e]),"loadingText"==e?(this.isLoading=!0,i.addClass(n).attr(n,n)):this.isLoading&&(this.isLoading=!1,i.removeClass(n).removeAttr(n))},this),0)},n.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var n=this.$element.find("input");"radio"==n.prop("type")?(n.prop("checked")&&(t=!1),e.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==n.prop("type")&&(n.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),n.prop("checked",this.$element.hasClass("active")),t&&n.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var i=t.fn.button;t.fn.button=e,t.fn.button.Constructor=n,t.fn.button.noConflict=function(){return t.fn.button=i,this},t(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(n){var i=t(n.target);i.hasClass("btn")||(i=i.closest(".btn")),e.call(i,"toggle"),t(n.target).is('input[type="radio"]')||t(n.target).is('input[type="checkbox"]')||n.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(e){t(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),o=i.data("bs.carousel"),r=t.extend({},n.DEFAULTS,i.data(),"object"==typeof e&&e),a="string"==typeof e?e:r.slide;o||i.data("bs.carousel",o=new n(this,r)),"number"==typeof e?o.to(e):a?o[a]():r.interval&&o.pause().cycle()})}var n=function(e,n){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",t.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",t.proxy(this.pause,this)).on("mouseleave.bs.carousel",t.proxy(this.cycle,this))};n.VERSION="3.3.6",n.TRANSITION_DURATION=600,n.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},n.prototype.keydown=function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},n.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},n.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},n.prototype.getItemForDirection=function(t,e){var n=this.getItemIndex(e),i="prev"==t&&0===n||"next"==t&&n==this.$items.length-1;if(i&&!this.options.wrap)return e;var o="prev"==t?-1:1,r=(n+o)%this.$items.length;return this.$items.eq(r)},n.prototype.to=function(t){var e=this,n=this.getItemIndex(this.$active=this.$element.find(".item.active"));return t>this.$items.length-1||0>t?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",this.$items.eq(t))},n.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},n.prototype.next=function(){return this.sliding?void 0:this.slide("next")},n.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},n.prototype.slide=function(e,i){var o=this.$element.find(".item.active"),r=i||this.getItemForDirection(e,o),a=this.interval,s="next"==e?"left":"right",l=this;if(r.hasClass("active"))return this.sliding=!1;var c=r[0],d=t.Event("slide.bs.carousel",{relatedTarget:c,direction:s});if(this.$element.trigger(d),!d.isDefaultPrevented()){if(this.sliding=!0,a&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var u=t(this.$indicators.children()[this.getItemIndex(r)]);u&&u.addClass("active")}var p=t.Event("slid.bs.carousel",{relatedTarget:c,direction:s});return t.support.transition&&this.$element.hasClass("slide")?(r.addClass(e),r[0].offsetWidth,o.addClass(s),r.addClass(s),o.one("bsTransitionEnd",function(){r.removeClass([e,s].join(" ")).addClass("active"),o.removeClass(["active",s].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger(p)},0)}).emulateTransitionEnd(n.TRANSITION_DURATION)):(o.removeClass("active"),r.addClass("active"),this.sliding=!1,this.$element.trigger(p)),a&&this.cycle(),this}};var i=t.fn.carousel;t.fn.carousel=e,t.fn.carousel.Constructor=n,t.fn.carousel.noConflict=function(){return t.fn.carousel=i,this};var o=function(n){var i,o=t(this),r=t(o.attr("data-target")||(i=o.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""));if(r.hasClass("carousel")){var a=t.extend({},r.data(),o.data()),s=o.attr("data-slide-to");s&&(a.interval=!1),e.call(r,a),s&&r.data("bs.carousel").to(s),n.preventDefault()}};t(document).on("click.bs.carousel.data-api","[data-slide]",o).on("click.bs.carousel.data-api","[data-slide-to]",o),t(window).on("load",function(){t('[data-ride="carousel"]').each(function(){var n=t(this);e.call(n,n.data())})})}(jQuery),+function(t){"use strict";function e(e){var n,i=e.attr("data-target")||(n=e.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"");return t(i)}function n(e){return this.each(function(){var n=t(this),o=n.data("bs.collapse"),r=t.extend({},i.DEFAULTS,n.data(),"object"==typeof e&&e);!o&&r.toggle&&/show|hide/.test(e)&&(r.toggle=!1),o||n.data("bs.collapse",o=new i(this,r)),"string"==typeof e&&o[e]()})}var i=function(e,n){this.$element=t(e),this.options=t.extend({},i.DEFAULTS,n),this.$trigger=t('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};i.VERSION="3.3.6",i.TRANSITION_DURATION=350,i.DEFAULTS={toggle:!0},i.prototype.dimension=function(){var t=this.$element.hasClass("width");return t?"width":"height"},i.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,o=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(o&&o.length&&(e=o.data("bs.collapse"),e&&e.transitioning))){var r=t.Event("show.bs.collapse");if(this.$element.trigger(r),!r.isDefaultPrevented()){o&&o.length&&(n.call(o,"hide"),e||o.data("bs.collapse",null));var a=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[a](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var s=function(){this.$element.removeClass("collapsing").addClass("collapse in")[a](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return s.call(this);var l=t.camelCase(["scroll",a].join("-"));this.$element.one("bsTransitionEnd",t.proxy(s,this)).emulateTransitionEnd(i.TRANSITION_DURATION)[a](this.$element[0][l])}}}},i.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var o=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return t.support.transition?void this.$element[n](0).one("bsTransitionEnd",t.proxy(o,this)).emulateTransitionEnd(i.TRANSITION_DURATION):o.call(this)}}},i.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},i.prototype.getParent=function(){return t(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(t.proxy(function(n,i){var o=t(i);this.addAriaAndCollapsedClass(e(o),o)},this)).end()},i.prototype.addAriaAndCollapsedClass=function(t,e){var n=t.hasClass("in");t.attr("aria-expanded",n),e.toggleClass("collapsed",!n).attr("aria-expanded",n)};var o=t.fn.collapse;t.fn.collapse=n,t.fn.collapse.Constructor=i,t.fn.collapse.noConflict=function(){return t.fn.collapse=o,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(i){var o=t(this);o.attr("data-target")||i.preventDefault();var r=e(o),a=r.data("bs.collapse"),s=a?"toggle":o.data();n.call(r,s)})}(jQuery),+function(t){"use strict";function e(e){var n=e.attr("data-target");n||(n=e.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var i=n&&t(n);return i&&i.length?i:e.parent()}function n(n){n&&3===n.which||(t(o).remove(),t(r).each(function(){var i=t(this),o=e(i),r={relatedTarget:this};o.hasClass("open")&&(n&&"click"==n.type&&/input|textarea/i.test(n.target.tagName)&&t.contains(o[0],n.target)||(o.trigger(n=t.Event("hide.bs.dropdown",r)),n.isDefaultPrevented()||(i.attr("aria-expanded","false"),o.removeClass("open").trigger(t.Event("hidden.bs.dropdown",r)))))}))}function i(e){return this.each(function(){var n=t(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new a(this)),"string"==typeof e&&i[e].call(n)})}var o=".dropdown-backdrop",r='[data-toggle="dropdown"]',a=function(e){t(e).on("click.bs.dropdown",this.toggle)};a.VERSION="3.3.6",a.prototype.toggle=function(i){var o=t(this);if(!o.is(".disabled, :disabled")){var r=e(o),a=r.hasClass("open");if(n(),!a){"ontouchstart"in document.documentElement&&!r.closest(".navbar-nav").length&&t(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(t(this)).on("click",n);var s={relatedTarget:this};if(r.trigger(i=t.Event("show.bs.dropdown",s)),i.isDefaultPrevented())return;o.trigger("focus").attr("aria-expanded","true"),r.toggleClass("open").trigger(t.Event("shown.bs.dropdown",s))}return!1}},a.prototype.keydown=function(n){if(/(38|40|27|32)/.test(n.which)&&!/input|textarea/i.test(n.target.tagName)){var i=t(this);if(n.preventDefault(),n.stopPropagation(),!i.is(".disabled, :disabled")){var o=e(i),a=o.hasClass("open");if(!a&&27!=n.which||a&&27==n.which)return 27==n.which&&o.find(r).trigger("focus"),i.trigger("click");var s=" li:not(.disabled):visible a",l=o.find(".dropdown-menu"+s);if(l.length){var c=l.index(n.target);38==n.which&&c>0&&c--,40==n.which&&c<l.length-1&&c++,
~c||(c=0),l.eq(c).trigger("focus")}}}};var s=t.fn.dropdown;t.fn.dropdown=i,t.fn.dropdown.Constructor=a,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=s,this},t(document).on("click.bs.dropdown.data-api",n).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",r,a.prototype.toggle).on("keydown.bs.dropdown.data-api",r,a.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",a.prototype.keydown)}(jQuery),+function(t){"use strict";function e(e,i){return this.each(function(){var o=t(this),r=o.data("bs.modal"),a=t.extend({},n.DEFAULTS,o.data(),"object"==typeof e&&e);r||o.data("bs.modal",r=new n(this,a)),"string"==typeof e?r[e](i):a.show&&r.show(i)})}var n=function(e,n){this.options=n,this.$body=t(document.body),this.$element=t(e),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};n.VERSION="3.3.6",n.TRANSITION_DURATION=300,n.BACKDROP_TRANSITION_DURATION=150,n.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},n.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},n.prototype.show=function(e){var i=this,o=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(o),this.isShown||o.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){i.$element.one("mouseup.dismiss.bs.modal",function(e){t(e.target).is(i.$element)&&(i.ignoreBackdropClick=!0)})}),this.backdrop(function(){var o=t.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(i.$body),i.$element.show().scrollTop(0),i.adjustDialog(),o&&i.$element[0].offsetWidth,i.$element.addClass("in"),i.enforceFocus();var r=t.Event("shown.bs.modal",{relatedTarget:e});o?i.$dialog.one("bsTransitionEnd",function(){i.$element.trigger("focus").trigger(r)}).emulateTransitionEnd(n.TRANSITION_DURATION):i.$element.trigger("focus").trigger(r)}))},n.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(n.TRANSITION_DURATION):this.hideModal())},n.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},n.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},n.prototype.resize=function(){this.isShown?t(window).on("resize.bs.modal",t.proxy(this.handleUpdate,this)):t(window).off("resize.bs.modal")},n.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},n.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},n.prototype.backdrop=function(e){var i=this,o=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var r=t.support.transition&&o;if(this.$backdrop=t(document.createElement("div")).addClass("modal-backdrop "+o).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",t.proxy(function(t){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),r&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;r?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION):e()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var a=function(){i.removeBackdrop(),e&&e()};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",a).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION):a()}else e&&e()},n.prototype.handleUpdate=function(){this.adjustDialog()},n.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},n.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},n.prototype.checkScrollbar=function(){var t=window.innerWidth;if(!t){var e=document.documentElement.getBoundingClientRect();t=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},n.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",t+this.scrollbarWidth)},n.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},n.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var i=t.fn.modal;t.fn.modal=e,t.fn.modal.Constructor=n,t.fn.modal.noConflict=function(){return t.fn.modal=i,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(n){var i=t(this),o=i.attr("href"),r=t(i.attr("data-target")||o&&o.replace(/.*(?=#[^\s]+$)/,"")),a=r.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(o)&&o},r.data(),i.data());i.is("a")&&n.preventDefault(),r.one("show.bs.modal",function(t){t.isDefaultPrevented()||r.one("hidden.bs.modal",function(){i.is(":visible")&&i.trigger("focus")})}),e.call(r,a,this)})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),o=i.data("bs.tooltip"),r="object"==typeof e&&e;(o||!/destroy|hide/.test(e))&&(o||i.data("bs.tooltip",o=new n(this,r)),"string"==typeof e&&o[e]())})}var n=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};n.VERSION="3.3.6",n.TRANSITION_DURATION=150,n.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},n.prototype.init=function(e,n,i){if(this.enabled=!0,this.type=e,this.$element=t(n),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&t(t.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var o=this.options.trigger.split(" "),r=o.length;r--;){var a=o[r];if("click"==a)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=a){var s="hover"==a?"mouseenter":"focusin",l="hover"==a?"mouseleave":"focusout";this.$element.on(s+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.getOptions=function(e){return e=t.extend({},this.getDefaults(),this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},n.prototype.getDelegateOptions=function(){var e={},n=this.getDefaults();return this._options&&t.each(this._options,function(t,i){n[t]!=i&&(e[t]=i)}),e},n.prototype.enter=function(e){var n=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n)),e instanceof t.Event&&(n.inState["focusin"==e.type?"focus":"hover"]=!0),n.tip().hasClass("in")||"in"==n.hoverState?void(n.hoverState="in"):(clearTimeout(n.timeout),n.hoverState="in",n.options.delay&&n.options.delay.show?void(n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show)):n.show())},n.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},n.prototype.leave=function(e){var n=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n)),e instanceof t.Event&&(n.inState["focusout"==e.type?"focus":"hover"]=!1),n.isInStateTrue()?void 0:(clearTimeout(n.timeout),n.hoverState="out",n.options.delay&&n.options.delay.hide?void(n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide)):n.hide())},n.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var i=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!i)return;var o=this,r=this.tip(),a=this.getUID(this.type);this.setContent(),r.attr("id",a),this.$element.attr("aria-describedby",a),this.options.animation&&r.addClass("fade");var s="function"==typeof this.options.placement?this.options.placement.call(this,r[0],this.$element[0]):this.options.placement,l=/\s?auto?\s?/i,c=l.test(s);c&&(s=s.replace(l,"")||"top"),r.detach().css({top:0,left:0,display:"block"}).addClass(s).data("bs."+this.type,this),this.options.container?r.appendTo(this.options.container):r.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var d=this.getPosition(),u=r[0].offsetWidth,p=r[0].offsetHeight;if(c){var f=s,h=this.getPosition(this.$viewport);s="bottom"==s&&d.bottom+p>h.bottom?"top":"top"==s&&d.top-p<h.top?"bottom":"right"==s&&d.right+u>h.width?"left":"left"==s&&d.left-u<h.left?"right":s,r.removeClass(f).addClass(s)}var m=this.getCalculatedOffset(s,d,u,p);this.applyPlacement(m,s);var g=function(){var t=o.hoverState;o.$element.trigger("shown.bs."+o.type),o.hoverState=null,"out"==t&&o.leave(o)};t.support.transition&&this.$tip.hasClass("fade")?r.one("bsTransitionEnd",g).emulateTransitionEnd(n.TRANSITION_DURATION):g()}},n.prototype.applyPlacement=function(e,n){var i=this.tip(),o=i[0].offsetWidth,r=i[0].offsetHeight,a=parseInt(i.css("margin-top"),10),s=parseInt(i.css("margin-left"),10);isNaN(a)&&(a=0),isNaN(s)&&(s=0),e.top+=a,e.left+=s,t.offset.setOffset(i[0],t.extend({using:function(t){i.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),i.addClass("in");var l=i[0].offsetWidth,c=i[0].offsetHeight;"top"==n&&c!=r&&(e.top=e.top+r-c);var d=this.getViewportAdjustedDelta(n,e,l,c);d.left?e.left+=d.left:e.top+=d.top;var u=/top|bottom/.test(n),p=u?2*d.left-o+l:2*d.top-r+c,f=u?"offsetWidth":"offsetHeight";i.offset(e),this.replaceArrow(p,i[0][f],u)},n.prototype.replaceArrow=function(t,e,n){this.arrow().css(n?"left":"top",50*(1-t/e)+"%").css(n?"top":"left","")},n.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},n.prototype.hide=function(e){function i(){"in"!=o.hoverState&&r.detach(),o.$element.removeAttr("aria-describedby").trigger("hidden.bs."+o.type),e&&e()}var o=this,r=t(this.$tip),a=t.Event("hide.bs."+this.type);return this.$element.trigger(a),a.isDefaultPrevented()?void 0:(r.removeClass("in"),t.support.transition&&r.hasClass("fade")?r.one("bsTransitionEnd",i).emulateTransitionEnd(n.TRANSITION_DURATION):i(),this.hoverState=null,this)},n.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},n.prototype.hasContent=function(){return this.getTitle()},n.prototype.getPosition=function(e){e=e||this.$element;var n=e[0],i="BODY"==n.tagName,o=n.getBoundingClientRect();null==o.width&&(o=t.extend({},o,{width:o.right-o.left,height:o.bottom-o.top}));var r=i?{top:0,left:0}:e.offset(),a={scroll:i?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},s=i?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},o,a,s,r)},n.prototype.getCalculatedOffset=function(t,e,n,i){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-n/2}:"top"==t?{top:e.top-i,left:e.left+e.width/2-n/2}:"left"==t?{top:e.top+e.height/2-i/2,left:e.left-n}:{top:e.top+e.height/2-i/2,left:e.left+e.width}},n.prototype.getViewportAdjustedDelta=function(t,e,n,i){var o={top:0,left:0};if(!this.$viewport)return o;var r=this.options.viewport&&this.options.viewport.padding||0,a=this.getPosition(this.$viewport);if(/right|left/.test(t)){var s=e.top-r-a.scroll,l=e.top+r-a.scroll+i;s<a.top?o.top=a.top-s:l>a.top+a.height&&(o.top=a.top+a.height-l)}else{var c=e.left-r,d=e.left+r+n;c<a.left?o.left=a.left-c:d>a.right&&(o.left=a.left+a.width-d)}return o},n.prototype.getTitle=function(){var t,e=this.$element,n=this.options;return t=e.attr("data-original-title")||("function"==typeof n.title?n.title.call(e[0]):n.title)},n.prototype.getUID=function(t){do t+=~~(1e6*Math.random());while(document.getElementById(t));return t},n.prototype.tip=function(){if(!this.$tip&&(this.$tip=t(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},n.prototype.enable=function(){this.enabled=!0},n.prototype.disable=function(){this.enabled=!1},n.prototype.toggleEnabled=function(){this.enabled=!this.enabled},n.prototype.toggle=function(e){var n=this;e&&(n=t(e.currentTarget).data("bs."+this.type),n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n))),e?(n.inState.click=!n.inState.click,n.isInStateTrue()?n.enter(n):n.leave(n)):n.tip().hasClass("in")?n.leave(n):n.enter(n)},n.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null})};var i=t.fn.tooltip;t.fn.tooltip=e,t.fn.tooltip.Constructor=n,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=i,this}}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),o=i.data("bs.popover"),r="object"==typeof e&&e;(o||!/destroy|hide/.test(e))&&(o||i.data("bs.popover",o=new n(this,r)),"string"==typeof e&&o[e]())})}var n=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");n.VERSION="3.3.6",n.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),n.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),n.prototype.constructor=n,n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),n=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof n?"html":"append":"text"](n),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},n.prototype.hasContent=function(){return this.getTitle()||this.getContent()},n.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var i=t.fn.popover;t.fn.popover=e,t.fn.popover.Constructor=n,t.fn.popover.noConflict=function(){return t.fn.popover=i,this}}(jQuery),+function(t){"use strict";function e(n,i){this.$body=t(document.body),this.$scrollElement=t(t(n).is(document.body)?window:n),this.options=t.extend({},e.DEFAULTS,i),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",t.proxy(this.process,this)),this.refresh(),this.process()}function n(n){return this.each(function(){var i=t(this),o=i.data("bs.scrollspy"),r="object"==typeof n&&n;o||i.data("bs.scrollspy",o=new e(this,r)),"string"==typeof n&&o[n]()})}e.VERSION="3.3.6",e.DEFAULTS={offset:10},e.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},e.prototype.refresh=function(){var e=this,n="offset",i=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),t.isWindow(this.$scrollElement[0])||(n="position",i=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var e=t(this),o=e.data("target")||e.attr("href"),r=/^#./.test(o)&&t(o);return r&&r.length&&r.is(":visible")&&[[r[n]().top+i,o]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){e.offsets.push(this[0]),e.targets.push(this[1])})},e.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,n=this.getScrollHeight(),i=this.options.offset+n-this.$scrollElement.height(),o=this.offsets,r=this.targets,a=this.activeTarget;if(this.scrollHeight!=n&&this.refresh(),e>=i)return a!=(t=r[r.length-1])&&this.activate(t);if(a&&e<o[0])return this.activeTarget=null,this.clear();for(t=o.length;t--;)a!=r[t]&&e>=o[t]&&(void 0===o[t+1]||e<o[t+1])&&this.activate(r[t])},e.prototype.activate=function(e){this.activeTarget=e,this.clear();var n=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',i=t(n).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate.bs.scrollspy")},e.prototype.clear=function(){t(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var i=t.fn.scrollspy;t.fn.scrollspy=n,t.fn.scrollspy.Constructor=e,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=i,this},t(window).on("load.bs.scrollspy.data-api",function(){t('[data-spy="scroll"]').each(function(){var e=t(this);n.call(e,e.data())})})}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),o=i.data("bs.tab");o||i.data("bs.tab",o=new n(this)),"string"==typeof e&&o[e]()})}var n=function(e){this.element=t(e)};n.VERSION="3.3.6",n.TRANSITION_DURATION=150,n.prototype.show=function(){var e=this.element,n=e.closest("ul:not(.dropdown-menu)"),i=e.data("target");if(i||(i=e.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var o=n.find(".active:last a"),r=t.Event("hide.bs.tab",{relatedTarget:e[0]}),a=t.Event("show.bs.tab",{relatedTarget:o[0]});if(o.trigger(r),e.trigger(a),!a.isDefaultPrevented()&&!r.isDefaultPrevented()){var s=t(i);this.activate(e.closest("li"),n),this.activate(s,s.parent(),function(){o.trigger({type:"hidden.bs.tab",relatedTarget:e[0]}),e.trigger({type:"shown.bs.tab",relatedTarget:o[0]})})}}},n.prototype.activate=function(e,i,o){function r(){a.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),e.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),s?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu").length&&e.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),o&&o()}var a=i.find("> .active"),s=o&&t.support.transition&&(a.length&&a.hasClass("fade")||!!i.find("> .fade").length);a.length&&s?a.one("bsTransitionEnd",r).emulateTransitionEnd(n.TRANSITION_DURATION):r(),a.removeClass("in")};var i=t.fn.tab;t.fn.tab=e,t.fn.tab.Constructor=n,t.fn.tab.noConflict=function(){return t.fn.tab=i,this};var o=function(n){n.preventDefault(),e.call(t(this),"show")};t(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',o).on("click.bs.tab.data-api",'[data-toggle="pill"]',o)}(jQuery),+function(t){"use strict";function e(e){return this.each(function(){var i=t(this),o=i.data("bs.affix"),r="object"==typeof e&&e;o||i.data("bs.affix",o=new n(this,r)),"string"==typeof e&&o[e]()})}var n=function(e,i){this.options=t.extend({},n.DEFAULTS,i),this.$target=t(this.options.target).on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(e),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};n.VERSION="3.3.6",n.RESET="affix affix-top affix-bottom",n.DEFAULTS={offset:0,target:window},n.prototype.getState=function(t,e,n,i){var o=this.$target.scrollTop(),r=this.$element.offset(),a=this.$target.height();if(null!=n&&"top"==this.affixed)return n>o?"top":!1;if("bottom"==this.affixed)return null!=n?o+this.unpin<=r.top?!1:"bottom":t-i>=o+a?!1:"bottom";var s=null==this.affixed,l=s?o:r.top,c=s?a:e;return null!=n&&n>=o?"top":null!=i&&l+c>=t-i?"bottom":!1},n.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(n.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},n.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},n.prototype.checkPosition=function(){if(this.$element.is(":visible")){var e=this.$element.height(),i=this.options.offset,o=i.top,r=i.bottom,a=Math.max(t(document).height(),t(document.body).height());"object"!=typeof i&&(r=o=i),"function"==typeof o&&(o=i.top(this.$element)),"function"==typeof r&&(r=i.bottom(this.$element));var s=this.getState(a,e,o,r);if(this.affixed!=s){null!=this.unpin&&this.$element.css("top","");var l="affix"+(s?"-"+s:""),c=t.Event(l+".bs.affix");if(this.$element.trigger(c),c.isDefaultPrevented())return;this.affixed=s,this.unpin="bottom"==s?this.getPinnedOffset():null,this.$element.removeClass(n.RESET).addClass(l).trigger(l.replace("affix","affixed")+".bs.affix")}"bottom"==s&&this.$element.offset({top:a-e-r})}};var i=t.fn.affix;t.fn.affix=e,t.fn.affix.Constructor=n,t.fn.affix.noConflict=function(){return t.fn.affix=i,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var n=t(this),i=n.data();i.offset=i.offset||{},null!=i.offsetBottom&&(i.offset.bottom=i.offsetBottom),null!=i.offsetTop&&(i.offset.top=i.offsetTop),e.call(n,i)})})}(jQuery)},function(t,e,n){var i,o,r;!function(a){o=[n(4)],i=a,r="function"==typeof i?i.apply(e,o):i,!(void 0!==r&&(t.exports=r))}(function(t){"use strict";var e,i=function(){var e=function(t){return function(e){return t===e}},n=function(t,e){return t===e},i=function(t){return function(e,n){return e[t]===n[t]}},o=function(){return!0},r=function(){return!1},a=function(t){return function(){return!t.apply(t,arguments)}},s=function(t,e){return function(n){return t(n)&&e(n)}},l=function(t){return t},c=function(t,e){return function(){return t[e].apply(t,arguments)}},d=0,u=function(t){var e=++d+"";return t?t+e:e},p=function(e){var n=t(document);return{top:e.top+n.scrollTop(),left:e.left+n.scrollLeft(),width:e.right-e.left,height:e.bottom-e.top}},f=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[t[n]]=n);return e},h=function(t,e){return e=e||"",e+t.split(".").map(function(t){return t.substring(0,1).toUpperCase()+t.substring(1)}).join("")};return{eq:e,eq2:n,peq2:i,ok:o,fail:r,self:l,not:a,and:s,invoke:c,uniqueId:u,rect2bnd:p,invertObject:f,namespaceToCamel:h}}(),o=function(){var e=function(t){return t[0]},n=function(t){return t[t.length-1]},o=function(t){return t.slice(0,t.length-1)},r=function(t){return t.slice(1)},a=function(t,e){for(var n=0,i=t.length;i>n;n++){var o=t[n];if(e(o))return o}},s=function(t,e){for(var n=0,i=t.length;i>n;n++)if(!e(t[n]))return!1;return!0},l=function(e,n){return t.inArray(n,e)},c=function(t,e){return-1!==l(t,e)},d=function(t,e){return e=e||i.self,t.reduce(function(t,n){return t+e(n)},0)},u=function(t){for(var e=[],n=-1,i=t.length;++n<i;)e[n]=t[n];return e},p=function(t){return!t||!t.length},f=function(t,i){if(!t.length)return[];var o=r(t);return o.reduce(function(t,e){var o=n(t);return i(n(o),e)?o[o.length]=e:t[t.length]=[e],t},[[e(t)]])},h=function(t){for(var e=[],n=0,i=t.length;i>n;n++)t[n]&&e.push(t[n]);return e},m=function(t){for(var e=[],n=0,i=t.length;i>n;n++)c(e,t[n])||e.push(t[n]);return e},g=function(t,e){var n=l(t,e);return-1===n?null:t[n+1]},v=function(t,e){var n=l(t,e);return-1===n?null:t[n-1]};return{head:e,last:n,initial:o,tail:r,prev:v,next:g,find:a,contains:c,all:s,sum:d,from:u,isEmpty:p,clusterBy:f,compact:h,unique:m}}(),r=n(26),a=function(e){var n="Comic Sans MS"===e?"Courier New":"Comic Sans MS",i=t("<div>").css({position:"absolute",left:"-9999px",top:"-9999px",fontSize:"200px"}).text("mmmmmmmmmwwwwwww").appendTo(document.body),o=i.css("fontFamily",n).width(),r=i.css("fontFamily",e+","+n).width();return i.remove(),o!==r},s=navigator.userAgent,l=/MSIE|Trident/i.test(s);if(l){var c=/MSIE (\d+[.]\d+)/.exec(s);c&&(e=parseFloat(c[1])),c=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(s),c&&(e=parseFloat(c[1]))}var d={isMac:navigator.appVersion.indexOf("Mac")>-1,isMSIE:l,isFF:/firefox/i.test(s),isWebkit:/webkit/i.test(s),isSafari:/safari/i.test(s),browserVersion:e,jqueryVersion:parseFloat(t.fn.jquery),isSupportAmd:r,hasCodeMirror:r?27:!!window.CodeMirror,isFontInstalled:a,isW3CRangeSupport:!!document.createRange},u=String.fromCharCode(160),p="\ufeff",f=function(){var e=function(e){return e&&t(e).hasClass("note-editable")},n=function(e){return e&&t(e).hasClass("note-control-sizing")},r=function(t){return t=t.toUpperCase(),function(e){return e&&e.nodeName.toUpperCase()===t}},a=function(t){return t&&3===t.nodeType},s=function(t){return t&&1===t.nodeType},l=function(t){return t&&/^BR|^IMG|^HR|^IFRAME|^BUTTON/.test(t.nodeName.toUpperCase())},c=function(t){return e(t)?!1:t&&/^DIV|^P|^LI|^H[1-7]/.test(t.nodeName.toUpperCase())},h=function(t){return t&&/^H[1-7]/.test(t.nodeName.toUpperCase())},m=r("PRE"),g=r("LI"),v=function(t){return c(t)&&!g(t)},b=r("TABLE"),y=function(t){return!(T(t)||w(t)||x(t)||c(t)||b(t)||C(t))},w=function(t){return t&&/^UL|^OL/.test(t.nodeName.toUpperCase())},x=r("HR"),k=function(t){return t&&/^TD|^TH/.test(t.nodeName.toUpperCase())},C=r("BLOCKQUOTE"),T=function(t){return k(t)||C(t)||e(t)},S=r("A"),_=function(t){return y(t)&&!!O(t,c)},I=function(t){return y(t)&&!O(t,c)},L=r("BODY"),D=function(t,e){return t.nextSibling===e||t.previousSibling===e},N=function(t,e){e=e||i.ok;var n=[];return t.previousSibling&&e(t.previousSibling)&&n.push(t.previousSibling),n.push(t),t.nextSibling&&e(t.nextSibling)&&n.push(t.nextSibling),n},E=d.isMSIE&&d.browserVersion<11?"&nbsp;":"<br>",A=function(t){return a(t)?t.nodeValue.length:t.childNodes.length},M=function(t){var e=A(t);return 0===e?!0:a(t)||1!==e||t.innerHTML!==E?o.all(t.childNodes,a)&&""===t.innerHTML?!0:!1:!0},P=function(t){l(t)||A(t)||(t.innerHTML=E)},O=function(t,n){for(;t;){if(n(t))return t;if(e(t))break;t=t.parentNode}return null},F=function(t,n){for(t=t.parentNode;t&&1===A(t);){if(n(t))return t;if(e(t))break;t=t.parentNode}return null},H=function(t,n){n=n||i.fail;var o=[];return O(t,function(t){return e(t)||o.push(t),n(t)}),o},$=function(t,e){var n=H(t);return o.last(n.filter(e))},B=function(e,n){for(var i=H(e),o=n;o;o=o.parentNode)if(t.inArray(o,i)>-1)return o;return null},R=function(t,e){e=e||i.fail;for(var n=[];t&&!e(t);)n.push(t),t=t.previousSibling;return n},z=function(t,e){e=e||i.fail;for(var n=[];t&&!e(t);)n.push(t),t=t.nextSibling;return n},j=function(t,e){var n=[];return e=e||i.ok,function o(i){t!==i&&e(i)&&n.push(i);for(var r=0,a=i.childNodes.length;a>r;r++)o(i.childNodes[r])}(t),n},W=function(e,n){var i=e.parentNode,o=t("<"+n+">")[0];return i.insertBefore(o,e),o.appendChild(e),o},U=function(t,e){var n=e.nextSibling,i=e.parentNode;return n?i.insertBefore(t,n):i.appendChild(t),t},q=function(e,n){return t.each(n,function(t,n){e.appendChild(n)}),e},V=function(t){return 0===t.offset},G=function(t){return t.offset===A(t.node)},K=function(t){return V(t)||G(t)},X=function(t,e){for(;t&&t!==e;){if(0!==Z(t))return!1;t=t.parentNode}return!0},Y=function(t,e){for(;t&&t!==e;){if(Z(t)!==A(t.parentNode)-1)return!1;t=t.parentNode}return!0},Q=function(t,e){return V(t)&&X(t.node,e)},J=function(t,e){return G(t)&&Y(t.node,e)},Z=function(t){for(var e=0;t=t.previousSibling;)e+=1;return e},tt=function(t){return!!(t&&t.childNodes&&t.childNodes.length)},et=function(t,n){var i,o;if(0===t.offset){if(e(t.node))return null;i=t.node.parentNode,o=Z(t.node)}else tt(t.node)?(i=t.node.childNodes[t.offset-1],o=A(i)):(i=t.node,o=n?0:t.offset-1);return{node:i,offset:o}},nt=function(t,n){var i,o;if(A(t.node)===t.offset){if(e(t.node))return null;i=t.node.parentNode,o=Z(t.node)+1}else tt(t.node)?(i=t.node.childNodes[t.offset],o=0):(i=t.node,o=n?A(t.node):t.offset+1);return{node:i,offset:o}},it=function(t,e){return t.node===e.node&&t.offset===e.offset},ot=function(t){if(a(t.node)||!tt(t.node)||M(t.node))return!0;var e=t.node.childNodes[t.offset-1],n=t.node.childNodes[t.offset];return e&&!l(e)||n&&!l(n)?!1:!0},rt=function(t,e){for(;t;){if(e(t))return t;t=et(t)}return null},at=function(t,e){for(;t;){if(e(t))return t;t=nt(t)}return null},st=function(t){if(!a(t.node))return!1;var e=t.node.nodeValue.charAt(t.offset-1);return e&&" "!==e&&e!==u},lt=function(t,e,n,i){for(var o=t;o&&(n(o),!it(o,e));){var r=i&&t.node!==o.node&&e.node!==o.node;o=nt(o,r)}},ct=function(t,e){var n=H(e,i.eq(t));return n.map(Z).reverse()},dt=function(t,e){for(var n=t,i=0,o=e.length;o>i;i++)n=n.childNodes.length<=e[i]?n.childNodes[n.childNodes.length-1]:n.childNodes[e[i]];return n},ut=function(t,e){var n=e&&e.isSkipPaddingBlankHTML,i=e&&e.isNotSplitEdgePoint;if(K(t)&&(a(t.node)||i)){if(V(t))return t.node;if(G(t))return t.node.nextSibling}if(a(t.node))return t.node.splitText(t.offset);var o=t.node.childNodes[t.offset],r=U(t.node.cloneNode(!1),t.node);return q(r,z(o)),n||(P(t.node),P(r)),r},pt=function(t,e,n){var o=H(e.node,i.eq(t));return o.length?1===o.length?ut(e,n):o.reduce(function(t,i){return t===e.node&&(t=ut(e,n)),ut({node:i,offset:t?f.position(t):A(i)},n)}):null},ft=function(t,e){var n,i,r=e?c:T,a=H(t.node,r),s=o.last(a)||t.node;r(s)?(n=a[a.length-2],i=s):(n=s,i=n.parentNode);var l=n&&pt(n,t,{isSkipPaddingBlankHTML:e,isNotSplitEdgePoint:e});return l||i!==t.node||(l=t.node.childNodes[t.offset]),{rightNode:l,container:i}},ht=function(t){return document.createElement(t)},mt=function(t){return document.createTextNode(t)},gt=function(t,e){if(t&&t.parentNode){if(t.removeNode)return t.removeNode(e);var n=t.parentNode;if(!e){var i,o,r=[];for(i=0,o=t.childNodes.length;o>i;i++)r.push(t.childNodes[i]);for(i=0,o=r.length;o>i;i++)n.insertBefore(r[i],t)}n.removeChild(t)}},vt=function(t,n){for(;t&&!e(t)&&n(t);){var i=t.parentNode;gt(t),t=i}},bt=function(t,e){
if(t.nodeName.toUpperCase()===e.toUpperCase())return t;var n=ht(e);return t.style.cssText&&(n.style.cssText=t.style.cssText),q(n,o.from(t.childNodes)),U(n,t),gt(t),n},yt=r("TEXTAREA"),wt=function(t,e){var n=yt(t[0])?t.val():t.html();return e?n.replace(/[\n\r]/g,""):n},xt=function(e,n){var i=wt(e);if(n){var o=/<(\/?)(\b(?!!)[^>\s]*)(.*?)(\s*\/?>)/g;i=i.replace(o,function(t,e,n){n=n.toUpperCase();var i=/^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(n)&&!!e,o=/^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(n);return t+(i||o?"\n":"")}),i=t.trim(i)}return i},kt=function(e){var n=t(e),i=n.offset(),o=n.outerHeight(!0);return{left:i.left,top:i.top+o}},Ct=function(t,e){Object.keys(e).forEach(function(n){t.on(n,e[n])})},Tt=function(t,e){Object.keys(e).forEach(function(n){t.off(n,e[n])})};return{NBSP_CHAR:u,ZERO_WIDTH_NBSP_CHAR:p,blank:E,emptyPara:"<p>"+E+"</p>",makePredByNodeName:r,isEditable:e,isControlSizing:n,isText:a,isElement:s,isVoid:l,isPara:c,isPurePara:v,isHeading:h,isInline:y,isBlock:i.not(y),isBodyInline:I,isBody:L,isParaInline:_,isPre:m,isList:w,isTable:b,isCell:k,isBlockquote:C,isBodyContainer:T,isAnchor:S,isDiv:r("DIV"),isLi:g,isBR:r("BR"),isSpan:r("SPAN"),isB:r("B"),isU:r("U"),isS:r("S"),isI:r("I"),isImg:r("IMG"),isTextarea:yt,isEmpty:M,isEmptyAnchor:i.and(S,M),isClosestSibling:D,withClosestSiblings:N,nodeLength:A,isLeftEdgePoint:V,isRightEdgePoint:G,isEdgePoint:K,isLeftEdgeOf:X,isRightEdgeOf:Y,isLeftEdgePointOf:Q,isRightEdgePointOf:J,prevPoint:et,nextPoint:nt,isSamePoint:it,isVisiblePoint:ot,prevPointUntil:rt,nextPointUntil:at,isCharPoint:st,walkPoint:lt,ancestor:O,singleChildAncestor:F,listAncestor:H,lastAncestor:$,listNext:z,listPrev:R,listDescendant:j,commonAncestor:B,wrap:W,insertAfter:U,appendChildNodes:q,position:Z,hasChildren:tt,makeOffsetPath:ct,fromOffsetPath:dt,splitTree:pt,splitPoint:ft,create:ht,createText:mt,remove:gt,removeWhile:vt,replace:bt,html:xt,value:wt,posFromPlaceholder:kt,attachEvents:Ct,detachEvents:Tt}}(),h=function(e,n){var r=this,a=t.summernote.ui;return this.memos={},this.modules={},this.layoutInfo={},this.options=n,this.initialize=function(){return this.layoutInfo=a.createLayout(e,n),this._initialize(),e.hide(),this},this.destroy=function(){this._destroy(),e.removeData("summernote"),a.removeLayout(e,this.layoutInfo)},this.reset=function(){this.code(f.emptyPara),this._destroy(),this._initialize()},this._initialize=function(){var e=t.extend({},this.options.buttons);Object.keys(e).forEach(function(t){r.memo("button."+t,e[t])});var n=t.extend({},this.options.modules,t.summernote.plugins||{});Object.keys(n).forEach(function(t){r.module(t,n[t],!0)}),Object.keys(this.modules).forEach(function(t){r.initializeModule(t)})},this._destroy=function(){Object.keys(this.modules).reverse().forEach(function(t){r.removeModule(t)}),Object.keys(this.memos).forEach(function(t){r.removeMemo(t)})},this.code=function(t){var n=this.invoke("codeview.isActivated");return void 0===t?(this.invoke("codeview.sync"),n?this.layoutInfo.codable.val():this.layoutInfo.editable.html()):(n?this.layoutInfo.codable.val(t):this.layoutInfo.editable.html(t),e.val(t),void this.triggerEvent("change",t))},this.isDisabled=function(){return"false"===this.layoutInfo.editable.attr("contenteditable")},this.enable=function(){this.layoutInfo.editable.attr("contenteditable",!0),this.invoke("toolbar.activate",!0)},this.disable=function(){this.invoke("codeview.isActivated")&&this.invoke("codeview.deactivate"),this.layoutInfo.editable.attr("contenteditable",!1),this.invoke("toolbar.deactivate",!0)},this.triggerEvent=function(){var t=o.head(arguments),n=o.tail(o.from(arguments)),r=this.options.callbacks[i.namespaceToCamel(t,"on")];r&&r.apply(e[0],n),e.trigger("summernote."+t,n)},this.initializeModule=function(t){var n=this.modules[t];n.shouldInitialize=n.shouldInitialize||i.ok,n.shouldInitialize()&&(n.initialize&&n.initialize(),n.events&&f.attachEvents(e,n.events))},this.module=function(t,e,n){return 1===arguments.length?this.modules[t]:(this.modules[t]=new e(this),void(n||this.initializeModule(t)))},this.removeModule=function(t){var n=this.modules[t];n.shouldInitialize()&&(n.events&&f.detachEvents(e,n.events),n.destroy&&n.destroy()),delete this.modules[t]},this.memo=function(t,e){return 1===arguments.length?this.memos[t]:void(this.memos[t]=e)},this.removeMemo=function(t){this.memos[t]&&this.memos[t].destroy&&this.memos[t].destroy(),delete this.memos[t]},this.createInvokeHandler=function(e,n){return function(i){i.preventDefault(),r.invoke(e,n||t(i.target).closest("[data-value]").data("value"))}},this.invoke=function(){var t=o.head(arguments),e=o.tail(o.from(arguments)),n=t.split("."),i=n.length>1,r=i&&o.head(n),a=i?o.last(n):o.head(n),s=this.modules[r||"editor"];return!r&&this[a]?this[a].apply(this,e):s&&s[a]&&s.shouldInitialize()?s[a].apply(s,e):void 0},this.initialize()};t.summernote=t.summernote||{lang:{}},t.fn.extend({summernote:function(){var e=t.type(o.head(arguments)),n="string"===e,i="object"===e,r=i?o.head(arguments):{};r=t.extend({},t.summernote.options,r),r.langInfo=t.extend(!0,{},t.summernote.lang["en-US"],t.summernote.lang[r.lang]),this.each(function(e,n){var i=t(n);if(!i.data("summernote")){var o=new h(i,r);i.data("summernote",o),i.data("summernote").triggerEvent("init",o.layoutInfo)}});var a=this.first();if(a.length){var s=a.data("summernote");if(n)return s.invoke.apply(s,o.from(arguments));r.focus&&s.invoke("editor.focus")}return this}});var m=function(e,n,i,o){this.render=function(r){var a=t(e);if(i&&i.contents&&a.html(i.contents),i&&i.className&&a.addClass(i.className),i&&i.data&&t.each(i.data,function(t,e){a.attr("data-"+t,e)}),i&&i.click&&a.on("click",i.click),n){var s=a.find(".note-children-container");n.forEach(function(t){t.render(s.length?s:a)})}return o&&o(a,i),i&&i.callback&&i.callback(a),r&&r.append(a),a}},g={create:function(e,n){return function(){var i=t.isArray(arguments[0])?arguments[0]:[],o="object"==typeof arguments[1]?arguments[1]:arguments[0];return o&&o.children&&(i=o.children),new m(e,i,o,n)}}},v=g.create('<div class="note-editor note-frame panel panel-default"/>'),b=g.create('<div class="note-toolbar panel-heading"/>'),y=g.create('<div class="note-editing-area"/>'),w=g.create('<textarea class="note-codable"/>'),x=g.create('<div class="note-editable panel-body" contentEditable="true"/>'),k=g.create(['<div class="note-statusbar">','  <div class="note-resizebar">','    <div class="note-icon-bar"/>','    <div class="note-icon-bar"/>','    <div class="note-icon-bar"/>',"  </div>","</div>"].join("")),C=g.create('<div class="note-editor"/>'),T=g.create('<div class="note-editable" contentEditable="true"/>'),S=g.create('<div class="note-btn-group btn-group">'),_=g.create('<button type="button" class="note-btn btn btn-default btn-sm">',function(t,e){e&&e.tooltip&&t.attr({title:e.tooltip}).tooltip({container:"body",trigger:"hover",placement:"bottom"})}),I=g.create('<div class="dropdown-menu">',function(e,n){var i=t.isArray(n.items)?n.items.map(function(t){var e="string"==typeof t?t:t.value||"",i=n.template?n.template(t):t;return'<li><a href="#" data-value="'+e+'">'+i+"</a></li>"}).join(""):n.items;e.html(i)}),L=g.create('<div class="dropdown-menu note-check">',function(e,n){var i=t.isArray(n.items)?n.items.map(function(t){var e="string"==typeof t?t:t.value||"",i=n.template?n.template(t):t;return'<li><a href="#" data-value="'+e+'">'+A(n.checkClassName)+" "+i+"</a></li>"}).join(""):n.items;e.html(i)}),D=g.create('<div class="note-color-palette"/>',function(t,e){for(var n=[],i=0,o=e.colors.length;o>i;i++){for(var r=e.eventName,a=e.colors[i],s=[],l=0,c=a.length;c>l;l++){var d=a[l];s.push(['<button type="button" class="note-color-btn"','style="background-color:',d,'" ','data-event="',r,'" ','data-value="',d,'" ','title="',d,'" ','data-toggle="button" tabindex="-1"></button>'].join(""))}n.push('<div class="note-color-row">'+s.join("")+"</div>")}t.html(n.join("")),t.find(".note-color-btn").tooltip({container:"body",trigger:"hover",placement:"bottom"})}),N=g.create('<div class="modal" aria-hidden="false" tabindex="-1"/>',function(t,e){e.fade&&t.addClass("fade"),t.html(['<div class="modal-dialog">','  <div class="modal-content">',e.title?'    <div class="modal-header">      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>      <h4 class="modal-title">'+e.title+"</h4>    </div>":"",'    <div class="modal-body">'+e.body+"</div>",e.footer?'    <div class="modal-footer">'+e.footer+"</div>":"","  </div>","</div>"].join(""))}),E=g.create(['<div class="note-popover popover in">','  <div class="arrow"/>','  <div class="popover-content note-children-container"/>',"</div>"].join(""),function(t,e){var n="undefined"!=typeof e.direction?e.direction:"bottom";t.addClass(n),e.hideArrow&&t.find(".arrow").hide()}),A=function(t,e){return e=e||"i","<"+e+' class="'+t+'"/>'},M={editor:v,toolbar:b,editingArea:y,codable:w,editable:x,statusbar:k,airEditor:C,airEditable:T,buttonGroup:S,button:_,dropdown:I,dropdownCheck:L,palette:D,dialog:N,popover:E,icon:A,toggleBtn:function(t,e){t.toggleClass("disabled",!e),t.attr("disabled",!e)},toggleBtnActive:function(t,e){t.toggleClass("active",e)},onDialogShown:function(t,e){t.one("shown.bs.modal",e)},onDialogHidden:function(t,e){t.one("hidden.bs.modal",e)},showDialog:function(t){t.modal("show")},hideDialog:function(t){t.modal("hide")},createLayout:function(t,e){var n=(e.airMode?M.airEditor([M.editingArea([M.airEditable()])]):M.editor([M.toolbar(),M.editingArea([M.codable(),M.editable()]),M.statusbar()])).render();return n.insertAfter(t),{note:t,editor:n,toolbar:n.find(".note-toolbar"),editingArea:n.find(".note-editing-area"),editable:n.find(".note-editable"),codable:n.find(".note-codable"),statusbar:n.find(".note-statusbar")}},removeLayout:function(t,e){t.html(e.editable.html()),e.editor.remove(),t.show()}};t.extend(t.summernote.lang,{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",clear:"Remove Font Style",height:"Line Height",name:"Font Family",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript",size:"Font Size"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",shapeRounded:"Shape: Rounded",shapeCircle:"Shape: Circle",shapeThumbnail:"Shape: Thumbnail",shapeNone:"Shape: None",dragImageHere:"Drag image or text here",dropImage:"Drop image or Text",selectFromFiles:"Select from files",maximumFileSize:"Maximum file size",maximumFileSizeError:"Maximum file size exceeded.",url:"Image URL",remove:"Remove Image"},video:{video:"Video",videoLink:"Video Link",insert:"Insert Video",url:"Video URL?",providers:"(YouTube, Vimeo, Vine, Instagram, DailyMotion or Youku)"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},table:{table:"Table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",normal:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"Background Color",foreground:"Foreground Color",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style",extraKeys:"Extra keys"},help:{insertParagraph:"Insert Paragraph",undo:"Undoes the last command",redo:"Redoes the last command",tab:"Tab",untab:"Untab",bold:"Set a bold style",italic:"Set a italic style",underline:"Set a underline style",strikethrough:"Set a strikethrough style",removeFormat:"Clean a style",justifyLeft:"Set left align",justifyCenter:"Set center align",justifyRight:"Set right align",justifyFull:"Set full align",insertUnorderedList:"Toggle unordered list",insertOrderedList:"Toggle ordered list",outdent:"Outdent on current paragraph",indent:"Indent on current paragraph",formatPara:"Change current block's format as a paragraph(P tag)",formatH1:"Change current block's format as H1",formatH2:"Change current block's format as H2",formatH3:"Change current block's format as H3",formatH4:"Change current block's format as H4",formatH5:"Change current block's format as H5",formatH6:"Change current block's format as H6",insertHorizontalRule:"Insert horizontal rule","linkDialog.show":"Show Link Dialog"},history:{undo:"Undo",redo:"Redo"},specialChar:{specialChar:"SPECIAL CHARACTERS",select:"Select Special characters"}}});var P,O=function(){var t={BACKSPACE:8,TAB:9,ENTER:13,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUM0:48,NUM1:49,NUM2:50,NUM3:51,NUM4:52,NUM5:53,NUM6:54,NUM7:55,NUM8:56,B:66,E:69,I:73,J:74,K:75,L:76,R:82,S:83,U:85,V:86,Y:89,Z:90,SLASH:191,LEFTBRACKET:219,BACKSLASH:220,RIGHTBRACKET:221};return{isEdit:function(e){return o.contains([t.BACKSPACE,t.TAB,t.ENTER,t.SPACe],e)},isMove:function(e){return o.contains([t.LEFT,t.UP,t.RIGHT,t.DOWN],e)},nameFromCode:i.invertObject(t),code:t}}(),F=function(){var e=function(t,e){var n,i,r=t.parentElement(),a=document.body.createTextRange(),s=o.from(r.childNodes);for(n=0;n<s.length;n++)if(!f.isText(s[n])){if(a.moveToElementText(s[n]),a.compareEndPoints("StartToStart",t)>=0)break;i=s[n]}if(0!==n&&f.isText(s[n-1])){var l=document.body.createTextRange(),c=null;l.moveToElementText(i||r),l.collapse(!i),c=i?i.nextSibling:r.firstChild;var d=t.duplicate();d.setEndPoint("StartToStart",l);for(var u=d.text.replace(/[\r\n]/g,"").length;u>c.nodeValue.length&&c.nextSibling;)u-=c.nodeValue.length,c=c.nextSibling;c.nodeValue,e&&c.nextSibling&&f.isText(c.nextSibling)&&u===c.nodeValue.length&&(u-=c.nodeValue.length,c=c.nextSibling),r=c,n=u}return{cont:r,offset:n}},n=function(t){var e=function(t,n){var r,a;if(f.isText(t)){var s=f.listPrev(t,i.not(f.isText)),l=o.last(s).previousSibling;r=l||t.parentNode,n+=o.sum(o.tail(s),f.nodeLength),a=!l}else{if(r=t.childNodes[n]||t,f.isText(r))return e(r,0);n=0,a=!1}return{node:r,collapseToStart:a,offset:n}},n=document.body.createTextRange(),r=e(t.node,t.offset);return n.moveToElementText(r.node),n.collapse(r.collapseToStart),n.moveStart("character",r.offset),n},r=function(e,a,s,l){this.sc=e,this.so=a,this.ec=s,this.eo=l;var c=function(){if(d.isW3CRangeSupport){var t=document.createRange();return t.setStart(e,a),t.setEnd(s,l),t}var i=n({node:e,offset:a});return i.setEndPoint("EndToEnd",n({node:s,offset:l})),i};this.getPoints=function(){return{sc:e,so:a,ec:s,eo:l}},this.getStartPoint=function(){return{node:e,offset:a}},this.getEndPoint=function(){return{node:s,offset:l}},this.select=function(){var t=c();if(d.isW3CRangeSupport){var e=document.getSelection();e.rangeCount>0&&e.removeAllRanges(),e.addRange(t)}else t.select();return this},this.scrollIntoView=function(t){return t[0].scrollTop+t.height()<this.sc.offsetTop&&(t[0].scrollTop+=Math.abs(t[0].scrollTop+t.height()-this.sc.offsetTop)),this},this.normalize=function(){var t=function(t,e){if(f.isVisiblePoint(t)&&!f.isEdgePoint(t)||f.isVisiblePoint(t)&&f.isRightEdgePoint(t)&&!e||f.isVisiblePoint(t)&&f.isLeftEdgePoint(t)&&e||f.isVisiblePoint(t)&&f.isBlock(t.node)&&f.isEmpty(t.node))return t;var n=f.ancestor(t.node,f.isBlock);if((f.isLeftEdgePointOf(t,n)||f.isVoid(f.prevPoint(t).node))&&!e||(f.isRightEdgePointOf(t,n)||f.isVoid(f.nextPoint(t).node))&&e){if(f.isVisiblePoint(t))return t;e=!e}var i=e?f.nextPointUntil(f.nextPoint(t),f.isVisiblePoint):f.prevPointUntil(f.prevPoint(t),f.isVisiblePoint);return i||t},e=t(this.getEndPoint(),!1),n=this.isCollapsed()?e:t(this.getStartPoint(),!0);return new r(n.node,n.offset,e.node,e.offset)},this.nodes=function(t,e){t=t||i.ok;var n=e&&e.includeAncestor,r=e&&e.fullyContains,a=this.getStartPoint(),s=this.getEndPoint(),l=[],c=[];return f.walkPoint(a,s,function(e){if(!f.isEditable(e.node)){var i;r?(f.isLeftEdgePoint(e)&&c.push(e.node),f.isRightEdgePoint(e)&&o.contains(c,e.node)&&(i=e.node)):i=n?f.ancestor(e.node,t):e.node,i&&t(i)&&l.push(i)}},!0),o.unique(l)},this.commonAncestor=function(){return f.commonAncestor(e,s)},this.expand=function(t){var n=f.ancestor(e,t),i=f.ancestor(s,t);if(!n&&!i)return new r(e,a,s,l);var o=this.getPoints();return n&&(o.sc=n,o.so=0),i&&(o.ec=i,o.eo=f.nodeLength(i)),new r(o.sc,o.so,o.ec,o.eo)},this.collapse=function(t){return t?new r(e,a,e,a):new r(s,l,s,l)},this.splitText=function(){var t=e===s,n=this.getPoints();return f.isText(s)&&!f.isEdgePoint(this.getEndPoint())&&s.splitText(l),f.isText(e)&&!f.isEdgePoint(this.getStartPoint())&&(n.sc=e.splitText(a),n.so=0,t&&(n.ec=n.sc,n.eo=l-a)),new r(n.sc,n.so,n.ec,n.eo)},this.deleteContents=function(){if(this.isCollapsed())return this;var e=this.splitText(),n=e.nodes(null,{fullyContains:!0}),i=f.prevPointUntil(e.getStartPoint(),function(t){return!o.contains(n,t.node)}),a=[];return t.each(n,function(t,e){var n=e.parentNode;i.node!==n&&1===f.nodeLength(n)&&a.push(n),f.remove(e,!1)}),t.each(a,function(t,e){f.remove(e,!1)}),new r(i.node,i.offset,i.node,i.offset).normalize()};var u=function(t){return function(){var n=f.ancestor(e,t);return!!n&&n===f.ancestor(s,t)}};this.isOnEditable=u(f.isEditable),this.isOnList=u(f.isList),this.isOnAnchor=u(f.isAnchor),this.isOnCell=u(f.isCell),this.isLeftEdgeOf=function(t){if(!f.isLeftEdgePoint(this.getStartPoint()))return!1;var e=f.ancestor(this.sc,t);return e&&f.isLeftEdgeOf(this.sc,e)},this.isCollapsed=function(){return e===s&&a===l},this.wrapBodyInlineWithPara=function(){if(f.isBodyContainer(e)&&f.isEmpty(e))return e.innerHTML=f.emptyPara,new r(e.firstChild,0,e.firstChild,0);var t=this.normalize();if(f.isParaInline(e)||f.isPara(e))return t;var n;if(f.isInline(t.sc)){var a=f.listAncestor(t.sc,i.not(f.isInline));n=o.last(a),f.isInline(n)||(n=a[a.length-2]||t.sc.childNodes[t.so])}else n=t.sc.childNodes[t.so>0?t.so-1:0];var s=f.listPrev(n,f.isParaInline).reverse();if(s=s.concat(f.listNext(n.nextSibling,f.isParaInline)),s.length){var l=f.wrap(o.head(s),"p");f.appendChildNodes(l,o.tail(s))}return this.normalize()},this.insertNode=function(t){var e=this.wrapBodyInlineWithPara().deleteContents(),n=f.splitPoint(e.getStartPoint(),f.isInline(t));return n.rightNode?n.rightNode.parentNode.insertBefore(t,n.rightNode):n.container.appendChild(t),t},this.pasteHTML=function(e){var n=t("<div></div>").html(e)[0],i=o.from(n.childNodes),r=this.wrapBodyInlineWithPara().deleteContents();return i.reverse().map(function(t){return r.insertNode(t)}).reverse()},this.toString=function(){var t=c();return d.isW3CRangeSupport?t.toString():t.text},this.getWordRange=function(t){var e=this.getEndPoint();if(!f.isCharPoint(e))return this;var n=f.prevPointUntil(e,function(t){return!f.isCharPoint(t)});return t&&(e=f.nextPointUntil(e,function(t){return!f.isCharPoint(t)})),new r(n.node,n.offset,e.node,e.offset)},this.bookmark=function(t){return{s:{path:f.makeOffsetPath(t,e),offset:a},e:{path:f.makeOffsetPath(t,s),offset:l}}},this.paraBookmark=function(t){return{s:{path:o.tail(f.makeOffsetPath(o.head(t),e)),offset:a},e:{path:o.tail(f.makeOffsetPath(o.last(t),s)),offset:l}}},this.getClientRects=function(){var t=c();return t.getClientRects()}};return{create:function(t,n,i,o){if(arguments.length)2===arguments.length&&(i=t,o=n);else if(d.isW3CRangeSupport){var a=document.getSelection();if(!a||0===a.rangeCount)return null;if(f.isBody(a.anchorNode))return null;var s=a.getRangeAt(0);t=s.startContainer,n=s.startOffset,i=s.endContainer,o=s.endOffset}else{var l=document.selection.createRange(),c=l.duplicate();c.collapse(!1);var u=l;u.collapse(!0);var p=e(u,!0),h=e(c,!1);f.isText(p.node)&&f.isLeftEdgePoint(p)&&f.isTextNode(h.node)&&f.isRightEdgePoint(h)&&h.node.nextSibling===p.node&&(p=h),t=p.cont,n=p.offset,i=h.cont,o=h.offset}return new r(t,n,i,o)},createFromNode:function(t){var e=t,n=0,i=t,o=f.nodeLength(i);return f.isVoid(e)&&(n=f.listPrev(e).length-1,e=e.parentNode),f.isBR(i)?(o=f.listPrev(i).length-1,i=i.parentNode):f.isVoid(i)&&(o=f.listPrev(i).length,i=i.parentNode),this.create(e,n,i,o)},createFromNodeBefore:function(t){return this.createFromNode(t).collapse(!0)},createFromNodeAfter:function(t){return this.createFromNode(t).collapse()},createFromBookmark:function(t,e){var n=f.fromOffsetPath(t,e.s.path),i=e.s.offset,o=f.fromOffsetPath(t,e.e.path),a=e.e.offset;return new r(n,i,o,a)},createFromParaBookmark:function(t,e){var n=t.s.offset,i=t.e.offset,a=f.fromOffsetPath(o.head(e),t.s.path),s=f.fromOffsetPath(o.last(e),t.e.path);return new r(a,n,s,i)}}}(),H=function(){var e=function(e){return t.Deferred(function(n){t.extend(new FileReader,{onload:function(t){var e=t.target.result;n.resolve(e)},onerror:function(){n.reject(this)}}).readAsDataURL(e)}).promise()},n=function(e){return t.Deferred(function(n){var i=t("<img>");i.one("load",function(){i.off("error abort"),n.resolve(i)}).one("error abort",function(){i.off("load").detach(),n.reject(i)}).css({display:"none"}).appendTo(document.body).attr("src",e)}).promise()};return{readFileAsDataURL:e,createImage:n}}(),$=function(t){var e=[],n=-1,i=t[0],o=function(){var e=F.create(),n={s:{path:[],offset:0},e:{path:[],offset:0}};return{contents:t.html(),bookmark:e?e.bookmark(i):n}},r=function(e){null!==e.contents&&t.html(e.contents),null!==e.bookmark&&F.createFromBookmark(i,e.bookmark).select()};this.rewind=function(){t.html()!==e[n].contents&&this.recordUndo(),n=0,r(e[n])},this.reset=function(){e=[],n=-1,t.html(""),this.recordUndo()},this.undo=function(){t.html()!==e[n].contents&&this.recordUndo(),n>0&&(n--,r(e[n]))},this.redo=function(){e.length-1>n&&(n++,r(e[n]))},this.recordUndo=function(){n++,e.length>n&&(e=e.slice(0,n)),e.push(o())}},B=function(){var e=function(e,n){if(d.jqueryVersion<1.9){var i={};return t.each(n,function(t,n){i[n]=e.css(n)}),i}return e.css.call(e,n)};this.fromNode=function(t){var n=["font-family","font-size","text-align","list-style-type","line-height"],i=e(t,n)||{};return i["font-size"]=parseInt(i["font-size"],10),i},this.stylePara=function(e,n){t.each(e.nodes(f.isPara,{includeAncestor:!0}),function(e,i){t(i).css(n)})},this.styleNodes=function(e,n){e=e.splitText();var r=n&&n.nodeName||"SPAN",a=!(!n||!n.expandClosestSibling),s=!(!n||!n.onlyPartialContains);if(e.isCollapsed())return[e.insertNode(f.create(r))];var l=f.makePredByNodeName(r),c=e.nodes(f.isText,{fullyContains:!0}).map(function(t){return f.singleChildAncestor(t,l)||f.wrap(t,r)});if(a){if(s){var d=e.nodes();l=i.and(l,function(t){return o.contains(d,t)})}return c.map(function(e){var n=f.withClosestSiblings(e,l),i=o.head(n),r=o.tail(n);return t.each(r,function(t,e){f.appendChildNodes(i,e.childNodes),f.remove(e)}),o.head(n)})}return c},this.current=function(e){var n=t(f.isElement(e.sc)?e.sc:e.sc.parentNode),i=this.fromNode(n);try{i=t.extend(i,{"font-bold":document.queryCommandState("bold")?"bold":"normal","font-italic":document.queryCommandState("italic")?"italic":"normal","font-underline":document.queryCommandState("underline")?"underline":"normal","font-subscript":document.queryCommandState("subscript")?"subscript":"normal","font-superscript":document.queryCommandState("superscript")?"superscript":"normal","font-strikethrough":document.queryCommandState("strikethrough")?"strikethrough":"normal"})}catch(o){}if(e.isOnList()){var r=["circle","disc","disc-leading-zero","square"],a=t.inArray(i["list-style-type"],r)>-1;i["list-style"]=a?"unordered":"ordered"}else i["list-style"]="none";var s=f.ancestor(e.sc,f.isPara);if(s&&s.style["line-height"])i["line-height"]=s.style.lineHeight;else{var l=parseInt(i["line-height"],10)/parseInt(i["font-size"],10);i["line-height"]=l.toFixed(1)}return i.anchor=e.isOnAnchor()&&f.ancestor(e.sc,f.isAnchor),i.ancestors=f.listAncestor(e.sc,f.isEditable),i.range=e,i}},R=function(){this.insertOrderedList=function(){this.toggleList("OL")},this.insertUnorderedList=function(){this.toggleList("UL")},this.indent=function(){var e=this,n=F.create().wrapBodyInlineWithPara(),r=n.nodes(f.isPara,{includeAncestor:!0}),a=o.clusterBy(r,i.peq2("parentNode"));t.each(a,function(n,i){var r=o.head(i);f.isLi(r)?e.wrapList(i,r.parentNode.nodeName):t.each(i,function(e,n){t(n).css("marginLeft",function(t,e){return(parseInt(e,10)||0)+25})})}),n.select()},this.outdent=function(){var e=this,n=F.create().wrapBodyInlineWithPara(),r=n.nodes(f.isPara,{includeAncestor:!0}),a=o.clusterBy(r,i.peq2("parentNode"));t.each(a,function(n,i){var r=o.head(i);f.isLi(r)?e.releaseList([i]):t.each(i,function(e,n){t(n).css("marginLeft",function(t,e){return e=parseInt(e,10)||0,e>25?e-25:""})})}),n.select()},this.toggleList=function(e){var n=this,r=F.create().wrapBodyInlineWithPara(),a=r.nodes(f.isPara,{includeAncestor:!0}),s=r.paraBookmark(a),l=o.clusterBy(a,i.peq2("parentNode"));if(o.find(a,f.isPurePara)){var c=[];t.each(l,function(t,i){c=c.concat(n.wrapList(i,e))}),a=c}else{var d=r.nodes(f.isList,{includeAncestor:!0}).filter(function(n){return!t.nodeName(n,e)});d.length?t.each(d,function(t,n){f.replace(n,e)}):a=this.releaseList(l,!0)}F.createFromParaBookmark(s,a).select()},this.wrapList=function(t,e){var n=o.head(t),i=o.last(t),r=f.isList(n.previousSibling)&&n.previousSibling,a=f.isList(i.nextSibling)&&i.nextSibling,s=r||f.insertAfter(f.create(e||"UL"),i);return t=t.map(function(t){return f.isPurePara(t)?f.replace(t,"LI"):t}),f.appendChildNodes(s,t),a&&(f.appendChildNodes(s,o.from(a.childNodes)),f.remove(a)),t},this.releaseList=function(e,n){var i=[];return t.each(e,function(e,r){var a=o.head(r),s=o.last(r),l=n?f.lastAncestor(a,f.isList):a.parentNode,c=l.childNodes.length>1?f.splitTree(l,{node:s.parentNode,offset:f.position(s)+1},{isSkipPaddingBlankHTML:!0}):null,d=f.splitTree(l,{node:a.parentNode,offset:f.position(a)},{isSkipPaddingBlankHTML:!0});r=n?f.listDescendant(d,f.isLi):o.from(d.childNodes).filter(f.isLi),(n||!f.isList(l.parentNode))&&(r=r.map(function(t){return f.replace(t,"P")})),t.each(o.from(r).reverse(),function(t,e){f.insertAfter(e,l)});var u=o.compact([l,d,c]);t.each(u,function(e,n){var i=[n].concat(f.listDescendant(n,f.isList));t.each(i.reverse(),function(t,e){f.nodeLength(e)||f.remove(e,!0)})}),i=i.concat(r)}),i}},z=function(){var e=new R;this.insertTab=function(t,e,n){var i=f.createText(new Array(n+1).join(f.NBSP_CHAR));e=e.deleteContents(),e.insertNode(i,!0),e=F.create(i,n),e.select()},this.insertParagraph=function(n){var i=F.create();i=i.deleteContents(),i=i.wrapBodyInlineWithPara();var o,r=f.ancestor(i.sc,f.isPara);if(r){if(f.isEmpty(r)&&f.isLi(r))return void e.toggleList(r.parentNode.nodeName);if(f.isEmpty(r)&&f.isPara(r)&&f.isBlockquote(r.parentNode))f.insertAfter(r,r.parentNode),o=r;else{o=f.splitTree(r,i.getStartPoint());var a=f.listDescendant(r,f.isEmptyAnchor);a=a.concat(f.listDescendant(o,f.isEmptyAnchor)),t.each(a,function(t,e){f.remove(e)}),(f.isHeading(o)||f.isPre(o))&&f.isEmpty(o)&&(o=f.replace(o,"p"))}}else{var s=i.sc.childNodes[i.so];o=t(f.emptyPara)[0],s?i.sc.insertBefore(o,s):i.sc.appendChild(o)}F.create(o,0).normalize().select().scrollIntoView(n)}},j=function(){this.tab=function(t,e){var n=f.ancestor(t.commonAncestor(),f.isCell),i=f.ancestor(n,f.isTable),r=f.listDescendant(i,f.isCell),a=o[e?"prev":"next"](r,n);a&&F.create(a,0).select()},this.createTable=function(e,n,i){for(var o,r=[],a=0;e>a;a++)r.push("<td>"+f.blank+"</td>");o=r.join("");for(var s,l=[],c=0;n>c;c++)l.push("<tr>"+o+"</tr>");s=l.join("");var d=t("<table>"+s+"</table>");return i&&i.tableClassName&&d.addClass(i.tableClassName),d[0]}},W="bogus",U=function(e){var n=this,i=e.layoutInfo.note,r=e.layoutInfo.editor,a=e.layoutInfo.editable,s=e.options,l=s.langInfo,c=new B,u=new j,p=new z,h=new R,m=new $(a);this.initialize=function(){a.on("keydown",function(t){t.keyCode===O.code.ENTER&&e.triggerEvent("enter",t),e.triggerEvent("keydown",t),s.shortcuts&&!t.isDefaultPrevented()&&n.handleKeyMap(t)}).on("keyup",function(t){e.triggerEvent("keyup",t)}).on("focus",function(t){e.triggerEvent("focus",t)}).on("blur",function(t){e.triggerEvent("blur",t)}).on("mousedown",function(t){e.triggerEvent("mousedown",t)}).on("mouseup",function(t){e.triggerEvent("mouseup",t)}).on("scroll",function(t){e.triggerEvent("scroll",t)}).on("paste",function(t){e.triggerEvent("paste",t)});var t=d.isMSIE?"DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted":"input";a.on(t,function(){e.triggerEvent("change",a.html())}),r.on("focusin",function(t){e.triggerEvent("focusin",t)}).on("focusout",function(t){e.triggerEvent("focusout",t)}),!s.airMode&&s.height&&a.outerHeight(s.height),!s.airMode&&s.maxHeight&&a.css("max-height",s.maxHeight),!s.airMode&&s.minHeight&&a.css("min-height",s.minHeight),a.html(f.html(i)||f.emptyPara),m.recordUndo()},this.destroy=function(){a.off()},this.handleKeyMap=function(t){var n=s.keyMap[d.isMac?"mac":"pc"],i=[];t.metaKey&&i.push("CMD"),t.ctrlKey&&!t.altKey&&i.push("CTRL"),t.shiftKey&&i.push("SHIFT");var o=O.nameFromCode[t.keyCode];o&&i.push(o);var r=n[i.join("+")];r?(t.preventDefault(),e.invoke(r)):O.isEdit(t.keyCode)&&this.afterCommand()},this.createRange=function(){return this.focus(),F.create()},this.saveRange=function(t){this.focus(),a.data("range",F.create()),t&&F.create().collapse().select()},this.restoreRange=function(){var t=a.data("range");t&&(t.select(),this.focus())},this.saveTarget=function(t){a.data("target",t)},this.clearTarget=function(){a.removeData("target")},this.restoreTarget=function(){return a.data("target")},this.currentStyle=function(){var t=F.create();return t&&(t=t.normalize()),t?c.current(t):c.fromNode(a)},this.styleFromNode=function(t){return c.fromNode(t)},this.undo=function(){e.triggerEvent("before.command",a.html()),m.undo(),e.triggerEvent("change",a.html())},e.memo("help.undo",l.help.undo),this.redo=function(){e.triggerEvent("before.command",a.html()),m.redo(),e.triggerEvent("change",a.html())},e.memo("help.redo",l.help.redo);for(var g=this.beforeCommand=function(){e.triggerEvent("before.command",a.html()),n.focus()},v=this.afterCommand=function(t){m.recordUndo(),t||e.triggerEvent("change",a.html())},b=["bold","italic","underline","strikethrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","justifyFull","formatBlock","removeFormat","backColor","foreColor","fontName"],y=0,w=b.length;w>y;y++)this[b[y]]=function(t){return function(e){g(),document.execCommand(t,!1,e),v(!0)}}(b[y]),e.memo("help."+b[y],l.help[b[y]]);this.tab=function(){var t=this.createRange();t.isCollapsed()&&t.isOnCell()?u.tab(t):(g(),p.insertTab(a,t,s.tabSize),v())},e.memo("help.tab",l.help.tab),this.untab=function(){var t=this.createRange();t.isCollapsed()&&t.isOnCell()&&u.tab(t,!0)},e.memo("help.untab",l.help.untab),this.wrapCommand=function(t){return function(){g(),t.apply(n,arguments),v()}},this.insertParagraph=this.wrapCommand(function(){p.insertParagraph(a)}),e.memo("help.insertParagraph",l.help.insertParagraph),this.insertOrderedList=this.wrapCommand(function(){h.insertOrderedList(a)}),e.memo("help.insertOrderedList",l.help.insertOrderedList),this.insertUnorderedList=this.wrapCommand(function(){h.insertUnorderedList(a)}),e.memo("help.insertUnorderedList",l.help.insertUnorderedList),this.indent=this.wrapCommand(function(){h.indent(a)}),e.memo("help.indent",l.help.indent),this.outdent=this.wrapCommand(function(){h.outdent(a)}),e.memo("help.outdent",l.help.outdent),this.insertImage=function(t,n){return H.createImage(t,n).then(function(t){g(),"function"==typeof n?n(t):("string"==typeof n&&t.attr("data-filename",n),t.css("width",Math.min(a.width(),t.width()))),t.show(),F.create().insertNode(t[0]),F.createFromNodeAfter(t[0]).select(),v()}).fail(function(){e.triggerEvent("image.upload.error")})},this.insertImages=function(i){t.each(i,function(t,i){
var o=i.name;s.maximumImageFileSize&&s.maximumImageFileSize<i.size?e.triggerEvent("image.upload.error",l.image.maximumFileSizeError):H.readFileAsDataURL(i).then(function(t){return n.insertImage(t,o)}).fail(function(){e.triggerEvent("image.upload.error")})})},this.insertImagesOrCallback=function(t){var n=s.callbacks;n.onImageUpload?e.triggerEvent("image.upload",t):this.insertImages(t)},this.insertNode=this.wrapCommand(function(t){F.create().insertNode(t),F.createFromNodeAfter(t).select()}),this.insertText=this.wrapCommand(function(t){var e=F.create().insertNode(f.createText(t));F.create(e,f.nodeLength(e)).select()}),this.getSelectedText=function(){var t=this.createRange();return t.isOnAnchor()&&(t=F.createFromNode(f.ancestor(t.sc,f.isAnchor))),t.toString()},this.pasteHTML=this.wrapCommand(function(t){var e=F.create().pasteHTML(t);F.createFromNodeAfter(o.last(e)).select()}),this.formatBlock=this.wrapCommand(function(t){t=d.isMSIE?"<"+t+">":t,document.execCommand("FormatBlock",!1,t)}),this.formatPara=function(){this.formatBlock("P")},e.memo("help.formatPara",l.help.formatPara);for(var y=1;6>=y;y++)this["formatH"+y]=function(t){return function(){this.formatBlock("H"+t)}}(y),e.memo("help.formatH"+y,l.help["formatH"+y]);this.fontSize=function(e){this.focus();var n=F.create();if(n&&n.isCollapsed()){var i=c.styleNodes(n),r=o.head(i);t(i).css({"font-size":e+"px"}),r&&!f.nodeLength(r)&&(r.innerHTML=f.ZERO_WIDTH_NBSP_CHAR,F.createFromNodeAfter(r.firstChild).select(),a.data(W,r))}else g(),t(c.styleNodes(n)).css({"font-size":e+"px"}),v()},this.insertHorizontalRule=this.wrapCommand(function(){var e=F.create(),n=e.insertNode(t("<HR/>")[0]);n.nextSibling&&F.create(n.nextSibling,0).normalize().select()}),e.memo("help.insertHorizontalRule",l.help.insertHorizontalRule),this.removeBogus=function(){var t=a.data(W);if(t){var e=o.find(o.from(t.childNodes),f.isText),n=e.nodeValue.indexOf(f.ZERO_WIDTH_NBSP_CHAR);-1!==n&&e.deleteData(n,1),f.isEmpty(t)&&f.remove(t),a.removeData(W)}},this.lineHeight=this.wrapCommand(function(t){c.stylePara(F.create(),{lineHeight:t})}),this.unlink=function(){var t=this.createRange();if(t.isOnAnchor()){var e=f.ancestor(t.sc,f.isAnchor);t=F.createFromNode(e),t.select(),g(),document.execCommand("unlink"),v()}},this.createLink=this.wrapCommand(function(e){var n=e.url,i=e.text,r=e.isNewWindow,a=e.range||this.createRange(),l=a.toString()!==i;s.onCreateLink&&(n=s.onCreateLink(n));var d=[];if(l){var u=a.insertNode(t("<A>"+i+"</A>")[0]);d.push(u)}else d=c.styleNodes(a,{nodeName:"A",expandClosestSibling:!0,onlyPartialContains:!0});t.each(d,function(e,i){t(i).attr("href",n),r?t(i).attr("target","_blank"):t(i).removeAttr("target")});var p=F.createFromNodeBefore(o.head(d)),f=p.getStartPoint(),h=F.createFromNodeAfter(o.last(d)),m=h.getEndPoint();F.create(f.node,f.offset,m.node,m.offset).select()}),this.getLinkInfo=function(){this.focus();var e=F.create().expand(f.isAnchor),n=t(o.head(e.nodes(f.isAnchor)));return{range:e,text:e.toString(),isNewWindow:n.length?"_blank"===n.attr("target"):!1,url:n.length?n.attr("href"):""}},this.color=this.wrapCommand(function(t){var e=t.foreColor,n=t.backColor;e&&document.execCommand("foreColor",!1,e),n&&document.execCommand("backColor",!1,n)}),this.insertTable=this.wrapCommand(function(t){var e=t.split("x"),n=F.create().deleteContents();n.insertNode(u.createTable(e[0],e[1],s))}),this.floatMe=this.wrapCommand(function(e){var n=t(this.restoreTarget());n.css("float",e)}),this.resize=this.wrapCommand(function(e){var n=t(this.restoreTarget());n.css({width:100*e+"%",height:""})}),this.resizeTo=function(t,e,n){var i;if(n){var o=t.y/t.x,r=e.data("ratio");i={width:r>o?t.x:t.y/r,height:r>o?t.x*r:t.y}}else i={width:t.x,height:t.y};e.css(i)},this.removeMedia=this.wrapCommand(function(){var n=t(this.restoreTarget()).detach();e.triggerEvent("media.delete",n,a)}),this.hasFocus=function(){return a.is(":focus")},this.focus=function(){this.hasFocus()||(a.focus(),!this.hasFocus()&&d.isFF&&F.createFromNode(a[0]).normalize().collapse().select())},this.isEmpty=function(){return f.isEmpty(a[0])||f.emptyPara===a.html()},this.empty=function(){e.invoke("code",f.emptyPara)}},q=function(e){var n=this,i=e.layoutInfo.editable;this.events={"summernote.keydown":function(t,i){n.needKeydownHook()&&(i.ctrlKey||i.metaKey)&&i.keyCode===O.code.V&&(e.invoke("editor.saveRange"),n.$paste.focus(),setTimeout(function(){n.pasteByHook()},0))}},this.needKeydownHook=function(){return d.isMSIE&&d.browserVersion>10||d.isFF},this.initialize=function(){this.needKeydownHook()?(this.$paste=t("<div />").attr("contenteditable",!0).css({position:"absolute",left:-1e5,opacity:0}),i.before(this.$paste),this.$paste.on("paste",function(t){e.triggerEvent("paste",t)})):i.on("paste",this.pasteByEvent)},this.destroy=function(){this.needKeydownHook()&&(this.$paste.remove(),this.$paste=null)},this.pasteByHook=function(){var n=this.$paste[0].firstChild;if(f.isImg(n)){for(var i=n.src,o=atob(i.split(",")[1]),r=new Uint8Array(o.length),a=0;a<o.length;a++)r[a]=o.charCodeAt(a);var s=new Blob([r],{type:"image/png"});s.name="clipboard.png",e.invoke("editor.restoreRange"),e.invoke("editor.focus"),e.invoke("editor.insertImagesOrCallback",[s])}else{var l=t("<div />").html(this.$paste.html()).html();e.invoke("editor.restoreRange"),e.invoke("editor.focus"),l&&e.invoke("editor.pasteHTML",l)}this.$paste.empty()},this.pasteByEvent=function(t){var n=t.originalEvent.clipboardData;if(n&&n.items&&n.items.length){var i=o.head(n.items);"file"===i.kind&&-1!==i.type.indexOf("image/")&&e.invoke("editor.insertImagesOrCallback",[i.getAsFile()]),e.invoke("editor.afterCommand")}}},V=function(e){var n=t(document),i=e.layoutInfo.editor,o=e.layoutInfo.editable,r=e.options,a=r.langInfo,s=t(['<div class="note-dropzone">','  <div class="note-dropzone-message"/>',"</div>"].join("")).prependTo(i);this.initialize=function(){r.disableDragAndDrop?n.on("drop",function(t){t.preventDefault()}):this.attachDragAndDropEvent()},this.attachDragAndDropEvent=function(){var r=t(),l=s.find(".note-dropzone-message");n.on("dragenter",function(t){var n=e.invoke("codeview.isActivated"),o=i.width()>0&&i.height()>0;n||r.length||!o||(i.addClass("dragover"),s.width(i.width()),s.height(i.height()),l.text(a.image.dragImageHere)),r=r.add(t.target)}).on("dragleave",function(t){r=r.not(t.target),r.length||i.removeClass("dragover")}).on("drop",function(){r=t(),i.removeClass("dragover")}),s.on("dragenter",function(){s.addClass("hover"),l.text(a.image.dropImage)}).on("dragleave",function(){s.removeClass("hover"),l.text(a.image.dragImageHere)}),s.on("drop",function(n){var i=n.originalEvent.dataTransfer;i&&i.files&&i.files.length?(n.preventDefault(),o.focus(),e.invoke("editor.insertImagesOrCallback",i.files)):t.each(i.types,function(n,o){var r=i.getData(o);o.toLowerCase().indexOf("text")>-1?e.invoke("editor.pasteHTML",r):t(r).each(function(){e.invoke("editor.insertNode",this)})})}).on("dragover",!1)}};d.hasCodeMirror&&(d.isSupportAmd?!function(){var t=[n(27)];(function(t){P=t}).apply(null,t)}():P=window.CodeMirror);var G=function(t){var e=t.layoutInfo.editor,n=t.layoutInfo.editable,i=t.layoutInfo.codable,o=t.options;this.sync=function(){var t=this.isActivated();t&&d.hasCodeMirror&&i.data("cmEditor").save()},this.isActivated=function(){return e.hasClass("codeview")},this.toggle=function(){this.isActivated()?this.deactivate():this.activate(),t.triggerEvent("codeview.toggled")},this.activate=function(){if(i.val(f.html(n,o.prettifyHtml)),i.height(n.height()),t.invoke("toolbar.updateCodeview",!0),e.addClass("codeview"),i.focus(),d.hasCodeMirror){var r=P.fromTextArea(i[0],o.codemirror);if(o.codemirror.tern){var a=new P.TernServer(o.codemirror.tern);r.ternServer=a,r.on("cursorActivity",function(t){a.updateArgHints(t)})}r.setSize(null,n.outerHeight()),i.data("cmEditor",r)}},this.deactivate=function(){if(d.hasCodeMirror){var r=i.data("cmEditor");i.val(r.getValue()),r.toTextArea()}var a=f.value(i,o.prettifyHtml)||f.emptyPara,s=n.html()!==a;n.html(a),n.height(o.height?i.height():"auto"),e.removeClass("codeview"),s&&t.triggerEvent("change",n.html(),n),n.focus(),t.invoke("toolbar.updateCodeview",!1)},this.destroy=function(){this.isActivated()&&this.deactivate()}},K=24,X=function(e){var n=t(document),i=e.layoutInfo.statusbar,o=e.layoutInfo.editable,r=e.options;this.initialize=function(){r.airMode||r.disableResizeEditor||i.on("mousedown",function(t){t.preventDefault(),t.stopPropagation();var e=o.offset().top-n.scrollTop();n.on("mousemove",function(t){var n=t.clientY-(e+K);n=r.minheight>0?Math.max(n,r.minheight):n,n=r.maxHeight>0?Math.min(n,r.maxHeight):n,o.height(n)}).one("mouseup",function(){n.off("mousemove")})})},this.destroy=function(){i.off()}},Y=function(e){var n=e.layoutInfo.editor,i=e.layoutInfo.toolbar,o=e.layoutInfo.editable,r=e.layoutInfo.codable,a=t(window),s=t("html, body");this.toggle=function(){var t=function(t){o.css("height",t.h),r.css("height",t.h),r.data("cmeditor")&&r.data("cmeditor").setsize(null,t.h)};n.toggleClass("fullscreen");var l=n.hasClass("fullscreen");l?(o.data("orgHeight",o.css("height")),a.on("resize",function(){t({h:a.height()-i.outerHeight()})}).trigger("resize"),s.css("overflow","hidden")):(a.off("resize"),t({h:o.data("orgHeight")}),s.css("overflow","visible")),e.invoke("toolbar.updateFullscreen",l)}},Q=function(e){var n=this,i=t(document),o=e.layoutInfo.editingArea,r=e.options;this.events={"summernote.mousedown":function(t,e){n.update(e.target)&&e.preventDefault()},"summernote.keyup summernote.scroll summernote.change summernote.dialog.shown":function(){n.update()}},this.initialize=function(){this.$handle=t(['<div class="note-handle">','<div class="note-control-selection">','<div class="note-control-selection-bg"></div>','<div class="note-control-holder note-control-nw"></div>','<div class="note-control-holder note-control-ne"></div>','<div class="note-control-holder note-control-sw"></div>','<div class="',r.disableResizeImage?"note-control-holder":"note-control-sizing",' note-control-se"></div>',r.disableResizeImage?"":'<div class="note-control-selection-info"></div>',"</div>","</div>"].join("")).prependTo(o),this.$handle.on("mousedown",function(t){if(f.isControlSizing(t.target)){t.preventDefault(),t.stopPropagation();var o=n.$handle.find(".note-control-selection").data("target"),r=o.offset(),a=i.scrollTop();i.on("mousemove",function(t){e.invoke("editor.resizeTo",{x:t.clientX-r.left,y:t.clientY-(r.top-a)},o,!t.shiftKey),n.update(o[0])}).one("mouseup",function(t){t.preventDefault(),i.off("mousemove"),e.invoke("editor.afterCommand")}),o.data("ratio")||o.data("ratio",o.height()/o.width())}})},this.destroy=function(){this.$handle.remove()},this.update=function(n){var i=f.isImg(n),o=this.$handle.find(".note-control-selection");if(e.invoke("imagePopover.update",n),i){var r=t(n),a=r.position(),s={w:r.outerWidth(!0),h:r.outerHeight(!0)};o.css({display:"block",left:a.left,top:a.top,width:s.w,height:s.h}).data("target",r);var l=s.w+"x"+s.h;o.find(".note-control-selection-info").text(l),e.invoke("editor.saveTarget",n)}else this.hide();return i},this.hide=function(){e.invoke("editor.clearTarget"),this.$handle.children().hide()}},J=function(e){var n=this,i="http://",r=/^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|mailto:[A-Z0-9._%+-]+@)?(www\.)?(.+)$/i;this.events={"summernote.keyup":function(t,e){e.isDefaultPrevented()||n.handleKeyup(e)},"summernote.keydown":function(t,e){n.handleKeydown(e)}},this.initialize=function(){this.lastWordRange=null},this.destroy=function(){this.lastWordRange=null},this.replace=function(){if(this.lastWordRange){var n=this.lastWordRange.toString(),o=n.match(r);if(o&&(o[1]||o[2])){var a=o[1]?n:i+n,s=t("<a />").html(n).attr("href",a)[0];this.lastWordRange.insertNode(s),this.lastWordRange=null,e.invoke("editor.focus")}}},this.handleKeydown=function(t){if(o.contains([O.code.ENTER,O.code.SPACE],t.keyCode)){var n=e.invoke("editor.createRange").getWordRange();this.lastWordRange=n}},this.handleKeyup=function(t){o.contains([O.code.ENTER,O.code.SPACE],t.keyCode)&&this.replace()}},Z=function(t){var e=t.layoutInfo.note;this.events={"summernote.change":function(){e.val(t.invoke("code"))}},this.shouldInitialize=function(){return f.isTextarea(e[0])}},tt=function(e){var n=this,i=e.layoutInfo.editingArea,o=e.options;this.events={"summernote.init summernote.change":function(){n.update()},"summernote.codeview.toggled":function(){n.update()}},this.shouldInitialize=function(){return!!o.placeholder},this.initialize=function(){this.$placeholder=t('<div class="note-placeholder">'),this.$placeholder.on("click",function(){e.invoke("focus")}).text(o.placeholder).prependTo(i)},this.destroy=function(){this.$placeholder.remove()},this.update=function(){var t=!e.invoke("codeview.isActivated")&&e.invoke("editor.isEmpty");this.$placeholder.toggle(t)}},et=function(e){var n=this,r=t.summernote.ui,a=e.layoutInfo.toolbar,s=e.options,l=s.langInfo,c=i.invertObject(s.keyMap[d.isMac?"mac":"pc"]),u=this.representShortcut=function(t){var e=c[t];return d.isMac&&(e=e.replace("CMD","⌘").replace("SHIFT","⇧")),e=e.replace("BACKSLASH","\\").replace("SLASH","/").replace("LEFTBRACKET","[").replace("RIGHTBRACKET","]")," ("+e+")"};this.initialize=function(){this.addToolbarButtons(),this.addImagePopoverButtons(),this.addLinkPopoverButtons()},this.addToolbarButtons=function(){e.memo("button.style",function(){return r.buttonGroup([r.button({className:"dropdown-toggle",contents:r.icon(s.icons.magic)+" "+r.icon(s.icons.caret,"span"),tooltip:l.style.style,data:{toggle:"dropdown"}}),r.dropdown({className:"dropdown-style",items:e.options.styleTags,template:function(t){"string"==typeof t&&(t={tag:t,title:t});var e=t.tag,n=t.title,i=t.style?' style="'+t.style+'" ':"",o=t.className?' className="'+t.className+'"':"";return"<"+e+i+o+">"+n+"</"+e+">"},click:e.createInvokeHandler("editor.formatBlock")})]).render()}),e.memo("button.bold",function(){return r.button({className:"note-btn-bold",contents:r.icon(s.icons.bold),tooltip:l.font.bold+u("bold"),click:e.createInvokeHandler("editor.bold")}).render()}),e.memo("button.italic",function(){return r.button({className:"note-btn-italic",contents:r.icon(s.icons.italic),tooltip:l.font.italic+u("italic"),click:e.createInvokeHandler("editor.italic")}).render()}),e.memo("button.underline",function(){return r.button({className:"note-btn-underline",contents:r.icon(s.icons.underline),tooltip:l.font.underline+u("underline"),click:e.createInvokeHandler("editor.underline")}).render()}),e.memo("button.clear",function(){return r.button({contents:r.icon(s.icons.eraser),tooltip:l.font.clear+u("removeFormat"),click:e.createInvokeHandler("editor.removeFormat")}).render()}),e.memo("button.strikethrough",function(){return r.button({className:"note-btn-strikethrough",contents:r.icon(s.icons.strikethrough),tooltip:l.font.strikethrough+u("strikethrough"),click:e.createInvokeHandler("editor.strikethrough")}).render()}),e.memo("button.superscript",function(){return r.button({className:"note-btn-superscript",contents:r.icon(s.icons.superscript),tooltip:l.font.superscript,click:e.createInvokeHandler("editor.superscript")}).render()}),e.memo("button.subscript",function(){return r.button({className:"note-btn-subscript",contents:r.icon(s.icons.subscript),tooltip:l.font.subscript,click:e.createInvokeHandler("editor.subscript")}).render()}),e.memo("button.fontname",function(){return r.buttonGroup([r.button({className:"dropdown-toggle",contents:'<span class="note-current-fontname"/> '+r.icon(s.icons.caret,"span"),tooltip:l.font.name,data:{toggle:"dropdown"}}),r.dropdownCheck({className:"dropdown-fontname",checkClassName:s.icons.menuCheck,items:s.fontNames.filter(function(t){return d.isFontInstalled(t)||o.contains(s.fontNamesIgnoreCheck,t)}),template:function(t){return'<span style="font-family:'+t+'">'+t+"</span>"},click:e.createInvokeHandler("editor.fontName")})]).render()}),e.memo("button.fontsize",function(){return r.buttonGroup([r.button({className:"dropdown-toggle",contents:'<span class="note-current-fontsize"/>'+r.icon(s.icons.caret,"span"),tooltip:l.font.size,data:{toggle:"dropdown"}}),r.dropdownCheck({className:"dropdown-fontsize",checkClassName:s.icons.menuCheck,items:s.fontSizes,click:e.createInvokeHandler("editor.fontSize")})]).render()}),e.memo("button.color",function(){return r.buttonGroup({className:"note-color",children:[r.button({className:"note-current-color-button",contents:r.icon(s.icons.font+" note-recent-color"),tooltip:l.color.recent,click:e.createInvokeHandler("editor.color"),callback:function(t){var e=t.find(".note-recent-color");e.css({"background-color":"yellow"}),t.data("value",{backColor:"yellow"})}}),r.button({className:"dropdown-toggle",contents:r.icon(s.icons.caret,"span"),tooltip:l.color.more,data:{toggle:"dropdown"}}),r.dropdown({items:["<li>",'<div class="btn-group">','  <div class="note-palette-title">'+l.color.background+"</div>","  <div>",'    <button type="button" class="note-color-reset btn btn-default" data-event="backColor" data-value="inherit">',l.color.transparent,"    </button>","  </div>",'  <div class="note-holder" data-event="backColor"/>',"</div>",'<div class="btn-group">','  <div class="note-palette-title">'+l.color.foreground+"</div>","  <div>",'    <button type="button" class="note-color-reset btn btn-default" data-event="removeFormat" data-value="foreColor">',l.color.resetToDefault,"    </button>","  </div>",'  <div class="note-holder" data-event="foreColor"/>',"</div>","</li>"].join(""),callback:function(e){e.find(".note-holder").each(function(){var e=t(this);e.append(r.palette({colors:s.colors,eventName:e.data("event")}).render())})},click:function(n){var i=t(n.target),o=i.data("event"),r=i.data("value");if(o&&r){var a="backColor"===o?"background-color":"color",s=i.closest(".note-color").find(".note-recent-color"),l=i.closest(".note-color").find(".note-current-color-button"),c=l.data("value");c[o]=r,s.css(a,r),l.data("value",c),e.invoke("editor."+o,r)}}})]}).render()}),e.memo("button.ol",function(){return r.button({contents:r.icon(s.icons.unorderedlist),tooltip:l.lists.unordered+u("insertUnorderedList"),click:e.createInvokeHandler("editor.insertUnorderedList")}).render()}),e.memo("button.ul",function(){return r.button({contents:r.icon(s.icons.orderedlist),tooltip:l.lists.ordered+u("insertOrderedList"),click:e.createInvokeHandler("editor.insertOrderedList")}).render()});var a=r.button({contents:r.icon(s.icons.alignLeft),tooltip:l.paragraph.left+u("justifyLeft"),click:e.createInvokeHandler("editor.justifyLeft")}),c=r.button({contents:r.icon(s.icons.alignCenter),tooltip:l.paragraph.center+u("justifyCenter"),click:e.createInvokeHandler("editor.justifyCenter")}),p=r.button({contents:r.icon(s.icons.alignRight),tooltip:l.paragraph.right+u("justifyRight"),click:e.createInvokeHandler("editor.justifyRight")}),f=r.button({contents:r.icon(s.icons.alignJustify),tooltip:l.paragraph.justify+u("justifyFull"),click:e.createInvokeHandler("editor.justifyFull")}),h=r.button({contents:r.icon(s.icons.outdent),tooltip:l.paragraph.outdent+u("outdent"),click:e.createInvokeHandler("editor.outdent")}),m=r.button({contents:r.icon(s.icons.indent),tooltip:l.paragraph.indent+u("indent"),click:e.createInvokeHandler("editor.indent")});e.memo("button.justifyLeft",i.invoke(a,"render")),e.memo("button.justifyCenter",i.invoke(c,"render")),e.memo("button.justifyRight",i.invoke(p,"render")),e.memo("button.justifyFull",i.invoke(f,"render")),e.memo("button.outdent",i.invoke(h,"render")),e.memo("button.indent",i.invoke(m,"render")),e.memo("button.paragraph",function(){return r.buttonGroup([r.button({className:"dropdown-toggle",contents:r.icon(s.icons.align)+" "+r.icon(s.icons.caret,"span"),tooltip:l.paragraph.paragraph,data:{toggle:"dropdown"}}),r.dropdown([r.buttonGroup({className:"note-align",children:[a,c,p,f]}),r.buttonGroup({className:"note-list",children:[h,m]})])]).render()}),e.memo("button.height",function(){return r.buttonGroup([r.button({className:"dropdown-toggle",contents:r.icon(s.icons.textHeight)+" "+r.icon(s.icons.caret,"span"),tooltip:l.font.height,data:{toggle:"dropdown"}}),r.dropdownCheck({items:s.lineHeights,checkClassName:s.icons.menuCheck,className:"dropdown-line-height",click:e.createInvokeHandler("editor.lineHeight")})]).render()}),e.memo("button.table",function(){return r.buttonGroup([r.button({className:"dropdown-toggle",contents:r.icon(s.icons.table)+" "+r.icon(s.icons.caret,"span"),tooltip:l.table.table,data:{toggle:"dropdown"}}),r.dropdown({className:"note-table",items:['<div class="note-dimension-picker">','  <div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"/>','  <div class="note-dimension-picker-highlighted"/>','  <div class="note-dimension-picker-unhighlighted"/>',"</div>",'<div class="note-dimension-display">1 x 1</div>'].join("")})],{callback:function(t){var i=t.find(".note-dimension-picker-mousecatcher");i.css({width:s.insertTableMaxSize.col+"em",height:s.insertTableMaxSize.row+"em"}).mousedown(e.createInvokeHandler("editor.insertTable")).on("mousemove",n.tableMoveHandler)}}).render()}),e.memo("button.link",function(){return r.button({contents:r.icon(s.icons.link),tooltip:l.link.link,click:e.createInvokeHandler("linkDialog.show")}).render()}),e.memo("button.picture",function(){return r.button({contents:r.icon(s.icons.picture),tooltip:l.image.image,click:e.createInvokeHandler("imageDialog.show")}).render()}),e.memo("button.video",function(){return r.button({contents:r.icon(s.icons.video),tooltip:l.video.video,click:e.createInvokeHandler("videoDialog.show")}).render()}),e.memo("button.hr",function(){return r.button({contents:r.icon(s.icons.minus),tooltip:l.hr.insert+u("insertHorizontalRule"),click:e.createInvokeHandler("editor.insertHorizontalRule")}).render()}),e.memo("button.fullscreen",function(){return r.button({className:"btn-fullscreen",contents:r.icon(s.icons.arrowsAlt),tooltip:l.options.fullscreen,click:e.createInvokeHandler("fullscreen.toggle")}).render()}),e.memo("button.codeview",function(){return r.button({className:"btn-codeview",contents:r.icon(s.icons.code),tooltip:l.options.codeview,click:e.createInvokeHandler("codeview.toggle")}).render()}),e.memo("button.redo",function(){return r.button({contents:r.icon(s.icons.redo),tooltip:l.history.redo+u("redo"),click:e.createInvokeHandler("editor.redo")}).render()}),e.memo("button.undo",function(){return r.button({contents:r.icon(s.icons.undo),tooltip:l.history.undo+u("undo"),click:e.createInvokeHandler("editor.undo")}).render()}),e.memo("button.help",function(){return r.button({contents:r.icon(s.icons.question),tooltip:l.options.help,click:e.createInvokeHandler("helpDialog.show")}).render()})},this.addImagePopoverButtons=function(){e.memo("button.imageSize100",function(){return r.button({contents:'<span class="note-fontsize-10">100%</span>',tooltip:l.image.resizeFull,click:e.createInvokeHandler("editor.resize","1")}).render()}),e.memo("button.imageSize50",function(){return r.button({contents:'<span class="note-fontsize-10">50%</span>',tooltip:l.image.resizeHalf,click:e.createInvokeHandler("editor.resize","0.5")}).render()}),e.memo("button.imageSize25",function(){return r.button({contents:'<span class="note-fontsize-10">25%</span>',tooltip:l.image.resizeQuarter,click:e.createInvokeHandler("editor.resize","0.25")}).render()}),e.memo("button.floatLeft",function(){return r.button({contents:r.icon(s.icons.alignLeft),tooltip:l.image.floatLeft,click:e.createInvokeHandler("editor.floatMe","left")}).render()}),e.memo("button.floatRight",function(){return r.button({contents:r.icon(s.icons.alignRight),tooltip:l.image.floatRight,click:e.createInvokeHandler("editor.floatMe","right")}).render()}),e.memo("button.floatNone",function(){return r.button({contents:r.icon(s.icons.alignJustify),tooltip:l.image.floatNone,click:e.createInvokeHandler("editor.floatMe","none")}).render()}),e.memo("button.removeMedia",function(){return r.button({contents:r.icon(s.icons.trash),tooltip:l.image.remove,click:e.createInvokeHandler("editor.removeMedia")}).render()})},this.addLinkPopoverButtons=function(){e.memo("button.linkDialogShow",function(){return r.button({contents:r.icon(s.icons.link),tooltip:l.link.edit,click:e.createInvokeHandler("linkDialog.show")}).render()}),e.memo("button.unlink",function(){return r.button({contents:r.icon(s.icons.unlink),tooltip:l.link.unlink,click:e.createInvokeHandler("editor.unlink")}).render()})},this.build=function(t,n){for(var i=0,o=n.length;o>i;i++){for(var a=n[i],s=a[0],l=a[1],c=r.buttonGroup({className:"note-"+s}).render(),d=0,u=l.length;u>d;d++){var p=e.memo("button."+l[d]);p&&c.append("function"==typeof p?p():p)}c.appendTo(t)}},this.updateCurrentStyle=function(){var n=e.invoke("editor.currentStyle");if(this.updateBtnStates({".note-btn-bold":function(){return"bold"===n["font-bold"]},".note-btn-italic":function(){return"italic"===n["font-italic"]},".note-btn-underline":function(){return"underline"===n["font-underline"]},".note-btn-subscript":function(){return"subscript"===n["font-subscript"]},".note-btn-superscript":function(){return"superscript"===n["font-superscript"]},".note-btn-strikethrough":function(){return"strikethrough"===n["font-strikethrough"]}}),n["font-family"]){var i=n["font-family"].split(",").map(function(t){return t.replace(/[\'\"]/g,"").replace(/\s+$/,"").replace(/^\s+/,"")}),r=o.find(i,function(t){return d.isFontInstalled(t)||o.contains(s.fontNamesIgnoreCheck,t)});a.find(".dropdown-fontname li a").each(function(){var e=t(this).data("value")+""==r+"";this.className=e?"checked":""}),a.find(".note-current-fontname").text(r)}if(n["font-size"]){var l=n["font-size"];a.find(".dropdown-fontsize li a").each(function(){var e=t(this).data("value")+""==l+"";this.className=e?"checked":""}),a.find(".note-current-fontsize").text(l)}if(n["line-height"]){var c=n["line-height"];a.find(".dropdown-line-height li a").each(function(){var e=t(this).data("value")+""==c+"";this.className=e?"checked":""})}},this.updateBtnStates=function(e){t.each(e,function(t,e){r.toggleBtnActive(a.find(t),e())})},this.tableMoveHandler=function(e){var n,i=18,o=t(e.target.parentNode),r=o.next(),a=o.find(".note-dimension-picker-mousecatcher"),l=o.find(".note-dimension-picker-highlighted"),c=o.find(".note-dimension-picker-unhighlighted");if(void 0===e.offsetX){var d=t(e.target).offset();n={x:e.pageX-d.left,y:e.pageY-d.top}}else n={x:e.offsetX,y:e.offsetY};var u={c:Math.ceil(n.x/i)||1,r:Math.ceil(n.y/i)||1};l.css({width:u.c+"em",height:u.r+"em"}),a.data("value",u.c+"x"+u.r),3<u.c&&u.c<s.insertTableMaxSize.col&&c.css({width:u.c+1+"em"}),3<u.r&&u.r<s.insertTableMaxSize.row&&c.css({height:u.r+1+"em"}),r.html(u.c+" x "+u.r)}},nt=function(e){var n=t.summernote.ui,i=e.layoutInfo.note,o=e.layoutInfo.toolbar,r=e.options;this.shouldInitialize=function(){return!r.airMode},this.initialize=function(){r.toolbar=r.toolbar||[],r.toolbar.length?e.invoke("buttons.build",o,r.toolbar):o.hide(),r.toolbarContainer&&o.appendTo(r.toolbarContainer),i.on("summernote.keyup summernote.mouseup summernote.change",function(){e.invoke("buttons.updateCurrentStyle")}),e.invoke("buttons.updateCurrentStyle")},this.destroy=function(){o.children().remove()},this.updateFullscreen=function(t){n.toggleBtnActive(o.find(".btn-fullscreen"),t)},this.updateCodeview=function(t){n.toggleBtnActive(o.find(".btn-codeview"),t),t?this.deactivate():this.activate()},this.activate=function(t){var e=o.find("button");t||(e=e.not(".btn-codeview")),n.toggleBtn(e,!0)},this.deactivate=function(t){var e=o.find("button");t||(e=e.not(".btn-codeview")),n.toggleBtn(e,!1)}},it=function(e){var n=this,i=t.summernote.ui,o=e.layoutInfo.editor,r=e.options,a=r.langInfo;this.initialize=function(){var e=r.dialogsInBody?t(document.body):o,n='<div class="form-group"><label>'+a.link.textToDisplay+'</label><input class="note-link-text form-control" type="text" /></div><div class="form-group"><label>'+a.link.url+'</label><input class="note-link-url form-control" type="text" value="http://" /></div>'+(r.disableLinkTarget?"":'<div class="checkbox"><label><input type="checkbox" checked> '+a.link.openInNewWindow+"</label></div>"),s='<button href="#" class="btn btn-primary note-link-btn disabled" disabled>'+a.link.insert+"</button>";this.$dialog=i.dialog({className:"link-dialog",title:a.link.insert,fade:r.dialogsFade,body:n,footer:s}).render().appendTo(e)},this.destroy=function(){i.hideDialog(this.$dialog),this.$dialog.remove()},this.bindEnterKey=function(t,e){t.on("keypress",function(t){t.keyCode===O.code.ENTER&&e.trigger("click")})},this.showLinkDialog=function(o){return t.Deferred(function(t){var r=n.$dialog.find(".note-link-text"),a=n.$dialog.find(".note-link-url"),s=n.$dialog.find(".note-link-btn"),l=n.$dialog.find("input[type=checkbox]");i.onDialogShown(n.$dialog,function(){e.triggerEvent("dialog.shown"),r.val(o.text),r.on("input",function(){i.toggleBtn(s,r.val()&&a.val()),o.text=r.val()}),o.url||(o.url=o.text||"http://",i.toggleBtn(s,o.text)),a.on("input",function(){i.toggleBtn(s,r.val()&&a.val()),o.text||r.val(a.val())}).val(o.url).trigger("focus"),n.bindEnterKey(a,s),n.bindEnterKey(r,s),l.prop("checked",o.isNewWindow),s.one("click",function(e){e.preventDefault(),t.resolve({range:o.range,url:a.val(),text:r.val(),isNewWindow:l.is(":checked")}),n.$dialog.modal("hide")})}),i.onDialogHidden(n.$dialog,function(){r.off("input keypress"),a.off("input keypress"),s.off("click"),"pending"===t.state()&&t.reject()}),i.showDialog(n.$dialog)}).promise()},this.show=function(){var t=e.invoke("editor.getLinkInfo");e.invoke("editor.saveRange"),this.showLinkDialog(t).then(function(t){e.invoke("editor.restoreRange"),e.invoke("editor.createLink",t)}).fail(function(){e.invoke("editor.restoreRange")})},e.memo("help.linkDialog.show",r.langInfo.help["linkDialog.show"])},ot=function(e){var n=this,i=t.summernote.ui,r=e.options;this.events={"summernote.keyup summernote.mouseup summernote.change summernote.scroll":function(){n.update()},"summernote.dialog.shown":function(){n.hide()}},this.shouldInitialize=function(){return!o.isEmpty(r.popover.link)},this.initialize=function(){this.$popover=i.popover({className:"note-link-popover",callback:function(t){var e=t.find(".popover-content");e.prepend('<span><a target="_blank"></a>&nbsp;</span>')}}).render().appendTo("body");var t=this.$popover.find(".popover-content");e.invoke("buttons.build",t,r.popover.link)},this.destroy=function(){this.$popover.remove()},this.update=function(){if(!e.invoke("editor.hasFocus"))return void this.hide();var n=e.invoke("editor.createRange");if(n.isCollapsed()&&n.isOnAnchor()){var i=f.ancestor(n.sc,f.isAnchor),o=t(i).attr("href");this.$popover.find("a").attr("href",o).html(o);var r=f.posFromPlaceholder(i);this.$popover.css({display:"block",left:r.left,top:r.top})}else this.hide()},this.hide=function(){this.$popover.hide()}},rt=function(e){var n=this,i=t.summernote.ui,o=e.layoutInfo.editor,r=e.options,a=r.langInfo;this.initialize=function(){var e=r.dialogsInBody?t(document.body):o,n="";if(r.maximumImageFileSize){var s=Math.floor(Math.log(r.maximumImageFileSize)/Math.log(1024)),l=1*(r.maximumImageFileSize/Math.pow(1024,s)).toFixed(2)+" "+" KMGTP"[s]+"B";n="<small>"+a.image.maximumFileSize+" : "+l+"</small>"}var c='<div class="form-group note-group-select-from-files"><label>'+a.image.selectFromFiles+'</label><input class="note-image-input form-control" type="file" name="files" accept="image/*" multiple="multiple" />'+n+'</div><div class="form-group" style="overflow:auto;"><label>'+a.image.url+'</label><input class="note-image-url form-control col-md-12" type="text" /></div>',d='<button href="#" class="btn btn-primary note-image-btn disabled" disabled>'+a.image.insert+"</button>";this.$dialog=i.dialog({title:a.image.insert,fade:r.dialogsFade,body:c,footer:d}).render().appendTo(e)},this.destroy=function(){i.hideDialog(this.$dialog),this.$dialog.remove()},this.bindEnterKey=function(t,e){t.on("keypress",function(t){t.keyCode===O.code.ENTER&&e.trigger("click")})},this.show=function(){e.invoke("editor.saveRange"),this.showImageDialog().then(function(t){
i.hideDialog(n.$dialog),e.invoke("editor.restoreRange"),"string"==typeof t?e.invoke("editor.insertImage",t):e.invoke("editor.insertImagesOrCallback",t)}).fail(function(){e.invoke("editor.restoreRange")})},this.showImageDialog=function(){return t.Deferred(function(t){var o=n.$dialog.find(".note-image-input"),r=n.$dialog.find(".note-image-url"),a=n.$dialog.find(".note-image-btn");i.onDialogShown(n.$dialog,function(){e.triggerEvent("dialog.shown"),o.replaceWith(o.clone().on("change",function(){t.resolve(this.files||this.value)}).val("")),a.click(function(e){e.preventDefault(),t.resolve(r.val())}),r.on("keyup paste",function(){var t=r.val();i.toggleBtn(a,t)}).val("").trigger("focus"),n.bindEnterKey(r,a)}),i.onDialogHidden(n.$dialog,function(){o.off("change"),r.off("keyup paste keypress"),a.off("click"),"pending"===t.state()&&t.reject()}),i.showDialog(n.$dialog)})}},at=function(e){var n=t.summernote.ui,i=e.options;this.shouldInitialize=function(){return!o.isEmpty(i.popover.image)},this.initialize=function(){this.$popover=n.popover({className:"note-image-popover"}).render().appendTo("body");var t=this.$popover.find(".popover-content");e.invoke("buttons.build",t,i.popover.image)},this.destroy=function(){this.$popover.remove()},this.update=function(t){if(f.isImg(t)){var e=f.posFromPlaceholder(t);this.$popover.css({display:"block",left:e.left,top:e.top})}else this.hide()},this.hide=function(){this.$popover.hide()}},st=function(e){var n=this,i=t.summernote.ui,o=e.layoutInfo.editor,r=e.options,a=r.langInfo;this.initialize=function(){var e=r.dialogsInBody?t(document.body):o,n='<div class="form-group row-fluid"><label>'+a.video.url+' <small class="text-muted">'+a.video.providers+'</small></label><input class="note-video-url form-control span12" type="text" /></div>',s='<button href="#" class="btn btn-primary note-video-btn disabled" disabled>'+a.video.insert+"</button>";this.$dialog=i.dialog({title:a.video.insert,fade:r.dialogsFade,body:n,footer:s}).render().appendTo(e)},this.destroy=function(){i.hideDialog(this.$dialog),this.$dialog.remove()},this.bindEnterKey=function(t,e){t.on("keypress",function(t){t.keyCode===O.code.ENTER&&e.trigger("click")})},this.createVideoNode=function(e){var n,i=/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/,o=e.match(i),r=/\/\/instagram.com\/p\/(.[a-zA-Z0-9_-]*)/,a=e.match(r),s=/\/\/vine.co\/v\/(.[a-zA-Z0-9]*)/,l=e.match(s),c=/\/\/(player.)?vimeo.com\/([a-z]*\/)*([0-9]{6,11})[?]?.*/,d=e.match(c),u=/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/,p=e.match(u),f=/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/,h=e.match(f),m=/^.+.(mp4|m4v)$/,g=e.match(m),v=/^.+.(ogg|ogv)$/,b=e.match(v),y=/^.+.(webm)$/,w=e.match(y);if(o&&11===o[1].length){var x=o[1];n=t("<iframe>").attr("frameborder",0).attr("src","//www.youtube.com/embed/"+x).attr("width","640").attr("height","360")}else if(a&&a[0].length)n=t("<iframe>").attr("frameborder",0).attr("src",a[0]+"/embed/").attr("width","612").attr("height","710").attr("scrolling","no").attr("allowtransparency","true");else if(l&&l[0].length)n=t("<iframe>").attr("frameborder",0).attr("src",l[0]+"/embed/simple").attr("width","600").attr("height","600").attr("class","vine-embed");else if(d&&d[3].length)n=t("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("src","//player.vimeo.com/video/"+d[3]).attr("width","640").attr("height","360");else if(p&&p[2].length)n=t("<iframe>").attr("frameborder",0).attr("src","//www.dailymotion.com/embed/video/"+p[2]).attr("width","640").attr("height","360");else if(h&&h[1].length)n=t("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("frameborder",0).attr("height","498").attr("width","510").attr("src","//player.youku.com/embed/"+h[1]);else{if(!(g||b||w))return!1;n=t("<video controls>").attr("src",e).attr("width","640").attr("height","360")}return n.addClass("note-video-clip"),n[0]},this.show=function(){var t=e.invoke("editor.getSelectedText");e.invoke("editor.saveRange"),this.showVideoDialog(t).then(function(t){i.hideDialog(n.$dialog),e.invoke("editor.restoreRange");var o=n.createVideoNode(t);o&&e.invoke("editor.insertNode",o)}).fail(function(){e.invoke("editor.restoreRange")})},this.showVideoDialog=function(o){return t.Deferred(function(t){var r=n.$dialog.find(".note-video-url"),a=n.$dialog.find(".note-video-btn");i.onDialogShown(n.$dialog,function(){e.triggerEvent("dialog.shown"),r.val(o).on("input",function(){i.toggleBtn(a,r.val())}).trigger("focus"),a.click(function(e){e.preventDefault(),t.resolve(r.val())}),n.bindEnterKey(r,a)}),i.onDialogHidden(n.$dialog,function(){r.off("input"),a.off("click"),"pending"===t.state()&&t.reject()}),i.showDialog(n.$dialog)})}},lt=function(e){var n=this,i=t.summernote.ui,o=e.layoutInfo.editor,r=e.options,a=r.langInfo;this.createShortCutList=function(){var n=r.keyMap[d.isMac?"mac":"pc"];return Object.keys(n).map(function(i){var o=n[i],r=t('<div><div class="help-list-item"/></div>');return r.append(t("<label><kbd>"+i+"</kdb></label>").css({width:180,"margin-right":10})).append(t("<span/>").html(e.memo("help."+o)||o)),r.html()}).join("")},this.initialize=function(){var e=r.dialogsInBody?t(document.body):o,n=['<p class="text-center">','<a href="//summernote.org/" target="_blank">Summernote 0.7.3</a> · ','<a href="//github.com/summernote/summernote" target="_blank">Project</a> · ','<a href="//github.com/summernote/summernote/issues" target="_blank">Issues</a>',"</p>"].join("");this.$dialog=i.dialog({title:a.options.help,fade:r.dialogsFade,body:this.createShortCutList(),footer:n,callback:function(t){t.find(".modal-body").css({"max-height":300,overflow:"scroll"})}}).render().appendTo(e)},this.destroy=function(){i.hideDialog(this.$dialog),this.$dialog.remove()},this.showHelpDialog=function(){return t.Deferred(function(t){i.onDialogShown(n.$dialog,function(){e.triggerEvent("dialog.shown"),t.resolve()}),i.showDialog(n.$dialog)}).promise()},this.show=function(){e.invoke("editor.saveRange"),this.showHelpDialog().then(function(){e.invoke("editor.restoreRange")})}},ct=function(e){var n=this,r=t.summernote.ui,a=e.options,s=20;this.events={"summernote.keyup summernote.mouseup summernote.scroll":function(){n.update()},"summernote.change summernote.dialog.shown":function(){n.hide()},"summernote.focusout":function(t,e){d.isFF||e.relatedTarget&&f.ancestor(e.relatedTarget,i.eq(n.$popover[0]))||n.hide()}},this.shouldInitialize=function(){return a.airMode&&!o.isEmpty(a.popover.air)},this.initialize=function(){this.$popover=r.popover({className:"note-air-popover"}).render().appendTo("body");var t=this.$popover.find(".popover-content");e.invoke("buttons.build",t,a.popover.air)},this.destroy=function(){this.$popover.remove()},this.update=function(){var t=e.invoke("editor.currentStyle");if(t.range&&!t.range.isCollapsed()){var n=o.last(t.range.getClientRects());if(n){var r=i.rect2bnd(n);this.$popover.css({display:"block",left:Math.max(r.left+r.width/2,0)-s,top:r.top+r.height})}}else this.hide()},this.hide=function(){this.$popover.hide()}},dt=function(e){var n=this,r=t.summernote.ui,a=5,s=e.options.hint||[],l=e.options.hintDirection||"bottom",c=t.isArray(s)?s:[s];this.events={"summernote.keyup":function(t,e){e.isDefaultPrevented()||n.handleKeyup(e)},"summernote.keydown":function(t,e){n.handleKeydown(e)},"summernote.dialog.shown":function(){n.hide()}},this.shouldInitialize=function(){return c.length>0},this.initialize=function(){this.lastWordRange=null,this.$popover=r.popover({className:"note-hint-popover",hideArrow:!0,direction:""}).render().appendTo("body"),this.$popover.hide(),this.$content=this.$popover.find(".popover-content"),this.$content.on("click",".note-hint-item",function(){n.$content.find(".active").removeClass("active"),t(this).addClass("active"),n.replace()})},this.destroy=function(){this.$popover.remove()},this.selectItem=function(t){this.$content.find(".active").removeClass("active"),t.addClass("active"),this.$content[0].scrollTop=t[0].offsetTop-this.$content.innerHeight()/2},this.moveDown=function(){var t=this.$content.find(".note-hint-item.active"),e=t.next();if(e.length)this.selectItem(e);else{var n=t.parent().next();n.length||(n=this.$content.find(".note-hint-group").first()),this.selectItem(n.find(".note-hint-item").first())}},this.moveUp=function(){var t=this.$content.find(".note-hint-item.active"),e=t.prev();if(e.length)this.selectItem(e);else{var n=t.parent().prev();n.length||(n=this.$content.find(".note-hint-group").last()),this.selectItem(n.find(".note-hint-item").last())}},this.replace=function(){var t=this.$content.find(".note-hint-item.active");if(t.length){var n=this.nodeFromItem(t);this.lastWordRange.insertNode(n),F.createFromNode(n).collapse().select(),this.lastWordRange=null,this.hide(),e.invoke("editor.focus")}},this.nodeFromItem=function(t){var e=c[t.data("index")],n=t.data("item"),i=e.content?e.content(n):n;return"string"==typeof i&&(i=f.createText(i)),i},this.createItemTemplates=function(e,n){var i=c[e];return n.map(function(n,o){var r=t('<div class="note-hint-item"/>');return r.append(i.template?i.template(n):n+""),r.data({index:e,item:n}),0===e&&0===o&&r.addClass("active"),r})},this.handleKeydown=function(t){this.$popover.is(":visible")&&(t.keyCode===O.code.ENTER?(t.preventDefault(),this.replace()):t.keyCode===O.code.UP?(t.preventDefault(),this.moveUp()):t.keyCode===O.code.DOWN&&(t.preventDefault(),this.moveDown()))},this.searchKeyword=function(t,e,n){var i=c[t];if(i&&i.match.test(e)&&i.search){var o=i.match.exec(e);i.search(o[1],n)}else n()},this.createGroup=function(e,i){var o=t('<div class="note-hint-group note-hint-group-'+e+'"/>');return this.searchKeyword(e,i,function(t){t=t||[],t.length&&(o.html(n.createItemTemplates(e,t)),n.show())}),o},this.handleKeyup=function(t){if(o.contains([O.code.ENTER,O.code.UP,O.code.DOWN],t.keyCode)){if(t.keyCode===O.code.ENTER&&this.$popover.is(":visible"))return}else{var r=e.invoke("editor.createRange").getWordRange(),s=r.toString();if(c.length&&s){this.$content.empty();var d=i.rect2bnd(o.last(r.getClientRects()));d&&(this.$popover.hide(),this.lastWordRange=r,c.forEach(function(t,e){t.match.test(s)&&n.createGroup(e,s).appendTo(n.$content)}),"top"===l?this.$popover.css({left:d.left,top:d.top-this.$popover.outerHeight()-a}):this.$popover.css({left:d.left,top:d.top+d.height+a}))}else this.hide()}},this.show=function(){this.$popover.show()},this.hide=function(){this.$popover.hide()}};t.summernote=t.extend(t.summernote,{version:"0.7.3",ui:M,plugins:{},options:{modules:{editor:U,clipboard:q,dropzone:V,codeview:G,statusbar:X,fullscreen:Y,handle:Q,hintPopover:dt,autoLink:J,autoSync:Z,placeholder:tt,buttons:et,toolbar:nt,linkDialog:it,linkPopover:ot,imageDialog:rt,imagePopover:at,videoDialog:st,helpDialog:lt,airPopover:ct},buttons:{},lang:"en-US",toolbar:[["style",["style"]],["font",["bold","underline","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["view",["fullscreen","codeview","help"]]],popover:{image:[["imagesize",["imageSize100","imageSize50","imageSize25"]],["float",["floatLeft","floatRight","floatNone"]],["remove",["removeMedia"]]],link:[["link",["linkDialogShow","unlink"]]],air:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]]]},airMode:!1,width:null,height:null,focus:!1,tabSize:4,styleWithSpan:!0,shortcuts:!0,textareaAutoSync:!0,direction:null,styleTags:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],fontNames:["Arial","Arial Black","Comic Sans MS","Courier New","Helvetica Neue","Helvetica","Impact","Lucida Grande","Tahoma","Times New Roman","Verdana"],fontSizes:["8","9","10","11","12","14","18","24","36"],colors:[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],lineHeights:["1.0","1.2","1.4","1.5","1.6","1.8","2.0","3.0"],tableClassName:"table table-bordered",insertTableMaxSize:{col:10,row:10},dialogsInBody:!1,dialogsFade:!1,maximumImageFileSize:null,callbacks:{onInit:null,onFocus:null,onBlur:null,onEnter:null,onKeyup:null,onKeydown:null,onSubmit:null,onImageUpload:null,onImageUploadError:null},codemirror:{mode:"text/html",htmlMode:!0,lineNumbers:!0},keyMap:{pc:{ENTER:"insertParagraph","CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule","CTRL+K":"linkDialog.show"},mac:{ENTER:"insertParagraph","CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule","CMD+K":"linkDialog.show"}},icons:{align:"fa fa-align-left",alignCenter:"fa fa-align-center",alignJustify:"fa fa-align-justify",alignLeft:"fa fa-align-left",alignRight:"fa fa-align-right",indent:"fa fa-indent",outdent:"fa fa-outdent",arrowsAlt:"fa fa-arrows-alt",bold:"fa fa-bold",caret:"caret",circle:"fa fa-circle",close:"fa fa-close",code:"fa fa-code",eraser:"fa fa-eraser",font:"fa fa-font",frame:"fa fa-frame",italic:"fa fa-italic",link:"fa fa-link",unlink:"fa fa-chain-broken",magic:"fa fa-magic",menuCheck:"fa fa-check",minus:"fa fa-minus",orderedlist:"fa fa-list-ol",pencil:"fa fa-pencil",picture:"fa fa-picture-o",question:"fa fa-question",redo:"fa fa-repeat",square:"fa fa-square",strikethrough:"fa fa-strikethrough",subscript:"fa fa-subscript",superscript:"fa fa-superscript",table:"fa fa-table",textHeight:"fa fa-text-height",trash:"fa fa-trash",underline:"fa fa-underline",undo:"fa fa-undo",unorderedlist:"fa fa-list-ul",video:"fa fa-youtube-play"}}})})},function(t,e){(function(e){t.exports=e}).call(e,{})},function(t,e,n){!function(e){t.exports=e()}(function(){"use strict";function t(n,i){if(!(this instanceof t))return new t(n,i);this.options=i=i?$o(i):{},$o(Zr,i,!1),f(i);var o=i.value;"string"==typeof o&&(o=new Ca(o,i.mode,null,i.lineSeparator)),this.doc=o;var r=new t.inputStyles[i.inputStyle](this),a=this.display=new e(n,o,r);a.wrapper.CodeMirror=this,c(this),s(this),i.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),i.autofocus&&!Dr&&a.input.focus(),v(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new Eo,keySeq:null,specialChars:null};var l=this;yr&&11>wr&&setTimeout(function(){l.display.input.reset(!0)},20),je(this),Yo(),we(this),this.curOp.forceUpdate=!0,Yi(this,o),i.autofocus&&!Dr||l.hasFocus()?setTimeout(Bo(vn,this),20):bn(this);for(var d in ta)ta.hasOwnProperty(d)&&ta[d](this,i[d],ea);k(this),i.finishInit&&i.finishInit(this);for(var u=0;u<ra.length;++u)ra[u](this);ke(this),xr&&i.lineWrapping&&"optimizelegibility"==getComputedStyle(a.lineDiv).textRendering&&(a.lineDiv.style.textRendering="auto")}function e(t,e,n){var i=this;this.input=n,i.scrollbarFiller=Wo("div",null,"CodeMirror-scrollbar-filler"),i.scrollbarFiller.setAttribute("cm-not-content","true"),i.gutterFiller=Wo("div",null,"CodeMirror-gutter-filler"),i.gutterFiller.setAttribute("cm-not-content","true"),i.lineDiv=Wo("div",null,"CodeMirror-code"),i.selectionDiv=Wo("div",null,null,"position: relative; z-index: 1"),i.cursorDiv=Wo("div",null,"CodeMirror-cursors"),i.measure=Wo("div",null,"CodeMirror-measure"),i.lineMeasure=Wo("div",null,"CodeMirror-measure"),i.lineSpace=Wo("div",[i.measure,i.lineMeasure,i.selectionDiv,i.cursorDiv,i.lineDiv],null,"position: relative; outline: none"),i.mover=Wo("div",[Wo("div",[i.lineSpace],"CodeMirror-lines")],null,"position: relative"),i.sizer=Wo("div",[i.mover],"CodeMirror-sizer"),i.sizerWidth=null,i.heightForcer=Wo("div",null,null,"position: absolute; height: "+Pa+"px; width: 1px;"),i.gutters=Wo("div",null,"CodeMirror-gutters"),i.lineGutter=null,i.scroller=Wo("div",[i.sizer,i.heightForcer,i.gutters],"CodeMirror-scroll"),i.scroller.setAttribute("tabIndex","-1"),i.wrapper=Wo("div",[i.scrollbarFiller,i.gutterFiller,i.scroller],"CodeMirror"),yr&&8>wr&&(i.gutters.style.zIndex=-1,i.scroller.style.paddingRight=0),xr||gr&&Dr||(i.scroller.draggable=!0),t&&(t.appendChild?t.appendChild(i.wrapper):t(i.wrapper)),i.viewFrom=i.viewTo=e.first,i.reportedViewFrom=i.reportedViewTo=e.first,i.view=[],i.renderedView=null,i.externalMeasured=null,i.viewOffset=0,i.lastWrapHeight=i.lastWrapWidth=0,i.updateLineNumbers=null,i.nativeBarWidth=i.barHeight=i.barWidth=0,i.scrollbarsClipped=!1,i.lineNumWidth=i.lineNumInnerWidth=i.lineNumChars=null,i.alignWidgets=!1,i.cachedCharWidth=i.cachedTextHeight=i.cachedPaddingH=null,i.maxLine=null,i.maxLineLength=0,i.maxLineChanged=!1,i.wheelDX=i.wheelDY=i.wheelStartX=i.wheelStartY=null,i.shift=!1,i.selForContextMenu=null,i.activeTouch=null,n.init(i)}function n(e){e.doc.mode=t.getMode(e.options,e.doc.modeOption),i(e)}function i(t){t.doc.iter(function(t){t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null)}),t.doc.frontier=t.doc.first,Bt(t,100),t.state.modeGen++,t.curOp&&Oe(t)}function o(t){t.options.lineWrapping?(Qa(t.display.wrapper,"CodeMirror-wrap"),t.display.sizer.style.minWidth="",t.display.sizerWidth=null):(Ya(t.display.wrapper,"CodeMirror-wrap"),p(t)),a(t),Oe(t),se(t),setTimeout(function(){b(t)},100)}function r(t){var e=be(t.display),n=t.options.lineWrapping,i=n&&Math.max(5,t.display.scroller.clientWidth/ye(t.display)-3);return function(o){if(ki(t.doc,o))return 0;var r=0;if(o.widgets)for(var a=0;a<o.widgets.length;a++)o.widgets[a].height&&(r+=o.widgets[a].height);return n?r+(Math.ceil(o.text.length/i)||1)*e:r+e}}function a(t){var e=t.doc,n=r(t);e.iter(function(t){var e=n(t);e!=t.height&&to(t,e)})}function s(t){t.display.wrapper.className=t.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+t.options.theme.replace(/(^|\s)\s*/g," cm-s-"),se(t)}function l(t){c(t),Oe(t),setTimeout(function(){x(t)},20)}function c(t){var e=t.display.gutters,n=t.options.gutters;Uo(e);for(var i=0;i<n.length;++i){var o=n[i],r=e.appendChild(Wo("div",null,"CodeMirror-gutter "+o));"CodeMirror-linenumbers"==o&&(t.display.lineGutter=r,r.style.width=(t.display.lineNumWidth||1)+"px")}e.style.display=i?"":"none",d(t)}function d(t){var e=t.display.gutters.offsetWidth;t.display.sizer.style.marginLeft=e+"px"}function u(t){if(0==t.height)return 0;for(var e,n=t.text.length,i=t;e=mi(i);){var o=e.find(0,!0);i=o.from.line,n+=o.from.ch-o.to.ch}for(i=t;e=gi(i);){var o=e.find(0,!0);n-=i.text.length-o.from.ch,i=o.to.line,n+=i.text.length-o.to.ch}return n}function p(t){var e=t.display,n=t.doc;e.maxLine=Qi(n,n.first),e.maxLineLength=u(e.maxLine),e.maxLineChanged=!0,n.iter(function(t){var n=u(t);n>e.maxLineLength&&(e.maxLineLength=n,e.maxLine=t)})}function f(t){var e=Po(t.gutters,"CodeMirror-linenumbers");-1==e&&t.lineNumbers?t.gutters=t.gutters.concat(["CodeMirror-linenumbers"]):e>-1&&!t.lineNumbers&&(t.gutters=t.gutters.slice(0),t.gutters.splice(e,1))}function h(t){var e=t.display,n=e.gutters.offsetWidth,i=Math.round(t.doc.height+Ut(t.display));return{clientHeight:e.scroller.clientHeight,viewHeight:e.wrapper.clientHeight,scrollWidth:e.scroller.scrollWidth,clientWidth:e.scroller.clientWidth,viewWidth:e.wrapper.clientWidth,barLeft:t.options.fixedGutter?n:0,docHeight:i,scrollHeight:i+Vt(t)+e.barHeight,nativeBarWidth:e.nativeBarWidth,gutterWidth:n}}function m(t,e,n){this.cm=n;var i=this.vert=Wo("div",[Wo("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),o=this.horiz=Wo("div",[Wo("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");t(i),t(o),Da(i,"scroll",function(){i.clientHeight&&e(i.scrollTop,"vertical")}),Da(o,"scroll",function(){o.clientWidth&&e(o.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,yr&&8>wr&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}function g(){}function v(e){e.display.scrollbars&&(e.display.scrollbars.clear(),e.display.scrollbars.addClass&&Ya(e.display.wrapper,e.display.scrollbars.addClass)),e.display.scrollbars=new t.scrollbarModel[e.options.scrollbarStyle](function(t){e.display.wrapper.insertBefore(t,e.display.scrollbarFiller),Da(t,"mousedown",function(){e.state.focused&&setTimeout(function(){e.display.input.focus()},0)}),t.setAttribute("cm-not-content","true")},function(t,n){"horizontal"==n?rn(e,t):on(e,t)},e),e.display.scrollbars.addClass&&Qa(e.display.wrapper,e.display.scrollbars.addClass)}function b(t,e){e||(e=h(t));var n=t.display.barWidth,i=t.display.barHeight;y(t,e);for(var o=0;4>o&&n!=t.display.barWidth||i!=t.display.barHeight;o++)n!=t.display.barWidth&&t.options.lineWrapping&&E(t),y(t,h(t)),n=t.display.barWidth,i=t.display.barHeight}function y(t,e){var n=t.display,i=n.scrollbars.update(e);n.sizer.style.paddingRight=(n.barWidth=i.right)+"px",n.sizer.style.paddingBottom=(n.barHeight=i.bottom)+"px",n.heightForcer.style.borderBottom=i.bottom+"px solid transparent",i.right&&i.bottom?(n.scrollbarFiller.style.display="block",n.scrollbarFiller.style.height=i.bottom+"px",n.scrollbarFiller.style.width=i.right+"px"):n.scrollbarFiller.style.display="",i.bottom&&t.options.coverGutterNextToScrollbar&&t.options.fixedGutter?(n.gutterFiller.style.display="block",n.gutterFiller.style.height=i.bottom+"px",n.gutterFiller.style.width=e.gutterWidth+"px"):n.gutterFiller.style.display=""}function w(t,e,n){var i=n&&null!=n.top?Math.max(0,n.top):t.scroller.scrollTop;i=Math.floor(i-Wt(t));var o=n&&null!=n.bottom?n.bottom:i+t.wrapper.clientHeight,r=no(e,i),a=no(e,o);if(n&&n.ensure){var s=n.ensure.from.line,l=n.ensure.to.line;r>s?(r=s,a=no(e,io(Qi(e,s))+t.wrapper.clientHeight)):Math.min(l,e.lastLine())>=a&&(r=no(e,io(Qi(e,l))-t.wrapper.clientHeight),a=l)}return{from:r,to:Math.max(a,r+1)}}function x(t){var e=t.display,n=e.view;if(e.alignWidgets||e.gutters.firstChild&&t.options.fixedGutter){for(var i=T(e)-e.scroller.scrollLeft+t.doc.scrollLeft,o=e.gutters.offsetWidth,r=i+"px",a=0;a<n.length;a++)if(!n[a].hidden){t.options.fixedGutter&&n[a].gutter&&(n[a].gutter.style.left=r);var s=n[a].alignable;if(s)for(var l=0;l<s.length;l++)s[l].style.left=r}t.options.fixedGutter&&(e.gutters.style.left=i+o+"px")}}function k(t){if(!t.options.lineNumbers)return!1;var e=t.doc,n=C(t.options,e.first+e.size-1),i=t.display;if(n.length!=i.lineNumChars){var o=i.measure.appendChild(Wo("div",[Wo("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),r=o.firstChild.offsetWidth,a=o.offsetWidth-r;return i.lineGutter.style.width="",i.lineNumInnerWidth=Math.max(r,i.lineGutter.offsetWidth-a)+1,i.lineNumWidth=i.lineNumInnerWidth+a,i.lineNumChars=i.lineNumInnerWidth?n.length:-1,i.lineGutter.style.width=i.lineNumWidth+"px",d(t),!0}return!1}function C(t,e){return String(t.lineNumberFormatter(e+t.firstLineNumber))}function T(t){return t.scroller.getBoundingClientRect().left-t.sizer.getBoundingClientRect().left}function S(t,e,n){var i=t.display;this.viewport=e,this.visible=w(i,t.doc,e),this.editorIsHidden=!i.wrapper.offsetWidth,this.wrapperHeight=i.wrapper.clientHeight,this.wrapperWidth=i.wrapper.clientWidth,this.oldDisplayWidth=Gt(t),this.force=n,this.dims=M(t),this.events=[]}function _(t){var e=t.display;!e.scrollbarsClipped&&e.scroller.offsetWidth&&(e.nativeBarWidth=e.scroller.offsetWidth-e.scroller.clientWidth,e.heightForcer.style.height=Vt(t)+"px",e.sizer.style.marginBottom=-e.nativeBarWidth+"px",e.sizer.style.borderRightWidth=Vt(t)+"px",e.scrollbarsClipped=!0)}function I(t,e){var n=t.display,i=t.doc;if(e.editorIsHidden)return He(t),!1;if(!e.force&&e.visible.from>=n.viewFrom&&e.visible.to<=n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo)&&n.renderedView==n.view&&0==ze(t))return!1;k(t)&&(He(t),e.dims=M(t));var o=i.first+i.size,r=Math.max(e.visible.from-t.options.viewportMargin,i.first),a=Math.min(o,e.visible.to+t.options.viewportMargin);n.viewFrom<r&&r-n.viewFrom<20&&(r=Math.max(i.first,n.viewFrom)),n.viewTo>a&&n.viewTo-a<20&&(a=Math.min(o,n.viewTo)),Fr&&(r=wi(t.doc,r),a=xi(t.doc,a));var s=r!=n.viewFrom||a!=n.viewTo||n.lastWrapHeight!=e.wrapperHeight||n.lastWrapWidth!=e.wrapperWidth;Re(t,r,a),n.viewOffset=io(Qi(t.doc,n.viewFrom)),t.display.mover.style.top=n.viewOffset+"px";var l=ze(t);if(!s&&0==l&&!e.force&&n.renderedView==n.view&&(null==n.updateLineNumbers||n.updateLineNumbers>=n.viewTo))return!1;var c=Vo();return l>4&&(n.lineDiv.style.display="none"),P(t,n.updateLineNumbers,e.dims),l>4&&(n.lineDiv.style.display=""),n.renderedView=n.view,c&&Vo()!=c&&c.offsetHeight&&c.focus(),Uo(n.cursorDiv),Uo(n.selectionDiv),n.gutters.style.height=n.sizer.style.minHeight=0,s&&(n.lastWrapHeight=e.wrapperHeight,n.lastWrapWidth=e.wrapperWidth,Bt(t,400)),n.updateLineNumbers=null,!0}function L(t,e){for(var n=e.viewport,i=!0;(i&&t.options.lineWrapping&&e.oldDisplayWidth!=Gt(t)||(n&&null!=n.top&&(n={top:Math.min(t.doc.height+Ut(t.display)-Kt(t),n.top)}),e.visible=w(t.display,t.doc,n),!(e.visible.from>=t.display.viewFrom&&e.visible.to<=t.display.viewTo)))&&I(t,e);i=!1){E(t);var o=h(t);Pt(t),b(t,o),N(t,o)}e.signal(t,"update",t),(t.display.viewFrom!=t.display.reportedViewFrom||t.display.viewTo!=t.display.reportedViewTo)&&(e.signal(t,"viewportChange",t,t.display.viewFrom,t.display.viewTo),t.display.reportedViewFrom=t.display.viewFrom,t.display.reportedViewTo=t.display.viewTo)}function D(t,e){var n=new S(t,e);if(I(t,n)){E(t),L(t,n);var i=h(t);Pt(t),b(t,i),N(t,i),n.finish()}}function N(t,e){t.display.sizer.style.minHeight=e.docHeight+"px",t.display.heightForcer.style.top=e.docHeight+"px",t.display.gutters.style.height=e.docHeight+t.display.barHeight+Vt(t)+"px"}function E(t){for(var e=t.display,n=e.lineDiv.offsetTop,i=0;i<e.view.length;i++){var o,r=e.view[i];if(!r.hidden){if(yr&&8>wr){var a=r.node.offsetTop+r.node.offsetHeight;o=a-n,n=a}else{var s=r.node.getBoundingClientRect();o=s.bottom-s.top}var l=r.line.height-o;if(2>o&&(o=be(e)),(l>.001||-.001>l)&&(to(r.line,o),A(r.line),r.rest))for(var c=0;c<r.rest.length;c++)A(r.rest[c])}}}function A(t){if(t.widgets)for(var e=0;e<t.widgets.length;++e)t.widgets[e].height=t.widgets[e].node.parentNode.offsetHeight}function M(t){for(var e=t.display,n={},i={},o=e.gutters.clientLeft,r=e.gutters.firstChild,a=0;r;r=r.nextSibling,++a)n[t.options.gutters[a]]=r.offsetLeft+r.clientLeft+o,i[t.options.gutters[a]]=r.clientWidth;return{fixedPos:T(e),gutterTotalWidth:e.gutters.offsetWidth,gutterLeft:n,gutterWidth:i,wrapperWidth:e.wrapper.clientWidth}}function P(t,e,n){function i(e){var n=e.nextSibling;return xr&&Nr&&t.display.currentWheelTarget==e?e.style.display="none":e.parentNode.removeChild(e),n}for(var o=t.display,r=t.options.lineNumbers,a=o.lineDiv,s=a.firstChild,l=o.view,c=o.viewFrom,d=0;d<l.length;d++){var u=l[d];if(u.hidden);else if(u.node&&u.node.parentNode==a){for(;s!=u.node;)s=i(s);var p=r&&null!=e&&c>=e&&u.lineNumber;u.changes&&(Po(u.changes,"gutter")>-1&&(p=!1),O(t,u,c,n)),p&&(Uo(u.lineNumber),u.lineNumber.appendChild(document.createTextNode(C(t.options,c)))),s=u.node.nextSibling}else{var f=W(t,u,c,n);a.insertBefore(f,s)}c+=u.size}for(;s;)s=i(s)}function O(t,e,n,i){for(var o=0;o<e.changes.length;o++){var r=e.changes[o];"text"==r?B(t,e):"gutter"==r?z(t,e,n,i):"class"==r?R(e):"widget"==r&&j(t,e,i)}e.changes=null}function F(t){return t.node==t.text&&(t.node=Wo("div",null,null,"position: relative"),t.text.parentNode&&t.text.parentNode.replaceChild(t.node,t.text),t.node.appendChild(t.text),yr&&8>wr&&(t.node.style.zIndex=2)),t.node}function H(t){var e=t.bgClass?t.bgClass+" "+(t.line.bgClass||""):t.line.bgClass;if(e&&(e+=" CodeMirror-linebackground"),t.background)e?t.background.className=e:(t.background.parentNode.removeChild(t.background),t.background=null);else if(e){var n=F(t);t.background=n.insertBefore(Wo("div",null,e),n.firstChild)}}function $(t,e){var n=t.display.externalMeasured;return n&&n.line==e.line?(t.display.externalMeasured=null,e.measure=n.measure,n.built):$i(t,e)}function B(t,e){var n=e.text.className,i=$(t,e);e.text==e.node&&(e.node=i.pre),e.text.parentNode.replaceChild(i.pre,e.text),e.text=i.pre,i.bgClass!=e.bgClass||i.textClass!=e.textClass?(e.bgClass=i.bgClass,e.textClass=i.textClass,R(e)):n&&(e.text.className=n)}function R(t){H(t),t.line.wrapClass?F(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var e=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=e||""}function z(t,e,n,i){if(e.gutter&&(e.node.removeChild(e.gutter),e.gutter=null),e.gutterBackground&&(e.node.removeChild(e.gutterBackground),e.gutterBackground=null),e.line.gutterClass){var o=F(e);e.gutterBackground=Wo("div",null,"CodeMirror-gutter-background "+e.line.gutterClass,"left: "+(t.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px; width: "+i.gutterTotalWidth+"px"),o.insertBefore(e.gutterBackground,e.text)}var r=e.line.gutterMarkers;if(t.options.lineNumbers||r){var o=F(e),a=e.gutter=Wo("div",null,"CodeMirror-gutter-wrapper","left: "+(t.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px");if(t.display.input.setUneditable(a),o.insertBefore(a,e.text),e.line.gutterClass&&(a.className+=" "+e.line.gutterClass),!t.options.lineNumbers||r&&r["CodeMirror-linenumbers"]||(e.lineNumber=a.appendChild(Wo("div",C(t.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+i.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+t.display.lineNumInnerWidth+"px"))),r)for(var s=0;s<t.options.gutters.length;++s){var l=t.options.gutters[s],c=r.hasOwnProperty(l)&&r[l];c&&a.appendChild(Wo("div",[c],"CodeMirror-gutter-elt","left: "+i.gutterLeft[l]+"px; width: "+i.gutterWidth[l]+"px"))}}}function j(t,e,n){e.alignable&&(e.alignable=null);for(var i,o=e.node.firstChild;o;o=i){var i=o.nextSibling;"CodeMirror-linewidget"==o.className&&e.node.removeChild(o)}U(t,e,n)}function W(t,e,n,i){var o=$(t,e);return e.text=e.node=o.pre,o.bgClass&&(e.bgClass=o.bgClass),o.textClass&&(e.textClass=o.textClass),R(e),z(t,e,n,i),U(t,e,i),e.node}function U(t,e,n){if(q(t,e.line,e,n,!0),e.rest)for(var i=0;i<e.rest.length;i++)q(t,e.rest[i],e,n,!1)}function q(t,e,n,i,o){if(e.widgets)for(var r=F(n),a=0,s=e.widgets;a<s.length;++a){var l=s[a],c=Wo("div",[l.node],"CodeMirror-linewidget");l.handleMouseEvents||c.setAttribute("cm-ignore-events","true"),V(l,c,n,i),t.display.input.setUneditable(c),o&&l.above?r.insertBefore(c,n.gutter||n.text):r.appendChild(c),So(l,"redraw")}}function V(t,e,n,i){if(t.noHScroll){(n.alignable||(n.alignable=[])).push(e);var o=i.wrapperWidth;e.style.left=i.fixedPos+"px",t.coverGutter||(o-=i.gutterTotalWidth,e.style.paddingLeft=i.gutterTotalWidth+"px"),e.style.width=o+"px"}t.coverGutter&&(e.style.zIndex=5,e.style.position="relative",t.noHScroll||(e.style.marginLeft=-i.gutterTotalWidth+"px"));
}function G(t){return Hr(t.line,t.ch)}function K(t,e){return $r(t,e)<0?e:t}function X(t,e){return $r(t,e)<0?t:e}function Y(t){t.state.focused||(t.display.input.focus(),vn(t))}function Q(t,e,n,i,o){var r=t.doc;t.display.shift=!1,i||(i=r.sel);var a=t.state.pasteIncoming||"paste"==o,s=r.splitLines(e),l=null;if(a&&i.ranges.length>1)if(Br&&Br.join("\n")==e){if(i.ranges.length%Br.length==0){l=[];for(var c=0;c<Br.length;c++)l.push(r.splitLines(Br[c]))}}else s.length==i.ranges.length&&(l=Oo(s,function(t){return[t]}));for(var c=i.ranges.length-1;c>=0;c--){var d=i.ranges[c],u=d.from(),p=d.to();d.empty()&&(n&&n>0?u=Hr(u.line,u.ch-n):t.state.overwrite&&!a&&(p=Hr(p.line,Math.min(Qi(r,p.line).text.length,p.ch+Mo(s).length))));var f=t.curOp.updateInput,h={from:u,to:p,text:l?l[c%l.length]:s,origin:o||(a?"paste":t.state.cutIncoming?"cut":"+input")};_n(t.doc,h),So(t,"inputRead",t,h)}e&&!a&&Z(t,e),$n(t),t.curOp.updateInput=f,t.curOp.typing=!0,t.state.pasteIncoming=t.state.cutIncoming=!1}function J(t,e){var n=t.clipboardData&&t.clipboardData.getData("text/plain");return n?(t.preventDefault(),e.isReadOnly()||e.options.disableInput||De(e,function(){Q(e,n,0,null,"paste")}),!0):void 0}function Z(t,e){if(t.options.electricChars&&t.options.smartIndent)for(var n=t.doc.sel,i=n.ranges.length-1;i>=0;i--){var o=n.ranges[i];if(!(o.head.ch>100||i&&n.ranges[i-1].head.line==o.head.line)){var r=t.getModeAt(o.head),a=!1;if(r.electricChars){for(var s=0;s<r.electricChars.length;s++)if(e.indexOf(r.electricChars.charAt(s))>-1){a=Rn(t,o.head.line,"smart");break}}else r.electricInput&&r.electricInput.test(Qi(t.doc,o.head.line).text.slice(0,o.head.ch))&&(a=Rn(t,o.head.line,"smart"));a&&So(t,"electricInput",t,o.head.line)}}}function tt(t){for(var e=[],n=[],i=0;i<t.doc.sel.ranges.length;i++){var o=t.doc.sel.ranges[i].head.line,r={anchor:Hr(o,0),head:Hr(o+1,0)};n.push(r),e.push(t.getRange(r.anchor,r.head))}return{text:e,ranges:n}}function et(t){t.setAttribute("autocorrect","off"),t.setAttribute("autocapitalize","off"),t.setAttribute("spellcheck","false")}function nt(t){this.cm=t,this.prevInput="",this.pollingFast=!1,this.polling=new Eo,this.inaccurateSelection=!1,this.hasSelection=!1,this.composing=null}function it(){var t=Wo("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none"),e=Wo("div",[t],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return xr?t.style.width="1000px":t.setAttribute("wrap","off"),Lr&&(t.style.border="1px solid black"),et(t),e}function ot(t){this.cm=t,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Eo,this.gracePeriod=!1}function rt(t,e){var n=Zt(t,e.line);if(!n||n.hidden)return null;var i=Qi(t.doc,e.line),o=Yt(n,i,e.line),r=oo(i),a="left";if(r){var s=dr(r,e.ch);a=s%2?"right":"left"}var l=ne(o.map,e.ch,a);return l.offset="right"==l.collapse?l.end:l.start,l}function at(t,e){return e&&(t.bad=!0),t}function st(t,e,n){var i;if(e==t.display.lineDiv){if(i=t.display.lineDiv.childNodes[n],!i)return at(t.clipPos(Hr(t.display.viewTo-1)),!0);e=null,n=0}else for(i=e;;i=i.parentNode){if(!i||i==t.display.lineDiv)return null;if(i.parentNode&&i.parentNode==t.display.lineDiv)break}for(var o=0;o<t.display.view.length;o++){var r=t.display.view[o];if(r.node==i)return lt(r,e,n)}}function lt(t,e,n){function i(e,n,i){for(var o=-1;o<(d?d.length:0);o++)for(var r=0>o?c.map:d[o],a=0;a<r.length;a+=3){var s=r[a+2];if(s==e||s==n){var l=eo(0>o?t.line:t.rest[o]),u=r[a]+i;return(0>i||s!=e)&&(u=r[a+(i?1:0)]),Hr(l,u)}}}var o=t.text.firstChild,r=!1;if(!e||!Ga(o,e))return at(Hr(eo(t.line),0),!0);if(e==o&&(r=!0,e=o.childNodes[n],n=0,!e)){var a=t.rest?Mo(t.rest):t.line;return at(Hr(eo(a),a.text.length),r)}var s=3==e.nodeType?e:null,l=e;for(s||1!=e.childNodes.length||3!=e.firstChild.nodeType||(s=e.firstChild,n&&(n=s.nodeValue.length));l.parentNode!=o;)l=l.parentNode;var c=t.measure,d=c.maps,u=i(s,l,n);if(u)return at(u,r);for(var p=l.nextSibling,f=s?s.nodeValue.length-n:0;p;p=p.nextSibling){if(u=i(p,p.firstChild,0))return at(Hr(u.line,u.ch-f),r);f+=p.textContent.length}for(var h=l.previousSibling,f=n;h;h=h.previousSibling){if(u=i(h,h.firstChild,-1))return at(Hr(u.line,u.ch+f),r);f+=p.textContent.length}}function ct(t,e,n,i,o){function r(t){return function(e){return e.id==t}}function a(e){if(1==e.nodeType){var n=e.getAttribute("cm-text");if(null!=n)return""==n&&(n=e.textContent.replace(/\u200b/g,"")),void(s+=n);var d,u=e.getAttribute("cm-marker");if(u){var p=t.findMarks(Hr(i,0),Hr(o+1,0),r(+u));return void(p.length&&(d=p[0].find())&&(s+=Ji(t.doc,d.from,d.to).join(c)))}if("false"==e.getAttribute("contenteditable"))return;for(var f=0;f<e.childNodes.length;f++)a(e.childNodes[f]);/^(pre|div|p)$/i.test(e.nodeName)&&(l=!0)}else if(3==e.nodeType){var h=e.nodeValue;if(!h)return;l&&(s+=c,l=!1),s+=h}}for(var s="",l=!1,c=t.doc.lineSeparator();a(e),e!=n;)e=e.nextSibling;return s}function dt(t,e){this.ranges=t,this.primIndex=e}function ut(t,e){this.anchor=t,this.head=e}function pt(t,e){var n=t[e];t.sort(function(t,e){return $r(t.from(),e.from())}),e=Po(t,n);for(var i=1;i<t.length;i++){var o=t[i],r=t[i-1];if($r(r.to(),o.from())>=0){var a=X(r.from(),o.from()),s=K(r.to(),o.to()),l=r.empty()?o.from()==o.head:r.from()==r.head;e>=i&&--e,t.splice(--i,2,new ut(l?s:a,l?a:s))}}return new dt(t,e)}function ft(t,e){return new dt([new ut(t,e||t)],0)}function ht(t,e){return Math.max(t.first,Math.min(e,t.first+t.size-1))}function mt(t,e){if(e.line<t.first)return Hr(t.first,0);var n=t.first+t.size-1;return e.line>n?Hr(n,Qi(t,n).text.length):gt(e,Qi(t,e.line).text.length)}function gt(t,e){var n=t.ch;return null==n||n>e?Hr(t.line,e):0>n?Hr(t.line,0):t}function vt(t,e){return e>=t.first&&e<t.first+t.size}function bt(t,e){for(var n=[],i=0;i<e.length;i++)n[i]=mt(t,e[i]);return n}function yt(t,e,n,i){if(t.cm&&t.cm.display.shift||t.extend){var o=e.anchor;if(i){var r=$r(n,o)<0;r!=$r(i,o)<0?(o=n,n=i):r!=$r(n,i)<0&&(n=i)}return new ut(o,n)}return new ut(i||n,n)}function wt(t,e,n,i){_t(t,new dt([yt(t,t.sel.primary(),e,n)],0),i)}function xt(t,e,n){for(var i=[],o=0;o<t.sel.ranges.length;o++)i[o]=yt(t,t.sel.ranges[o],e[o],null);var r=pt(i,t.sel.primIndex);_t(t,r,n)}function kt(t,e,n,i){var o=t.sel.ranges.slice(0);o[e]=n,_t(t,pt(o,t.sel.primIndex),i)}function Ct(t,e,n,i){_t(t,ft(e,n),i)}function Tt(t,e,n){var i={ranges:e.ranges,update:function(e){this.ranges=[];for(var n=0;n<e.length;n++)this.ranges[n]=new ut(mt(t,e[n].anchor),mt(t,e[n].head))},origin:n&&n.origin};return Aa(t,"beforeSelectionChange",t,i),t.cm&&Aa(t.cm,"beforeSelectionChange",t.cm,i),i.ranges!=e.ranges?pt(i.ranges,i.ranges.length-1):e}function St(t,e,n){var i=t.history.done,o=Mo(i);o&&o.ranges?(i[i.length-1]=e,It(t,e,n)):_t(t,e,n)}function _t(t,e,n){It(t,e,n),po(t,t.sel,t.cm?t.cm.curOp.id:NaN,n)}function It(t,e,n){(Do(t,"beforeSelectionChange")||t.cm&&Do(t.cm,"beforeSelectionChange"))&&(e=Tt(t,e,n));var i=n&&n.bias||($r(e.primary().head,t.sel.primary().head)<0?-1:1);Lt(t,Nt(t,e,i,!0)),n&&n.scroll===!1||!t.cm||$n(t.cm)}function Lt(t,e){e.equals(t.sel)||(t.sel=e,t.cm&&(t.cm.curOp.updateInput=t.cm.curOp.selectionChanged=!0,Lo(t.cm)),So(t,"cursorActivity",t))}function Dt(t){Lt(t,Nt(t,t.sel,null,!1),Fa)}function Nt(t,e,n,i){for(var o,r=0;r<e.ranges.length;r++){var a=e.ranges[r],s=e.ranges.length==t.sel.ranges.length&&t.sel.ranges[r],l=At(t,a.anchor,s&&s.anchor,n,i),c=At(t,a.head,s&&s.head,n,i);(o||l!=a.anchor||c!=a.head)&&(o||(o=e.ranges.slice(0,r)),o[r]=new ut(l,c))}return o?pt(o,e.primIndex):e}function Et(t,e,n,i,o){var r=Qi(t,e.line);if(r.markedSpans)for(var a=0;a<r.markedSpans.length;++a){var s=r.markedSpans[a],l=s.marker;if((null==s.from||(l.inclusiveLeft?s.from<=e.ch:s.from<e.ch))&&(null==s.to||(l.inclusiveRight?s.to>=e.ch:s.to>e.ch))){if(o&&(Aa(l,"beforeCursorEnter"),l.explicitlyCleared)){if(r.markedSpans){--a;continue}break}if(!l.atomic)continue;if(n){var c,d=l.find(0>i?1:-1);if((0>i?l.inclusiveRight:l.inclusiveLeft)&&(d=Mt(t,d,-i,d&&d.line==e.line?r:null)),d&&d.line==e.line&&(c=$r(d,n))&&(0>i?0>c:c>0))return Et(t,d,e,i,o)}var u=l.find(0>i?-1:1);return(0>i?l.inclusiveLeft:l.inclusiveRight)&&(u=Mt(t,u,i,u.line==e.line?r:null)),u?Et(t,u,e,i,o):null}}return e}function At(t,e,n,i,o){var r=i||1,a=Et(t,e,n,r,o)||!o&&Et(t,e,n,r,!0)||Et(t,e,n,-r,o)||!o&&Et(t,e,n,-r,!0);return a?a:(t.cantEdit=!0,Hr(t.first,0))}function Mt(t,e,n,i){return 0>n&&0==e.ch?e.line>t.first?mt(t,Hr(e.line-1)):null:n>0&&e.ch==(i||Qi(t,e.line)).text.length?e.line<t.first+t.size-1?Hr(e.line+1,0):null:new Hr(e.line,e.ch+n)}function Pt(t){t.display.input.showSelection(t.display.input.prepareSelection())}function Ot(t,e){for(var n=t.doc,i={},o=i.cursors=document.createDocumentFragment(),r=i.selection=document.createDocumentFragment(),a=0;a<n.sel.ranges.length;a++)if(e!==!1||a!=n.sel.primIndex){var s=n.sel.ranges[a];if(!(s.from().line>=t.display.viewTo||s.to().line<t.display.viewFrom)){var l=s.empty();(l||t.options.showCursorWhenSelecting)&&Ft(t,s.head,o),l||Ht(t,s,r)}}return i}function Ft(t,e,n){var i=fe(t,e,"div",null,null,!t.options.singleCursorHeightPerLine),o=n.appendChild(Wo("div"," ","CodeMirror-cursor"));if(o.style.left=i.left+"px",o.style.top=i.top+"px",o.style.height=Math.max(0,i.bottom-i.top)*t.options.cursorHeight+"px",i.other){var r=n.appendChild(Wo("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));r.style.display="",r.style.left=i.other.left+"px",r.style.top=i.other.top+"px",r.style.height=.85*(i.other.bottom-i.other.top)+"px"}}function Ht(t,e,n){function i(t,e,n,i){0>e&&(e=0),e=Math.round(e),i=Math.round(i),s.appendChild(Wo("div",null,"CodeMirror-selected","position: absolute; left: "+t+"px; top: "+e+"px; width: "+(null==n?d-t:n)+"px; height: "+(i-e)+"px"))}function o(e,n,o){function r(n,i){return pe(t,Hr(e,n),"div",u,i)}var s,l,u=Qi(a,e),p=u.text.length;return er(oo(u),n||0,null==o?p:o,function(t,e,a){var u,f,h,m=r(t,"left");if(t==e)u=m,f=h=m.left;else{if(u=r(e-1,"right"),"rtl"==a){var g=m;m=u,u=g}f=m.left,h=u.right}null==n&&0==t&&(f=c),u.top-m.top>3&&(i(f,m.top,null,m.bottom),f=c,m.bottom<u.top&&i(f,m.bottom,null,u.top)),null==o&&e==p&&(h=d),(!s||m.top<s.top||m.top==s.top&&m.left<s.left)&&(s=m),(!l||u.bottom>l.bottom||u.bottom==l.bottom&&u.right>l.right)&&(l=u),c+1>f&&(f=c),i(f,u.top,h-f,u.bottom)}),{start:s,end:l}}var r=t.display,a=t.doc,s=document.createDocumentFragment(),l=qt(t.display),c=l.left,d=Math.max(r.sizerWidth,Gt(t)-r.sizer.offsetLeft)-l.right,u=e.from(),p=e.to();if(u.line==p.line)o(u.line,u.ch,p.ch);else{var f=Qi(a,u.line),h=Qi(a,p.line),m=bi(f)==bi(h),g=o(u.line,u.ch,m?f.text.length+1:null).end,v=o(p.line,m?0:null,p.ch).start;m&&(g.top<v.top-2?(i(g.right,g.top,null,g.bottom),i(c,v.top,v.left,v.bottom)):i(g.right,g.top,v.left-g.right,g.bottom)),g.bottom<v.top&&i(c,g.bottom,null,v.top)}n.appendChild(s)}function $t(t){if(t.state.focused){var e=t.display;clearInterval(e.blinker);var n=!0;e.cursorDiv.style.visibility="",t.options.cursorBlinkRate>0?e.blinker=setInterval(function(){e.cursorDiv.style.visibility=(n=!n)?"":"hidden"},t.options.cursorBlinkRate):t.options.cursorBlinkRate<0&&(e.cursorDiv.style.visibility="hidden")}}function Bt(t,e){t.doc.mode.startState&&t.doc.frontier<t.display.viewTo&&t.state.highlight.set(e,Bo(Rt,t))}function Rt(t){var e=t.doc;if(e.frontier<e.first&&(e.frontier=e.first),!(e.frontier>=t.display.viewTo)){var n=+new Date+t.options.workTime,i=sa(e.mode,jt(t,e.frontier)),o=[];e.iter(e.frontier,Math.min(e.first+e.size,t.display.viewTo+500),function(r){if(e.frontier>=t.display.viewFrom){var a=r.styles,s=r.text.length>t.options.maxHighlightLength,l=Pi(t,r,s?sa(e.mode,i):i,!0);r.styles=l.styles;var c=r.styleClasses,d=l.classes;d?r.styleClasses=d:c&&(r.styleClasses=null);for(var u=!a||a.length!=r.styles.length||c!=d&&(!c||!d||c.bgClass!=d.bgClass||c.textClass!=d.textClass),p=0;!u&&p<a.length;++p)u=a[p]!=r.styles[p];u&&o.push(e.frontier),r.stateAfter=s?i:sa(e.mode,i)}else r.text.length<=t.options.maxHighlightLength&&Fi(t,r.text,i),r.stateAfter=e.frontier%5==0?sa(e.mode,i):null;return++e.frontier,+new Date>n?(Bt(t,t.options.workDelay),!0):void 0}),o.length&&De(t,function(){for(var e=0;e<o.length;e++)Fe(t,o[e],"text")})}}function zt(t,e,n){for(var i,o,r=t.doc,a=n?-1:e-(t.doc.mode.innerMode?1e3:100),s=e;s>a;--s){if(s<=r.first)return r.first;var l=Qi(r,s-1);if(l.stateAfter&&(!n||s<=r.frontier))return s;var c=Ba(l.text,null,t.options.tabSize);(null==o||i>c)&&(o=s-1,i=c)}return o}function jt(t,e,n){var i=t.doc,o=t.display;if(!i.mode.startState)return!0;var r=zt(t,e,n),a=r>i.first&&Qi(i,r-1).stateAfter;return a=a?sa(i.mode,a):la(i.mode),i.iter(r,e,function(n){Fi(t,n.text,a);var s=r==e-1||r%5==0||r>=o.viewFrom&&r<o.viewTo;n.stateAfter=s?sa(i.mode,a):null,++r}),n&&(i.frontier=r),a}function Wt(t){return t.lineSpace.offsetTop}function Ut(t){return t.mover.offsetHeight-t.lineSpace.offsetHeight}function qt(t){if(t.cachedPaddingH)return t.cachedPaddingH;var e=qo(t.measure,Wo("pre","x")),n=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,i={left:parseInt(n.paddingLeft),right:parseInt(n.paddingRight)};return isNaN(i.left)||isNaN(i.right)||(t.cachedPaddingH=i),i}function Vt(t){return Pa-t.display.nativeBarWidth}function Gt(t){return t.display.scroller.clientWidth-Vt(t)-t.display.barWidth}function Kt(t){return t.display.scroller.clientHeight-Vt(t)-t.display.barHeight}function Xt(t,e,n){var i=t.options.lineWrapping,o=i&&Gt(t);if(!e.measure.heights||i&&e.measure.width!=o){var r=e.measure.heights=[];if(i){e.measure.width=o;for(var a=e.text.firstChild.getClientRects(),s=0;s<a.length-1;s++){var l=a[s],c=a[s+1];Math.abs(l.bottom-c.bottom)>2&&r.push((l.bottom+c.top)/2-n.top)}}r.push(n.bottom-n.top)}}function Yt(t,e,n){if(t.line==e)return{map:t.measure.map,cache:t.measure.cache};for(var i=0;i<t.rest.length;i++)if(t.rest[i]==e)return{map:t.measure.maps[i],cache:t.measure.caches[i]};for(var i=0;i<t.rest.length;i++)if(eo(t.rest[i])>n)return{map:t.measure.maps[i],cache:t.measure.caches[i],before:!0}}function Qt(t,e){e=bi(e);var n=eo(e),i=t.display.externalMeasured=new Me(t.doc,e,n);i.lineN=n;var o=i.built=$i(t,i);return i.text=o.pre,qo(t.display.lineMeasure,o.pre),i}function Jt(t,e,n,i){return ee(t,te(t,e),n,i)}function Zt(t,e){if(e>=t.display.viewFrom&&e<t.display.viewTo)return t.display.view[$e(t,e)];var n=t.display.externalMeasured;return n&&e>=n.lineN&&e<n.lineN+n.size?n:void 0}function te(t,e){var n=eo(e),i=Zt(t,n);i&&!i.text?i=null:i&&i.changes&&(O(t,i,n,M(t)),t.curOp.forceUpdate=!0),i||(i=Qt(t,e));var o=Yt(i,e,n);return{line:e,view:i,rect:null,map:o.map,cache:o.cache,before:o.before,hasHeights:!1}}function ee(t,e,n,i,o){e.before&&(n=-1);var r,a=n+(i||"");return e.cache.hasOwnProperty(a)?r=e.cache[a]:(e.rect||(e.rect=e.view.text.getBoundingClientRect()),e.hasHeights||(Xt(t,e.view,e.rect),e.hasHeights=!0),r=ie(t,e,n,i),r.bogus||(e.cache[a]=r)),{left:r.left,right:r.right,top:o?r.rtop:r.top,bottom:o?r.rbottom:r.bottom}}function ne(t,e,n){for(var i,o,r,a,s=0;s<t.length;s+=3){var l=t[s],c=t[s+1];if(l>e?(o=0,r=1,a="left"):c>e?(o=e-l,r=o+1):(s==t.length-3||e==c&&t[s+3]>e)&&(r=c-l,o=r-1,e>=c&&(a="right")),null!=o){if(i=t[s+2],l==c&&n==(i.insertLeft?"left":"right")&&(a=n),"left"==n&&0==o)for(;s&&t[s-2]==t[s-3]&&t[s-1].insertLeft;)i=t[(s-=3)+2],a="left";if("right"==n&&o==c-l)for(;s<t.length-3&&t[s+3]==t[s+4]&&!t[s+5].insertLeft;)i=t[(s+=3)+2],a="right";break}}return{node:i,start:o,end:r,collapse:a,coverStart:l,coverEnd:c}}function ie(t,e,n,i){var o,r=ne(e.map,n,i),a=r.node,s=r.start,l=r.end,c=r.collapse;if(3==a.nodeType){for(var d=0;4>d;d++){for(;s&&jo(e.line.text.charAt(r.coverStart+s));)--s;for(;r.coverStart+l<r.coverEnd&&jo(e.line.text.charAt(r.coverStart+l));)++l;if(yr&&9>wr&&0==s&&l==r.coverEnd-r.coverStart)o=a.parentNode.getBoundingClientRect();else if(yr&&t.options.lineWrapping){var u=Wa(a,s,l).getClientRects();o=u.length?u["right"==i?u.length-1:0]:Wr}else o=Wa(a,s,l).getBoundingClientRect()||Wr;if(o.left||o.right||0==s)break;l=s,s-=1,c="right"}yr&&11>wr&&(o=oe(t.display.measure,o))}else{s>0&&(c=i="right");var u;o=t.options.lineWrapping&&(u=a.getClientRects()).length>1?u["right"==i?u.length-1:0]:a.getBoundingClientRect()}if(yr&&9>wr&&!s&&(!o||!o.left&&!o.right)){var p=a.parentNode.getClientRects()[0];o=p?{left:p.left,right:p.left+ye(t.display),top:p.top,bottom:p.bottom}:Wr}for(var f=o.top-e.rect.top,h=o.bottom-e.rect.top,m=(f+h)/2,g=e.view.measure.heights,d=0;d<g.length-1&&!(m<g[d]);d++);var v=d?g[d-1]:0,b=g[d],y={left:("right"==c?o.right:o.left)-e.rect.left,right:("left"==c?o.left:o.right)-e.rect.left,top:v,bottom:b};return o.left||o.right||(y.bogus=!0),t.options.singleCursorHeightPerLine||(y.rtop=f,y.rbottom=h),y}function oe(t,e){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!tr(t))return e;var n=screen.logicalXDPI/screen.deviceXDPI,i=screen.logicalYDPI/screen.deviceYDPI;return{left:e.left*n,right:e.right*n,top:e.top*i,bottom:e.bottom*i}}function re(t){if(t.measure&&(t.measure.cache={},t.measure.heights=null,t.rest))for(var e=0;e<t.rest.length;e++)t.measure.caches[e]={}}function ae(t){t.display.externalMeasure=null,Uo(t.display.lineMeasure);for(var e=0;e<t.display.view.length;e++)re(t.display.view[e])}function se(t){ae(t),t.display.cachedCharWidth=t.display.cachedTextHeight=t.display.cachedPaddingH=null,t.options.lineWrapping||(t.display.maxLineChanged=!0),t.display.lineNumChars=null}function le(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function ce(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function de(t,e,n,i){if(e.widgets)for(var o=0;o<e.widgets.length;++o)if(e.widgets[o].above){var r=Si(e.widgets[o]);n.top+=r,n.bottom+=r}if("line"==i)return n;i||(i="local");var a=io(e);if("local"==i?a+=Wt(t.display):a-=t.display.viewOffset,"page"==i||"window"==i){var s=t.display.lineSpace.getBoundingClientRect();a+=s.top+("window"==i?0:ce());var l=s.left+("window"==i?0:le());n.left+=l,n.right+=l}return n.top+=a,n.bottom+=a,n}function ue(t,e,n){if("div"==n)return e;var i=e.left,o=e.top;if("page"==n)i-=le(),o-=ce();else if("local"==n||!n){var r=t.display.sizer.getBoundingClientRect();i+=r.left,o+=r.top}var a=t.display.lineSpace.getBoundingClientRect();return{left:i-a.left,top:o-a.top}}function pe(t,e,n,i,o){return i||(i=Qi(t.doc,e.line)),de(t,i,Jt(t,i,e.ch,o),n)}function fe(t,e,n,i,o,r){function a(e,a){var s=ee(t,o,e,a?"right":"left",r);return a?s.left=s.right:s.right=s.left,de(t,i,s,n)}function s(t,e){var n=l[e],i=n.level%2;return t==nr(n)&&e&&n.level<l[e-1].level?(n=l[--e],t=ir(n)-(n.level%2?0:1),i=!0):t==ir(n)&&e<l.length-1&&n.level<l[e+1].level&&(n=l[++e],t=nr(n)-n.level%2,i=!1),i&&t==n.to&&t>n.from?a(t-1):a(t,i)}i=i||Qi(t.doc,e.line),o||(o=te(t,i));var l=oo(i),c=e.ch;if(!l)return a(c);var d=dr(l,c),u=s(c,d);return null!=rs&&(u.other=s(c,rs)),u}function he(t,e){var n=0,e=mt(t.doc,e);t.options.lineWrapping||(n=ye(t.display)*e.ch);var i=Qi(t.doc,e.line),o=io(i)+Wt(t.display);return{left:n,right:n,top:o,bottom:o+i.height}}function me(t,e,n,i){var o=Hr(t,e);return o.xRel=i,n&&(o.outside=!0),o}function ge(t,e,n){var i=t.doc;if(n+=t.display.viewOffset,0>n)return me(i.first,0,!0,-1);var o=no(i,n),r=i.first+i.size-1;if(o>r)return me(i.first+i.size-1,Qi(i,r).text.length,!0,1);0>e&&(e=0);for(var a=Qi(i,o);;){var s=ve(t,a,o,e,n),l=gi(a),c=l&&l.find(0,!0);if(!l||!(s.ch>c.from.ch||s.ch==c.from.ch&&s.xRel>0))return s;o=eo(a=c.to.line)}}function ve(t,e,n,i,o){function r(i){var o=fe(t,Hr(n,i),"line",e,c);return s=!0,a>o.bottom?o.left-l:a<o.top?o.left+l:(s=!1,o.left)}var a=o-io(e),s=!1,l=2*t.display.wrapper.clientWidth,c=te(t,e),d=oo(e),u=e.text.length,p=or(e),f=rr(e),h=r(p),m=s,g=r(f),v=s;if(i>g)return me(n,f,v,1);for(;;){if(d?f==p||f==pr(e,p,1):1>=f-p){for(var b=h>i||g-i>=i-h?p:f,y=i-(b==p?h:g);jo(e.text.charAt(b));)++b;var w=me(n,b,b==p?m:v,-1>y?-1:y>1?1:0);return w}var x=Math.ceil(u/2),k=p+x;if(d){k=p;for(var C=0;x>C;++C)k=pr(e,k,1)}var T=r(k);T>i?(f=k,g=T,(v=s)&&(g+=1e3),u=x):(p=k,h=T,m=s,u-=x)}}function be(t){if(null!=t.cachedTextHeight)return t.cachedTextHeight;if(null==Rr){Rr=Wo("pre");for(var e=0;49>e;++e)Rr.appendChild(document.createTextNode("x")),Rr.appendChild(Wo("br"));Rr.appendChild(document.createTextNode("x"))}qo(t.measure,Rr);var n=Rr.offsetHeight/50;return n>3&&(t.cachedTextHeight=n),Uo(t.measure),n||1}function ye(t){if(null!=t.cachedCharWidth)return t.cachedCharWidth;var e=Wo("span","xxxxxxxxxx"),n=Wo("pre",[e]);qo(t.measure,n);var i=e.getBoundingClientRect(),o=(i.right-i.left)/10;return o>2&&(t.cachedCharWidth=o),o||10}function we(t){t.curOp={cm:t,viewChanged:!1,startHeight:t.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++qr},Ur?Ur.ops.push(t.curOp):t.curOp.ownsGroup=Ur={ops:[t.curOp],delayedCallbacks:[]}}function xe(t){var e=t.delayedCallbacks,n=0;do{for(;n<e.length;n++)e[n].call(null);for(var i=0;i<t.ops.length;i++){var o=t.ops[i];if(o.cursorActivityHandlers)for(;o.cursorActivityCalled<o.cursorActivityHandlers.length;)o.cursorActivityHandlers[o.cursorActivityCalled++].call(null,o.cm)}}while(n<e.length)}function ke(t){var e=t.curOp,n=e.ownsGroup;if(n)try{xe(n)}finally{Ur=null;for(var i=0;i<n.ops.length;i++)n.ops[i].cm.curOp=null;Ce(n)}}function Ce(t){for(var e=t.ops,n=0;n<e.length;n++)Te(e[n]);for(var n=0;n<e.length;n++)Se(e[n]);for(var n=0;n<e.length;n++)_e(e[n]);for(var n=0;n<e.length;n++)Ie(e[n]);for(var n=0;n<e.length;n++)Le(e[n])}function Te(t){var e=t.cm,n=e.display;_(e),t.updateMaxLine&&p(e),t.mustUpdate=t.viewChanged||t.forceUpdate||null!=t.scrollTop||t.scrollToPos&&(t.scrollToPos.from.line<n.viewFrom||t.scrollToPos.to.line>=n.viewTo)||n.maxLineChanged&&e.options.lineWrapping,t.update=t.mustUpdate&&new S(e,t.mustUpdate&&{top:t.scrollTop,ensure:t.scrollToPos},t.forceUpdate)}function Se(t){t.updatedDisplay=t.mustUpdate&&I(t.cm,t.update)}function _e(t){var e=t.cm,n=e.display;t.updatedDisplay&&E(e),t.barMeasure=h(e),n.maxLineChanged&&!e.options.lineWrapping&&(t.adjustWidthTo=Jt(e,n.maxLine,n.maxLine.text.length).left+3,e.display.sizerWidth=t.adjustWidthTo,t.barMeasure.scrollWidth=Math.max(n.scroller.clientWidth,n.sizer.offsetLeft+t.adjustWidthTo+Vt(e)+e.display.barWidth),t.maxScrollLeft=Math.max(0,n.sizer.offsetLeft+t.adjustWidthTo-Gt(e))),(t.updatedDisplay||t.selectionChanged)&&(t.preparedSelection=n.input.prepareSelection())}function Ie(t){var e=t.cm;null!=t.adjustWidthTo&&(e.display.sizer.style.minWidth=t.adjustWidthTo+"px",t.maxScrollLeft<e.doc.scrollLeft&&rn(e,Math.min(e.display.scroller.scrollLeft,t.maxScrollLeft),!0),e.display.maxLineChanged=!1),t.preparedSelection&&e.display.input.showSelection(t.preparedSelection),(t.updatedDisplay||t.startHeight!=e.doc.height)&&b(e,t.barMeasure),t.updatedDisplay&&N(e,t.barMeasure),t.selectionChanged&&$t(e),e.state.focused&&t.updateInput&&e.display.input.reset(t.typing),!t.focus||t.focus!=Vo()||document.hasFocus&&!document.hasFocus()||Y(t.cm)}function Le(t){var e=t.cm,n=e.display,i=e.doc;if(t.updatedDisplay&&L(e,t.update),null==n.wheelStartX||null==t.scrollTop&&null==t.scrollLeft&&!t.scrollToPos||(n.wheelStartX=n.wheelStartY=null),null==t.scrollTop||n.scroller.scrollTop==t.scrollTop&&!t.forceScroll||(i.scrollTop=Math.max(0,Math.min(n.scroller.scrollHeight-n.scroller.clientHeight,t.scrollTop)),n.scrollbars.setScrollTop(i.scrollTop),n.scroller.scrollTop=i.scrollTop),null==t.scrollLeft||n.scroller.scrollLeft==t.scrollLeft&&!t.forceScroll||(i.scrollLeft=Math.max(0,Math.min(n.scroller.scrollWidth-n.scroller.clientWidth,t.scrollLeft)),n.scrollbars.setScrollLeft(i.scrollLeft),n.scroller.scrollLeft=i.scrollLeft,x(e)),t.scrollToPos){var o=Pn(e,mt(i,t.scrollToPos.from),mt(i,t.scrollToPos.to),t.scrollToPos.margin);t.scrollToPos.isCursor&&e.state.focused&&Mn(e,o)}var r=t.maybeHiddenMarkers,a=t.maybeUnhiddenMarkers;if(r)for(var s=0;s<r.length;++s)r[s].lines.length||Aa(r[s],"hide");if(a)for(var s=0;s<a.length;++s)a[s].lines.length&&Aa(a[s],"unhide");n.wrapper.offsetHeight&&(i.scrollTop=e.display.scroller.scrollTop),t.changeObjs&&Aa(e,"changes",e,t.changeObjs),t.update&&t.update.finish()}function De(t,e){if(t.curOp)return e();we(t);try{return e()}finally{ke(t)}}function Ne(t,e){return function(){if(t.curOp)return e.apply(t,arguments);we(t);try{return e.apply(t,arguments)}finally{ke(t)}}}function Ee(t){return function(){if(this.curOp)return t.apply(this,arguments);we(this);try{return t.apply(this,arguments)}finally{ke(this)}}}function Ae(t){return function(){var e=this.cm;if(!e||e.curOp)return t.apply(this,arguments);we(e);try{return t.apply(this,arguments)}finally{ke(e)}}}function Me(t,e,n){this.line=e,this.rest=yi(e),this.size=this.rest?eo(Mo(this.rest))-n+1:1,this.node=this.text=null,this.hidden=ki(t,e)}function Pe(t,e,n){for(var i,o=[],r=e;n>r;r=i){var a=new Me(t.doc,Qi(t.doc,r),r);i=r+a.size,o.push(a)}return o}function Oe(t,e,n,i){null==e&&(e=t.doc.first),null==n&&(n=t.doc.first+t.doc.size),i||(i=0);var o=t.display;if(i&&n<o.viewTo&&(null==o.updateLineNumbers||o.updateLineNumbers>e)&&(o.updateLineNumbers=e),t.curOp.viewChanged=!0,e>=o.viewTo)Fr&&wi(t.doc,e)<o.viewTo&&He(t);else if(n<=o.viewFrom)Fr&&xi(t.doc,n+i)>o.viewFrom?He(t):(o.viewFrom+=i,o.viewTo+=i);else if(e<=o.viewFrom&&n>=o.viewTo)He(t);else if(e<=o.viewFrom){var r=Be(t,n,n+i,1);r?(o.view=o.view.slice(r.index),o.viewFrom=r.lineN,o.viewTo+=i):He(t)}else if(n>=o.viewTo){var r=Be(t,e,e,-1);r?(o.view=o.view.slice(0,r.index),o.viewTo=r.lineN):He(t)}else{var a=Be(t,e,e,-1),s=Be(t,n,n+i,1);a&&s?(o.view=o.view.slice(0,a.index).concat(Pe(t,a.lineN,s.lineN)).concat(o.view.slice(s.index)),o.viewTo+=i):He(t)}var l=o.externalMeasured;l&&(n<l.lineN?l.lineN+=i:e<l.lineN+l.size&&(o.externalMeasured=null))}function Fe(t,e,n){t.curOp.viewChanged=!0;var i=t.display,o=t.display.externalMeasured;if(o&&e>=o.lineN&&e<o.lineN+o.size&&(i.externalMeasured=null),!(e<i.viewFrom||e>=i.viewTo)){var r=i.view[$e(t,e)];if(null!=r.node){var a=r.changes||(r.changes=[]);-1==Po(a,n)&&a.push(n)}}}function He(t){t.display.viewFrom=t.display.viewTo=t.doc.first,t.display.view=[],t.display.viewOffset=0}function $e(t,e){if(e>=t.display.viewTo)return null;if(e-=t.display.viewFrom,0>e)return null;for(var n=t.display.view,i=0;i<n.length;i++)if(e-=n[i].size,0>e)return i}function Be(t,e,n,i){var o,r=$e(t,e),a=t.display.view;if(!Fr||n==t.doc.first+t.doc.size)return{index:r,lineN:n};for(var s=0,l=t.display.viewFrom;r>s;s++)l+=a[s].size;if(l!=e){if(i>0){if(r==a.length-1)return null;o=l+a[r].size-e,r++}else o=l-e;e+=o,n+=o}for(;wi(t.doc,n)!=n;){if(r==(0>i?0:a.length-1))return null;n+=i*a[r-(0>i?1:0)].size,r+=i}return{index:r,lineN:n}}function Re(t,e,n){var i=t.display,o=i.view;0==o.length||e>=i.viewTo||n<=i.viewFrom?(i.view=Pe(t,e,n),i.viewFrom=e):(i.viewFrom>e?i.view=Pe(t,e,i.viewFrom).concat(i.view):i.viewFrom<e&&(i.view=i.view.slice($e(t,e))),i.viewFrom=e,i.viewTo<n?i.view=i.view.concat(Pe(t,i.viewTo,n)):i.viewTo>n&&(i.view=i.view.slice(0,$e(t,n)))),i.viewTo=n}function ze(t){for(var e=t.display.view,n=0,i=0;i<e.length;i++){var o=e[i];o.hidden||o.node&&!o.changes||++n}return n}function je(t){function e(){o.activeTouch&&(r=setTimeout(function(){o.activeTouch=null},1e3),a=o.activeTouch,a.end=+new Date)}function n(t){if(1!=t.touches.length)return!1;var e=t.touches[0];return e.radiusX<=1&&e.radiusY<=1}function i(t,e){if(null==e.left)return!0;var n=e.left-t.left,i=e.top-t.top;return n*n+i*i>400}var o=t.display;Da(o.scroller,"mousedown",Ne(t,Ge)),yr&&11>wr?Da(o.scroller,"dblclick",Ne(t,function(e){if(!Io(t,e)){var n=Ve(t,e);if(n&&!Je(t,e)&&!qe(t.display,e)){_a(e);var i=t.findWordAt(n);wt(t.doc,i.anchor,i.head)}}})):Da(o.scroller,"dblclick",function(e){Io(t,e)||_a(e)}),Pr||Da(o.scroller,"contextmenu",function(e){yn(t,e)});var r,a={end:0};Da(o.scroller,"touchstart",function(e){if(!Io(t,e)&&!n(e)){clearTimeout(r);var i=+new Date;o.activeTouch={start:i,moved:!1,prev:i-a.end<=300?a:null},1==e.touches.length&&(o.activeTouch.left=e.touches[0].pageX,o.activeTouch.top=e.touches[0].pageY)}}),Da(o.scroller,"touchmove",function(){o.activeTouch&&(o.activeTouch.moved=!0)}),Da(o.scroller,"touchend",function(n){var r=o.activeTouch;if(r&&!qe(o,n)&&null!=r.left&&!r.moved&&new Date-r.start<300){var a,s=t.coordsChar(o.activeTouch,"page");a=!r.prev||i(r,r.prev)?new ut(s,s):!r.prev.prev||i(r,r.prev.prev)?t.findWordAt(s):new ut(Hr(s.line,0),mt(t.doc,Hr(s.line+1,0))),t.setSelection(a.anchor,a.head),t.focus(),_a(n)}e()}),Da(o.scroller,"touchcancel",e),Da(o.scroller,"scroll",function(){o.scroller.clientHeight&&(on(t,o.scroller.scrollTop),rn(t,o.scroller.scrollLeft,!0),Aa(t,"scroll",t))}),Da(o.scroller,"mousewheel",function(e){an(t,e)}),Da(o.scroller,"DOMMouseScroll",function(e){an(t,e)}),Da(o.wrapper,"scroll",function(){o.wrapper.scrollTop=o.wrapper.scrollLeft=0}),o.dragFunctions={enter:function(e){Io(t,e)||La(e)},over:function(e){Io(t,e)||(en(t,e),La(e))},start:function(e){tn(t,e)},drop:Ne(t,Ze),leave:function(e){Io(t,e)||nn(t)}};var s=o.input.getField();Da(s,"keyup",function(e){hn.call(t,e)}),Da(s,"keydown",Ne(t,pn)),Da(s,"keypress",Ne(t,mn)),Da(s,"focus",Bo(vn,t)),Da(s,"blur",Bo(bn,t))}function We(e,n,i){var o=i&&i!=t.Init;if(!n!=!o){var r=e.display.dragFunctions,a=n?Da:Ea;a(e.display.scroller,"dragstart",r.start),a(e.display.scroller,"dragenter",r.enter),a(e.display.scroller,"dragover",r.over),a(e.display.scroller,"dragleave",r.leave),a(e.display.scroller,"drop",r.drop)}}function Ue(t){var e=t.display;(e.lastWrapHeight!=e.wrapper.clientHeight||e.lastWrapWidth!=e.wrapper.clientWidth)&&(e.cachedCharWidth=e.cachedTextHeight=e.cachedPaddingH=null,e.scrollbarsClipped=!1,t.setSize())}function qe(t,e){for(var n=ko(e);n!=t.wrapper;n=n.parentNode)if(!n||1==n.nodeType&&"true"==n.getAttribute("cm-ignore-events")||n.parentNode==t.sizer&&n!=t.mover)return!0}function Ve(t,e,n,i){var o=t.display;if(!n&&"true"==ko(e).getAttribute("cm-not-content"))return null;var r,a,s=o.lineSpace.getBoundingClientRect();try{r=e.clientX-s.left,a=e.clientY-s.top}catch(e){return null}var l,c=ge(t,r,a);if(i&&1==c.xRel&&(l=Qi(t.doc,c.line).text).length==c.ch){var d=Ba(l,l.length,t.options.tabSize)-l.length;c=Hr(c.line,Math.max(0,Math.round((r-qt(t.display).left)/ye(t.display))-d))}return c}function Ge(t){var e=this,n=e.display;if(!(Io(e,t)||n.activeTouch&&n.input.supportsTouch())){if(n.shift=t.shiftKey,qe(n,t))return void(xr||(n.scroller.draggable=!1,setTimeout(function(){n.scroller.draggable=!0},100)));if(!Je(e,t)){var i=Ve(e,t);switch(window.focus(),Co(t)){case 1:e.state.selectingText?e.state.selectingText(t):i?Ke(e,t,i):ko(t)==n.scroller&&_a(t);break;case 2:xr&&(e.state.lastMiddleDown=+new Date),i&&wt(e.doc,i),setTimeout(function(){n.input.focus()},20),_a(t);break;case 3:Pr?yn(e,t):gn(e)}}}}function Ke(t,e,n){yr?setTimeout(Bo(Y,t),0):t.curOp.focus=Vo();var i,o=+new Date;jr&&jr.time>o-400&&0==$r(jr.pos,n)?i="triple":zr&&zr.time>o-400&&0==$r(zr.pos,n)?(i="double",jr={time:o,pos:n}):(i="single",zr={time:o,pos:n});var r,a=t.doc.sel,s=Nr?e.metaKey:e.ctrlKey;t.options.dragDrop&&Za&&!t.isReadOnly()&&"single"==i&&(r=a.contains(n))>-1&&($r((r=a.ranges[r]).from(),n)<0||n.xRel>0)&&($r(r.to(),n)>0||n.xRel<0)?Xe(t,e,n,s):Ye(t,e,n,i,s)}function Xe(t,e,n,i){var o=t.display,r=+new Date,a=Ne(t,function(s){xr&&(o.scroller.draggable=!1),t.state.draggingText=!1,Ea(document,"mouseup",a),Ea(o.scroller,"drop",a),Math.abs(e.clientX-s.clientX)+Math.abs(e.clientY-s.clientY)<10&&(_a(s),!i&&+new Date-200<r&&wt(t.doc,n),xr||yr&&9==wr?setTimeout(function(){document.body.focus(),o.input.focus()},20):o.input.focus())});xr&&(o.scroller.draggable=!0),t.state.draggingText=a,o.scroller.dragDrop&&o.scroller.dragDrop(),Da(document,"mouseup",a),Da(o.scroller,"drop",a)}function Ye(t,e,n,i,o){function r(e){if(0!=$r(g,e))if(g=e,"rect"==i){for(var o=[],r=t.options.tabSize,a=Ba(Qi(c,n.line).text,n.ch,r),s=Ba(Qi(c,e.line).text,e.ch,r),l=Math.min(a,s),f=Math.max(a,s),h=Math.min(n.line,e.line),m=Math.min(t.lastLine(),Math.max(n.line,e.line));m>=h;h++){var v=Qi(c,h).text,b=Ra(v,l,r);l==f?o.push(new ut(Hr(h,b),Hr(h,b))):v.length>b&&o.push(new ut(Hr(h,b),Hr(h,Ra(v,f,r))));
}o.length||o.push(new ut(n,n)),_t(c,pt(p.ranges.slice(0,u).concat(o),u),{origin:"*mouse",scroll:!1}),t.scrollIntoView(e)}else{var y=d,w=y.anchor,x=e;if("single"!=i){if("double"==i)var k=t.findWordAt(e);else var k=new ut(Hr(e.line,0),mt(c,Hr(e.line+1,0)));$r(k.anchor,w)>0?(x=k.head,w=X(y.from(),k.anchor)):(x=k.anchor,w=K(y.to(),k.head))}var o=p.ranges.slice(0);o[u]=new ut(mt(c,w),x),_t(c,pt(o,u),Ha)}}function a(e){var n=++b,o=Ve(t,e,!0,"rect"==i);if(o)if(0!=$r(o,g)){t.curOp.focus=Vo(),r(o);var s=w(l,c);(o.line>=s.to||o.line<s.from)&&setTimeout(Ne(t,function(){b==n&&a(e)}),150)}else{var d=e.clientY<v.top?-20:e.clientY>v.bottom?20:0;d&&setTimeout(Ne(t,function(){b==n&&(l.scroller.scrollTop+=d,a(e))}),50)}}function s(e){t.state.selectingText=!1,b=1/0,_a(e),l.input.focus(),Ea(document,"mousemove",y),Ea(document,"mouseup",x),c.history.lastSelOrigin=null}var l=t.display,c=t.doc;_a(e);var d,u,p=c.sel,f=p.ranges;if(o&&!e.shiftKey?(u=c.sel.contains(n),d=u>-1?f[u]:new ut(n,n)):(d=c.sel.primary(),u=c.sel.primIndex),e.altKey)i="rect",o||(d=new ut(n,n)),n=Ve(t,e,!0,!0),u=-1;else if("double"==i){var h=t.findWordAt(n);d=t.display.shift||c.extend?yt(c,d,h.anchor,h.head):h}else if("triple"==i){var m=new ut(Hr(n.line,0),mt(c,Hr(n.line+1,0)));d=t.display.shift||c.extend?yt(c,d,m.anchor,m.head):m}else d=yt(c,d,n);o?-1==u?(u=f.length,_t(c,pt(f.concat([d]),u),{scroll:!1,origin:"*mouse"})):f.length>1&&f[u].empty()&&"single"==i&&!e.shiftKey?(_t(c,pt(f.slice(0,u).concat(f.slice(u+1)),0),{scroll:!1,origin:"*mouse"}),p=c.sel):kt(c,u,d,Ha):(u=0,_t(c,new dt([d],0),Ha),p=c.sel);var g=n,v=l.wrapper.getBoundingClientRect(),b=0,y=Ne(t,function(t){Co(t)?a(t):s(t)}),x=Ne(t,s);t.state.selectingText=x,Da(document,"mousemove",y),Da(document,"mouseup",x)}function Qe(t,e,n,i){try{var o=e.clientX,r=e.clientY}catch(e){return!1}if(o>=Math.floor(t.display.gutters.getBoundingClientRect().right))return!1;i&&_a(e);var a=t.display,s=a.lineDiv.getBoundingClientRect();if(r>s.bottom||!Do(t,n))return xo(e);r-=s.top-a.viewOffset;for(var l=0;l<t.options.gutters.length;++l){var c=a.gutters.childNodes[l];if(c&&c.getBoundingClientRect().right>=o){var d=no(t.doc,r),u=t.options.gutters[l];return Aa(t,n,t,d,u,e),xo(e)}}}function Je(t,e){return Qe(t,e,"gutterClick",!0)}function Ze(t){var e=this;if(nn(e),!Io(e,t)&&!qe(e.display,t)){_a(t),yr&&(Vr=+new Date);var n=Ve(e,t,!0),i=t.dataTransfer.files;if(n&&!e.isReadOnly())if(i&&i.length&&window.FileReader&&window.File)for(var o=i.length,r=Array(o),a=0,s=function(t,i){if(!e.options.allowDropFileTypes||-1!=Po(e.options.allowDropFileTypes,t.type)){var s=new FileReader;s.onload=Ne(e,function(){var t=s.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(t)&&(t=""),r[i]=t,++a==o){n=mt(e.doc,n);var l={from:n,to:n,text:e.doc.splitLines(r.join(e.doc.lineSeparator())),origin:"paste"};_n(e.doc,l),St(e.doc,ft(n,Jr(l)))}}),s.readAsText(t)}},l=0;o>l;++l)s(i[l],l);else{if(e.state.draggingText&&e.doc.sel.contains(n)>-1)return e.state.draggingText(t),void setTimeout(function(){e.display.input.focus()},20);try{var r=t.dataTransfer.getData("Text");if(r){if(e.state.draggingText&&!(Nr?t.altKey:t.ctrlKey))var c=e.listSelections();if(It(e.doc,ft(n,n)),c)for(var l=0;l<c.length;++l)An(e.doc,"",c[l].anchor,c[l].head,"drag");e.replaceSelection(r,"around","paste"),e.display.input.focus()}}catch(t){}}}}function tn(t,e){if(yr&&(!t.state.draggingText||+new Date-Vr<100))return void La(e);if(!Io(t,e)&&!qe(t.display,e)&&(e.dataTransfer.setData("Text",t.getSelection()),e.dataTransfer.setDragImage&&!Sr)){var n=Wo("img",null,null,"position: fixed; left: 0; top: 0;");n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",Tr&&(n.width=n.height=1,t.display.wrapper.appendChild(n),n._top=n.offsetTop),e.dataTransfer.setDragImage(n,0,0),Tr&&n.parentNode.removeChild(n)}}function en(t,e){var n=Ve(t,e);if(n){var i=document.createDocumentFragment();Ft(t,n,i),t.display.dragCursor||(t.display.dragCursor=Wo("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),t.display.lineSpace.insertBefore(t.display.dragCursor,t.display.cursorDiv)),qo(t.display.dragCursor,i)}}function nn(t){t.display.dragCursor&&(t.display.lineSpace.removeChild(t.display.dragCursor),t.display.dragCursor=null)}function on(t,e){Math.abs(t.doc.scrollTop-e)<2||(t.doc.scrollTop=e,gr||D(t,{top:e}),t.display.scroller.scrollTop!=e&&(t.display.scroller.scrollTop=e),t.display.scrollbars.setScrollTop(e),gr&&D(t),Bt(t,100))}function rn(t,e,n){(n?e==t.doc.scrollLeft:Math.abs(t.doc.scrollLeft-e)<2)||(e=Math.min(e,t.display.scroller.scrollWidth-t.display.scroller.clientWidth),t.doc.scrollLeft=e,x(t),t.display.scroller.scrollLeft!=e&&(t.display.scroller.scrollLeft=e),t.display.scrollbars.setScrollLeft(e))}function an(t,e){var n=Xr(e),i=n.x,o=n.y,r=t.display,a=r.scroller,s=a.scrollWidth>a.clientWidth,l=a.scrollHeight>a.clientHeight;if(i&&s||o&&l){if(o&&Nr&&xr)t:for(var c=e.target,d=r.view;c!=a;c=c.parentNode)for(var u=0;u<d.length;u++)if(d[u].node==c){t.display.currentWheelTarget=c;break t}if(i&&!gr&&!Tr&&null!=Kr)return o&&l&&on(t,Math.max(0,Math.min(a.scrollTop+o*Kr,a.scrollHeight-a.clientHeight))),rn(t,Math.max(0,Math.min(a.scrollLeft+i*Kr,a.scrollWidth-a.clientWidth))),(!o||o&&l)&&_a(e),void(r.wheelStartX=null);if(o&&null!=Kr){var p=o*Kr,f=t.doc.scrollTop,h=f+r.wrapper.clientHeight;0>p?f=Math.max(0,f+p-50):h=Math.min(t.doc.height,h+p+50),D(t,{top:f,bottom:h})}20>Gr&&(null==r.wheelStartX?(r.wheelStartX=a.scrollLeft,r.wheelStartY=a.scrollTop,r.wheelDX=i,r.wheelDY=o,setTimeout(function(){if(null!=r.wheelStartX){var t=a.scrollLeft-r.wheelStartX,e=a.scrollTop-r.wheelStartY,n=e&&r.wheelDY&&e/r.wheelDY||t&&r.wheelDX&&t/r.wheelDX;r.wheelStartX=r.wheelStartY=null,n&&(Kr=(Kr*Gr+n)/(Gr+1),++Gr)}},200)):(r.wheelDX+=i,r.wheelDY+=o))}}function sn(t,e,n){if("string"==typeof e&&(e=ca[e],!e))return!1;t.display.input.ensurePolled();var i=t.display.shift,o=!1;try{t.isReadOnly()&&(t.state.suppressEdits=!0),n&&(t.display.shift=!1),o=e(t)!=Oa}finally{t.display.shift=i,t.state.suppressEdits=!1}return o}function ln(t,e,n){for(var i=0;i<t.state.keyMaps.length;i++){var o=ua(e,t.state.keyMaps[i],n,t);if(o)return o}return t.options.extraKeys&&ua(e,t.options.extraKeys,n,t)||ua(e,t.options.keyMap,n,t)}function cn(t,e,n,i){var o=t.state.keySeq;if(o){if(pa(e))return"handled";Yr.set(50,function(){t.state.keySeq==o&&(t.state.keySeq=null,t.display.input.reset())}),e=o+" "+e}var r=ln(t,e,i);return"multi"==r&&(t.state.keySeq=e),"handled"==r&&So(t,"keyHandled",t,e,n),("handled"==r||"multi"==r)&&(_a(n),$t(t)),o&&!r&&/\'$/.test(e)?(_a(n),!0):!!r}function dn(t,e){var n=fa(e,!0);return n?e.shiftKey&&!t.state.keySeq?cn(t,"Shift-"+n,e,function(e){return sn(t,e,!0)})||cn(t,n,e,function(e){return("string"==typeof e?/^go[A-Z]/.test(e):e.motion)?sn(t,e):void 0}):cn(t,n,e,function(e){return sn(t,e)}):!1}function un(t,e,n){return cn(t,"'"+n+"'",e,function(e){return sn(t,e,!0)})}function pn(t){var e=this;if(e.curOp.focus=Vo(),!Io(e,t)){yr&&11>wr&&27==t.keyCode&&(t.returnValue=!1);var n=t.keyCode;e.display.shift=16==n||t.shiftKey;var i=dn(e,t);Tr&&(Qr=i?n:null,!i&&88==n&&!ns&&(Nr?t.metaKey:t.ctrlKey)&&e.replaceSelection("",null,"cut")),18!=n||/\bCodeMirror-crosshair\b/.test(e.display.lineDiv.className)||fn(e)}}function fn(t){function e(t){18!=t.keyCode&&t.altKey||(Ya(n,"CodeMirror-crosshair"),Ea(document,"keyup",e),Ea(document,"mouseover",e))}var n=t.display.lineDiv;Qa(n,"CodeMirror-crosshair"),Da(document,"keyup",e),Da(document,"mouseover",e)}function hn(t){16==t.keyCode&&(this.doc.sel.shift=!1),Io(this,t)}function mn(t){var e=this;if(!(qe(e.display,t)||Io(e,t)||t.ctrlKey&&!t.altKey||Nr&&t.metaKey)){var n=t.keyCode,i=t.charCode;if(Tr&&n==Qr)return Qr=null,void _a(t);if(!Tr||t.which&&!(t.which<10)||!dn(e,t)){var o=String.fromCharCode(null==i?n:i);un(e,t,o)||e.display.input.onKeyPress(t)}}}function gn(t){t.state.delayingBlurEvent=!0,setTimeout(function(){t.state.delayingBlurEvent&&(t.state.delayingBlurEvent=!1,bn(t))},100)}function vn(t){t.state.delayingBlurEvent&&(t.state.delayingBlurEvent=!1),"nocursor"!=t.options.readOnly&&(t.state.focused||(Aa(t,"focus",t),t.state.focused=!0,Qa(t.display.wrapper,"CodeMirror-focused"),t.curOp||t.display.selForContextMenu==t.doc.sel||(t.display.input.reset(),xr&&setTimeout(function(){t.display.input.reset(!0)},20)),t.display.input.receivedFocus()),$t(t))}function bn(t){t.state.delayingBlurEvent||(t.state.focused&&(Aa(t,"blur",t),t.state.focused=!1,Ya(t.display.wrapper,"CodeMirror-focused")),clearInterval(t.display.blinker),setTimeout(function(){t.state.focused||(t.display.shift=!1)},150))}function yn(t,e){qe(t.display,e)||wn(t,e)||Io(t,e,"contextmenu")||t.display.input.onContextMenu(e)}function wn(t,e){return Do(t,"gutterContextMenu")?Qe(t,e,"gutterContextMenu",!1):!1}function xn(t,e){if($r(t,e.from)<0)return t;if($r(t,e.to)<=0)return Jr(e);var n=t.line+e.text.length-(e.to.line-e.from.line)-1,i=t.ch;return t.line==e.to.line&&(i+=Jr(e).ch-e.to.ch),Hr(n,i)}function kn(t,e){for(var n=[],i=0;i<t.sel.ranges.length;i++){var o=t.sel.ranges[i];n.push(new ut(xn(o.anchor,e),xn(o.head,e)))}return pt(n,t.sel.primIndex)}function Cn(t,e,n){return t.line==e.line?Hr(n.line,t.ch-e.ch+n.ch):Hr(n.line+(t.line-e.line),t.ch)}function Tn(t,e,n){for(var i=[],o=Hr(t.first,0),r=o,a=0;a<e.length;a++){var s=e[a],l=Cn(s.from,o,r),c=Cn(Jr(s),o,r);if(o=s.to,r=c,"around"==n){var d=t.sel.ranges[a],u=$r(d.head,d.anchor)<0;i[a]=new ut(u?c:l,u?l:c)}else i[a]=new ut(l,l)}return new dt(i,t.sel.primIndex)}function Sn(t,e,n){var i={canceled:!1,from:e.from,to:e.to,text:e.text,origin:e.origin,cancel:function(){this.canceled=!0}};return n&&(i.update=function(e,n,i,o){e&&(this.from=mt(t,e)),n&&(this.to=mt(t,n)),i&&(this.text=i),void 0!==o&&(this.origin=o)}),Aa(t,"beforeChange",t,i),t.cm&&Aa(t.cm,"beforeChange",t.cm,i),i.canceled?null:{from:i.from,to:i.to,text:i.text,origin:i.origin}}function _n(t,e,n){if(t.cm){if(!t.cm.curOp)return Ne(t.cm,_n)(t,e,n);if(t.cm.state.suppressEdits)return}if(!(Do(t,"beforeChange")||t.cm&&Do(t.cm,"beforeChange"))||(e=Sn(t,e,!0))){var i=Or&&!n&&li(t,e.from,e.to);if(i)for(var o=i.length-1;o>=0;--o)In(t,{from:i[o].from,to:i[o].to,text:o?[""]:e.text});else In(t,e)}}function In(t,e){if(1!=e.text.length||""!=e.text[0]||0!=$r(e.from,e.to)){var n=kn(t,e);co(t,e,n,t.cm?t.cm.curOp.id:NaN),Nn(t,e,n,ri(t,e));var i=[];Xi(t,function(t,n){n||-1!=Po(i,t.history)||(wo(t.history,e),i.push(t.history)),Nn(t,e,null,ri(t,e))})}}function Ln(t,e,n){if(!t.cm||!t.cm.state.suppressEdits){for(var i,o=t.history,r=t.sel,a="undo"==e?o.done:o.undone,s="undo"==e?o.undone:o.done,l=0;l<a.length&&(i=a[l],n?!i.ranges||i.equals(t.sel):i.ranges);l++);if(l!=a.length){for(o.lastOrigin=o.lastSelOrigin=null;i=a.pop(),i.ranges;){if(fo(i,s),n&&!i.equals(t.sel))return void _t(t,i,{clearRedo:!1});r=i}var c=[];fo(r,s),s.push({changes:c,generation:o.generation}),o.generation=i.generation||++o.maxGeneration;for(var d=Do(t,"beforeChange")||t.cm&&Do(t.cm,"beforeChange"),l=i.changes.length-1;l>=0;--l){var u=i.changes[l];if(u.origin=e,d&&!Sn(t,u,!1))return void(a.length=0);c.push(ao(t,u));var p=l?kn(t,u):Mo(a);Nn(t,u,p,si(t,u)),!l&&t.cm&&t.cm.scrollIntoView({from:u.from,to:Jr(u)});var f=[];Xi(t,function(t,e){e||-1!=Po(f,t.history)||(wo(t.history,u),f.push(t.history)),Nn(t,u,null,si(t,u))})}}}}function Dn(t,e){if(0!=e&&(t.first+=e,t.sel=new dt(Oo(t.sel.ranges,function(t){return new ut(Hr(t.anchor.line+e,t.anchor.ch),Hr(t.head.line+e,t.head.ch))}),t.sel.primIndex),t.cm)){Oe(t.cm,t.first,t.first-e,e);for(var n=t.cm.display,i=n.viewFrom;i<n.viewTo;i++)Fe(t.cm,i,"gutter")}}function Nn(t,e,n,i){if(t.cm&&!t.cm.curOp)return Ne(t.cm,Nn)(t,e,n,i);if(e.to.line<t.first)return void Dn(t,e.text.length-1-(e.to.line-e.from.line));if(!(e.from.line>t.lastLine())){if(e.from.line<t.first){var o=e.text.length-1-(t.first-e.from.line);Dn(t,o),e={from:Hr(t.first,0),to:Hr(e.to.line+o,e.to.ch),text:[Mo(e.text)],origin:e.origin}}var r=t.lastLine();e.to.line>r&&(e={from:e.from,to:Hr(r,Qi(t,r).text.length),text:[e.text[0]],origin:e.origin}),e.removed=Ji(t,e.from,e.to),n||(n=kn(t,e)),t.cm?En(t.cm,e,i):Vi(t,e,i),It(t,n,Fa)}}function En(t,e,n){var i=t.doc,o=t.display,a=e.from,s=e.to,l=!1,c=a.line;t.options.lineWrapping||(c=eo(bi(Qi(i,a.line))),i.iter(c,s.line+1,function(t){return t==o.maxLine?(l=!0,!0):void 0})),i.sel.contains(e.from,e.to)>-1&&Lo(t),Vi(i,e,n,r(t)),t.options.lineWrapping||(i.iter(c,a.line+e.text.length,function(t){var e=u(t);e>o.maxLineLength&&(o.maxLine=t,o.maxLineLength=e,o.maxLineChanged=!0,l=!1)}),l&&(t.curOp.updateMaxLine=!0)),i.frontier=Math.min(i.frontier,a.line),Bt(t,400);var d=e.text.length-(s.line-a.line)-1;e.full?Oe(t):a.line!=s.line||1!=e.text.length||qi(t.doc,e)?Oe(t,a.line,s.line+1,d):Fe(t,a.line,"text");var p=Do(t,"changes"),f=Do(t,"change");if(f||p){var h={from:a,to:s,text:e.text,removed:e.removed,origin:e.origin};f&&So(t,"change",t,h),p&&(t.curOp.changeObjs||(t.curOp.changeObjs=[])).push(h)}t.display.selForContextMenu=null}function An(t,e,n,i,o){if(i||(i=n),$r(i,n)<0){var r=i;i=n,n=r}"string"==typeof e&&(e=t.splitLines(e)),_n(t,{from:n,to:i,text:e,origin:o})}function Mn(t,e){if(!Io(t,"scrollCursorIntoView")){var n=t.display,i=n.sizer.getBoundingClientRect(),o=null;if(e.top+i.top<0?o=!0:e.bottom+i.top>(window.innerHeight||document.documentElement.clientHeight)&&(o=!1),null!=o&&!Ir){var r=Wo("div","​",null,"position: absolute; top: "+(e.top-n.viewOffset-Wt(t.display))+"px; height: "+(e.bottom-e.top+Vt(t)+n.barHeight)+"px; left: "+e.left+"px; width: 2px;");t.display.lineSpace.appendChild(r),r.scrollIntoView(o),t.display.lineSpace.removeChild(r)}}}function Pn(t,e,n,i){null==i&&(i=0);for(var o=0;5>o;o++){var r=!1,a=fe(t,e),s=n&&n!=e?fe(t,n):a,l=Fn(t,Math.min(a.left,s.left),Math.min(a.top,s.top)-i,Math.max(a.left,s.left),Math.max(a.bottom,s.bottom)+i),c=t.doc.scrollTop,d=t.doc.scrollLeft;if(null!=l.scrollTop&&(on(t,l.scrollTop),Math.abs(t.doc.scrollTop-c)>1&&(r=!0)),null!=l.scrollLeft&&(rn(t,l.scrollLeft),Math.abs(t.doc.scrollLeft-d)>1&&(r=!0)),!r)break}return a}function On(t,e,n,i,o){var r=Fn(t,e,n,i,o);null!=r.scrollTop&&on(t,r.scrollTop),null!=r.scrollLeft&&rn(t,r.scrollLeft)}function Fn(t,e,n,i,o){var r=t.display,a=be(t.display);0>n&&(n=0);var s=t.curOp&&null!=t.curOp.scrollTop?t.curOp.scrollTop:r.scroller.scrollTop,l=Kt(t),c={};o-n>l&&(o=n+l);var d=t.doc.height+Ut(r),u=a>n,p=o>d-a;if(s>n)c.scrollTop=u?0:n;else if(o>s+l){var f=Math.min(n,(p?d:o)-l);f!=s&&(c.scrollTop=f)}var h=t.curOp&&null!=t.curOp.scrollLeft?t.curOp.scrollLeft:r.scroller.scrollLeft,m=Gt(t)-(t.options.fixedGutter?r.gutters.offsetWidth:0),g=i-e>m;return g&&(i=e+m),10>e?c.scrollLeft=0:h>e?c.scrollLeft=Math.max(0,e-(g?0:10)):i>m+h-3&&(c.scrollLeft=i+(g?0:10)-m),c}function Hn(t,e,n){(null!=e||null!=n)&&Bn(t),null!=e&&(t.curOp.scrollLeft=(null==t.curOp.scrollLeft?t.doc.scrollLeft:t.curOp.scrollLeft)+e),null!=n&&(t.curOp.scrollTop=(null==t.curOp.scrollTop?t.doc.scrollTop:t.curOp.scrollTop)+n)}function $n(t){Bn(t);var e=t.getCursor(),n=e,i=e;t.options.lineWrapping||(n=e.ch?Hr(e.line,e.ch-1):e,i=Hr(e.line,e.ch+1)),t.curOp.scrollToPos={from:n,to:i,margin:t.options.cursorScrollMargin,isCursor:!0}}function Bn(t){var e=t.curOp.scrollToPos;if(e){t.curOp.scrollToPos=null;var n=he(t,e.from),i=he(t,e.to),o=Fn(t,Math.min(n.left,i.left),Math.min(n.top,i.top)-e.margin,Math.max(n.right,i.right),Math.max(n.bottom,i.bottom)+e.margin);t.scrollTo(o.scrollLeft,o.scrollTop)}}function Rn(t,e,n,i){var o,r=t.doc;null==n&&(n="add"),"smart"==n&&(r.mode.indent?o=jt(t,e):n="prev");var a=t.options.tabSize,s=Qi(r,e),l=Ba(s.text,null,a);s.stateAfter&&(s.stateAfter=null);var c,d=s.text.match(/^\s*/)[0];if(i||/\S/.test(s.text)){if("smart"==n&&(c=r.mode.indent(o,s.text.slice(d.length),s.text),c==Oa||c>150)){if(!i)return;n="prev"}}else c=0,n="not";"prev"==n?c=e>r.first?Ba(Qi(r,e-1).text,null,a):0:"add"==n?c=l+t.options.indentUnit:"subtract"==n?c=l-t.options.indentUnit:"number"==typeof n&&(c=l+n),c=Math.max(0,c);var u="",p=0;if(t.options.indentWithTabs)for(var f=Math.floor(c/a);f;--f)p+=a,u+="	";if(c>p&&(u+=Ao(c-p)),u!=d)return An(r,u,Hr(e,0),Hr(e,d.length),"+input"),s.stateAfter=null,!0;for(var f=0;f<r.sel.ranges.length;f++){var h=r.sel.ranges[f];if(h.head.line==e&&h.head.ch<d.length){var p=Hr(e,d.length);kt(r,f,new ut(p,p));break}}}function zn(t,e,n,i){var o=e,r=e;return"number"==typeof e?r=Qi(t,ht(t,e)):o=eo(e),null==o?null:(i(r,o)&&t.cm&&Fe(t.cm,o,n),r)}function jn(t,e){for(var n=t.doc.sel.ranges,i=[],o=0;o<n.length;o++){for(var r=e(n[o]);i.length&&$r(r.from,Mo(i).to)<=0;){var a=i.pop();if($r(a.from,r.from)<0){r.from=a.from;break}}i.push(r)}De(t,function(){for(var e=i.length-1;e>=0;e--)An(t.doc,"",i[e].from,i[e].to,"+delete");$n(t)})}function Wn(t,e,n,i,o){function r(){var e=s+n;return e<t.first||e>=t.first+t.size?!1:(s=e,d=Qi(t,e))}function a(t){var e=(o?pr:fr)(d,l,n,!0);if(null==e){if(t||!r())return!1;l=o?(0>n?rr:or)(d):0>n?d.text.length:0}else l=e;return!0}var s=e.line,l=e.ch,c=n,d=Qi(t,s);if("char"==i)a();else if("column"==i)a(!0);else if("word"==i||"group"==i)for(var u=null,p="group"==i,f=t.cm&&t.cm.getHelper(e,"wordChars"),h=!0;!(0>n)||a(!h);h=!1){var m=d.text.charAt(l)||"\n",g=Ro(m,f)?"w":p&&"\n"==m?"n":!p||/\s/.test(m)?null:"p";if(!p||h||g||(g="s"),u&&u!=g){0>n&&(n=1,a());break}if(g&&(u=g),n>0&&!a(!h))break}var v=At(t,Hr(s,l),e,c,!0);return $r(e,v)||(v.hitSide=!0),v}function Un(t,e,n,i){var o,r=t.doc,a=e.left;if("page"==i){var s=Math.min(t.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);o=e.top+n*(s-(0>n?1.5:.5)*be(t.display))}else"line"==i&&(o=n>0?e.bottom+3:e.top-3);for(;;){var l=ge(t,a,o);if(!l.outside)break;if(0>n?0>=o:o>=r.height){l.hitSide=!0;break}o+=5*n}return l}function qn(e,n,i,o){t.defaults[e]=n,i&&(ta[e]=o?function(t,e,n){n!=ea&&i(t,e,n)}:i)}function Vn(t){for(var e,n,i,o,r=t.split(/-(?!$)/),t=r[r.length-1],a=0;a<r.length-1;a++){var s=r[a];if(/^(cmd|meta|m)$/i.test(s))o=!0;else if(/^a(lt)?$/i.test(s))e=!0;else if(/^(c|ctrl|control)$/i.test(s))n=!0;else{if(!/^s(hift)$/i.test(s))throw new Error("Unrecognized modifier name: "+s);i=!0}}return e&&(t="Alt-"+t),n&&(t="Ctrl-"+t),o&&(t="Cmd-"+t),i&&(t="Shift-"+t),t}function Gn(t){return"string"==typeof t?da[t]:t}function Kn(t,e,n,i,o){if(i&&i.shared)return Xn(t,e,n,i,o);if(t.cm&&!t.cm.curOp)return Ne(t.cm,Kn)(t,e,n,i,o);var r=new ga(t,o),a=$r(e,n);if(i&&$o(i,r,!1),a>0||0==a&&r.clearWhenEmpty!==!1)return r;if(r.replacedWith&&(r.collapsed=!0,r.widgetNode=Wo("span",[r.replacedWith],"CodeMirror-widget"),i.handleMouseEvents||r.widgetNode.setAttribute("cm-ignore-events","true"),i.insertLeft&&(r.widgetNode.insertLeft=!0)),r.collapsed){if(vi(t,e.line,e,n,r)||e.line!=n.line&&vi(t,n.line,e,n,r))throw new Error("Inserting collapsed marker partially overlapping an existing one");Fr=!0}r.addToHistory&&co(t,{from:e,to:n,origin:"markText"},t.sel,NaN);var s,l=e.line,c=t.cm;if(t.iter(l,n.line+1,function(t){c&&r.collapsed&&!c.options.lineWrapping&&bi(t)==c.display.maxLine&&(s=!0),r.collapsed&&l!=e.line&&to(t,0),ni(t,new Zn(r,l==e.line?e.ch:null,l==n.line?n.ch:null)),++l}),r.collapsed&&t.iter(e.line,n.line+1,function(e){ki(t,e)&&to(e,0)}),r.clearOnEnter&&Da(r,"beforeCursorEnter",function(){r.clear()}),r.readOnly&&(Or=!0,(t.history.done.length||t.history.undone.length)&&t.clearHistory()),r.collapsed&&(r.id=++ma,r.atomic=!0),c){if(s&&(c.curOp.updateMaxLine=!0),r.collapsed)Oe(c,e.line,n.line+1);else if(r.className||r.title||r.startStyle||r.endStyle||r.css)for(var d=e.line;d<=n.line;d++)Fe(c,d,"text");r.atomic&&Dt(c.doc),So(c,"markerAdded",c,r)}return r}function Xn(t,e,n,i,o){i=$o(i),i.shared=!1;var r=[Kn(t,e,n,i,o)],a=r[0],s=i.widgetNode;return Xi(t,function(t){s&&(i.widgetNode=s.cloneNode(!0)),r.push(Kn(t,mt(t,e),mt(t,n),i,o));for(var l=0;l<t.linked.length;++l)if(t.linked[l].isParent)return;a=Mo(r)}),new va(r,a)}function Yn(t){return t.findMarks(Hr(t.first,0),t.clipPos(Hr(t.lastLine())),function(t){return t.parent})}function Qn(t,e){for(var n=0;n<e.length;n++){var i=e[n],o=i.find(),r=t.clipPos(o.from),a=t.clipPos(o.to);if($r(r,a)){var s=Kn(t,r,a,i.primary,i.primary.type);i.markers.push(s),s.parent=i}}}function Jn(t){for(var e=0;e<t.length;e++){var n=t[e],i=[n.primary.doc];Xi(n.primary.doc,function(t){i.push(t)});for(var o=0;o<n.markers.length;o++){var r=n.markers[o];-1==Po(i,r.doc)&&(r.parent=null,n.markers.splice(o--,1))}}}function Zn(t,e,n){this.marker=t,this.from=e,this.to=n}function ti(t,e){if(t)for(var n=0;n<t.length;++n){var i=t[n];if(i.marker==e)return i}}function ei(t,e){for(var n,i=0;i<t.length;++i)t[i]!=e&&(n||(n=[])).push(t[i]);return n}function ni(t,e){t.markedSpans=t.markedSpans?t.markedSpans.concat([e]):[e],e.marker.attachLine(t)}function ii(t,e,n){if(t)for(var i,o=0;o<t.length;++o){var r=t[o],a=r.marker,s=null==r.from||(a.inclusiveLeft?r.from<=e:r.from<e);if(s||r.from==e&&"bookmark"==a.type&&(!n||!r.marker.insertLeft)){var l=null==r.to||(a.inclusiveRight?r.to>=e:r.to>e);(i||(i=[])).push(new Zn(a,r.from,l?null:r.to))}}return i}function oi(t,e,n){if(t)for(var i,o=0;o<t.length;++o){var r=t[o],a=r.marker,s=null==r.to||(a.inclusiveRight?r.to>=e:r.to>e);if(s||r.from==e&&"bookmark"==a.type&&(!n||r.marker.insertLeft)){var l=null==r.from||(a.inclusiveLeft?r.from<=e:r.from<e);(i||(i=[])).push(new Zn(a,l?null:r.from-e,null==r.to?null:r.to-e))}}return i}function ri(t,e){if(e.full)return null;var n=vt(t,e.from.line)&&Qi(t,e.from.line).markedSpans,i=vt(t,e.to.line)&&Qi(t,e.to.line).markedSpans;if(!n&&!i)return null;var o=e.from.ch,r=e.to.ch,a=0==$r(e.from,e.to),s=ii(n,o,a),l=oi(i,r,a),c=1==e.text.length,d=Mo(e.text).length+(c?o:0);if(s)for(var u=0;u<s.length;++u){var p=s[u];if(null==p.to){var f=ti(l,p.marker);f?c&&(p.to=null==f.to?null:f.to+d):p.to=o}}if(l)for(var u=0;u<l.length;++u){var p=l[u];if(null!=p.to&&(p.to+=d),null==p.from){var f=ti(s,p.marker);f||(p.from=d,c&&(s||(s=[])).push(p))}else p.from+=d,c&&(s||(s=[])).push(p)}s&&(s=ai(s)),l&&l!=s&&(l=ai(l));var h=[s];if(!c){var m,g=e.text.length-2;if(g>0&&s)for(var u=0;u<s.length;++u)null==s[u].to&&(m||(m=[])).push(new Zn(s[u].marker,null,null));for(var u=0;g>u;++u)h.push(m);h.push(l)}return h}function ai(t){for(var e=0;e<t.length;++e){var n=t[e];null!=n.from&&n.from==n.to&&n.marker.clearWhenEmpty!==!1&&t.splice(e--,1)}return t.length?t:null}function si(t,e){var n=go(t,e),i=ri(t,e);if(!n)return i;if(!i)return n;for(var o=0;o<n.length;++o){var r=n[o],a=i[o];if(r&&a)t:for(var s=0;s<a.length;++s){for(var l=a[s],c=0;c<r.length;++c)if(r[c].marker==l.marker)continue t;r.push(l)}else a&&(n[o]=a)}return n}function li(t,e,n){var i=null;if(t.iter(e.line,n.line+1,function(t){if(t.markedSpans)for(var e=0;e<t.markedSpans.length;++e){var n=t.markedSpans[e].marker;!n.readOnly||i&&-1!=Po(i,n)||(i||(i=[])).push(n)}}),!i)return null;for(var o=[{from:e,to:n}],r=0;r<i.length;++r)for(var a=i[r],s=a.find(0),l=0;l<o.length;++l){var c=o[l];if(!($r(c.to,s.from)<0||$r(c.from,s.to)>0)){var d=[l,1],u=$r(c.from,s.from),p=$r(c.to,s.to);(0>u||!a.inclusiveLeft&&!u)&&d.push({from:c.from,to:s.from}),(p>0||!a.inclusiveRight&&!p)&&d.push({from:s.to,to:c.to}),o.splice.apply(o,d),l+=d.length-1}}return o}function ci(t){var e=t.markedSpans;if(e){for(var n=0;n<e.length;++n)e[n].marker.detachLine(t);t.markedSpans=null}}function di(t,e){if(e){for(var n=0;n<e.length;++n)e[n].marker.attachLine(t);t.markedSpans=e}}function ui(t){return t.inclusiveLeft?-1:0}function pi(t){return t.inclusiveRight?1:0}function fi(t,e){var n=t.lines.length-e.lines.length;if(0!=n)return n;var i=t.find(),o=e.find(),r=$r(i.from,o.from)||ui(t)-ui(e);if(r)return-r;var a=$r(i.to,o.to)||pi(t)-pi(e);return a?a:e.id-t.id}function hi(t,e){var n,i=Fr&&t.markedSpans;if(i)for(var o,r=0;r<i.length;++r)o=i[r],o.marker.collapsed&&null==(e?o.from:o.to)&&(!n||fi(n,o.marker)<0)&&(n=o.marker);return n}function mi(t){return hi(t,!0)}function gi(t){return hi(t,!1)}function vi(t,e,n,i,o){var r=Qi(t,e),a=Fr&&r.markedSpans;if(a)for(var s=0;s<a.length;++s){var l=a[s];if(l.marker.collapsed){var c=l.marker.find(0),d=$r(c.from,n)||ui(l.marker)-ui(o),u=$r(c.to,i)||pi(l.marker)-pi(o);if(!(d>=0&&0>=u||0>=d&&u>=0)&&(0>=d&&($r(c.to,n)>0||l.marker.inclusiveRight&&o.inclusiveLeft)||d>=0&&($r(c.from,i)<0||l.marker.inclusiveLeft&&o.inclusiveRight)))return!0}}}function bi(t){for(var e;e=mi(t);)t=e.find(-1,!0).line;return t}function yi(t){for(var e,n;e=gi(t);)t=e.find(1,!0).line,(n||(n=[])).push(t);return n}function wi(t,e){var n=Qi(t,e),i=bi(n);return n==i?e:eo(i)}function xi(t,e){if(e>t.lastLine())return e;var n,i=Qi(t,e);if(!ki(t,i))return e;for(;n=gi(i);)i=n.find(1,!0).line;return eo(i)+1}function ki(t,e){var n=Fr&&e.markedSpans;if(n)for(var i,o=0;o<n.length;++o)if(i=n[o],i.marker.collapsed){if(null==i.from)return!0;if(!i.marker.widgetNode&&0==i.from&&i.marker.inclusiveLeft&&Ci(t,e,i))return!0}}function Ci(t,e,n){if(null==n.to){var i=n.marker.find(1,!0);return Ci(t,i.line,ti(i.line.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==e.text.length)return!0;for(var o,r=0;r<e.markedSpans.length;++r)if(o=e.markedSpans[r],o.marker.collapsed&&!o.marker.widgetNode&&o.from==n.to&&(null==o.to||o.to!=n.from)&&(o.marker.inclusiveLeft||n.marker.inclusiveRight)&&Ci(t,e,o))return!0}function Ti(t,e,n){io(e)<(t.curOp&&t.curOp.scrollTop||t.doc.scrollTop)&&Hn(t,null,n)}function Si(t){if(null!=t.height)return t.height;var e=t.doc.cm;if(!e)return 0;if(!Ga(document.body,t.node)){var n="position: relative;";t.coverGutter&&(n+="margin-left: -"+e.display.gutters.offsetWidth+"px;"),t.noHScroll&&(n+="width: "+e.display.wrapper.clientWidth+"px;"),qo(e.display.measure,Wo("div",[t.node],null,n))}return t.height=t.node.parentNode.offsetHeight}function _i(t,e,n,i){var o=new ba(t,n,i),r=t.cm;return r&&o.noHScroll&&(r.display.alignWidgets=!0),zn(t,e,"widget",function(e){var n=e.widgets||(e.widgets=[]);if(null==o.insertAt?n.push(o):n.splice(Math.min(n.length-1,Math.max(0,o.insertAt)),0,o),o.line=e,r&&!ki(t,e)){var i=io(e)<t.scrollTop;to(e,e.height+Si(o)),i&&Hn(r,null,o.height),r.curOp.forceUpdate=!0}return!0}),o}function Ii(t,e,n,i){t.text=e,t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null),null!=t.order&&(t.order=null),ci(t),di(t,n);var o=i?i(t):1;o!=t.height&&to(t,o)}function Li(t){t.parent=null,ci(t)}function Di(t,e){if(t)for(;;){var n=t.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!n)break;t=t.slice(0,n.index)+t.slice(n.index+n[0].length);var i=n[1]?"bgClass":"textClass";null==e[i]?e[i]=n[2]:new RegExp("(?:^|s)"+n[2]+"(?:$|s)").test(e[i])||(e[i]+=" "+n[2])}return t}function Ni(e,n){if(e.blankLine)return e.blankLine(n);if(e.innerMode){var i=t.innerMode(e,n);return i.mode.blankLine?i.mode.blankLine(i.state):void 0}}function Ei(e,n,i,o){for(var r=0;10>r;r++){o&&(o[0]=t.innerMode(e,i).mode);var a=e.token(n,i);if(n.pos>n.start)return a}throw new Error("Mode "+e.name+" failed to advance stream.")}function Ai(t,e,n,i){function o(t){return{start:u.start,end:u.pos,string:u.current(),type:r||null,state:t?sa(a.mode,d):d}}var r,a=t.doc,s=a.mode;e=mt(a,e);var l,c=Qi(a,e.line),d=jt(t,e.line,n),u=new ha(c.text,t.options.tabSize);for(i&&(l=[]);(i||u.pos<e.ch)&&!u.eol();)u.start=u.pos,r=Ei(s,u,d),i&&l.push(o(!0));return i?l:o()}function Mi(t,e,n,i,o,r,a){var s=n.flattenSpans;null==s&&(s=t.options.flattenSpans);var l,c=0,d=null,u=new ha(e,t.options.tabSize),p=t.options.addModeClass&&[null];for(""==e&&Di(Ni(n,i),r);!u.eol();){if(u.pos>t.options.maxHighlightLength?(s=!1,a&&Fi(t,e,i,u.pos),u.pos=e.length,l=null):l=Di(Ei(n,u,i,p),r),p){var f=p[0].name;f&&(l="m-"+(l?f+" "+l:f))}if(!s||d!=l){for(;c<u.start;)c=Math.min(u.start,c+5e4),o(c,d);d=l}u.start=u.pos}for(;c<u.pos;){var h=Math.min(u.pos,c+5e4);o(h,d),c=h}}function Pi(t,e,n,i){var o=[t.state.modeGen],r={};Mi(t,e.text,t.doc.mode,n,function(t,e){o.push(t,e)},r,i);for(var a=0;a<t.state.overlays.length;++a){var s=t.state.overlays[a],l=1,c=0;Mi(t,e.text,s.mode,!0,function(t,e){for(var n=l;t>c;){var i=o[l];i>t&&o.splice(l,1,t,o[l+1],i),l+=2,c=Math.min(t,i)}if(e)if(s.opaque)o.splice(n,l-n,t,"cm-overlay "+e),l=n+2;else for(;l>n;n+=2){var r=o[n+1];o[n+1]=(r?r+" ":"")+"cm-overlay "+e}},r)}return{styles:o,classes:r.bgClass||r.textClass?r:null}}function Oi(t,e,n){if(!e.styles||e.styles[0]!=t.state.modeGen){var i=jt(t,eo(e)),o=Pi(t,e,e.text.length>t.options.maxHighlightLength?sa(t.doc.mode,i):i);e.stateAfter=i,e.styles=o.styles,o.classes?e.styleClasses=o.classes:e.styleClasses&&(e.styleClasses=null),n===t.doc.frontier&&t.doc.frontier++}return e.styles}function Fi(t,e,n,i){var o=t.doc.mode,r=new ha(e,t.options.tabSize);for(r.start=r.pos=i||0,""==e&&Ni(o,n);!r.eol();)Ei(o,r,n),r.start=r.pos}function Hi(t,e){if(!t||/^\s*$/.test(t))return null;var n=e.addModeClass?xa:wa;return n[t]||(n[t]=t.replace(/\S+/g,"cm-$&"))}function $i(t,e){var n=Wo("span",null,null,xr?"padding-right: .1px":null),i={pre:Wo("pre",[n],"CodeMirror-line"),content:n,col:0,pos:0,cm:t,splitSpaces:(yr||xr)&&t.getOption("lineWrapping")};e.measure={};for(var o=0;o<=(e.rest?e.rest.length:0);o++){var r,a=o?e.rest[o-1]:e.line;i.pos=0,i.addToken=Ri,Zo(t.display.measure)&&(r=oo(a))&&(i.addToken=ji(i.addToken,r)),i.map=[];var s=e!=t.display.externalMeasured&&eo(a);Ui(a,i,Oi(t,a,s)),a.styleClasses&&(a.styleClasses.bgClass&&(i.bgClass=Ko(a.styleClasses.bgClass,i.bgClass||"")),a.styleClasses.textClass&&(i.textClass=Ko(a.styleClasses.textClass,i.textClass||""))),0==i.map.length&&i.map.push(0,0,i.content.appendChild(Jo(t.display.measure))),0==o?(e.measure.map=i.map,e.measure.cache={}):((e.measure.maps||(e.measure.maps=[])).push(i.map),(e.measure.caches||(e.measure.caches=[])).push({}))}return xr&&/\bcm-tab\b/.test(i.content.lastChild.className)&&(i.content.className="cm-tab-wrap-hack"),Aa(t,"renderLine",t,e.line,i.pre),i.pre.className&&(i.textClass=Ko(i.pre.className,i.textClass||"")),i}function Bi(t){var e=Wo("span","•","cm-invalidchar");return e.title="\\u"+t.charCodeAt(0).toString(16),e.setAttribute("aria-label",e.title),e}function Ri(t,e,n,i,o,r,a){if(e){var s=t.splitSpaces?e.replace(/ {3,}/g,zi):e,l=t.cm.state.specialChars,c=!1;if(l.test(e))for(var d=document.createDocumentFragment(),u=0;;){l.lastIndex=u;var p=l.exec(e),f=p?p.index-u:e.length-u;if(f){var h=document.createTextNode(s.slice(u,u+f));yr&&9>wr?d.appendChild(Wo("span",[h])):d.appendChild(h),t.map.push(t.pos,t.pos+f,h),t.col+=f,t.pos+=f}if(!p)break;if(u+=f+1,"	"==p[0]){var m=t.cm.options.tabSize,g=m-t.col%m,h=d.appendChild(Wo("span",Ao(g),"cm-tab"));h.setAttribute("role","presentation"),h.setAttribute("cm-text","	"),t.col+=g}else if("\r"==p[0]||"\n"==p[0]){var h=d.appendChild(Wo("span","\r"==p[0]?"␍":"␤","cm-invalidchar"));h.setAttribute("cm-text",p[0]),t.col+=1}else{var h=t.cm.options.specialCharPlaceholder(p[0]);h.setAttribute("cm-text",p[0]),yr&&9>wr?d.appendChild(Wo("span",[h])):d.appendChild(h),t.col+=1}t.map.push(t.pos,t.pos+1,h),t.pos++}else{t.col+=e.length;var d=document.createTextNode(s);t.map.push(t.pos,t.pos+e.length,d),yr&&9>wr&&(c=!0),t.pos+=e.length}if(n||i||o||c||a){var v=n||"";i&&(v+=i),o&&(v+=o);var b=Wo("span",[d],v,a);return r&&(b.title=r),t.content.appendChild(b)}t.content.appendChild(d)}}function zi(t){for(var e=" ",n=0;n<t.length-2;++n)e+=n%2?" ":" ";return e+=" "}function ji(t,e){return function(n,i,o,r,a,s,l){o=o?o+" cm-force-border":"cm-force-border";for(var c=n.pos,d=c+i.length;;){for(var u=0;u<e.length;u++){var p=e[u];if(p.to>c&&p.from<=c)break}if(p.to>=d)return t(n,i,o,r,a,s,l);t(n,i.slice(0,p.to-c),o,r,null,s,l),r=null,i=i.slice(p.to-c),c=p.to}}}function Wi(t,e,n,i){var o=!i&&n.widgetNode;o&&t.map.push(t.pos,t.pos+e,o),!i&&t.cm.display.input.needsContentAttribute&&(o||(o=t.content.appendChild(document.createElement("span"))),o.setAttribute("cm-marker",n.id)),o&&(t.cm.display.input.setUneditable(o),t.content.appendChild(o)),t.pos+=e}function Ui(t,e,n){var i=t.markedSpans,o=t.text,r=0;if(i)for(var a,s,l,c,d,u,p,f=o.length,h=0,m=1,g="",v=0;;){if(v==h){l=c=d=u=s="",p=null,v=1/0;for(var b,y=[],w=0;w<i.length;++w){var x=i[w],k=x.marker;"bookmark"==k.type&&x.from==h&&k.widgetNode?y.push(k):x.from<=h&&(null==x.to||x.to>h||k.collapsed&&x.to==h&&x.from==h)?(null!=x.to&&x.to!=h&&v>x.to&&(v=x.to,c=""),k.className&&(l+=" "+k.className),k.css&&(s=(s?s+";":"")+k.css),
k.startStyle&&x.from==h&&(d+=" "+k.startStyle),k.endStyle&&x.to==v&&(b||(b=[])).push(k.endStyle,x.to),k.title&&!u&&(u=k.title),k.collapsed&&(!p||fi(p.marker,k)<0)&&(p=x)):x.from>h&&v>x.from&&(v=x.from)}if(b)for(var w=0;w<b.length;w+=2)b[w+1]==v&&(c+=" "+b[w]);if(!p||p.from==h)for(var w=0;w<y.length;++w)Wi(e,0,y[w]);if(p&&(p.from||0)==h){if(Wi(e,(null==p.to?f+1:p.to)-h,p.marker,null==p.from),null==p.to)return;p.to==h&&(p=!1)}}if(h>=f)break;for(var C=Math.min(f,v);;){if(g){var T=h+g.length;if(!p){var S=T>C?g.slice(0,C-h):g;e.addToken(e,S,a?a+l:l,d,h+S.length==v?c:"",u,s)}if(T>=C){g=g.slice(C-h),h=C;break}h=T,d=""}g=o.slice(r,r=n[m++]),a=Hi(n[m++],e.cm.options)}}else for(var m=1;m<n.length;m+=2)e.addToken(e,o.slice(r,r=n[m]),Hi(n[m+1],e.cm.options))}function qi(t,e){return 0==e.from.ch&&0==e.to.ch&&""==Mo(e.text)&&(!t.cm||t.cm.options.wholeLineUpdateBefore)}function Vi(t,e,n,i){function o(t){return n?n[t]:null}function r(t,n,o){Ii(t,n,o,i),So(t,"change",t,e)}function a(t,e){for(var n=t,r=[];e>n;++n)r.push(new ya(c[n],o(n),i));return r}var s=e.from,l=e.to,c=e.text,d=Qi(t,s.line),u=Qi(t,l.line),p=Mo(c),f=o(c.length-1),h=l.line-s.line;if(e.full)t.insert(0,a(0,c.length)),t.remove(c.length,t.size-c.length);else if(qi(t,e)){var m=a(0,c.length-1);r(u,u.text,f),h&&t.remove(s.line,h),m.length&&t.insert(s.line,m)}else if(d==u)if(1==c.length)r(d,d.text.slice(0,s.ch)+p+d.text.slice(l.ch),f);else{var m=a(1,c.length-1);m.push(new ya(p+d.text.slice(l.ch),f,i)),r(d,d.text.slice(0,s.ch)+c[0],o(0)),t.insert(s.line+1,m)}else if(1==c.length)r(d,d.text.slice(0,s.ch)+c[0]+u.text.slice(l.ch),o(0)),t.remove(s.line+1,h);else{r(d,d.text.slice(0,s.ch)+c[0],o(0)),r(u,p+u.text.slice(l.ch),f);var m=a(1,c.length-1);h>1&&t.remove(s.line+1,h-1),t.insert(s.line+1,m)}So(t,"change",t,e)}function Gi(t){this.lines=t,this.parent=null;for(var e=0,n=0;e<t.length;++e)t[e].parent=this,n+=t[e].height;this.height=n}function Ki(t){this.children=t;for(var e=0,n=0,i=0;i<t.length;++i){var o=t[i];e+=o.chunkSize(),n+=o.height,o.parent=this}this.size=e,this.height=n,this.parent=null}function Xi(t,e,n){function i(t,o,r){if(t.linked)for(var a=0;a<t.linked.length;++a){var s=t.linked[a];if(s.doc!=o){var l=r&&s.sharedHist;(!n||l)&&(e(s.doc,l),i(s.doc,t,l))}}}i(t,null,!0)}function Yi(t,e){if(e.cm)throw new Error("This document is already in use.");t.doc=e,e.cm=t,a(t),n(t),t.options.lineWrapping||p(t),t.options.mode=e.modeOption,Oe(t)}function Qi(t,e){if(e-=t.first,0>e||e>=t.size)throw new Error("There is no line "+(e+t.first)+" in the document.");for(var n=t;!n.lines;)for(var i=0;;++i){var o=n.children[i],r=o.chunkSize();if(r>e){n=o;break}e-=r}return n.lines[e]}function Ji(t,e,n){var i=[],o=e.line;return t.iter(e.line,n.line+1,function(t){var r=t.text;o==n.line&&(r=r.slice(0,n.ch)),o==e.line&&(r=r.slice(e.ch)),i.push(r),++o}),i}function Zi(t,e,n){var i=[];return t.iter(e,n,function(t){i.push(t.text)}),i}function to(t,e){var n=e-t.height;if(n)for(var i=t;i;i=i.parent)i.height+=n}function eo(t){if(null==t.parent)return null;for(var e=t.parent,n=Po(e.lines,t),i=e.parent;i;e=i,i=i.parent)for(var o=0;i.children[o]!=e;++o)n+=i.children[o].chunkSize();return n+e.first}function no(t,e){var n=t.first;t:do{for(var i=0;i<t.children.length;++i){var o=t.children[i],r=o.height;if(r>e){t=o;continue t}e-=r,n+=o.chunkSize()}return n}while(!t.lines);for(var i=0;i<t.lines.length;++i){var a=t.lines[i],s=a.height;if(s>e)break;e-=s}return n+i}function io(t){t=bi(t);for(var e=0,n=t.parent,i=0;i<n.lines.length;++i){var o=n.lines[i];if(o==t)break;e+=o.height}for(var r=n.parent;r;n=r,r=n.parent)for(var i=0;i<r.children.length;++i){var a=r.children[i];if(a==n)break;e+=a.height}return e}function oo(t){var e=t.order;return null==e&&(e=t.order=as(t.text)),e}function ro(t){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=t||1}function ao(t,e){var n={from:G(e.from),to:Jr(e),text:Ji(t,e.from,e.to)};return ho(t,n,e.from.line,e.to.line+1),Xi(t,function(t){ho(t,n,e.from.line,e.to.line+1)},!0),n}function so(t){for(;t.length;){var e=Mo(t);if(!e.ranges)break;t.pop()}}function lo(t,e){return e?(so(t.done),Mo(t.done)):t.done.length&&!Mo(t.done).ranges?Mo(t.done):t.done.length>1&&!t.done[t.done.length-2].ranges?(t.done.pop(),Mo(t.done)):void 0}function co(t,e,n,i){var o=t.history;o.undone.length=0;var r,a=+new Date;if((o.lastOp==i||o.lastOrigin==e.origin&&e.origin&&("+"==e.origin.charAt(0)&&t.cm&&o.lastModTime>a-t.cm.options.historyEventDelay||"*"==e.origin.charAt(0)))&&(r=lo(o,o.lastOp==i))){var s=Mo(r.changes);0==$r(e.from,e.to)&&0==$r(e.from,s.to)?s.to=Jr(e):r.changes.push(ao(t,e))}else{var l=Mo(o.done);for(l&&l.ranges||fo(t.sel,o.done),r={changes:[ao(t,e)],generation:o.generation},o.done.push(r);o.done.length>o.undoDepth;)o.done.shift(),o.done[0].ranges||o.done.shift()}o.done.push(n),o.generation=++o.maxGeneration,o.lastModTime=o.lastSelTime=a,o.lastOp=o.lastSelOp=i,o.lastOrigin=o.lastSelOrigin=e.origin,s||Aa(t,"historyAdded")}function uo(t,e,n,i){var o=e.charAt(0);return"*"==o||"+"==o&&n.ranges.length==i.ranges.length&&n.somethingSelected()==i.somethingSelected()&&new Date-t.history.lastSelTime<=(t.cm?t.cm.options.historyEventDelay:500)}function po(t,e,n,i){var o=t.history,r=i&&i.origin;n==o.lastSelOp||r&&o.lastSelOrigin==r&&(o.lastModTime==o.lastSelTime&&o.lastOrigin==r||uo(t,r,Mo(o.done),e))?o.done[o.done.length-1]=e:fo(e,o.done),o.lastSelTime=+new Date,o.lastSelOrigin=r,o.lastSelOp=n,i&&i.clearRedo!==!1&&so(o.undone)}function fo(t,e){var n=Mo(e);n&&n.ranges&&n.equals(t)||e.push(t)}function ho(t,e,n,i){var o=e["spans_"+t.id],r=0;t.iter(Math.max(t.first,n),Math.min(t.first+t.size,i),function(n){n.markedSpans&&((o||(o=e["spans_"+t.id]={}))[r]=n.markedSpans),++r})}function mo(t){if(!t)return null;for(var e,n=0;n<t.length;++n)t[n].marker.explicitlyCleared?e||(e=t.slice(0,n)):e&&e.push(t[n]);return e?e.length?e:null:t}function go(t,e){var n=e["spans_"+t.id];if(!n)return null;for(var i=0,o=[];i<e.text.length;++i)o.push(mo(n[i]));return o}function vo(t,e,n){for(var i=0,o=[];i<t.length;++i){var r=t[i];if(r.ranges)o.push(n?dt.prototype.deepCopy.call(r):r);else{var a=r.changes,s=[];o.push({changes:s});for(var l=0;l<a.length;++l){var c,d=a[l];if(s.push({from:d.from,to:d.to,text:d.text}),e)for(var u in d)(c=u.match(/^spans_(\d+)$/))&&Po(e,Number(c[1]))>-1&&(Mo(s)[u]=d[u],delete d[u])}}}return o}function bo(t,e,n,i){n<t.line?t.line+=i:e<t.line&&(t.line=e,t.ch=0)}function yo(t,e,n,i){for(var o=0;o<t.length;++o){var r=t[o],a=!0;if(r.ranges){r.copied||(r=t[o]=r.deepCopy(),r.copied=!0);for(var s=0;s<r.ranges.length;s++)bo(r.ranges[s].anchor,e,n,i),bo(r.ranges[s].head,e,n,i)}else{for(var s=0;s<r.changes.length;++s){var l=r.changes[s];if(n<l.from.line)l.from=Hr(l.from.line+i,l.from.ch),l.to=Hr(l.to.line+i,l.to.ch);else if(e<=l.to.line){a=!1;break}}a||(t.splice(0,o+1),o=0)}}}function wo(t,e){var n=e.from.line,i=e.to.line,o=e.text.length-(i-n)-1;yo(t.done,n,i,o),yo(t.undone,n,i,o)}function xo(t){return null!=t.defaultPrevented?t.defaultPrevented:0==t.returnValue}function ko(t){return t.target||t.srcElement}function Co(t){var e=t.which;return null==e&&(1&t.button?e=1:2&t.button?e=3:4&t.button&&(e=2)),Nr&&t.ctrlKey&&1==e&&(e=3),e}function To(t,e,n){var i=t._handlers&&t._handlers[e];return n?i&&i.length>0?i.slice():Na:i||Na}function So(t,e){function n(t){return function(){t.apply(null,r)}}var i=To(t,e,!1);if(i.length){var o,r=Array.prototype.slice.call(arguments,2);Ur?o=Ur.delayedCallbacks:Ma?o=Ma:(o=Ma=[],setTimeout(_o,0));for(var a=0;a<i.length;++a)o.push(n(i[a]))}}function _o(){var t=Ma;Ma=null;for(var e=0;e<t.length;++e)t[e]()}function Io(t,e,n){return"string"==typeof e&&(e={type:e,preventDefault:function(){this.defaultPrevented=!0}}),Aa(t,n||e.type,t,e),xo(e)||e.codemirrorIgnore}function Lo(t){var e=t._handlers&&t._handlers.cursorActivity;if(e)for(var n=t.curOp.cursorActivityHandlers||(t.curOp.cursorActivityHandlers=[]),i=0;i<e.length;++i)-1==Po(n,e[i])&&n.push(e[i])}function Do(t,e){return To(t,e).length>0}function No(t){t.prototype.on=function(t,e){Da(this,t,e)},t.prototype.off=function(t,e){Ea(this,t,e)}}function Eo(){this.id=null}function Ao(t){for(;za.length<=t;)za.push(Mo(za)+" ");return za[t]}function Mo(t){return t[t.length-1]}function Po(t,e){for(var n=0;n<t.length;++n)if(t[n]==e)return n;return-1}function Oo(t,e){for(var n=[],i=0;i<t.length;i++)n[i]=e(t[i],i);return n}function Fo(){}function Ho(t,e){var n;return Object.create?n=Object.create(t):(Fo.prototype=t,n=new Fo),e&&$o(e,n),n}function $o(t,e,n){e||(e={});for(var i in t)!t.hasOwnProperty(i)||n===!1&&e.hasOwnProperty(i)||(e[i]=t[i]);return e}function Bo(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e)}}function Ro(t,e){return e?e.source.indexOf("\\w")>-1&&qa(t)?!0:e.test(t):qa(t)}function zo(t){for(var e in t)if(t.hasOwnProperty(e)&&t[e])return!1;return!0}function jo(t){return t.charCodeAt(0)>=768&&Va.test(t)}function Wo(t,e,n,i){var o=document.createElement(t);if(n&&(o.className=n),i&&(o.style.cssText=i),"string"==typeof e)o.appendChild(document.createTextNode(e));else if(e)for(var r=0;r<e.length;++r)o.appendChild(e[r]);return o}function Uo(t){for(var e=t.childNodes.length;e>0;--e)t.removeChild(t.firstChild);return t}function qo(t,e){return Uo(t).appendChild(e)}function Vo(){for(var t=document.activeElement;t&&t.root&&t.root.activeElement;)t=t.root.activeElement;return t}function Go(t){return new RegExp("(^|\\s)"+t+"(?:$|\\s)\\s*")}function Ko(t,e){for(var n=t.split(" "),i=0;i<n.length;i++)n[i]&&!Go(n[i]).test(e)&&(e+=" "+n[i]);return e}function Xo(t){if(document.body.getElementsByClassName)for(var e=document.body.getElementsByClassName("CodeMirror"),n=0;n<e.length;n++){var i=e[n].CodeMirror;i&&t(i)}}function Yo(){Ja||(Qo(),Ja=!0)}function Qo(){var t;Da(window,"resize",function(){null==t&&(t=setTimeout(function(){t=null,Xo(Ue)},100))}),Da(window,"blur",function(){Xo(bn)})}function Jo(t){if(null==Ka){var e=Wo("span","​");qo(t,Wo("span",[e,document.createTextNode("x")])),0!=t.firstChild.offsetHeight&&(Ka=e.offsetWidth<=1&&e.offsetHeight>2&&!(yr&&8>wr))}var n=Ka?Wo("span","​"):Wo("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return n.setAttribute("cm-text",""),n}function Zo(t){if(null!=Xa)return Xa;var e=qo(t,document.createTextNode("AخA")),n=Wa(e,0,1).getBoundingClientRect();if(!n||n.left==n.right)return!1;var i=Wa(e,1,2).getBoundingClientRect();return Xa=i.right-n.right<3}function tr(t){if(null!=is)return is;var e=qo(t,Wo("span","x")),n=e.getBoundingClientRect(),i=Wa(e,0,1).getBoundingClientRect();return is=Math.abs(n.left-i.left)>1}function er(t,e,n,i){if(!t)return i(e,n,"ltr");for(var o=!1,r=0;r<t.length;++r){var a=t[r];(a.from<n&&a.to>e||e==n&&a.to==e)&&(i(Math.max(a.from,e),Math.min(a.to,n),1==a.level?"rtl":"ltr"),o=!0)}o||i(e,n,"ltr")}function nr(t){return t.level%2?t.to:t.from}function ir(t){return t.level%2?t.from:t.to}function or(t){var e=oo(t);return e?nr(e[0]):0}function rr(t){var e=oo(t);return e?ir(Mo(e)):t.text.length}function ar(t,e){var n=Qi(t.doc,e),i=bi(n);i!=n&&(e=eo(i));var o=oo(i),r=o?o[0].level%2?rr(i):or(i):0;return Hr(e,r)}function sr(t,e){for(var n,i=Qi(t.doc,e);n=gi(i);)i=n.find(1,!0).line,e=null;var o=oo(i),r=o?o[0].level%2?or(i):rr(i):i.text.length;return Hr(null==e?eo(i):e,r)}function lr(t,e){var n=ar(t,e.line),i=Qi(t.doc,n.line),o=oo(i);if(!o||0==o[0].level){var r=Math.max(0,i.text.search(/\S/)),a=e.line==n.line&&e.ch<=r&&e.ch;return Hr(n.line,a?0:r)}return n}function cr(t,e,n){var i=t[0].level;return e==i?!0:n==i?!1:n>e}function dr(t,e){rs=null;for(var n,i=0;i<t.length;++i){var o=t[i];if(o.from<e&&o.to>e)return i;if(o.from==e||o.to==e){if(null!=n)return cr(t,o.level,t[n].level)?(o.from!=o.to&&(rs=n),i):(o.from!=o.to&&(rs=i),n);n=i}}return n}function ur(t,e,n,i){if(!i)return e+n;do e+=n;while(e>0&&jo(t.text.charAt(e)));return e}function pr(t,e,n,i){var o=oo(t);if(!o)return fr(t,e,n,i);for(var r=dr(o,e),a=o[r],s=ur(t,e,a.level%2?-n:n,i);;){if(s>a.from&&s<a.to)return s;if(s==a.from||s==a.to)return dr(o,s)==r?s:(a=o[r+=n],n>0==a.level%2?a.to:a.from);if(a=o[r+=n],!a)return null;s=n>0==a.level%2?ur(t,a.to,-1,i):ur(t,a.from,1,i)}}function fr(t,e,n,i){var o=e+n;if(i)for(;o>0&&jo(t.text.charAt(o));)o+=n;return 0>o||o>t.text.length?null:o}var hr=navigator.userAgent,mr=navigator.platform,gr=/gecko\/\d/i.test(hr),vr=/MSIE \d/.test(hr),br=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(hr),yr=vr||br,wr=yr&&(vr?document.documentMode||6:br[1]),xr=/WebKit\//.test(hr),kr=xr&&/Qt\/\d+\.\d+/.test(hr),Cr=/Chrome\//.test(hr),Tr=/Opera\//.test(hr),Sr=/Apple Computer/.test(navigator.vendor),_r=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(hr),Ir=/PhantomJS/.test(hr),Lr=/AppleWebKit/.test(hr)&&/Mobile\/\w+/.test(hr),Dr=Lr||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(hr),Nr=Lr||/Mac/.test(mr),Er=/win/i.test(mr),Ar=Tr&&hr.match(/Version\/(\d*\.\d*)/);Ar&&(Ar=Number(Ar[1])),Ar&&Ar>=15&&(Tr=!1,xr=!0);var Mr=Nr&&(kr||Tr&&(null==Ar||12.11>Ar)),Pr=gr||yr&&wr>=9,Or=!1,Fr=!1;m.prototype=$o({update:function(t){var e=t.scrollWidth>t.clientWidth+1,n=t.scrollHeight>t.clientHeight+1,i=t.nativeBarWidth;if(n){this.vert.style.display="block",this.vert.style.bottom=e?i+"px":"0";var o=t.viewHeight-(e?i:0);this.vert.firstChild.style.height=Math.max(0,t.scrollHeight-t.clientHeight+o)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(e){this.horiz.style.display="block",this.horiz.style.right=n?i+"px":"0",this.horiz.style.left=t.barLeft+"px";var r=t.viewWidth-t.barLeft-(n?i:0);this.horiz.firstChild.style.width=t.scrollWidth-t.clientWidth+r+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&t.clientHeight>0&&(0==i&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:n?i:0,bottom:e?i:0}},setScrollLeft:function(t){this.horiz.scrollLeft!=t&&(this.horiz.scrollLeft=t),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz)},setScrollTop:function(t){this.vert.scrollTop!=t&&(this.vert.scrollTop=t),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert)},zeroWidthHack:function(){var t=Nr&&!_r?"12px":"18px";this.horiz.style.height=this.vert.style.width=t,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new Eo,this.disableVert=new Eo},enableZeroWidthBar:function(t,e){function n(){var i=t.getBoundingClientRect(),o=document.elementFromPoint(i.left+1,i.bottom-1);o!=t?t.style.pointerEvents="none":e.set(1e3,n)}t.style.pointerEvents="auto",e.set(1e3,n)},clear:function(){var t=this.horiz.parentNode;t.removeChild(this.horiz),t.removeChild(this.vert)}},m.prototype),g.prototype=$o({update:function(){return{bottom:0,right:0}},setScrollLeft:function(){},setScrollTop:function(){},clear:function(){}},g.prototype),t.scrollbarModel={"native":m,"null":g},S.prototype.signal=function(t,e){Do(t,e)&&this.events.push(arguments)},S.prototype.finish=function(){for(var t=0;t<this.events.length;t++)Aa.apply(null,this.events[t])};var Hr=t.Pos=function(t,e){return this instanceof Hr?(this.line=t,void(this.ch=e)):new Hr(t,e)},$r=t.cmpPos=function(t,e){return t.line-e.line||t.ch-e.ch},Br=null;nt.prototype=$o({init:function(t){function e(t){if(!Io(i,t)){if(i.somethingSelected())Br=i.getSelections(),n.inaccurateSelection&&(n.prevInput="",n.inaccurateSelection=!1,r.value=Br.join("\n"),ja(r));else{if(!i.options.lineWiseCopyCut)return;var e=tt(i);Br=e.text,"cut"==t.type?i.setSelections(e.ranges,null,Fa):(n.prevInput="",r.value=e.text.join("\n"),ja(r))}"cut"==t.type&&(i.state.cutIncoming=!0)}}var n=this,i=this.cm,o=this.wrapper=it(),r=this.textarea=o.firstChild;t.wrapper.insertBefore(o,t.wrapper.firstChild),Lr&&(r.style.width="0px"),Da(r,"input",function(){yr&&wr>=9&&n.hasSelection&&(n.hasSelection=null),n.poll()}),Da(r,"paste",function(t){Io(i,t)||J(t,i)||(i.state.pasteIncoming=!0,n.fastPoll())}),Da(r,"cut",e),Da(r,"copy",e),Da(t.scroller,"paste",function(e){qe(t,e)||Io(i,e)||(i.state.pasteIncoming=!0,n.focus())}),Da(t.lineSpace,"selectstart",function(e){qe(t,e)||_a(e)}),Da(r,"compositionstart",function(){var t=i.getCursor("from");n.composing&&n.composing.range.clear(),n.composing={start:t,range:i.markText(t,i.getCursor("to"),{className:"CodeMirror-composing"})}}),Da(r,"compositionend",function(){n.composing&&(n.poll(),n.composing.range.clear(),n.composing=null)})},prepareSelection:function(){var t=this.cm,e=t.display,n=t.doc,i=Ot(t);if(t.options.moveInputWithCursor){var o=fe(t,n.sel.primary().head,"div"),r=e.wrapper.getBoundingClientRect(),a=e.lineDiv.getBoundingClientRect();i.teTop=Math.max(0,Math.min(e.wrapper.clientHeight-10,o.top+a.top-r.top)),i.teLeft=Math.max(0,Math.min(e.wrapper.clientWidth-10,o.left+a.left-r.left))}return i},showSelection:function(t){var e=this.cm,n=e.display;qo(n.cursorDiv,t.cursors),qo(n.selectionDiv,t.selection),null!=t.teTop&&(this.wrapper.style.top=t.teTop+"px",this.wrapper.style.left=t.teLeft+"px")},reset:function(t){if(!this.contextMenuPending){var e,n,i=this.cm,o=i.doc;if(i.somethingSelected()){this.prevInput="";var r=o.sel.primary();e=ns&&(r.to().line-r.from().line>100||(n=i.getSelection()).length>1e3);var a=e?"-":n||i.getSelection();this.textarea.value=a,i.state.focused&&ja(this.textarea),yr&&wr>=9&&(this.hasSelection=a)}else t||(this.prevInput=this.textarea.value="",yr&&wr>=9&&(this.hasSelection=null));this.inaccurateSelection=e}},getField:function(){return this.textarea},supportsTouch:function(){return!1},focus:function(){if("nocursor"!=this.cm.options.readOnly&&(!Dr||Vo()!=this.textarea))try{this.textarea.focus()}catch(t){}},blur:function(){this.textarea.blur()},resetPosition:function(){this.wrapper.style.top=this.wrapper.style.left=0},receivedFocus:function(){this.slowPoll()},slowPoll:function(){var t=this;t.pollingFast||t.polling.set(this.cm.options.pollInterval,function(){t.poll(),t.cm.state.focused&&t.slowPoll()})},fastPoll:function(){function t(){var i=n.poll();i||e?(n.pollingFast=!1,n.slowPoll()):(e=!0,n.polling.set(60,t))}var e=!1,n=this;n.pollingFast=!0,n.polling.set(20,t)},poll:function(){var t=this.cm,e=this.textarea,n=this.prevInput;if(this.contextMenuPending||!t.state.focused||es(e)&&!n&&!this.composing||t.isReadOnly()||t.options.disableInput||t.state.keySeq)return!1;var i=e.value;if(i==n&&!t.somethingSelected())return!1;if(yr&&wr>=9&&this.hasSelection===i||Nr&&/[\uf700-\uf7ff]/.test(i))return t.display.input.reset(),!1;if(t.doc.sel==t.display.selForContextMenu){var o=i.charCodeAt(0);if(8203!=o||n||(n="​"),8666==o)return this.reset(),this.cm.execCommand("undo")}for(var r=0,a=Math.min(n.length,i.length);a>r&&n.charCodeAt(r)==i.charCodeAt(r);)++r;var s=this;return De(t,function(){Q(t,i.slice(r),n.length-r,null,s.composing?"*compose":null),i.length>1e3||i.indexOf("\n")>-1?e.value=s.prevInput="":s.prevInput=i,s.composing&&(s.composing.range.clear(),s.composing.range=t.markText(s.composing.start,t.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},ensurePolled:function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},onKeyPress:function(){yr&&wr>=9&&(this.hasSelection=null),this.fastPoll()},onContextMenu:function(t){function e(){if(null!=a.selectionStart){var t=o.somethingSelected(),e="​"+(t?a.value:"");a.value="⇚",a.value=e,i.prevInput=t?"":"​",a.selectionStart=1,a.selectionEnd=e.length,r.selForContextMenu=o.doc.sel}}function n(){if(i.contextMenuPending=!1,i.wrapper.style.cssText=u,a.style.cssText=d,yr&&9>wr&&r.scrollbars.setScrollTop(r.scroller.scrollTop=l),null!=a.selectionStart){(!yr||yr&&9>wr)&&e();var t=0,n=function(){r.selForContextMenu==o.doc.sel&&0==a.selectionStart&&a.selectionEnd>0&&"​"==i.prevInput?Ne(o,ca.selectAll)(o):t++<10?r.detectingSelectAll=setTimeout(n,500):r.input.reset()};r.detectingSelectAll=setTimeout(n,200)}}var i=this,o=i.cm,r=o.display,a=i.textarea,s=Ve(o,t),l=r.scroller.scrollTop;if(s&&!Tr){var c=o.options.resetSelectionOnContextMenu;c&&-1==o.doc.sel.contains(s)&&Ne(o,_t)(o.doc,ft(s),Fa);var d=a.style.cssText,u=i.wrapper.style.cssText;i.wrapper.style.cssText="position: absolute";var p=i.wrapper.getBoundingClientRect();if(a.style.cssText="position: absolute; width: 30px; height: 30px; top: "+(t.clientY-p.top-5)+"px; left: "+(t.clientX-p.left-5)+"px; z-index: 1000; background: "+(yr?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",xr)var f=window.scrollY;if(r.input.focus(),xr&&window.scrollTo(null,f),r.input.reset(),o.somethingSelected()||(a.value=i.prevInput=" "),i.contextMenuPending=!0,r.selForContextMenu=o.doc.sel,clearTimeout(r.detectingSelectAll),yr&&wr>=9&&e(),Pr){La(t);var h=function(){Ea(window,"mouseup",h),setTimeout(n,20)};Da(window,"mouseup",h)}else setTimeout(n,50)}},readOnlyChanged:function(t){t||this.reset()},setUneditable:Fo,needsContentAttribute:!1},nt.prototype),ot.prototype=$o({init:function(t){function e(t){if(!Io(i,t)){if(i.somethingSelected())Br=i.getSelections(),"cut"==t.type&&i.replaceSelection("",null,"cut");else{if(!i.options.lineWiseCopyCut)return;var e=tt(i);Br=e.text,"cut"==t.type&&i.operation(function(){i.setSelections(e.ranges,0,Fa),i.replaceSelection("",null,"cut")})}if(t.clipboardData&&!Lr)t.preventDefault(),t.clipboardData.clearData(),t.clipboardData.setData("text/plain",Br.join("\n"));else{var n=it(),o=n.firstChild;i.display.lineSpace.insertBefore(n,i.display.lineSpace.firstChild),o.value=Br.join("\n");var r=document.activeElement;ja(o),setTimeout(function(){i.display.lineSpace.removeChild(n),r.focus()},50)}}}var n=this,i=n.cm,o=n.div=t.lineDiv;et(o),Da(o,"paste",function(t){Io(i,t)||J(t,i)}),Da(o,"compositionstart",function(t){var e=t.data;if(n.composing={sel:i.doc.sel,data:e,startData:e},e){var o=i.doc.sel.primary(),r=i.getLine(o.head.line),a=r.indexOf(e,Math.max(0,o.head.ch-e.length));a>-1&&a<=o.head.ch&&(n.composing.sel=ft(Hr(o.head.line,a),Hr(o.head.line,a+e.length)))}}),Da(o,"compositionupdate",function(t){n.composing.data=t.data}),Da(o,"compositionend",function(t){var e=n.composing;e&&(t.data==e.startData||/\u200b/.test(t.data)||(e.data=t.data),setTimeout(function(){e.handled||n.applyComposition(e),n.composing==e&&(n.composing=null)},50))}),Da(o,"touchstart",function(){n.forceCompositionEnd()}),Da(o,"input",function(){n.composing||(i.isReadOnly()||!n.pollContent())&&De(n.cm,function(){Oe(i)})}),Da(o,"copy",e),Da(o,"cut",e)},prepareSelection:function(){var t=Ot(this.cm,!1);return t.focus=this.cm.state.focused,t},showSelection:function(t){t&&this.cm.display.view.length&&(t.focus&&this.showPrimarySelection(),this.showMultipleSelections(t))},showPrimarySelection:function(){var t=window.getSelection(),e=this.cm.doc.sel.primary(),n=st(this.cm,t.anchorNode,t.anchorOffset),i=st(this.cm,t.focusNode,t.focusOffset);if(!n||n.bad||!i||i.bad||0!=$r(X(n,i),e.from())||0!=$r(K(n,i),e.to())){var o=rt(this.cm,e.from()),r=rt(this.cm,e.to());if(o||r){var a=this.cm.display.view,s=t.rangeCount&&t.getRangeAt(0);if(o){if(!r){var l=a[a.length-1].measure,c=l.maps?l.maps[l.maps.length-1]:l.map;r={node:c[c.length-1],offset:c[c.length-2]-c[c.length-3]}}}else o={node:a[0].measure.map[2],offset:0};try{var d=Wa(o.node,o.offset,r.offset,r.node)}catch(u){}d&&(!gr&&this.cm.state.focused?(t.collapse(o.node,o.offset),d.collapsed||t.addRange(d)):(t.removeAllRanges(),t.addRange(d)),s&&null==t.anchorNode?t.addRange(s):gr&&this.startGracePeriod()),this.rememberSelection()}}},startGracePeriod:function(){var t=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){t.gracePeriod=!1,t.selectionChanged()&&t.cm.operation(function(){t.cm.curOp.selectionChanged=!0})},20)},showMultipleSelections:function(t){qo(this.cm.display.cursorDiv,t.cursors),qo(this.cm.display.selectionDiv,t.selection)},rememberSelection:function(){var t=window.getSelection();this.lastAnchorNode=t.anchorNode,this.lastAnchorOffset=t.anchorOffset,this.lastFocusNode=t.focusNode,this.lastFocusOffset=t.focusOffset},selectionInEditor:function(){var t=window.getSelection();if(!t.rangeCount)return!1;var e=t.getRangeAt(0).commonAncestorContainer;return Ga(this.div,e)},focus:function(){"nocursor"!=this.cm.options.readOnly&&this.div.focus()},blur:function(){this.div.blur()},getField:function(){return this.div},supportsTouch:function(){return!0},receivedFocus:function(){function t(){e.cm.state.focused&&(e.pollSelection(),e.polling.set(e.cm.options.pollInterval,t))}var e=this;this.selectionInEditor()?this.pollSelection():De(this.cm,function(){e.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,t)},selectionChanged:function(){var t=window.getSelection();return t.anchorNode!=this.lastAnchorNode||t.anchorOffset!=this.lastAnchorOffset||t.focusNode!=this.lastFocusNode||t.focusOffset!=this.lastFocusOffset},pollSelection:function(){if(!this.composing&&!this.gracePeriod&&this.selectionChanged()){var t=window.getSelection(),e=this.cm;this.rememberSelection();var n=st(e,t.anchorNode,t.anchorOffset),i=st(e,t.focusNode,t.focusOffset);n&&i&&De(e,function(){_t(e.doc,ft(n,i),Fa),(n.bad||i.bad)&&(e.curOp.selectionChanged=!0)})}},pollContent:function(){var t=this.cm,e=t.display,n=t.doc.sel.primary(),i=n.from(),o=n.to();if(i.line<e.viewFrom||o.line>e.viewTo-1)return!1;var r;if(i.line==e.viewFrom||0==(r=$e(t,i.line)))var a=eo(e.view[0].line),s=e.view[0].node;else var a=eo(e.view[r].line),s=e.view[r-1].node.nextSibling;var l=$e(t,o.line);if(l==e.view.length-1)var c=e.viewTo-1,d=e.lineDiv.lastChild;else var c=eo(e.view[l+1].line)-1,d=e.view[l+1].node.previousSibling;for(var u=t.doc.splitLines(ct(t,s,d,a,c)),p=Ji(t.doc,Hr(a,0),Hr(c,Qi(t.doc,c).text.length));u.length>1&&p.length>1;)if(Mo(u)==Mo(p))u.pop(),p.pop(),c--;else{if(u[0]!=p[0])break;u.shift(),p.shift(),a++}for(var f=0,h=0,m=u[0],g=p[0],v=Math.min(m.length,g.length);v>f&&m.charCodeAt(f)==g.charCodeAt(f);)++f;for(var b=Mo(u),y=Mo(p),w=Math.min(b.length-(1==u.length?f:0),y.length-(1==p.length?f:0));w>h&&b.charCodeAt(b.length-h-1)==y.charCodeAt(y.length-h-1);)++h;u[u.length-1]=b.slice(0,b.length-h),u[0]=u[0].slice(f);var x=Hr(a,f),k=Hr(c,p.length?Mo(p).length-h:0);return u.length>1||u[0]||$r(x,k)?(An(t.doc,u,x,k,"+input"),!0):void 0},ensurePolled:function(){this.forceCompositionEnd()},reset:function(){this.forceCompositionEnd()},forceCompositionEnd:function(){this.composing&&!this.composing.handled&&(this.applyComposition(this.composing),this.composing.handled=!0,this.div.blur(),this.div.focus())},applyComposition:function(t){this.cm.isReadOnly()?Ne(this.cm,Oe)(this.cm):t.data&&t.data!=t.startData&&Ne(this.cm,Q)(this.cm,t.data,0,t.sel)},setUneditable:function(t){t.contentEditable="false"},onKeyPress:function(t){t.preventDefault(),this.cm.isReadOnly()||Ne(this.cm,Q)(this.cm,String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),0)},readOnlyChanged:function(t){this.div.contentEditable=String("nocursor"!=t)},onContextMenu:Fo,resetPosition:Fo,needsContentAttribute:!0},ot.prototype),t.inputStyles={textarea:nt,contenteditable:ot},dt.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(t){if(t==this)return!0;if(t.primIndex!=this.primIndex||t.ranges.length!=this.ranges.length)return!1;for(var e=0;e<this.ranges.length;e++){var n=this.ranges[e],i=t.ranges[e];if(0!=$r(n.anchor,i.anchor)||0!=$r(n.head,i.head))return!1}return!0},deepCopy:function(){for(var t=[],e=0;e<this.ranges.length;e++)t[e]=new ut(G(this.ranges[e].anchor),G(this.ranges[e].head));return new dt(t,this.primIndex)},somethingSelected:function(){for(var t=0;t<this.ranges.length;t++)if(!this.ranges[t].empty())return!0;return!1},contains:function(t,e){e||(e=t);for(var n=0;n<this.ranges.length;n++){var i=this.ranges[n];if($r(e,i.from())>=0&&$r(t,i.to())<=0)return n}return-1}},ut.prototype={from:function(){return X(this.anchor,this.head)},to:function(){return K(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};var Rr,zr,jr,Wr={left:0,right:0,top:0,bottom:0},Ur=null,qr=0,Vr=0,Gr=0,Kr=null;yr?Kr=-.53:gr?Kr=15:Cr?Kr=-.7:Sr&&(Kr=-1/3);var Xr=function(t){var e=t.wheelDeltaX,n=t.wheelDeltaY;return null==e&&t.detail&&t.axis==t.HORIZONTAL_AXIS&&(e=t.detail),null==n&&t.detail&&t.axis==t.VERTICAL_AXIS?n=t.detail:null==n&&(n=t.wheelDelta),{x:e,y:n}};t.wheelEventPixels=function(t){var e=Xr(t);return e.x*=Kr,e.y*=Kr,e};var Yr=new Eo,Qr=null,Jr=t.changeEnd=function(t){return t.text?Hr(t.from.line+t.text.length-1,Mo(t.text).length+(1==t.text.length?t.from.ch:0)):t.to};t.prototype={constructor:t,focus:function(){window.focus(),this.display.input.focus()},setOption:function(t,e){var n=this.options,i=n[t];(n[t]!=e||"mode"==t)&&(n[t]=e,ta.hasOwnProperty(t)&&Ne(this,ta[t])(this,e,i))},getOption:function(t){return this.options[t]},getDoc:function(){return this.doc},addKeyMap:function(t,e){this.state.keyMaps[e?"push":"unshift"](Gn(t))},removeKeyMap:function(t){for(var e=this.state.keyMaps,n=0;n<e.length;++n)if(e[n]==t||e[n].name==t)return e.splice(n,1),!0},addOverlay:Ee(function(e,n){var i=e.token?e:t.getMode(this.options,e);if(i.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:i,modeSpec:e,opaque:n&&n.opaque}),this.state.modeGen++,Oe(this)}),removeOverlay:Ee(function(t){for(var e=this.state.overlays,n=0;n<e.length;++n){var i=e[n].modeSpec;if(i==t||"string"==typeof t&&i.name==t)return e.splice(n,1),this.state.modeGen++,void Oe(this)}}),indentLine:Ee(function(t,e,n){"string"!=typeof e&&"number"!=typeof e&&(e=null==e?this.options.smartIndent?"smart":"prev":e?"add":"subtract"),vt(this.doc,t)&&Rn(this,t,e,n)}),indentSelection:Ee(function(t){for(var e=this.doc.sel.ranges,n=-1,i=0;i<e.length;i++){var o=e[i];if(o.empty())o.head.line>n&&(Rn(this,o.head.line,t,!0),n=o.head.line,i==this.doc.sel.primIndex&&$n(this));else{var r=o.from(),a=o.to(),s=Math.max(n,r.line);n=Math.min(this.lastLine(),a.line-(a.ch?0:1))+1;for(var l=s;n>l;++l)Rn(this,l,t);var c=this.doc.sel.ranges;0==r.ch&&e.length==c.length&&c[i].from().ch>0&&kt(this.doc,i,new ut(r,c[i].to()),Fa)}}}),getTokenAt:function(t,e){return Ai(this,t,e)},getLineTokens:function(t,e){return Ai(this,Hr(t),e,!0)},getTokenTypeAt:function(t){t=mt(this.doc,t);var e,n=Oi(this,Qi(this.doc,t.line)),i=0,o=(n.length-1)/2,r=t.ch;if(0==r)e=n[2];else for(;;){var a=i+o>>1;if((a?n[2*a-1]:0)>=r)o=a;else{if(!(n[2*a+1]<r)){e=n[2*a+2];break}i=a+1}}var s=e?e.indexOf("cm-overlay "):-1;return 0>s?e:0==s?null:e.slice(0,s-1)},getModeAt:function(e){var n=this.doc.mode;return n.innerMode?t.innerMode(n,this.getTokenAt(e).state).mode:n},getHelper:function(t,e){return this.getHelpers(t,e)[0]},getHelpers:function(t,e){var n=[];if(!aa.hasOwnProperty(e))return n;var i=aa[e],o=this.getModeAt(t);if("string"==typeof o[e])i[o[e]]&&n.push(i[o[e]]);else if(o[e])for(var r=0;r<o[e].length;r++){var a=i[o[e][r]];a&&n.push(a)}else o.helperType&&i[o.helperType]?n.push(i[o.helperType]):i[o.name]&&n.push(i[o.name]);for(var r=0;r<i._global.length;r++){var s=i._global[r];s.pred(o,this)&&-1==Po(n,s.val)&&n.push(s.val)}return n},getStateAfter:function(t,e){var n=this.doc;return t=ht(n,null==t?n.first+n.size-1:t),jt(this,t+1,e)},cursorCoords:function(t,e){var n,i=this.doc.sel.primary();return n=null==t?i.head:"object"==typeof t?mt(this.doc,t):t?i.from():i.to(),fe(this,n,e||"page")},charCoords:function(t,e){return pe(this,mt(this.doc,t),e||"page")},coordsChar:function(t,e){return t=ue(this,t,e||"page"),ge(this,t.left,t.top)},lineAtHeight:function(t,e){return t=ue(this,{top:t,left:0},e||"page").top,no(this.doc,t+this.display.viewOffset)},heightAtLine:function(t,e){var n,i=!1;if("number"==typeof t){var o=this.doc.first+this.doc.size-1;t<this.doc.first?t=this.doc.first:t>o&&(t=o,i=!0),n=Qi(this.doc,t)}else n=t;return de(this,n,{top:0,left:0},e||"page").top+(i?this.doc.height-io(n):0)},defaultTextHeight:function(){return be(this.display)},defaultCharWidth:function(){return ye(this.display)},setGutterMarker:Ee(function(t,e,n){return zn(this.doc,t,"gutter",function(t){var i=t.gutterMarkers||(t.gutterMarkers={});
return i[e]=n,!n&&zo(i)&&(t.gutterMarkers=null),!0})}),clearGutter:Ee(function(t){var e=this,n=e.doc,i=n.first;n.iter(function(n){n.gutterMarkers&&n.gutterMarkers[t]&&(n.gutterMarkers[t]=null,Fe(e,i,"gutter"),zo(n.gutterMarkers)&&(n.gutterMarkers=null)),++i})}),lineInfo:function(t){if("number"==typeof t){if(!vt(this.doc,t))return null;var e=t;if(t=Qi(this.doc,t),!t)return null}else{var e=eo(t);if(null==e)return null}return{line:e,handle:t,text:t.text,gutterMarkers:t.gutterMarkers,textClass:t.textClass,bgClass:t.bgClass,wrapClass:t.wrapClass,widgets:t.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(t,e,n,i,o){var r=this.display;t=fe(this,mt(this.doc,t));var a=t.bottom,s=t.left;if(e.style.position="absolute",e.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(e),r.sizer.appendChild(e),"over"==i)a=t.top;else if("above"==i||"near"==i){var l=Math.max(r.wrapper.clientHeight,this.doc.height),c=Math.max(r.sizer.clientWidth,r.lineSpace.clientWidth);("above"==i||t.bottom+e.offsetHeight>l)&&t.top>e.offsetHeight?a=t.top-e.offsetHeight:t.bottom+e.offsetHeight<=l&&(a=t.bottom),s+e.offsetWidth>c&&(s=c-e.offsetWidth)}e.style.top=a+"px",e.style.left=e.style.right="","right"==o?(s=r.sizer.clientWidth-e.offsetWidth,e.style.right="0px"):("left"==o?s=0:"middle"==o&&(s=(r.sizer.clientWidth-e.offsetWidth)/2),e.style.left=s+"px"),n&&On(this,s,a,s+e.offsetWidth,a+e.offsetHeight)},triggerOnKeyDown:Ee(pn),triggerOnKeyPress:Ee(mn),triggerOnKeyUp:hn,execCommand:function(t){return ca.hasOwnProperty(t)?ca[t].call(null,this):void 0},triggerElectric:Ee(function(t){Z(this,t)}),findPosH:function(t,e,n,i){var o=1;0>e&&(o=-1,e=-e);for(var r=0,a=mt(this.doc,t);e>r&&(a=Wn(this.doc,a,o,n,i),!a.hitSide);++r);return a},moveH:Ee(function(t,e){var n=this;n.extendSelectionsBy(function(i){return n.display.shift||n.doc.extend||i.empty()?Wn(n.doc,i.head,t,e,n.options.rtlMoveVisually):0>t?i.from():i.to()},$a)}),deleteH:Ee(function(t,e){var n=this.doc.sel,i=this.doc;n.somethingSelected()?i.replaceSelection("",null,"+delete"):jn(this,function(n){var o=Wn(i,n.head,t,e,!1);return 0>t?{from:o,to:n.head}:{from:n.head,to:o}})}),findPosV:function(t,e,n,i){var o=1,r=i;0>e&&(o=-1,e=-e);for(var a=0,s=mt(this.doc,t);e>a;++a){var l=fe(this,s,"div");if(null==r?r=l.left:l.left=r,s=Un(this,l,o,n),s.hitSide)break}return s},moveV:Ee(function(t,e){var n=this,i=this.doc,o=[],r=!n.display.shift&&!i.extend&&i.sel.somethingSelected();if(i.extendSelectionsBy(function(a){if(r)return 0>t?a.from():a.to();var s=fe(n,a.head,"div");null!=a.goalColumn&&(s.left=a.goalColumn),o.push(s.left);var l=Un(n,s,t,e);return"page"==e&&a==i.sel.primary()&&Hn(n,null,pe(n,l,"div").top-s.top),l},$a),o.length)for(var a=0;a<i.sel.ranges.length;a++)i.sel.ranges[a].goalColumn=o[a]}),findWordAt:function(t){var e=this.doc,n=Qi(e,t.line).text,i=t.ch,o=t.ch;if(n){var r=this.getHelper(t,"wordChars");(t.xRel<0||o==n.length)&&i?--i:++o;for(var a=n.charAt(i),s=Ro(a,r)?function(t){return Ro(t,r)}:/\s/.test(a)?function(t){return/\s/.test(t)}:function(t){return!/\s/.test(t)&&!Ro(t)};i>0&&s(n.charAt(i-1));)--i;for(;o<n.length&&s(n.charAt(o));)++o}return new ut(Hr(t.line,i),Hr(t.line,o))},toggleOverwrite:function(t){(null==t||t!=this.state.overwrite)&&((this.state.overwrite=!this.state.overwrite)?Qa(this.display.cursorDiv,"CodeMirror-overwrite"):Ya(this.display.cursorDiv,"CodeMirror-overwrite"),Aa(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==Vo()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:Ee(function(t,e){(null!=t||null!=e)&&Bn(this),null!=t&&(this.curOp.scrollLeft=t),null!=e&&(this.curOp.scrollTop=e)}),getScrollInfo:function(){var t=this.display.scroller;return{left:t.scrollLeft,top:t.scrollTop,height:t.scrollHeight-Vt(this)-this.display.barHeight,width:t.scrollWidth-Vt(this)-this.display.barWidth,clientHeight:Kt(this),clientWidth:Gt(this)}},scrollIntoView:Ee(function(t,e){if(null==t?(t={from:this.doc.sel.primary().head,to:null},null==e&&(e=this.options.cursorScrollMargin)):"number"==typeof t?t={from:Hr(t,0),to:null}:null==t.from&&(t={from:t,to:null}),t.to||(t.to=t.from),t.margin=e||0,null!=t.from.line)Bn(this),this.curOp.scrollToPos=t;else{var n=Fn(this,Math.min(t.from.left,t.to.left),Math.min(t.from.top,t.to.top)-t.margin,Math.max(t.from.right,t.to.right),Math.max(t.from.bottom,t.to.bottom)+t.margin);this.scrollTo(n.scrollLeft,n.scrollTop)}}),setSize:Ee(function(t,e){function n(t){return"number"==typeof t||/^\d+$/.test(String(t))?t+"px":t}var i=this;null!=t&&(i.display.wrapper.style.width=n(t)),null!=e&&(i.display.wrapper.style.height=n(e)),i.options.lineWrapping&&ae(this);var o=i.display.viewFrom;i.doc.iter(o,i.display.viewTo,function(t){if(t.widgets)for(var e=0;e<t.widgets.length;e++)if(t.widgets[e].noHScroll){Fe(i,o,"widget");break}++o}),i.curOp.forceUpdate=!0,Aa(i,"refresh",this)}),operation:function(t){return De(this,t)},refresh:Ee(function(){var t=this.display.cachedTextHeight;Oe(this),this.curOp.forceUpdate=!0,se(this),this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop),d(this),(null==t||Math.abs(t-be(this.display))>.5)&&a(this),Aa(this,"refresh",this)}),swapDoc:Ee(function(t){var e=this.doc;return e.cm=null,Yi(this,t),se(this),this.display.input.reset(),this.scrollTo(t.scrollLeft,t.scrollTop),this.curOp.forceScroll=!0,So(this,"swapDoc",this,e),e}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},No(t);var Zr=t.defaults={},ta=t.optionHandlers={},ea=t.Init={toString:function(){return"CodeMirror.Init"}};qn("value","",function(t,e){t.setValue(e)},!0),qn("mode",null,function(t,e){t.doc.modeOption=e,n(t)},!0),qn("indentUnit",2,n,!0),qn("indentWithTabs",!1),qn("smartIndent",!0),qn("tabSize",4,function(t){i(t),se(t),Oe(t)},!0),qn("lineSeparator",null,function(t,e){if(t.doc.lineSep=e,e){var n=[],i=t.doc.first;t.doc.iter(function(t){for(var o=0;;){var r=t.text.indexOf(e,o);if(-1==r)break;o=r+e.length,n.push(Hr(i,r))}i++});for(var o=n.length-1;o>=0;o--)An(t.doc,e,n[o],Hr(n[o].line,n[o].ch+e.length))}}),qn("specialChars",/[\t\u0000-\u0019\u00ad\u200b-\u200f\u2028\u2029\ufeff]/g,function(e,n,i){e.state.specialChars=new RegExp(n.source+(n.test("	")?"":"|	"),"g"),i!=t.Init&&e.refresh()}),qn("specialCharPlaceholder",Bi,function(t){t.refresh()},!0),qn("electricChars",!0),qn("inputStyle",Dr?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),qn("rtlMoveVisually",!Er),qn("wholeLineUpdateBefore",!0),qn("theme","default",function(t){s(t),l(t)},!0),qn("keyMap","default",function(e,n,i){var o=Gn(n),r=i!=t.Init&&Gn(i);r&&r.detach&&r.detach(e,o),o.attach&&o.attach(e,r||null)}),qn("extraKeys",null),qn("lineWrapping",!1,o,!0),qn("gutters",[],function(t){f(t.options),l(t)},!0),qn("fixedGutter",!0,function(t,e){t.display.gutters.style.left=e?T(t.display)+"px":"0",t.refresh()},!0),qn("coverGutterNextToScrollbar",!1,function(t){b(t)},!0),qn("scrollbarStyle","native",function(t){v(t),b(t),t.display.scrollbars.setScrollTop(t.doc.scrollTop),t.display.scrollbars.setScrollLeft(t.doc.scrollLeft)},!0),qn("lineNumbers",!1,function(t){f(t.options),l(t)},!0),qn("firstLineNumber",1,l,!0),qn("lineNumberFormatter",function(t){return t},l,!0),qn("showCursorWhenSelecting",!1,Pt,!0),qn("resetSelectionOnContextMenu",!0),qn("lineWiseCopyCut",!0),qn("readOnly",!1,function(t,e){"nocursor"==e?(bn(t),t.display.input.blur(),t.display.disabled=!0):t.display.disabled=!1,t.display.input.readOnlyChanged(e)}),qn("disableInput",!1,function(t,e){e||t.display.input.reset()},!0),qn("dragDrop",!0,We),qn("allowDropFileTypes",null),qn("cursorBlinkRate",530),qn("cursorScrollMargin",0),qn("cursorHeight",1,Pt,!0),qn("singleCursorHeightPerLine",!0,Pt,!0),qn("workTime",100),qn("workDelay",100),qn("flattenSpans",!0,i,!0),qn("addModeClass",!1,i,!0),qn("pollInterval",100),qn("undoDepth",200,function(t,e){t.doc.history.undoDepth=e}),qn("historyEventDelay",1250),qn("viewportMargin",10,function(t){t.refresh()},!0),qn("maxHighlightLength",1e4,i,!0),qn("moveInputWithCursor",!0,function(t,e){e||t.display.input.resetPosition()}),qn("tabindex",null,function(t,e){t.display.input.getField().tabIndex=e||""}),qn("autofocus",null);var na=t.modes={},ia=t.mimeModes={};t.defineMode=function(e,n){t.defaults.mode||"null"==e||(t.defaults.mode=e),arguments.length>2&&(n.dependencies=Array.prototype.slice.call(arguments,2)),na[e]=n},t.defineMIME=function(t,e){ia[t]=e},t.resolveMode=function(e){if("string"==typeof e&&ia.hasOwnProperty(e))e=ia[e];else if(e&&"string"==typeof e.name&&ia.hasOwnProperty(e.name)){var n=ia[e.name];"string"==typeof n&&(n={name:n}),e=Ho(n,e),e.name=n.name}else if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return t.resolveMode("application/xml");return"string"==typeof e?{name:e}:e||{name:"null"}},t.getMode=function(e,n){var n=t.resolveMode(n),i=na[n.name];if(!i)return t.getMode(e,"text/plain");var o=i(e,n);if(oa.hasOwnProperty(n.name)){var r=oa[n.name];for(var a in r)r.hasOwnProperty(a)&&(o.hasOwnProperty(a)&&(o["_"+a]=o[a]),o[a]=r[a])}if(o.name=n.name,n.helperType&&(o.helperType=n.helperType),n.modeProps)for(var a in n.modeProps)o[a]=n.modeProps[a];return o},t.defineMode("null",function(){return{token:function(t){t.skipToEnd()}}}),t.defineMIME("text/plain","null");var oa=t.modeExtensions={};t.extendMode=function(t,e){var n=oa.hasOwnProperty(t)?oa[t]:oa[t]={};$o(e,n)},t.defineExtension=function(e,n){t.prototype[e]=n},t.defineDocExtension=function(t,e){Ca.prototype[t]=e},t.defineOption=qn;var ra=[];t.defineInitHook=function(t){ra.push(t)};var aa=t.helpers={};t.registerHelper=function(e,n,i){aa.hasOwnProperty(e)||(aa[e]=t[e]={_global:[]}),aa[e][n]=i},t.registerGlobalHelper=function(e,n,i,o){t.registerHelper(e,n,o),aa[e]._global.push({pred:i,val:o})};var sa=t.copyState=function(t,e){if(e===!0)return e;if(t.copyState)return t.copyState(e);var n={};for(var i in e){var o=e[i];o instanceof Array&&(o=o.concat([])),n[i]=o}return n},la=t.startState=function(t,e,n){return t.startState?t.startState(e,n):!0};t.innerMode=function(t,e){for(;t.innerMode;){var n=t.innerMode(e);if(!n||n.mode==t)break;e=n.state,t=n.mode}return n||{mode:t,state:e}};var ca=t.commands={selectAll:function(t){t.setSelection(Hr(t.firstLine(),0),Hr(t.lastLine()),Fa)},singleSelection:function(t){t.setSelection(t.getCursor("anchor"),t.getCursor("head"),Fa)},killLine:function(t){jn(t,function(e){if(e.empty()){var n=Qi(t.doc,e.head.line).text.length;return e.head.ch==n&&e.head.line<t.lastLine()?{from:e.head,to:Hr(e.head.line+1,0)}:{from:e.head,to:Hr(e.head.line,n)}}return{from:e.from(),to:e.to()}})},deleteLine:function(t){jn(t,function(e){return{from:Hr(e.from().line,0),to:mt(t.doc,Hr(e.to().line+1,0))}})},delLineLeft:function(t){jn(t,function(t){return{from:Hr(t.from().line,0),to:t.from()}})},delWrappedLineLeft:function(t){jn(t,function(e){var n=t.charCoords(e.head,"div").top+5,i=t.coordsChar({left:0,top:n},"div");return{from:i,to:e.from()}})},delWrappedLineRight:function(t){jn(t,function(e){var n=t.charCoords(e.head,"div").top+5,i=t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:n},"div");return{from:e.from(),to:i}})},undo:function(t){t.undo()},redo:function(t){t.redo()},undoSelection:function(t){t.undoSelection()},redoSelection:function(t){t.redoSelection()},goDocStart:function(t){t.extendSelection(Hr(t.firstLine(),0))},goDocEnd:function(t){t.extendSelection(Hr(t.lastLine()))},goLineStart:function(t){t.extendSelectionsBy(function(e){return ar(t,e.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(t){t.extendSelectionsBy(function(e){return lr(t,e.head)},{origin:"+move",bias:1})},goLineEnd:function(t){t.extendSelectionsBy(function(e){return sr(t,e.head.line)},{origin:"+move",bias:-1})},goLineRight:function(t){t.extendSelectionsBy(function(e){var n=t.charCoords(e.head,"div").top+5;return t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:n},"div")},$a)},goLineLeft:function(t){t.extendSelectionsBy(function(e){var n=t.charCoords(e.head,"div").top+5;return t.coordsChar({left:0,top:n},"div")},$a)},goLineLeftSmart:function(t){t.extendSelectionsBy(function(e){var n=t.charCoords(e.head,"div").top+5,i=t.coordsChar({left:0,top:n},"div");return i.ch<t.getLine(i.line).search(/\S/)?lr(t,e.head):i},$a)},goLineUp:function(t){t.moveV(-1,"line")},goLineDown:function(t){t.moveV(1,"line")},goPageUp:function(t){t.moveV(-1,"page")},goPageDown:function(t){t.moveV(1,"page")},goCharLeft:function(t){t.moveH(-1,"char")},goCharRight:function(t){t.moveH(1,"char")},goColumnLeft:function(t){t.moveH(-1,"column")},goColumnRight:function(t){t.moveH(1,"column")},goWordLeft:function(t){t.moveH(-1,"word")},goGroupRight:function(t){t.moveH(1,"group")},goGroupLeft:function(t){t.moveH(-1,"group")},goWordRight:function(t){t.moveH(1,"word")},delCharBefore:function(t){t.deleteH(-1,"char")},delCharAfter:function(t){t.deleteH(1,"char")},delWordBefore:function(t){t.deleteH(-1,"word")},delWordAfter:function(t){t.deleteH(1,"word")},delGroupBefore:function(t){t.deleteH(-1,"group")},delGroupAfter:function(t){t.deleteH(1,"group")},indentAuto:function(t){t.indentSelection("smart")},indentMore:function(t){t.indentSelection("add")},indentLess:function(t){t.indentSelection("subtract")},insertTab:function(t){t.replaceSelection("	")},insertSoftTab:function(t){for(var e=[],n=t.listSelections(),i=t.options.tabSize,o=0;o<n.length;o++){var r=n[o].from(),a=Ba(t.getLine(r.line),r.ch,i);e.push(new Array(i-a%i+1).join(" "))}t.replaceSelections(e)},defaultTab:function(t){t.somethingSelected()?t.indentSelection("add"):t.execCommand("insertTab")},transposeChars:function(t){De(t,function(){for(var e=t.listSelections(),n=[],i=0;i<e.length;i++){var o=e[i].head,r=Qi(t.doc,o.line).text;if(r)if(o.ch==r.length&&(o=new Hr(o.line,o.ch-1)),o.ch>0)o=new Hr(o.line,o.ch+1),t.replaceRange(r.charAt(o.ch-1)+r.charAt(o.ch-2),Hr(o.line,o.ch-2),o,"+transpose");else if(o.line>t.doc.first){var a=Qi(t.doc,o.line-1).text;a&&t.replaceRange(r.charAt(0)+t.doc.lineSeparator()+a.charAt(a.length-1),Hr(o.line-1,a.length-1),Hr(o.line,1),"+transpose")}n.push(new ut(o,o))}t.setSelections(n)})},newlineAndIndent:function(t){De(t,function(){for(var e=t.listSelections().length,n=0;e>n;n++){var i=t.listSelections()[n];t.replaceRange(t.doc.lineSeparator(),i.anchor,i.head,"+input"),t.indentLine(i.from().line+1,null,!0)}$n(t)})},toggleOverwrite:function(t){t.toggleOverwrite()}},da=t.keyMap={};da.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},da.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},da.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},da.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},da["default"]=Nr?da.macDefault:da.pcDefault,t.normalizeKeyMap=function(t){var e={};for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];if(/^(name|fallthrough|(de|at)tach)$/.test(n))continue;if("..."==i){delete t[n];continue}for(var o=Oo(n.split(" "),Vn),r=0;r<o.length;r++){var a,s;r==o.length-1?(s=o.join(" "),a=i):(s=o.slice(0,r+1).join(" "),a="...");var l=e[s];if(l){if(l!=a)throw new Error("Inconsistent bindings for "+s)}else e[s]=a}delete t[n]}for(var c in e)t[c]=e[c];return t};var ua=t.lookupKey=function(t,e,n,i){e=Gn(e);var o=e.call?e.call(t,i):e[t];if(o===!1)return"nothing";if("..."===o)return"multi";if(null!=o&&n(o))return"handled";if(e.fallthrough){if("[object Array]"!=Object.prototype.toString.call(e.fallthrough))return ua(t,e.fallthrough,n,i);for(var r=0;r<e.fallthrough.length;r++){var a=ua(t,e.fallthrough[r],n,i);if(a)return a}}},pa=t.isModifierKey=function(t){var e="string"==typeof t?t:os[t.keyCode];return"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e},fa=t.keyName=function(t,e){if(Tr&&34==t.keyCode&&t["char"])return!1;var n=os[t.keyCode],i=n;return null==i||t.altGraphKey?!1:(t.altKey&&"Alt"!=n&&(i="Alt-"+i),(Mr?t.metaKey:t.ctrlKey)&&"Ctrl"!=n&&(i="Ctrl-"+i),(Mr?t.ctrlKey:t.metaKey)&&"Cmd"!=n&&(i="Cmd-"+i),!e&&t.shiftKey&&"Shift"!=n&&(i="Shift-"+i),i)};t.fromTextArea=function(e,n){function i(){e.value=c.getValue()}if(n=n?$o(n):{},n.value=e.value,!n.tabindex&&e.tabIndex&&(n.tabindex=e.tabIndex),!n.placeholder&&e.placeholder&&(n.placeholder=e.placeholder),null==n.autofocus){var o=Vo();n.autofocus=o==e||null!=e.getAttribute("autofocus")&&o==document.body}if(e.form&&(Da(e.form,"submit",i),!n.leaveSubmitMethodAlone)){var r=e.form,a=r.submit;try{var s=r.submit=function(){i(),r.submit=a,r.submit(),r.submit=s}}catch(l){}}n.finishInit=function(t){t.save=i,t.getTextArea=function(){return e},t.toTextArea=function(){t.toTextArea=isNaN,i(),e.parentNode.removeChild(t.getWrapperElement()),e.style.display="",e.form&&(Ea(e.form,"submit",i),"function"==typeof e.form.submit&&(e.form.submit=a))}},e.style.display="none";var c=t(function(t){e.parentNode.insertBefore(t,e.nextSibling)},n);return c};var ha=t.StringStream=function(t,e){this.pos=this.start=0,this.string=t,this.tabSize=e||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0};ha.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(t){var e=this.string.charAt(this.pos);if("string"==typeof t)var n=e==t;else var n=e&&(t.test?t.test(e):t(e));return n?(++this.pos,e):void 0},eatWhile:function(t){for(var e=this.pos;this.eat(t););return this.pos>e},eatSpace:function(){for(var t=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t},skipToEnd:function(){this.pos=this.string.length},skipTo:function(t){var e=this.string.indexOf(t,this.pos);return e>-1?(this.pos=e,!0):void 0},backUp:function(t){this.pos-=t},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=Ba(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?Ba(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return Ba(this.string,null,this.tabSize)-(this.lineStart?Ba(this.string,this.lineStart,this.tabSize):0)},match:function(t,e,n){if("string"!=typeof t){var i=this.string.slice(this.pos).match(t);return i&&i.index>0?null:(i&&e!==!1&&(this.pos+=i[0].length),i)}var o=function(t){return n?t.toLowerCase():t},r=this.string.substr(this.pos,t.length);return o(r)==o(t)?(e!==!1&&(this.pos+=t.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(t,e){this.lineStart+=t;try{return e()}finally{this.lineStart-=t}}};var ma=0,ga=t.TextMarker=function(t,e){this.lines=[],this.type=e,this.doc=t,this.id=++ma};No(ga),ga.prototype.clear=function(){if(!this.explicitlyCleared){var t=this.doc.cm,e=t&&!t.curOp;if(e&&we(t),Do(this,"clear")){var n=this.find();n&&So(this,"clear",n.from,n.to)}for(var i=null,o=null,r=0;r<this.lines.length;++r){var a=this.lines[r],s=ti(a.markedSpans,this);t&&!this.collapsed?Fe(t,eo(a),"text"):t&&(null!=s.to&&(o=eo(a)),null!=s.from&&(i=eo(a))),a.markedSpans=ei(a.markedSpans,s),null==s.from&&this.collapsed&&!ki(this.doc,a)&&t&&to(a,be(t.display))}if(t&&this.collapsed&&!t.options.lineWrapping)for(var r=0;r<this.lines.length;++r){var l=bi(this.lines[r]),c=u(l);c>t.display.maxLineLength&&(t.display.maxLine=l,t.display.maxLineLength=c,t.display.maxLineChanged=!0)}null!=i&&t&&this.collapsed&&Oe(t,i,o+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,t&&Dt(t.doc)),t&&So(t,"markerCleared",t,this),e&&ke(t),this.parent&&this.parent.clear()}},ga.prototype.find=function(t,e){null==t&&"bookmark"==this.type&&(t=1);for(var n,i,o=0;o<this.lines.length;++o){var r=this.lines[o],a=ti(r.markedSpans,this);if(null!=a.from&&(n=Hr(e?r:eo(r),a.from),-1==t))return n;if(null!=a.to&&(i=Hr(e?r:eo(r),a.to),1==t))return i}return n&&{from:n,to:i}},ga.prototype.changed=function(){var t=this.find(-1,!0),e=this,n=this.doc.cm;t&&n&&De(n,function(){var i=t.line,o=eo(t.line),r=Zt(n,o);if(r&&(re(r),n.curOp.selectionChanged=n.curOp.forceUpdate=!0),n.curOp.updateMaxLine=!0,!ki(e.doc,i)&&null!=e.height){var a=e.height;e.height=null;var s=Si(e)-a;s&&to(i,i.height+s)}})},ga.prototype.attachLine=function(t){if(!this.lines.length&&this.doc.cm){var e=this.doc.cm.curOp;e.maybeHiddenMarkers&&-1!=Po(e.maybeHiddenMarkers,this)||(e.maybeUnhiddenMarkers||(e.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(t)},ga.prototype.detachLine=function(t){if(this.lines.splice(Po(this.lines,t),1),!this.lines.length&&this.doc.cm){var e=this.doc.cm.curOp;(e.maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this)}};var ma=0,va=t.SharedTextMarker=function(t,e){this.markers=t,this.primary=e;for(var n=0;n<t.length;++n)t[n].parent=this};No(va),va.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var t=0;t<this.markers.length;++t)this.markers[t].clear();So(this,"clear")}},va.prototype.find=function(t,e){return this.primary.find(t,e)};var ba=t.LineWidget=function(t,e,n){if(n)for(var i in n)n.hasOwnProperty(i)&&(this[i]=n[i]);this.doc=t,this.node=e};No(ba),ba.prototype.clear=function(){var t=this.doc.cm,e=this.line.widgets,n=this.line,i=eo(n);if(null!=i&&e){for(var o=0;o<e.length;++o)e[o]==this&&e.splice(o--,1);e.length||(n.widgets=null);var r=Si(this);to(n,Math.max(0,n.height-r)),t&&De(t,function(){Ti(t,n,-r),Fe(t,i,"widget")})}},ba.prototype.changed=function(){var t=this.height,e=this.doc.cm,n=this.line;this.height=null;var i=Si(this)-t;i&&(to(n,n.height+i),e&&De(e,function(){e.curOp.forceUpdate=!0,Ti(e,n,i)}))};var ya=t.Line=function(t,e,n){this.text=t,di(this,e),this.height=n?n(this):1};No(ya),ya.prototype.lineNo=function(){return eo(this)};var wa={},xa={};Gi.prototype={chunkSize:function(){return this.lines.length},removeInner:function(t,e){for(var n=t,i=t+e;i>n;++n){var o=this.lines[n];this.height-=o.height,Li(o),So(o,"delete")}this.lines.splice(t,e)},collapse:function(t){t.push.apply(t,this.lines)},insertInner:function(t,e,n){this.height+=n,this.lines=this.lines.slice(0,t).concat(e).concat(this.lines.slice(t));for(var i=0;i<e.length;++i)e[i].parent=this},iterN:function(t,e,n){for(var i=t+e;i>t;++t)if(n(this.lines[t]))return!0}},Ki.prototype={chunkSize:function(){return this.size},removeInner:function(t,e){this.size-=e;for(var n=0;n<this.children.length;++n){var i=this.children[n],o=i.chunkSize();if(o>t){var r=Math.min(e,o-t),a=i.height;if(i.removeInner(t,r),this.height-=a-i.height,o==r&&(this.children.splice(n--,1),i.parent=null),0==(e-=r))break;t=0}else t-=o}if(this.size-e<25&&(this.children.length>1||!(this.children[0]instanceof Gi))){var s=[];this.collapse(s),this.children=[new Gi(s)],this.children[0].parent=this}},collapse:function(t){for(var e=0;e<this.children.length;++e)this.children[e].collapse(t)},insertInner:function(t,e,n){this.size+=e.length,this.height+=n;for(var i=0;i<this.children.length;++i){var o=this.children[i],r=o.chunkSize();if(r>=t){if(o.insertInner(t,e,n),o.lines&&o.lines.length>50){for(;o.lines.length>50;){var a=o.lines.splice(o.lines.length-25,25),s=new Gi(a);o.height-=s.height,this.children.splice(i+1,0,s),s.parent=this}this.maybeSpill()}break}t-=r}},maybeSpill:function(){if(!(this.children.length<=10)){var t=this;do{var e=t.children.splice(t.children.length-5,5),n=new Ki(e);if(t.parent){t.size-=n.size,t.height-=n.height;var i=Po(t.parent.children,t);t.parent.children.splice(i+1,0,n)}else{var o=new Ki(t.children);o.parent=t,t.children=[o,n],t=o}n.parent=t.parent}while(t.children.length>10);t.parent.maybeSpill()}},iterN:function(t,e,n){for(var i=0;i<this.children.length;++i){var o=this.children[i],r=o.chunkSize();if(r>t){var a=Math.min(e,r-t);if(o.iterN(t,a,n))return!0;if(0==(e-=a))break;t=0}else t-=r}}};var ka=0,Ca=t.Doc=function(t,e,n,i){if(!(this instanceof Ca))return new Ca(t,e,n,i);null==n&&(n=0),Ki.call(this,[new Gi([new ya("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.frontier=n;var o=Hr(n,0);this.sel=ft(o),this.history=new ro(null),this.id=++ka,this.modeOption=e,this.lineSep=i,this.extend=!1,"string"==typeof t&&(t=this.splitLines(t)),Vi(this,{from:o,to:o,text:t}),_t(this,ft(o),Fa)};Ca.prototype=Ho(Ki.prototype,{constructor:Ca,iter:function(t,e,n){n?this.iterN(t-this.first,e-t,n):this.iterN(this.first,this.first+this.size,t)},insert:function(t,e){for(var n=0,i=0;i<e.length;++i)n+=e[i].height;this.insertInner(t-this.first,e,n)},remove:function(t,e){this.removeInner(t-this.first,e)},getValue:function(t){var e=Zi(this,this.first,this.first+this.size);return t===!1?e:e.join(t||this.lineSeparator())},setValue:Ae(function(t){var e=Hr(this.first,0),n=this.first+this.size-1;_n(this,{from:e,to:Hr(n,Qi(this,n).text.length),text:this.splitLines(t),origin:"setValue",full:!0},!0),_t(this,ft(e))}),replaceRange:function(t,e,n,i){e=mt(this,e),n=n?mt(this,n):e,An(this,t,e,n,i)},getRange:function(t,e,n){var i=Ji(this,mt(this,t),mt(this,e));return n===!1?i:i.join(n||this.lineSeparator())},getLine:function(t){var e=this.getLineHandle(t);return e&&e.text},getLineHandle:function(t){return vt(this,t)?Qi(this,t):void 0},getLineNumber:function(t){return eo(t)},getLineHandleVisualStart:function(t){return"number"==typeof t&&(t=Qi(this,t)),bi(t)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(t){return mt(this,t)},getCursor:function(t){var e,n=this.sel.primary();return e=null==t||"head"==t?n.head:"anchor"==t?n.anchor:"end"==t||"to"==t||t===!1?n.to():n.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:Ae(function(t,e,n){Ct(this,mt(this,"number"==typeof t?Hr(t,e||0):t),null,n)}),setSelection:Ae(function(t,e,n){Ct(this,mt(this,t),mt(this,e||t),n)}),extendSelection:Ae(function(t,e,n){wt(this,mt(this,t),e&&mt(this,e),n)}),extendSelections:Ae(function(t,e){xt(this,bt(this,t),e)}),extendSelectionsBy:Ae(function(t,e){var n=Oo(this.sel.ranges,t);xt(this,bt(this,n),e)}),setSelections:Ae(function(t,e,n){if(t.length){for(var i=0,o=[];i<t.length;i++)o[i]=new ut(mt(this,t[i].anchor),mt(this,t[i].head));null==e&&(e=Math.min(t.length-1,this.sel.primIndex)),_t(this,pt(o,e),n)}}),addSelection:Ae(function(t,e,n){var i=this.sel.ranges.slice(0);i.push(new ut(mt(this,t),mt(this,e||t))),_t(this,pt(i,i.length-1),n)}),getSelection:function(t){for(var e,n=this.sel.ranges,i=0;i<n.length;i++){var o=Ji(this,n[i].from(),n[i].to());e=e?e.concat(o):o}return t===!1?e:e.join(t||this.lineSeparator())},getSelections:function(t){for(var e=[],n=this.sel.ranges,i=0;i<n.length;i++){var o=Ji(this,n[i].from(),n[i].to());t!==!1&&(o=o.join(t||this.lineSeparator())),e[i]=o}return e},replaceSelection:function(t,e,n){for(var i=[],o=0;o<this.sel.ranges.length;o++)i[o]=t;this.replaceSelections(i,e,n||"+input")},replaceSelections:Ae(function(t,e,n){for(var i=[],o=this.sel,r=0;r<o.ranges.length;r++){var a=o.ranges[r];i[r]={from:a.from(),to:a.to(),text:this.splitLines(t[r]),origin:n}}for(var s=e&&"end"!=e&&Tn(this,i,e),r=i.length-1;r>=0;r--)_n(this,i[r]);s?St(this,s):this.cm&&$n(this.cm)}),undo:Ae(function(){Ln(this,"undo")}),redo:Ae(function(){Ln(this,"redo")}),undoSelection:Ae(function(){Ln(this,"undo",!0)}),redoSelection:Ae(function(){Ln(this,"redo",!0)}),setExtending:function(t){this.extend=t},getExtending:function(){return this.extend},historySize:function(){for(var t=this.history,e=0,n=0,i=0;i<t.done.length;i++)t.done[i].ranges||++e;for(var i=0;i<t.undone.length;i++)t.undone[i].ranges||++n;return{undo:e,redo:n}},clearHistory:function(){this.history=new ro(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(t){return t&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(t){return this.history.generation==(t||this.cleanGeneration)},getHistory:function(){return{done:vo(this.history.done),undone:vo(this.history.undone)}},setHistory:function(t){var e=this.history=new ro(this.history.maxGeneration);e.done=vo(t.done.slice(0),null,!0),e.undone=vo(t.undone.slice(0),null,!0)},addLineClass:Ae(function(t,e,n){return zn(this,t,"gutter"==e?"gutter":"class",function(t){var i="text"==e?"textClass":"background"==e?"bgClass":"gutter"==e?"gutterClass":"wrapClass";if(t[i]){if(Go(n).test(t[i]))return!1;t[i]+=" "+n}else t[i]=n;return!0})}),removeLineClass:Ae(function(t,e,n){return zn(this,t,"gutter"==e?"gutter":"class",function(t){var i="text"==e?"textClass":"background"==e?"bgClass":"gutter"==e?"gutterClass":"wrapClass",o=t[i];if(!o)return!1;if(null==n)t[i]=null;else{var r=o.match(Go(n));if(!r)return!1;var a=r.index+r[0].length;t[i]=o.slice(0,r.index)+(r.index&&a!=o.length?" ":"")+o.slice(a)||null}return!0})}),addLineWidget:Ae(function(t,e,n){return _i(this,t,e,n)}),removeLineWidget:function(t){t.clear()},markText:function(t,e,n){return Kn(this,mt(this,t),mt(this,e),n,n&&n.type||"range")},setBookmark:function(t,e){var n={replacedWith:e&&(null==e.nodeType?e.widget:e),insertLeft:e&&e.insertLeft,clearWhenEmpty:!1,shared:e&&e.shared,handleMouseEvents:e&&e.handleMouseEvents};return t=mt(this,t),Kn(this,t,t,n,"bookmark")},findMarksAt:function(t){t=mt(this,t);var e=[],n=Qi(this,t.line).markedSpans;if(n)for(var i=0;i<n.length;++i){var o=n[i];(null==o.from||o.from<=t.ch)&&(null==o.to||o.to>=t.ch)&&e.push(o.marker.parent||o.marker)}return e},findMarks:function(t,e,n){t=mt(this,t),e=mt(this,e);var i=[],o=t.line;return this.iter(t.line,e.line+1,function(r){var a=r.markedSpans;if(a)for(var s=0;s<a.length;s++){var l=a[s];null!=l.to&&o==t.line&&t.ch>l.to||null==l.from&&o!=t.line||null!=l.from&&o==e.line&&l.from>e.ch||n&&!n(l.marker)||i.push(l.marker.parent||l.marker)}++o}),i},getAllMarks:function(){var t=[];return this.iter(function(e){var n=e.markedSpans;if(n)for(var i=0;i<n.length;++i)null!=n[i].from&&t.push(n[i].marker);
}),t},posFromIndex:function(t){var e,n=this.first;return this.iter(function(i){var o=i.text.length+1;return o>t?(e=t,!0):(t-=o,void++n)}),mt(this,Hr(n,e))},indexFromPos:function(t){t=mt(this,t);var e=t.ch;return t.line<this.first||t.ch<0?0:(this.iter(this.first,t.line,function(t){e+=t.text.length+1}),e)},copy:function(t){var e=new Ca(Zi(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep);return e.scrollTop=this.scrollTop,e.scrollLeft=this.scrollLeft,e.sel=this.sel,e.extend=!1,t&&(e.history.undoDepth=this.history.undoDepth,e.setHistory(this.getHistory())),e},linkedDoc:function(t){t||(t={});var e=this.first,n=this.first+this.size;null!=t.from&&t.from>e&&(e=t.from),null!=t.to&&t.to<n&&(n=t.to);var i=new Ca(Zi(this,e,n),t.mode||this.modeOption,e,this.lineSep);return t.sharedHist&&(i.history=this.history),(this.linked||(this.linked=[])).push({doc:i,sharedHist:t.sharedHist}),i.linked=[{doc:this,isParent:!0,sharedHist:t.sharedHist}],Qn(i,Yn(this)),i},unlinkDoc:function(e){if(e instanceof t&&(e=e.doc),this.linked)for(var n=0;n<this.linked.length;++n){var i=this.linked[n];if(i.doc==e){this.linked.splice(n,1),e.unlinkDoc(this),Jn(Yn(this));break}}if(e.history==this.history){var o=[e.id];Xi(e,function(t){o.push(t.id)},!0),e.history=new ro(null),e.history.done=vo(this.history.done,o),e.history.undone=vo(this.history.undone,o)}},iterLinkedDocs:function(t){Xi(this,t)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(t){return this.lineSep?t.split(this.lineSep):ts(t)},lineSeparator:function(){return this.lineSep||"\n"}}),Ca.prototype.eachLine=Ca.prototype.iter;var Ta="iter insert remove copy getEditor constructor".split(" ");for(var Sa in Ca.prototype)Ca.prototype.hasOwnProperty(Sa)&&Po(Ta,Sa)<0&&(t.prototype[Sa]=function(t){return function(){return t.apply(this.doc,arguments)}}(Ca.prototype[Sa]));No(Ca);var _a=t.e_preventDefault=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},Ia=t.e_stopPropagation=function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},La=t.e_stop=function(t){_a(t),Ia(t)},Da=t.on=function(t,e,n){if(t.addEventListener)t.addEventListener(e,n,!1);else if(t.attachEvent)t.attachEvent("on"+e,n);else{var i=t._handlers||(t._handlers={}),o=i[e]||(i[e]=[]);o.push(n)}},Na=[],Ea=t.off=function(t,e,n){if(t.removeEventListener)t.removeEventListener(e,n,!1);else if(t.detachEvent)t.detachEvent("on"+e,n);else for(var i=To(t,e,!1),o=0;o<i.length;++o)if(i[o]==n){i.splice(o,1);break}},Aa=t.signal=function(t,e){var n=To(t,e,!0);if(n.length)for(var i=Array.prototype.slice.call(arguments,2),o=0;o<n.length;++o)n[o].apply(null,i)},Ma=null,Pa=30,Oa=t.Pass={toString:function(){return"CodeMirror.Pass"}},Fa={scroll:!1},Ha={origin:"*mouse"},$a={origin:"+move"};Eo.prototype.set=function(t,e){clearTimeout(this.id),this.id=setTimeout(e,t)};var Ba=t.countColumn=function(t,e,n,i,o){null==e&&(e=t.search(/[^\s\u00a0]/),-1==e&&(e=t.length));for(var r=i||0,a=o||0;;){var s=t.indexOf("	",r);if(0>s||s>=e)return a+(e-r);a+=s-r,a+=n-a%n,r=s+1}},Ra=t.findColumn=function(t,e,n){for(var i=0,o=0;;){var r=t.indexOf("	",i);-1==r&&(r=t.length);var a=r-i;if(r==t.length||o+a>=e)return i+Math.min(a,e-o);if(o+=r-i,o+=n-o%n,i=r+1,o>=e)return i}},za=[""],ja=function(t){t.select()};Lr?ja=function(t){t.selectionStart=0,t.selectionEnd=t.value.length}:yr&&(ja=function(t){try{t.select()}catch(e){}});var Wa,Ua=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,qa=t.isWordChar=function(t){return/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||Ua.test(t))},Va=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;Wa=document.createRange?function(t,e,n,i){var o=document.createRange();return o.setEnd(i||t,n),o.setStart(t,e),o}:function(t,e,n){var i=document.body.createTextRange();try{i.moveToElementText(t.parentNode)}catch(o){return i}return i.collapse(!0),i.moveEnd("character",n),i.moveStart("character",e),i};var Ga=t.contains=function(t,e){if(3==e.nodeType&&(e=e.parentNode),t.contains)return t.contains(e);do if(11==e.nodeType&&(e=e.host),e==t)return!0;while(e=e.parentNode)};yr&&11>wr&&(Vo=function(){try{return document.activeElement}catch(t){return document.body}});var Ka,Xa,Ya=t.rmClass=function(t,e){var n=t.className,i=Go(e).exec(n);if(i){var o=n.slice(i.index+i[0].length);t.className=n.slice(0,i.index)+(o?i[1]+o:"")}},Qa=t.addClass=function(t,e){var n=t.className;Go(e).test(n)||(t.className+=(n?" ":"")+e)},Ja=!1,Za=function(){if(yr&&9>wr)return!1;var t=Wo("div");return"draggable"in t||"dragDrop"in t}(),ts=t.splitLines=3!="\n\nb".split(/\n/).length?function(t){for(var e=0,n=[],i=t.length;i>=e;){var o=t.indexOf("\n",e);-1==o&&(o=t.length);var r=t.slice(e,"\r"==t.charAt(o-1)?o-1:o),a=r.indexOf("\r");-1!=a?(n.push(r.slice(0,a)),e+=a+1):(n.push(r),e=o+1)}return n}:function(t){return t.split(/\r\n?|\n/)},es=window.getSelection?function(t){try{return t.selectionStart!=t.selectionEnd}catch(e){return!1}}:function(t){try{var e=t.ownerDocument.selection.createRange()}catch(n){}return e&&e.parentElement()==t?0!=e.compareEndPoints("StartToEnd",e):!1},ns=function(){var t=Wo("div");return"oncopy"in t?!0:(t.setAttribute("oncopy","return;"),"function"==typeof t.oncopy)}(),is=null,os=t.keyNames={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};!function(){for(var t=0;10>t;t++)os[t+48]=os[t+96]=String(t);for(var t=65;90>=t;t++)os[t]=String.fromCharCode(t);for(var t=1;12>=t;t++)os[t+111]=os[t+63235]="F"+t}();var rs,as=function(){function t(t){return 247>=t?n.charAt(t):t>=1424&&1524>=t?"R":t>=1536&&1773>=t?i.charAt(t-1536):t>=1774&&2220>=t?"r":t>=8192&&8203>=t?"w":8204==t?"b":"L"}function e(t,e,n){this.level=t,this.from=e,this.to=n}var n="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",i="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",o=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,r=/[stwN]/,a=/[LRr]/,s=/[Lb1n]/,l=/[1n]/,c="L";return function(n){if(!o.test(n))return!1;for(var i,d=n.length,u=[],p=0;d>p;++p)u.push(i=t(n.charCodeAt(p)));for(var p=0,f=c;d>p;++p){var i=u[p];"m"==i?u[p]=f:f=i}for(var p=0,h=c;d>p;++p){var i=u[p];"1"==i&&"r"==h?u[p]="n":a.test(i)&&(h=i,"r"==i&&(u[p]="R"))}for(var p=1,f=u[0];d-1>p;++p){var i=u[p];"+"==i&&"1"==f&&"1"==u[p+1]?u[p]="1":","!=i||f!=u[p+1]||"1"!=f&&"n"!=f||(u[p]=f),f=i}for(var p=0;d>p;++p){var i=u[p];if(","==i)u[p]="N";else if("%"==i){for(var m=p+1;d>m&&"%"==u[m];++m);for(var g=p&&"!"==u[p-1]||d>m&&"1"==u[m]?"1":"N",v=p;m>v;++v)u[v]=g;p=m-1}}for(var p=0,h=c;d>p;++p){var i=u[p];"L"==h&&"1"==i?u[p]="L":a.test(i)&&(h=i)}for(var p=0;d>p;++p)if(r.test(u[p])){for(var m=p+1;d>m&&r.test(u[m]);++m);for(var b="L"==(p?u[p-1]:c),y="L"==(d>m?u[m]:c),g=b||y?"L":"R",v=p;m>v;++v)u[v]=g;p=m-1}for(var w,x=[],p=0;d>p;)if(s.test(u[p])){var k=p;for(++p;d>p&&s.test(u[p]);++p);x.push(new e(0,k,p))}else{var C=p,T=x.length;for(++p;d>p&&"L"!=u[p];++p);for(var v=C;p>v;)if(l.test(u[v])){v>C&&x.splice(T,0,new e(1,C,v));var S=v;for(++v;p>v&&l.test(u[v]);++v);x.splice(T,0,new e(2,S,v)),C=v}else++v;p>C&&x.splice(T,0,new e(1,C,p))}return 1==x[0].level&&(w=n.match(/^\s+/))&&(x[0].from=w[0].length,x.unshift(new e(0,0,w[0].length))),1==Mo(x).level&&(w=n.match(/\s+$/))&&(Mo(x).to-=w[0].length,x.push(new e(0,d-w[0].length,d))),2==x[0].level&&x.unshift(new e(1,x[0].to,x[0].to)),x[0].level!=Mo(x).level&&x.push(new e(x[0].level,d,d)),x}}();return t.version="5.13.4",t})},function(t,e,n){var i=n(1),o=n(7),r=function(t){console.info("route to be parsed: "+t);var e=[],n="",i=t.split("#"),o=1==i.length?i[0]:i[1],r=o.split("?"),a=r[0]||n,s=r[1]||"",l={};l.route=a,l.expression=-1!=a.indexOf("_"),l.expression?(l.routeKey=a.replace(/_(\w+)/g,"_"),l.paramList=a.match(/_(\w+)/g)):(l.routeKey=a,l.paramList=[]);for(var c=l.paramList.length,d=0;c>d;d++)l.paramList[d]=l.paramList[d].slice(l.paramList[d].indexOf("_")+1);var u={};s&&s.split("&").forEach(function(t){var e=t.split("=");u[e[0]]=e[1]||""}),l.query=u;var p=a.split("/");return l.module=p[0]||"",l.topic=p[1]||"",l.subModule=p[2]||"",l.subTopic=p[3]||"",e.push(l),e},a=function(t){i.observable(this),this.history=[],this.routeMap={},this.routeViewCache={},this.defaultHash=t&&t.defaultHash||""},s={init:function(){var t=this;i.route.parser(r),i.route(t._doRoute.bind(t)),this.on("init",function(){}),this.on("before-view-route-to",t._doBeforeViewRouteTo.bind(t)),this.on("view-route-to",t._doViewRouteTo.bind(t)),this.on("view-route-back",t._doViewRouteBack.bind(t)),window.prdOrNot?window.onload=function(){t.trigger("init")}:i.compile(function(){t.trigger("init")})},route:function(t,e){var n={};if(n.route=t,n.handler=e,n.expression=-1!=t.indexOf(":"),n.expression){var i=t.match(/_(:\w+)/g);n.routeKey=t.replace(/_(:\w+)/g,"_");for(var o=i.length,r=0;o>r;r++)i[r]=i[r].slice(i[r].indexOf("_:")+2);n.paramNames=i}else n.paramNames=[],n.routeKey=t;this.routeMap[n.routeKey]=n,console.info("a route rule is added:"),console.info(n)},routeView:function(t,e){var n=this;this.route(t,function(t){var i=n.routeViewCache[e.name];i||(i=n.routeViewCache[e.name]=e,i.setParent(n),i.init(t)),i.context=t,n.trigger("before-view-route-to",i),i.route(t)})},currentTrigger:function(){var t=this.currentView&&this.currentView.tag;t&&t.trigger.apply(t,arguments)},_doBeforeViewRouteTo:function(t){this.currentView==t&&this.currentView.equalRoute(t)?this.currentView&&this.currentView.reenter():(this.currentView&&this.currentView.leave(this.currentView,t),t.enter(this.currentView,t))},_doViewRouteTo:function(t){this.currentView&&this.currentView.show(!1),this.lastView=this.currentView,this.currentView=t,this.currentView&&this.currentView.show(!0)},_doViewRouteBack:function(t){this.lastView&&this.lastView.context&&i.route(this.lastView.context.req.route)},_doRoute:function(t){var e=this,n={app:e,req:t},i=e.routeMap[t.routeKey];if(i){var o={};if(i.expression)for(var r=i.paramNames.length,a="",s=0;r>s;s++)a=i.paramNames[s],o[a]=t.paramList[s]||null;t.params=o;var l=i.handler;if(l)try{l(n)}catch(c){console.error(c),console.error("500 on "+t.route+" :"+c.message),e.trigger("500",t,c)}else console.info("404 on "+t.route),e.trigger("404",t)}else console.info("404 on "+t.route),e.trigger("404",t)},emptyFn:function(){}};o.extend(a.prototype,s),t.exports=a}]);